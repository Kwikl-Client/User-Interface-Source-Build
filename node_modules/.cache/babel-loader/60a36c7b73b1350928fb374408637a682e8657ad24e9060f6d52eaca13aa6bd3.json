{"ast":null,"code":"import { addClass, detach, EventHandler, isNullOrUndefined, Ajax } from '@syncfusion/ej2-base';\nimport { Browser, closest, removeClass, isNullOrUndefined as isNOU } from '@syncfusion/ej2-base';\nimport * as events from '../base/constant';\nimport * as classes from '../base/classes';\nimport { Uploader } from '@syncfusion/ej2-inputs';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { RenderType } from '../base/enum';\nimport { dispatchEvent, hasClass, convertToBlob } from '../base/util';\nimport { isIDevice } from '../../common/util';\n/**\n * `Audio` module is used to handle audio actions.\n */\nvar Audio = /** @class */function () {\n  function Audio(parent, serviceLocator) {\n    this.isAudioUploaded = false;\n    this.isAllowedTypes = true;\n    this.deletedAudio = [];\n    this.parent = parent;\n    this.rteID = parent.element.id;\n    this.i10n = serviceLocator.getService('rteLocale');\n    this.rendererFactory = serviceLocator.getService('rendererFactory');\n    this.dialogRenderObj = serviceLocator.getService('dialogRenderObject');\n    this.addEventListener();\n  }\n  Audio.prototype.addEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n    this.parent.on(events.keyDown, this.onKeyDown, this);\n    this.parent.on(events.keyUp, this.onKeyUp, this);\n    this.parent.on(events.insertAudio, this.insertingAudio, this);\n    this.parent.on(events.initialEnd, this.afterRender, this);\n    this.parent.on(events.dynamicModule, this.afterRender, this);\n    this.parent.on(events.showAudioDialog, this.showDialog, this);\n    this.parent.on(events.closeAudioDialog, this.closeDialog, this);\n    this.parent.on(events.audioToolbarAction, this.onToolbarAction, this);\n    this.parent.on(events.dropDownSelect, this.alignmentSelect, this);\n    this.parent.on(events.audioDelete, this.deleteAudio, this);\n    this.parent.on(events.editAreaClick, this.editAreaClickHandler, this);\n    this.parent.on(events.insertCompleted, this.showAudioQuickToolbar, this);\n    this.parent.on(events.destroy, this.removeEventListener, this);\n  };\n  Audio.prototype.removeEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n    this.parent.off(events.keyDown, this.onKeyDown);\n    this.parent.off(events.keyUp, this.onKeyUp);\n    this.parent.off(events.insertAudio, this.insertingAudio);\n    this.parent.off(events.initialEnd, this.afterRender);\n    this.parent.off(events.dynamicModule, this.afterRender);\n    this.parent.off(events.showAudioDialog, this.showDialog);\n    this.parent.off(events.closeAudioDialog, this.closeDialog);\n    this.parent.off(events.audioToolbarAction, this.onToolbarAction);\n    this.parent.off(events.dropDownSelect, this.alignmentSelect);\n    this.parent.off(events.audioDelete, this.deleteAudio);\n    this.parent.off(events.editAreaClick, this.editAreaClickHandler);\n    this.parent.off(events.insertCompleted, this.showAudioQuickToolbar);\n    this.parent.off(events.destroy, this.removeEventListener);\n    if (!isNullOrUndefined(this.contentModule)) {\n      EventHandler.remove(this.parent.contentModule.getEditPanel(), Browser.touchStartEvent, this.touchStart);\n      EventHandler.remove(this.contentModule.getEditPanel(), Browser.touchEndEvent, this.audioClick);\n      EventHandler.remove(this.parent.element.ownerDocument, 'mousedown', this.onDocumentClick);\n    }\n  };\n  Audio.prototype.afterRender = function () {\n    this.contentModule = this.rendererFactory.getRenderer(RenderType.Content);\n    EventHandler.add(this.parent.contentModule.getEditPanel(), Browser.touchStartEvent, this.touchStart, this);\n    EventHandler.add(this.contentModule.getEditPanel(), Browser.touchEndEvent, this.audioClick, this);\n    EventHandler.add(this.parent.element.ownerDocument, 'mousedown', this.onDocumentClick, this);\n  };\n  Audio.prototype.checkAudioBack = function (range) {\n    if (range.startContainer.nodeName === '#text' && range.startOffset === 0 && !isNOU(range.startContainer.previousSibling) && this.isAudioElem(range.startContainer.previousSibling)) {\n      this.deletedAudio.push(range.startContainer.previousSibling);\n    } else if (range.startContainer.nodeName !== '#text' && !isNOU(range.startContainer.childNodes[range.startOffset - 1]) && this.isAudioElem(range.startContainer.childNodes[range.startOffset - 1])) {\n      this.deletedAudio.push(range.startContainer.childNodes[range.startOffset - 1]);\n    }\n  };\n  Audio.prototype.checkAudioDel = function (range) {\n    if (range.startContainer.nodeName === '#text' && range.startOffset === range.startContainer.textContent.length && !isNOU(range.startContainer.nextSibling) && range.startContainer.nextSibling.nodeName === 'IMG') {\n      this.deletedAudio.push(range.startContainer.nextSibling);\n    } else if (range.startContainer.nodeName !== '#text' && !isNOU(range.startContainer.childNodes[range.startOffset]) && this.isAudioElem(range.startContainer.childNodes[range.startOffset])) {\n      this.deletedAudio.push(range.startContainer.childNodes[range.startOffset]);\n    }\n  };\n  Audio.prototype.undoStack = function (args) {\n    if (args.subCommand.toLowerCase() === 'undo' || args.subCommand.toLowerCase() === 'redo') {\n      for (var i = 0; i < this.parent.formatter.getUndoRedoStack().length; i++) {\n        var temp = this.parent.createElement('div');\n        var contentElem = this.parent.formatter.getUndoRedoStack()[i].text;\n        temp.appendChild(contentElem.cloneNode(true));\n      }\n    }\n  };\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  Audio.prototype.touchStart = function (e, ele) {\n    if (this.parent.readonly) {\n      return;\n    }\n    this.prevSelectedAudEle = this.audEle;\n  };\n  Audio.prototype.onToolbarAction = function (args) {\n    if (isIDevice()) {\n      this.parent.notify(events.selectionRestore, {});\n    }\n    var item = args.args.item;\n    switch (item.subCommand) {\n      case 'AudioReplace':\n        this.parent.notify(events.insertAudio, args);\n        break;\n      case 'AudioRemove':\n        this.parent.notify(events.audioDelete, args);\n        break;\n    }\n  };\n  // eslint-disable-next-line\n  Audio.prototype.onKeyUp = function (event) {\n    if (!isNOU(this.deletedAudio) && this.deletedAudio.length > 0) {\n      for (var i = 0; i < this.deletedAudio.length - 1; i++) {\n        var args = {\n          element: this.deletedAudio[i].querySelector('audio'),\n          src: this.deletedAudio[i].querySelector('source').getAttribute('src')\n        };\n        this.parent.trigger(events.afterMediaDelete, args);\n      }\n    }\n  };\n  Audio.prototype.onKeyDown = function (event) {\n    var originalEvent = event.args;\n    var range;\n    var save;\n    var selectNodeEle;\n    var selectParentEle;\n    this.deletedAudio = [];\n    var isCursor;\n    var keyCodeValues = [27, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 44, 45, 9, 16, 17, 18, 19, 20, 33, 34, 35, 36, 37, 38, 39, 40, 91, 92, 93, 144, 145, 182, 183];\n    if (this.parent.editorMode === 'HTML') {\n      range = this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());\n      isCursor = range.startContainer === range.endContainer && range.startOffset === range.endOffset;\n    }\n    if (!isCursor && this.parent.editorMode === 'HTML' && keyCodeValues.indexOf(originalEvent.which) < 0) {\n      var nodes = this.parent.formatter.editorManager.nodeSelection.getNodeCollection(range);\n      for (var i = 0; i < nodes.length; i++) {\n        if (this.isAudioElem(nodes[i])) {\n          this.deletedAudio.push(nodes[i]);\n        }\n      }\n    }\n    if (this.parent.editorMode === 'HTML' && (originalEvent.which === 8 && originalEvent.code === 'Backspace' || originalEvent.which === 46 && originalEvent.code === 'Delete')) {\n      var isCursor_1 = range.startContainer === range.endContainer && range.startOffset === range.endOffset;\n      if (originalEvent.which === 8 && originalEvent.code === 'Backspace' && isCursor_1) {\n        this.checkAudioBack(range);\n      } else if (originalEvent.which === 46 && originalEvent.code === 'Delete' && isCursor_1) {\n        this.checkAudioDel(range);\n      }\n    }\n    if (!isNullOrUndefined(this.parent.formatter.editorManager.nodeSelection) && originalEvent.code !== 'KeyK') {\n      range = this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());\n      selectNodeEle = this.parent.formatter.editorManager.nodeSelection.getNodeCollection(range);\n      selectParentEle = this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(range);\n      if (!originalEvent.ctrlKey && originalEvent.key && (originalEvent.key.length === 1 || originalEvent.action === 'enter') && this.isAudioElem(selectParentEle[0]) && selectParentEle[0].parentElement) {\n        var prev = selectParentEle[0].parentElement.childNodes[0];\n        this.parent.formatter.editorManager.nodeSelection.setSelectionText(this.contentModule.getDocument(), prev, prev, prev.textContent.length, prev.textContent.length);\n        removeClass([selectParentEle[0]], classes.CLS_AUD_FOCUS);\n        this.quickToolObj.audioQTBar.hidePopup();\n      }\n    }\n    if (originalEvent.ctrlKey && (originalEvent.keyCode === 89 || originalEvent.keyCode === 90)) {\n      this.undoStack({\n        subCommand: originalEvent.keyCode === 90 ? 'undo' : 'redo'\n      });\n    }\n    if (originalEvent.keyCode === 8 || originalEvent.keyCode === 46) {\n      if (selectNodeEle && this.isAudioElem(selectNodeEle[0]) && selectNodeEle.length < 1) {\n        if (!isNullOrUndefined(this.parent.formatter.editorManager.nodeSelection)) {\n          save = this.parent.formatter.editorManager.nodeSelection.save(range, this.parent.contentModule.getDocument());\n        }\n        originalEvent.preventDefault();\n        var event_1 = {\n          selectNode: selectNodeEle,\n          selection: save,\n          selectParent: selectParentEle,\n          args: {\n            item: {\n              command: 'Audios',\n              subCommand: 'AudioRemove'\n            },\n            originalEvent: originalEvent\n          }\n        };\n        this.deleteAudio(event_1, originalEvent.keyCode);\n      }\n    }\n    switch (originalEvent.action) {\n      case 'escape':\n        if (!isNullOrUndefined(this.dialogObj)) {\n          this.dialogObj.close();\n        }\n        break;\n      case 'backspace':\n      case 'delete':\n        for (var i = 0; i < this.deletedAudio.length; i++) {\n          var src = this.deletedAudio[i].src;\n          this.audioRemovePost(src);\n        }\n        if (this.parent.editorMode !== 'Markdown') {\n          if (range.startContainer.nodeType === 3) {\n            if (originalEvent.code === 'Backspace') {\n              if (range.startContainer.previousElementSibling && range.startOffset === 0 && range.startContainer.previousElementSibling.classList.contains(classes.CLS_AUDIOWRAP)) {\n                detach(range.startContainer.previousElementSibling);\n              }\n            } else {\n              if (range.startContainer.nextElementSibling && range.endContainer.textContent.length === range.endOffset && range.startContainer.nextElementSibling.classList.contains(classes.CLS_AUDIOWRAP)) {\n                detach(range.startContainer.nextElementSibling);\n              }\n            }\n          } else if (range.startContainer.nodeType === 1 && range.startContainer.classList && (range.startContainer.classList.contains(classes.CLS_AUDIOWRAP) || range.startContainer.classList.contains(classes.CLS_CLICKELEM) || range.startContainer.classList.contains(classes.CLS_VID_CLICK_ELEM))) {\n            detach(range.startContainer);\n          }\n        }\n        break;\n      case 'insert-audio':\n        if (!isNullOrUndefined(this.parent.formatter.editorManager.nodeSelection)) {\n          save = this.parent.formatter.editorManager.nodeSelection.save(range, this.parent.contentModule.getDocument());\n        }\n        this.openDialog(true, originalEvent, save, selectNodeEle, selectParentEle);\n        originalEvent.preventDefault();\n        break;\n    }\n    if (originalEvent.ctrlKey && originalEvent.key === 'a') {\n      this.handleSelectAll();\n    }\n  };\n  Audio.prototype.handleSelectAll = function () {\n    var audioFocusNodes = this.parent.inputElement.querySelectorAll('.' + classes.CLS_AUD_FOCUS);\n    removeClass(audioFocusNodes, classes.CLS_AUD_FOCUS);\n  };\n  Audio.prototype.openDialog = function (isInternal, event, selection, ele, parentEle) {\n    var range;\n    var save;\n    var selectNodeEle;\n    var selectParentEle;\n    if (!isInternal && !isNOU(this.parent.formatter.editorManager.nodeSelection)) {\n      range = this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());\n      save = this.parent.formatter.editorManager.nodeSelection.save(range, this.parent.contentModule.getDocument());\n      selectNodeEle = this.parent.formatter.editorManager.nodeSelection.getNodeCollection(range);\n      selectParentEle = this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(range);\n    } else {\n      save = selection;\n      selectNodeEle = ele;\n      selectParentEle = parentEle;\n    }\n    if (this.parent.editorMode === 'HTML') {\n      this.insertAudio({\n        args: {\n          item: {\n            command: 'Audios',\n            subCommand: 'Audio'\n          },\n          originalEvent: event,\n          name: !isInternal ? 'showDialog' : null\n        },\n        selectNode: selectNodeEle,\n        selection: save,\n        selectParent: selectParentEle\n      });\n    }\n  };\n  Audio.prototype.showDialog = function () {\n    this.openDialog(false);\n  };\n  Audio.prototype.closeDialog = function () {\n    if (this.dialogObj) {\n      this.dialogObj.hide({\n        returnValue: true\n      });\n    }\n  };\n  Audio.prototype.deleteAudio = function (e, keyCode) {\n    if (!this.isAudioElem(e.selectNode[0])) {\n      return;\n    }\n    if (this.audEle) {\n      if (e.selectNode[0].nodeType === 3) {\n        e.selectNode[0] = this.audEle;\n      } else if (this.isAudioElem(e.selectNode[0])) {\n        e.selectNode[0] = e.selectNode[0].classList.contains(classes.CLS_AUDIOWRAP) ? e.selectNode[0] : e.selectNode[0].parentElement;\n      }\n    }\n    var args = {\n      element: e.selectNode[0].querySelector('audio'),\n      src: e.selectNode[0].querySelector('source').getAttribute('src')\n    };\n    if (this.parent.formatter.getUndoRedoStack().length === 0) {\n      this.parent.formatter.saveData();\n    }\n    e.selection.restore();\n    this.parent.formatter.process(this.parent, e.args, e.args, {\n      selectNode: e.selectNode,\n      subCommand: e.args.item.subCommand\n    });\n    this.audioRemovePost(args.src);\n    if (this.quickToolObj && document.body.contains(this.quickToolObj.audioQTBar.element)) {\n      this.quickToolObj.audioQTBar.hidePopup();\n    }\n    if (isNullOrUndefined(keyCode)) {\n      this.parent.trigger(events.afterMediaDelete, args);\n    }\n  };\n  Audio.prototype.audioRemovePost = function (src) {\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    var proxy = this;\n    var absoluteUrl = '';\n    if (isNOU(this.parent.insertAudioSettings.removeUrl) || this.parent.insertAudioSettings.removeUrl === '') {\n      return;\n    }\n    if (src.indexOf('http://') > -1 || src.indexOf('https://') > -1) {\n      absoluteUrl = src;\n    } else {\n      absoluteUrl = new URL(src, document.baseURI).href;\n    }\n    this.removingAudioName = absoluteUrl.replace(/^.*[\\\\/]/, '');\n    var xhr = new XMLHttpRequest();\n    // eslint-disable-next-line @typescript-eslint/tslint/config\n    xhr.addEventListener('readystatechange', function () {\n      if (this.readyState === 4 && this.status === 200) {\n        proxy.triggerPost(this.response);\n      }\n    });\n    xhr.open('GET', absoluteUrl);\n    xhr.responseType = 'blob';\n    xhr.send();\n  };\n  Audio.prototype.triggerPost = function (response) {\n    var removeUrl = this.parent.insertAudioSettings.removeUrl;\n    if (isNOU(removeUrl) || removeUrl === '') {\n      return;\n    }\n    var file = new File([response], this.removingAudioName);\n    var ajax = new Ajax(removeUrl, 'POST', true, null);\n    var formData = new FormData();\n    formData.append('UploadFiles', file);\n    ajax.send(formData);\n  };\n  Audio.prototype.audioClick = function (e) {\n    if (Browser.isDevice) {\n      if (this.isAudioElem(e.target)) {\n        this.contentModule.getEditPanel().setAttribute('contenteditable', 'false');\n        e.target.focus();\n      } else {\n        if (!this.parent.readonly) {\n          this.contentModule.getEditPanel().setAttribute('contenteditable', 'true');\n        }\n      }\n    }\n    if (this.isAudioElem(e.target)) {\n      this.audEle = e.target.querySelector('audio');\n      e.preventDefault();\n    }\n  };\n  Audio.prototype.onDocumentClick = function (e) {\n    var target = e.target;\n    if (this.isAudioElem(target)) {\n      this.audEle = target.querySelector('audio');\n    }\n    if (!isNullOrUndefined(this.dialogObj) && (\n    // eslint-disable-next-line\n    !closest(target, '[id=' + \"'\" + this.dialogObj.element.id + \"'\" + ']') && this.parent.toolbarSettings.enable && this.parent.getToolbarElement() && !this.parent.getToolbarElement().contains(e.target) || this.parent.getToolbarElement() && this.parent.getToolbarElement().contains(e.target) && !closest(target, '#' + this.parent.getID() + '_toolbar_Audio') && !target.querySelector('#' + this.parent.getID() + '_toolbar_Audio'))) {\n      /* eslint-disable */\n      if (e.offsetX > e.target.clientWidth || e.offsetY > e.target.clientHeight) {} else {\n        this.parent.notify(events.documentClickClosedBy, {\n          closedBy: \"outside click\"\n        });\n        this.dialogObj.hide({\n          returnValue: true\n        });\n        this.parent.isBlur = true;\n        dispatchEvent(this.parent.element, 'focusout');\n      }\n      /* eslint-enable */\n    }\n    if (this.contentModule.getEditPanel().querySelector('.' + classes.CLS_AUD_FOCUS)) {\n      if (!this.isAudioElem(e.target) && !isNOU(this.audEle)) {\n        this.audEle.style.outline = '';\n      } else if (!isNOU(this.prevSelectedAudEle) && this.prevSelectedAudEle !== target) {\n        this.prevSelectedAudEle.style.outline = '';\n      }\n    }\n  };\n  Audio.prototype.alignmentSelect = function (e) {\n    var item = e.item;\n    if (!document.body.contains(document.body.querySelector('.e-rte-quick-toolbar')) || item.command !== 'Audios') {\n      return;\n    }\n    var range = this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());\n    var selectNodeEle = this.parent.formatter.editorManager.nodeSelection.getNodeCollection(range);\n    selectNodeEle = [this.audEle];\n    var args = {\n      args: e,\n      selectNode: selectNodeEle\n    };\n    if (this.parent.formatter.getUndoRedoStack().length === 0) {\n      this.parent.formatter.saveData();\n    }\n    switch (item.subCommand) {\n      case 'Inline':\n        this.inline(args);\n        break;\n      case 'Break':\n        this.break(args);\n        break;\n    }\n    if (this.quickToolObj && document.body.contains(this.quickToolObj.audioQTBar.element)) {\n      this.quickToolObj.audioQTBar.hidePopup();\n      removeClass([selectNodeEle[0]], classes.CLS_AUD_FOCUS);\n    }\n  };\n  Audio.prototype.break = function (e) {\n    if (e.selectNode[0].nodeName !== 'AUDIO') {\n      return;\n    }\n    var subCommand = e.args.item ? e.args.item.subCommand : 'Break';\n    this.parent.formatter.process(this.parent, e.args, e.args, {\n      selectNode: e.selectNode,\n      subCommand: subCommand\n    });\n  };\n  Audio.prototype.inline = function (e) {\n    if (e.selectNode[0].nodeName !== 'AUDIO') {\n      return;\n    }\n    var subCommand = e.args.item ? e.args.item.subCommand : 'Inline';\n    this.parent.formatter.process(this.parent, e.args, e.args, {\n      selectNode: e.selectNode,\n      subCommand: subCommand\n    });\n  };\n  Audio.prototype.editAreaClickHandler = function (e) {\n    if (this.parent.readonly) {\n      this.hideAudioQuickToolbar();\n      return;\n    }\n    var args = e.args;\n    var showOnRightClick = this.parent.quickToolbarSettings.showOnRightClick;\n    if (args.which === 2 || showOnRightClick && args.which === 1 || !showOnRightClick && args.which === 3) {\n      if (showOnRightClick && args.which === 1 && !isNullOrUndefined(args.target) && this.isAudioElem(args.target)) {\n        this.parent.formatter.editorManager.nodeSelection.Clear(this.contentModule.getDocument());\n        this.parent.formatter.editorManager.nodeSelection.setSelectionContents(this.contentModule.getDocument(), args.target);\n      }\n      return;\n    }\n    if (this.parent.editorMode === 'HTML' && this.parent.quickToolbarModule && this.parent.quickToolbarModule.audioQTBar) {\n      this.quickToolObj = this.parent.quickToolbarModule;\n      var target = args.target;\n      this.contentModule = this.rendererFactory.getRenderer(RenderType.Content);\n      var isPopupOpen = this.quickToolObj.audioQTBar.element.classList.contains('e-rte-pop');\n      if (this.isAudioElem(target) && this.parent.quickToolbarModule) {\n        if (isPopupOpen) {\n          return;\n        }\n        this.parent.formatter.editorManager.nodeSelection.Clear(this.contentModule.getDocument());\n        this.parent.formatter.editorManager.nodeSelection.setSelectionContents(this.contentModule.getDocument(), target);\n        if (isIDevice()) {\n          this.parent.notify(events.selectionSave, e);\n        }\n        target.querySelector('audio').style.outline = '2px solid #4a90e2';\n        this.showAudioQuickToolbar({\n          args: args,\n          type: 'Audios',\n          elements: [args.target]\n        });\n      } else {\n        this.hideAudioQuickToolbar();\n      }\n    }\n  };\n  Audio.prototype.isAudioElem = function (target) {\n    if (target && target.nodeType !== 3 && target.nodeName !== 'BR' && target.classList && (target.classList.contains(classes.CLS_AUDIOWRAP) || target.classList.contains(classes.CLS_CLICKELEM))) {\n      return true;\n    } else {\n      return false;\n    }\n  };\n  Audio.prototype.showAudioQuickToolbar = function (e) {\n    var _this = this;\n    if (e.type !== 'Audios' || isNullOrUndefined(this.parent.quickToolbarModule) || isNullOrUndefined(this.parent.quickToolbarModule.audioQTBar) || isNullOrUndefined(e.args)) {\n      return;\n    }\n    this.quickToolObj = this.parent.quickToolbarModule;\n    var args = e.args;\n    var target = e.elements;\n    [].forEach.call(e.elements, function (element, index) {\n      if (index === 0) {\n        target = element;\n      }\n    });\n    if (this.isAudioElem(target)) {\n      addClass([target.querySelector('audio')], [classes.CLS_AUD_FOCUS]);\n      target.querySelector('audio').style.outline = '2px solid #4a90e2';\n    }\n    if (this.parent.quickToolbarModule.audioQTBar) {\n      if (e.isNotify) {\n        setTimeout(function () {\n          _this.parent.formatter.editorManager.nodeSelection.Clear(_this.contentModule.getDocument());\n          _this.parent.formatter.editorManager.nodeSelection.setSelectionContents(_this.contentModule.getDocument(), target);\n          _this.quickToolObj.audioQTBar.showPopup(args.pageX - 50, target.getBoundingClientRect().top + 34, target);\n        }, 400);\n      } else {\n        this.quickToolObj.audioQTBar.showPopup(args.pageX - 50, target.getBoundingClientRect().top + 34, target);\n      }\n    }\n  };\n  Audio.prototype.hideAudioQuickToolbar = function () {\n    if (!isNullOrUndefined(this.contentModule.getEditPanel().querySelector('.' + classes.CLS_AUD_FOCUS))) {\n      removeClass([this.contentModule.getEditPanel().querySelector('.' + classes.CLS_AUD_FOCUS)], classes.CLS_AUD_FOCUS);\n      if (!isNOU(this.audEle)) {\n        this.audEle.style.outline = '';\n      }\n      if (this.quickToolObj && this.quickToolObj.audioQTBar && document.body.contains(this.quickToolObj.audioQTBar.element)) {\n        this.quickToolObj.audioQTBar.hidePopup();\n      }\n    }\n  };\n  Audio.prototype.insertingAudio = function (e) {\n    this.insertAudio(e);\n    if (!isNullOrUndefined(this.dialogObj)) {\n      this.dialogObj.element.style.maxHeight = 'inherit';\n      var dialogContent = this.dialogObj.element.querySelector('.e-audio-content');\n      if (!isNullOrUndefined(this.parent.insertAudioSettings.path) || this.parent.editorMode === 'HTML') {\n        document.getElementById(this.rteID + '_insertAudio').focus();\n      } else {\n        dialogContent.querySelector('.e-audio-url').focus();\n      }\n    }\n  };\n  Audio.prototype.insertAudio = function (e) {\n    var _this = this;\n    if (this.dialogObj) {\n      this.dialogObj.hide({\n        returnValue: true\n      });\n      return;\n    }\n    var audioDialog = this.parent.createElement('div', {\n      className: 'e-rte-audio-dialog',\n      id: this.rteID + '_audio'\n    });\n    this.parent.element.appendChild(audioDialog);\n    var audioInsert = this.i10n.getConstant('dialogInsert');\n    var audiolinkCancel = this.i10n.getConstant('dialogCancel');\n    var audioHeader = this.i10n.getConstant('audioHeader');\n    var selection = e.selection;\n    var selectObj = {\n      selfAudio: this,\n      selection: e.selection,\n      args: e.args,\n      selectParent: e.selectParent\n    };\n    var dialogModel = {\n      header: audioHeader,\n      cssClass: classes.CLS_RTE_ELEMENTS,\n      enableRtl: this.parent.enableRtl,\n      locale: this.parent.locale,\n      showCloseIcon: true,\n      closeOnEscape: true,\n      width: Browser.isDevice ? '290px' : '340px',\n      isModal: Browser.isDevice,\n      buttons: [{\n        click: this.insertAudioUrl.bind(selectObj),\n        buttonModel: {\n          content: audioInsert,\n          cssClass: 'e-flat e-insertAudio',\n          isPrimary: true,\n          disabled: true\n        }\n      }, {\n        click: function (e) {\n          _this.cancelDialog(e);\n        },\n        buttonModel: {\n          cssClass: 'e-flat e-cancel',\n          content: audiolinkCancel\n        }\n      }],\n      target: Browser.isDevice ? document.body : this.parent.element,\n      animationSettings: {\n        effect: 'None'\n      },\n      close: function (event) {\n        if (_this.isAudioUploaded) {\n          _this.uploadObj.removing();\n        }\n        _this.parent.isBlur = false;\n        if (event && event.event.returnValue) {\n          if (_this.parent.editorMode === 'HTML') {\n            selection.restore();\n          }\n        }\n        _this.dialogObj.destroy();\n        detach(_this.dialogObj.element);\n        _this.dialogRenderObj.close(event);\n        _this.dialogObj = null;\n      }\n    };\n    var dialogContent = this.parent.createElement('div', {\n      className: 'e-audio-content'\n    });\n    if (!isNullOrUndefined(this.parent.insertAudioSettings.path) || this.parent.editorMode === 'HTML') {\n      dialogContent.appendChild(this.audioUpload(e));\n    }\n    var linkHeader = this.parent.createElement('div', {\n      className: 'e-audioheader'\n    });\n    var linkHeaderText = this.i10n.getConstant('audioLinkHeader');\n    if (this.parent.editorMode === 'HTML') {\n      linkHeader.innerHTML = linkHeaderText;\n    }\n    dialogContent.appendChild(linkHeader);\n    dialogContent.appendChild(this.audioUrlPopup(e));\n    if (e.selectNode && e.selectNode[0].nodeType === 1 && this.isAudioElem(e.selectNode[0])) {\n      dialogModel.header = this.parent.localeObj.getConstant('editAudioHeader');\n      dialogModel.content = dialogContent;\n    } else {\n      dialogModel.content = dialogContent;\n    }\n    this.dialogObj = this.dialogRenderObj.render(dialogModel);\n    this.dialogObj.createElement = this.parent.createElement;\n    this.dialogObj.appendTo(audioDialog);\n    if (e.selectNode && e.selectNode[0].nodeType === 1 && this.isAudioElem(e.selectNode[0]) && e.name === 'insertAudio') {\n      this.dialogObj.element.querySelector('.e-insertAudio').textContent = this.parent.localeObj.getConstant('dialogUpdate');\n    }\n    audioDialog.style.maxHeight = 'inherit';\n    if (this.quickToolObj) {\n      if (this.quickToolObj.audioQTBar && document.body.contains(this.quickToolObj.audioQTBar.element)) {\n        this.quickToolObj.audioQTBar.hidePopup();\n      }\n      if (this.quickToolObj.inlineQTBar && document.body.contains(this.quickToolObj.inlineQTBar.element)) {\n        this.quickToolObj.inlineQTBar.hidePopup();\n      }\n      if (this.quickToolObj.textQTBar && this.parent.element.ownerDocument.body.contains(this.quickToolObj.textQTBar.element)) {\n        this.quickToolObj.textQTBar.hidePopup();\n      }\n    }\n  };\n  // eslint-disable-next-line\n  Audio.prototype.audioUrlPopup = function (e) {\n    var _this = this;\n    var audioUrl = this.parent.createElement('div', {\n      className: 'audioUrl'\n    });\n    var placeUrl = this.i10n.getConstant('audioUrl');\n    this.inputUrl = this.parent.createElement('input', {\n      className: 'e-input e-audio-url',\n      attrs: {\n        placeholder: placeUrl,\n        spellcheck: 'false',\n        'aria-label': this.i10n.getConstant('audioLinkHeader')\n      }\n    });\n    this.inputUrl.addEventListener('input', function () {\n      if (!isNOU(_this.inputUrl)) {\n        if (_this.inputUrl.value.length === 0) {\n          _this.dialogObj.getButtons(0).element.disabled = true;\n        } else {\n          _this.dialogObj.getButtons(0).element.removeAttribute('disabled');\n        }\n      }\n    });\n    if (e.selectNode && this.isAudioElem(e.selectNode[0])) {\n      var regex = new RegExp(/([^\\S]|^)(((https?\\:\\/\\/)|(www\\.))(\\S+))/gi);\n      var sourceElement = e.selectNode[0].querySelector('source');\n      this.inputUrl.value = sourceElement.src.match(regex) ? sourceElement.src : '';\n    }\n    audioUrl.appendChild(this.inputUrl);\n    return audioUrl;\n  };\n  Audio.prototype.audioUpload = function (e) {\n    var _this = this;\n    var save;\n    var selectParent;\n    // eslint-disable-next-line\n    var proxy = this;\n    var iframe = proxy.parent.iframeSettings.enable;\n    if (proxy.parent.editorMode === 'HTML' && (!iframe && isNullOrUndefined(closest(e.selection.range.startContainer.parentNode, '[id='\n    // eslint-disable-next-line\n    + \"'\" + this.parent.contentModule.getPanel().id + \"'\" + ']')) || iframe && !hasClass(e.selection.range.startContainer.parentNode.ownerDocument.querySelector('body'), 'e-lib'))) {\n      this.contentModule.getEditPanel().focus();\n      var range = this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());\n      save = this.parent.formatter.editorManager.nodeSelection.save(range, this.parent.contentModule.getDocument());\n      selectParent = this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(range);\n    } else {\n      save = e.selection;\n      selectParent = e.selectParent;\n    }\n    var uploadParentEle = this.parent.createElement('div', {\n      className: 'e-aud-uploadwrap e-droparea'\n    });\n    var deviceAudioUpMsg = this.i10n.getConstant('audioDeviceUploadMessage');\n    var audioUpMsg = this.i10n.getConstant('audioUploadMessage');\n    var span = this.parent.createElement('span', {\n      className: 'e-droptext'\n    });\n    var spanMsg = this.parent.createElement('span', {\n      className: 'e-rte-upload-text',\n      innerHTML: Browser.isDevice ? deviceAudioUpMsg : audioUpMsg\n    });\n    span.appendChild(spanMsg);\n    var btnEle = this.parent.createElement('button', {\n      className: 'e-browsebtn',\n      id: this.rteID + '_insertAudio',\n      attrs: {\n        autofocus: 'true',\n        type: 'button'\n      }\n    });\n    span.appendChild(btnEle);\n    uploadParentEle.appendChild(span);\n    var browserMsg = this.i10n.getConstant('browse');\n    var button = new Button({\n      content: browserMsg,\n      enableRtl: this.parent.enableRtl\n    });\n    button.isStringTemplate = true;\n    button.createElement = this.parent.createElement;\n    button.appendTo(btnEle);\n    var btnClick = Browser.isDevice ? span : btnEle;\n    EventHandler.add(btnClick, 'click', this.fileSelect, this);\n    var uploadEle = this.parent.createElement('input', {\n      id: this.rteID + '_upload',\n      attrs: {\n        type: 'File',\n        name: 'UploadFiles'\n      }\n    });\n    uploadParentEle.appendChild(uploadEle);\n    var fileName;\n    var selectArgs;\n    var filesData;\n    this.uploadObj = new Uploader({\n      asyncSettings: {\n        saveUrl: this.parent.insertAudioSettings.saveUrl,\n        removeUrl: this.parent.insertAudioSettings.removeUrl\n      },\n      dropArea: span,\n      multiple: false,\n      enableRtl: this.parent.enableRtl,\n      allowedExtensions: this.parent.insertAudioSettings.allowedTypes.toString(),\n      selected: function (e) {\n        proxy.isAudioUploaded = true;\n        selectArgs = e;\n        // eslint-disable-next-line\n        filesData = e.filesData;\n        _this.parent.trigger(events.fileSelected, selectArgs, function (selectArgs) {\n          if (!selectArgs.cancel) {\n            _this.checkExtension(selectArgs.filesData[0]);\n            fileName = selectArgs.filesData[0].name;\n            if (_this.parent.editorMode === 'HTML' && isNullOrUndefined(_this.parent.insertAudioSettings.path)) {\n              var reader_1 = new FileReader();\n              // eslint-disable-next-line\n              reader_1.addEventListener('load', function (e) {\n                var url = _this.parent.insertAudioSettings.saveFormat === 'Base64' ? reader_1.result : URL.createObjectURL(convertToBlob(reader_1.result));\n                proxy.uploadUrl = {\n                  url: url,\n                  selection: save,\n                  fileName: fileName,\n                  selectParent: selectParent\n                };\n                proxy.inputUrl.setAttribute('disabled', 'true');\n                if (isNullOrUndefined(proxy.parent.insertAudioSettings.saveUrl) && _this.isAllowedTypes && !isNullOrUndefined(_this.dialogObj)) {\n                  _this.dialogObj.getButtons(0).element.removeAttribute('disabled');\n                }\n              });\n              reader_1.readAsDataURL(selectArgs.filesData[0].rawFile);\n            }\n          }\n        });\n      },\n      beforeUpload: function (args) {\n        _this.parent.trigger(events.beforeFileUpload, args);\n      },\n      uploading: function (e) {\n        if (!_this.parent.isServerRendered) {\n          _this.parent.trigger(events.fileUploading, e);\n        }\n      },\n      success: function (e) {\n        _this.parent.trigger(events.fileUploadSuccess, e, function (e) {\n          if (!isNullOrUndefined(_this.parent.insertAudioSettings.path)) {\n            var url = _this.parent.insertAudioSettings.path + e.file.name;\n            // eslint-disable-next-line\n            var value = {\n              url: url,\n              selection: save\n            };\n            proxy.uploadUrl = {\n              url: url,\n              selection: save,\n              fileName: fileName,\n              selectParent: selectParent\n            };\n            proxy.inputUrl.setAttribute('disabled', 'true');\n          }\n          if (e.operation === 'upload' && !isNullOrUndefined(_this.dialogObj)) {\n            _this.dialogObj.getButtons(0).element.removeAttribute('disabled');\n          }\n        });\n      },\n      failure: function (e) {\n        _this.parent.trigger(events.fileUploadFailed, e);\n      },\n      removing: function () {\n        // eslint-disable-next-line\n        _this.parent.trigger(events.fileRemoving, e, function (e) {\n          proxy.isAudioUploaded = false;\n          _this.dialogObj.getButtons(0).element.disabled = true;\n          proxy.inputUrl.removeAttribute('disabled');\n          if (proxy.uploadUrl) {\n            proxy.uploadUrl.url = '';\n          }\n        });\n      }\n    });\n    this.uploadObj.isStringTemplate = true;\n    this.uploadObj.createElement = this.parent.createElement;\n    this.uploadObj.appendTo(uploadEle);\n    return uploadParentEle;\n  };\n  Audio.prototype.checkExtension = function (e) {\n    if (this.uploadObj.allowedExtensions) {\n      if (this.uploadObj.allowedExtensions.toLocaleLowerCase().indexOf(('.' + e.type).toLocaleLowerCase()) === -1) {\n        this.dialogObj.getButtons(0).element.setAttribute('disabled', 'disabled');\n        this.isAllowedTypes = false;\n      } else {\n        this.isAllowedTypes = true;\n      }\n    }\n  };\n  Audio.prototype.fileSelect = function () {\n    this.dialogObj.element.getElementsByClassName('e-file-select-wrap')[0].querySelector('button').click();\n    return false;\n  };\n  // eslint-disable-next-line\n  Audio.prototype.cancelDialog = function (e) {\n    this.parent.isBlur = false;\n    this.dialogObj.hide({\n      returnValue: true\n    });\n    if (this.isAudioUploaded) {\n      this.uploadObj.removing();\n    }\n  };\n  // eslint-disable-next-line\n  Audio.prototype.insertAudioUrl = function (e) {\n    var proxy = this.selfAudio;\n    //let audioSelectParent: Node = proxy.uploadUrl.selectParent[0];\n    proxy.isAudioUploaded = false;\n    var url = proxy.inputUrl.value;\n    if (proxy.parent.formatter.getUndoRedoStack().length === 0) {\n      proxy.parent.formatter.saveData();\n    }\n    if (!isNullOrUndefined(proxy.uploadUrl) && proxy.uploadUrl.url !== '') {\n      proxy.uploadUrl.cssClass = proxy.parent.insertAudioSettings.layoutOption === 'Inline' ? classes.CLS_AUDIOINLINE : classes.CLS_AUDIOBREAK;\n      proxy.dialogObj.hide({\n        returnValue: false\n      });\n      proxy.parent.formatter.process(proxy.parent, this.args, this.args.originalEvent, proxy.uploadUrl);\n      proxy.uploadUrl.url = '';\n    } else if (url !== '') {\n      if (proxy.parent.editorMode === 'HTML' && isNullOrUndefined(closest(\n      // eslint-disable-next-line\n      this.selection.range.startContainer.parentNode, '[id=' + \"'\" + proxy.contentModule.getPanel().id + \"'\" + ']'))) {\n        proxy.contentModule.getEditPanel().focus();\n        var range = proxy.parent.formatter.editorManager.nodeSelection.getRange(proxy.contentModule.getDocument());\n        this.selection = proxy.parent.formatter.editorManager.nodeSelection.save(range, proxy.contentModule.getDocument());\n        this.selectParent = proxy.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(range);\n      }\n      var name_1 = proxy.parent.editorMode === 'HTML' ? url.split('/')[url.split('/').length - 1] : '';\n      var value = {\n        cssClass: proxy.parent.insertAudioSettings.layoutOption === 'Inline' ? classes.CLS_AUDIOINLINE : classes.CLS_AUDIOBREAK,\n        url: url,\n        selection: this.selection,\n        fileName: name_1,\n        selectParent: this.selectParent\n      };\n      proxy.parent.formatter.process(proxy.parent, this.args, this.args.originalEvent, value);\n      proxy.dialogObj.hide({\n        returnValue: false\n      });\n    }\n  };\n  /* eslint-disable */\n  /**\n   * Destroys the ToolBar.\n   *\n   * @method destroy\n   * @returns {void}\n   * @hidden\n    */\n  /* eslint-enable */\n  Audio.prototype.destroy = function () {\n    this.prevSelectedAudEle = undefined;\n    this.removeEventListener();\n  };\n  /**\n   * For internal use only - Get the module name.\n   *\n   * @returns {void}\n   * @hidden\n   */\n  Audio.prototype.getModuleName = function () {\n    return 'audio';\n  };\n  return Audio;\n}();\nexport { Audio };","map":{"version":3,"names":["addClass","detach","EventHandler","isNullOrUndefined","Ajax","Browser","closest","removeClass","isNOU","events","classes","Uploader","Button","RenderType","dispatchEvent","hasClass","convertToBlob","isIDevice","Audio","parent","serviceLocator","isAudioUploaded","isAllowedTypes","deletedAudio","rteID","element","id","i10n","getService","rendererFactory","dialogRenderObj","addEventListener","prototype","isDestroyed","on","keyDown","onKeyDown","keyUp","onKeyUp","insertAudio","insertingAudio","initialEnd","afterRender","dynamicModule","showAudioDialog","showDialog","closeAudioDialog","closeDialog","audioToolbarAction","onToolbarAction","dropDownSelect","alignmentSelect","audioDelete","deleteAudio","editAreaClick","editAreaClickHandler","insertCompleted","showAudioQuickToolbar","destroy","removeEventListener","off","contentModule","remove","getEditPanel","touchStartEvent","touchStart","touchEndEvent","audioClick","ownerDocument","onDocumentClick","getRenderer","Content","add","checkAudioBack","range","startContainer","nodeName","startOffset","previousSibling","isAudioElem","push","childNodes","checkAudioDel","textContent","length","nextSibling","undoStack","args","subCommand","toLowerCase","i","formatter","getUndoRedoStack","temp","createElement","contentElem","text","appendChild","cloneNode","e","ele","readonly","prevSelectedAudEle","audEle","notify","selectionRestore","item","event","querySelector","src","getAttribute","trigger","afterMediaDelete","originalEvent","save","selectNodeEle","selectParentEle","isCursor","keyCodeValues","editorMode","editorManager","nodeSelection","getRange","getDocument","endContainer","endOffset","indexOf","which","nodes","getNodeCollection","code","isCursor_1","getParentNodeCollection","ctrlKey","key","action","parentElement","prev","setSelectionText","CLS_AUD_FOCUS","quickToolObj","audioQTBar","hidePopup","keyCode","preventDefault","event_1","selectNode","selection","selectParent","command","dialogObj","close","audioRemovePost","nodeType","previousElementSibling","classList","contains","CLS_AUDIOWRAP","nextElementSibling","CLS_CLICKELEM","CLS_VID_CLICK_ELEM","openDialog","handleSelectAll","audioFocusNodes","inputElement","querySelectorAll","isInternal","parentEle","name","hide","returnValue","saveData","restore","process","document","body","proxy","absoluteUrl","insertAudioSettings","removeUrl","URL","baseURI","href","removingAudioName","replace","xhr","XMLHttpRequest","readyState","status","triggerPost","response","open","responseType","send","file","File","ajax","formData","FormData","append","isDevice","target","setAttribute","focus","toolbarSettings","enable","getToolbarElement","getID","offsetX","clientWidth","offsetY","clientHeight","documentClickClosedBy","closedBy","isBlur","style","outline","inline","break","hideAudioQuickToolbar","showOnRightClick","quickToolbarSettings","Clear","setSelectionContents","quickToolbarModule","isPopupOpen","selectionSave","type","elements","_this","forEach","call","index","isNotify","setTimeout","showPopup","pageX","getBoundingClientRect","top","maxHeight","dialogContent","path","getElementById","audioDialog","className","audioInsert","getConstant","audiolinkCancel","audioHeader","selectObj","selfAudio","dialogModel","header","cssClass","CLS_RTE_ELEMENTS","enableRtl","locale","showCloseIcon","closeOnEscape","width","isModal","buttons","click","insertAudioUrl","bind","buttonModel","content","isPrimary","disabled","cancelDialog","animationSettings","effect","uploadObj","removing","audioUpload","linkHeader","linkHeaderText","innerHTML","audioUrlPopup","localeObj","render","appendTo","inlineQTBar","textQTBar","audioUrl","placeUrl","inputUrl","attrs","placeholder","spellcheck","value","getButtons","removeAttribute","regex","RegExp","sourceElement","match","iframe","iframeSettings","parentNode","getPanel","uploadParentEle","deviceAudioUpMsg","audioUpMsg","span","spanMsg","btnEle","autofocus","browserMsg","button","isStringTemplate","btnClick","fileSelect","uploadEle","fileName","selectArgs","filesData","asyncSettings","saveUrl","dropArea","multiple","allowedExtensions","allowedTypes","toString","selected","fileSelected","cancel","checkExtension","reader_1","FileReader","url","saveFormat","result","createObjectURL","uploadUrl","readAsDataURL","rawFile","beforeUpload","beforeFileUpload","uploading","isServerRendered","fileUploading","success","fileUploadSuccess","operation","failure","fileUploadFailed","fileRemoving","toLocaleLowerCase","getElementsByClassName","layoutOption","CLS_AUDIOINLINE","CLS_AUDIOBREAK","name_1","split","undefined","getModuleName"],"sources":["/Users/saleem/Desktop/KClient/Web App/Ver_3.6/User Interface/website_Source files/node_modules/@syncfusion/ej2-richtexteditor/src/rich-text-editor/renderer/audio-module.js"],"sourcesContent":["import { addClass, detach, EventHandler, isNullOrUndefined, Ajax } from '@syncfusion/ej2-base';\nimport { Browser, closest, removeClass, isNullOrUndefined as isNOU } from '@syncfusion/ej2-base';\nimport * as events from '../base/constant';\nimport * as classes from '../base/classes';\nimport { Uploader } from '@syncfusion/ej2-inputs';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { RenderType } from '../base/enum';\nimport { dispatchEvent, hasClass, convertToBlob } from '../base/util';\nimport { isIDevice } from '../../common/util';\n/**\n * `Audio` module is used to handle audio actions.\n */\nvar Audio = /** @class */ (function () {\n    function Audio(parent, serviceLocator) {\n        this.isAudioUploaded = false;\n        this.isAllowedTypes = true;\n        this.deletedAudio = [];\n        this.parent = parent;\n        this.rteID = parent.element.id;\n        this.i10n = serviceLocator.getService('rteLocale');\n        this.rendererFactory = serviceLocator.getService('rendererFactory');\n        this.dialogRenderObj = serviceLocator.getService('dialogRenderObject');\n        this.addEventListener();\n    }\n    Audio.prototype.addEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.on(events.keyDown, this.onKeyDown, this);\n        this.parent.on(events.keyUp, this.onKeyUp, this);\n        this.parent.on(events.insertAudio, this.insertingAudio, this);\n        this.parent.on(events.initialEnd, this.afterRender, this);\n        this.parent.on(events.dynamicModule, this.afterRender, this);\n        this.parent.on(events.showAudioDialog, this.showDialog, this);\n        this.parent.on(events.closeAudioDialog, this.closeDialog, this);\n        this.parent.on(events.audioToolbarAction, this.onToolbarAction, this);\n        this.parent.on(events.dropDownSelect, this.alignmentSelect, this);\n        this.parent.on(events.audioDelete, this.deleteAudio, this);\n        this.parent.on(events.editAreaClick, this.editAreaClickHandler, this);\n        this.parent.on(events.insertCompleted, this.showAudioQuickToolbar, this);\n        this.parent.on(events.destroy, this.removeEventListener, this);\n    };\n    Audio.prototype.removeEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.off(events.keyDown, this.onKeyDown);\n        this.parent.off(events.keyUp, this.onKeyUp);\n        this.parent.off(events.insertAudio, this.insertingAudio);\n        this.parent.off(events.initialEnd, this.afterRender);\n        this.parent.off(events.dynamicModule, this.afterRender);\n        this.parent.off(events.showAudioDialog, this.showDialog);\n        this.parent.off(events.closeAudioDialog, this.closeDialog);\n        this.parent.off(events.audioToolbarAction, this.onToolbarAction);\n        this.parent.off(events.dropDownSelect, this.alignmentSelect);\n        this.parent.off(events.audioDelete, this.deleteAudio);\n        this.parent.off(events.editAreaClick, this.editAreaClickHandler);\n        this.parent.off(events.insertCompleted, this.showAudioQuickToolbar);\n        this.parent.off(events.destroy, this.removeEventListener);\n        if (!isNullOrUndefined(this.contentModule)) {\n            EventHandler.remove(this.parent.contentModule.getEditPanel(), Browser.touchStartEvent, this.touchStart);\n            EventHandler.remove(this.contentModule.getEditPanel(), Browser.touchEndEvent, this.audioClick);\n            EventHandler.remove(this.parent.element.ownerDocument, 'mousedown', this.onDocumentClick);\n        }\n    };\n    Audio.prototype.afterRender = function () {\n        this.contentModule = this.rendererFactory.getRenderer(RenderType.Content);\n        EventHandler.add(this.parent.contentModule.getEditPanel(), Browser.touchStartEvent, this.touchStart, this);\n        EventHandler.add(this.contentModule.getEditPanel(), Browser.touchEndEvent, this.audioClick, this);\n        EventHandler.add(this.parent.element.ownerDocument, 'mousedown', this.onDocumentClick, this);\n    };\n    Audio.prototype.checkAudioBack = function (range) {\n        if (range.startContainer.nodeName === '#text' && range.startOffset === 0 &&\n            !isNOU(range.startContainer.previousSibling) && this.isAudioElem(range.startContainer.previousSibling)) {\n            this.deletedAudio.push(range.startContainer.previousSibling);\n        }\n        else if (range.startContainer.nodeName !== '#text' && !isNOU(range.startContainer.childNodes[range.startOffset - 1]) &&\n            this.isAudioElem(range.startContainer.childNodes[range.startOffset - 1])) {\n            this.deletedAudio.push(range.startContainer.childNodes[range.startOffset - 1]);\n        }\n    };\n    Audio.prototype.checkAudioDel = function (range) {\n        if (range.startContainer.nodeName === '#text' && range.startOffset === range.startContainer.textContent.length &&\n            !isNOU(range.startContainer.nextSibling) && range.startContainer.nextSibling.nodeName === 'IMG') {\n            this.deletedAudio.push(range.startContainer.nextSibling);\n        }\n        else if (range.startContainer.nodeName !== '#text' && !isNOU(range.startContainer.childNodes[range.startOffset]) &&\n            this.isAudioElem(range.startContainer.childNodes[range.startOffset])) {\n            this.deletedAudio.push(range.startContainer.childNodes[range.startOffset]);\n        }\n    };\n    Audio.prototype.undoStack = function (args) {\n        if (args.subCommand.toLowerCase() === 'undo' || args.subCommand.toLowerCase() === 'redo') {\n            for (var i = 0; i < this.parent.formatter.getUndoRedoStack().length; i++) {\n                var temp = this.parent.createElement('div');\n                var contentElem = this.parent.formatter.getUndoRedoStack()[i].text;\n                temp.appendChild(contentElem.cloneNode(true));\n            }\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    Audio.prototype.touchStart = function (e, ele) {\n        if (this.parent.readonly) {\n            return;\n        }\n        this.prevSelectedAudEle = this.audEle;\n    };\n    Audio.prototype.onToolbarAction = function (args) {\n        if (isIDevice()) {\n            this.parent.notify(events.selectionRestore, {});\n        }\n        var item = args.args.item;\n        switch (item.subCommand) {\n            case 'AudioReplace':\n                this.parent.notify(events.insertAudio, args);\n                break;\n            case 'AudioRemove':\n                this.parent.notify(events.audioDelete, args);\n                break;\n        }\n    };\n    // eslint-disable-next-line\n    Audio.prototype.onKeyUp = function (event) {\n        if (!isNOU(this.deletedAudio) && this.deletedAudio.length > 0) {\n            for (var i = 0; i < this.deletedAudio.length - 1; i++) {\n                var args = {\n                    element: this.deletedAudio[i].querySelector('audio'),\n                    src: this.deletedAudio[i].querySelector('source').getAttribute('src')\n                };\n                this.parent.trigger(events.afterMediaDelete, args);\n            }\n        }\n    };\n    Audio.prototype.onKeyDown = function (event) {\n        var originalEvent = event.args;\n        var range;\n        var save;\n        var selectNodeEle;\n        var selectParentEle;\n        this.deletedAudio = [];\n        var isCursor;\n        var keyCodeValues = [27, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123,\n            44, 45, 9, 16, 17, 18, 19, 20, 33, 34, 35, 36, 37, 38, 39, 40, 91, 92, 93, 144, 145, 182, 183];\n        if (this.parent.editorMode === 'HTML') {\n            range = this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());\n            isCursor = range.startContainer === range.endContainer && range.startOffset === range.endOffset;\n        }\n        if (!isCursor && this.parent.editorMode === 'HTML' && keyCodeValues.indexOf(originalEvent.which) < 0) {\n            var nodes = this.parent.formatter.editorManager.nodeSelection.getNodeCollection(range);\n            for (var i = 0; i < nodes.length; i++) {\n                if (this.isAudioElem(nodes[i])) {\n                    this.deletedAudio.push(nodes[i]);\n                }\n            }\n        }\n        if (this.parent.editorMode === 'HTML' && ((originalEvent.which === 8 && originalEvent.code === 'Backspace') ||\n            (originalEvent.which === 46 && originalEvent.code === 'Delete'))) {\n            var isCursor_1 = range.startContainer === range.endContainer && range.startOffset === range.endOffset;\n            if ((originalEvent.which === 8 && originalEvent.code === 'Backspace' && isCursor_1)) {\n                this.checkAudioBack(range);\n            }\n            else if ((originalEvent.which === 46 && originalEvent.code === 'Delete' && isCursor_1)) {\n                this.checkAudioDel(range);\n            }\n        }\n        if (!isNullOrUndefined(this.parent.formatter.editorManager.nodeSelection) &&\n            originalEvent.code !== 'KeyK') {\n            range = this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());\n            selectNodeEle = this.parent.formatter.editorManager.nodeSelection.getNodeCollection(range);\n            selectParentEle = this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(range);\n            if (!originalEvent.ctrlKey && originalEvent.key && (originalEvent.key.length === 1 || originalEvent.action === 'enter') &&\n                (this.isAudioElem(selectParentEle[0])) && selectParentEle[0].parentElement) {\n                var prev = selectParentEle[0].parentElement.childNodes[0];\n                this.parent.formatter.editorManager.nodeSelection.setSelectionText(this.contentModule.getDocument(), prev, prev, prev.textContent.length, prev.textContent.length);\n                removeClass([selectParentEle[0]], classes.CLS_AUD_FOCUS);\n                this.quickToolObj.audioQTBar.hidePopup();\n            }\n        }\n        if (originalEvent.ctrlKey && (originalEvent.keyCode === 89 || originalEvent.keyCode === 90)) {\n            this.undoStack({ subCommand: (originalEvent.keyCode === 90 ? 'undo' : 'redo') });\n        }\n        if (originalEvent.keyCode === 8 || originalEvent.keyCode === 46) {\n            if (selectNodeEle && this.isAudioElem(selectNodeEle[0]) && selectNodeEle.length < 1) {\n                if (!isNullOrUndefined(this.parent.formatter.editorManager.nodeSelection)) {\n                    save = this.parent.formatter.editorManager.nodeSelection.save(range, this.parent.contentModule.getDocument());\n                }\n                originalEvent.preventDefault();\n                var event_1 = {\n                    selectNode: selectNodeEle, selection: save, selectParent: selectParentEle,\n                    args: {\n                        item: { command: 'Audios', subCommand: 'AudioRemove' },\n                        originalEvent: originalEvent\n                    }\n                };\n                this.deleteAudio(event_1, originalEvent.keyCode);\n            }\n        }\n        switch (originalEvent.action) {\n            case 'escape':\n                if (!isNullOrUndefined(this.dialogObj)) {\n                    this.dialogObj.close();\n                }\n                break;\n            case 'backspace':\n            case 'delete':\n                for (var i = 0; i < this.deletedAudio.length; i++) {\n                    var src = this.deletedAudio[i].src;\n                    this.audioRemovePost(src);\n                }\n                if (this.parent.editorMode !== 'Markdown') {\n                    if (range.startContainer.nodeType === 3) {\n                        if (originalEvent.code === 'Backspace') {\n                            if (range.startContainer.previousElementSibling && range.startOffset === 0 &&\n                                range.startContainer.previousElementSibling.classList.contains(classes.CLS_AUDIOWRAP)) {\n                                detach(range.startContainer.previousElementSibling);\n                            }\n                        }\n                        else {\n                            if (range.startContainer.nextElementSibling &&\n                                range.endContainer.textContent.length === range.endOffset &&\n                                range.startContainer.nextElementSibling.classList.contains(classes.CLS_AUDIOWRAP)) {\n                                detach(range.startContainer.nextElementSibling);\n                            }\n                        }\n                    }\n                    else if (range.startContainer.nodeType === 1 && (range.startContainer.classList &&\n                        (range.startContainer.classList.contains(classes.CLS_AUDIOWRAP) ||\n                            range.startContainer.classList.contains(classes.CLS_CLICKELEM) ||\n                            range.startContainer.classList.contains(classes.CLS_VID_CLICK_ELEM)))) {\n                        detach(range.startContainer);\n                    }\n                }\n                break;\n            case 'insert-audio':\n                if (!isNullOrUndefined(this.parent.formatter.editorManager.nodeSelection)) {\n                    save = this.parent.formatter.editorManager.nodeSelection.save(range, this.parent.contentModule.getDocument());\n                }\n                this.openDialog(true, originalEvent, save, selectNodeEle, selectParentEle);\n                originalEvent.preventDefault();\n                break;\n        }\n        if (originalEvent.ctrlKey && originalEvent.key === 'a') {\n            this.handleSelectAll();\n        }\n    };\n    Audio.prototype.handleSelectAll = function () {\n        var audioFocusNodes = this.parent.inputElement.querySelectorAll('.' + classes.CLS_AUD_FOCUS);\n        removeClass(audioFocusNodes, classes.CLS_AUD_FOCUS);\n    };\n    Audio.prototype.openDialog = function (isInternal, event, selection, ele, parentEle) {\n        var range;\n        var save;\n        var selectNodeEle;\n        var selectParentEle;\n        if (!isInternal && !isNOU(this.parent.formatter.editorManager.nodeSelection)) {\n            range = this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());\n            save = this.parent.formatter.editorManager.nodeSelection.save(range, this.parent.contentModule.getDocument());\n            selectNodeEle = this.parent.formatter.editorManager.nodeSelection.getNodeCollection(range);\n            selectParentEle = this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(range);\n        }\n        else {\n            save = selection;\n            selectNodeEle = ele;\n            selectParentEle = parentEle;\n        }\n        if (this.parent.editorMode === 'HTML') {\n            this.insertAudio({\n                args: {\n                    item: { command: 'Audios', subCommand: 'Audio' },\n                    originalEvent: event,\n                    name: !isInternal ? 'showDialog' : null\n                },\n                selectNode: selectNodeEle,\n                selection: save,\n                selectParent: selectParentEle\n            });\n        }\n    };\n    Audio.prototype.showDialog = function () {\n        this.openDialog(false);\n    };\n    Audio.prototype.closeDialog = function () {\n        if (this.dialogObj) {\n            this.dialogObj.hide({ returnValue: true });\n        }\n    };\n    Audio.prototype.deleteAudio = function (e, keyCode) {\n        if (!this.isAudioElem(e.selectNode[0])) {\n            return;\n        }\n        if (this.audEle) {\n            if (e.selectNode[0].nodeType === 3) {\n                e.selectNode[0] = this.audEle;\n            }\n            else if (this.isAudioElem(e.selectNode[0])) {\n                e.selectNode[0] = e.selectNode[0].classList.contains(classes.CLS_AUDIOWRAP) ? e.selectNode[0] :\n                    e.selectNode[0].parentElement;\n            }\n        }\n        var args = {\n            element: e.selectNode[0].querySelector('audio'),\n            src: e.selectNode[0].querySelector('source').getAttribute('src')\n        };\n        if (this.parent.formatter.getUndoRedoStack().length === 0) {\n            this.parent.formatter.saveData();\n        }\n        e.selection.restore();\n        this.parent.formatter.process(this.parent, e.args, e.args, {\n            selectNode: e.selectNode,\n            subCommand: e.args.item.subCommand\n        });\n        this.audioRemovePost(args.src);\n        if (this.quickToolObj && document.body.contains(this.quickToolObj.audioQTBar.element)) {\n            this.quickToolObj.audioQTBar.hidePopup();\n        }\n        if (isNullOrUndefined(keyCode)) {\n            this.parent.trigger(events.afterMediaDelete, args);\n        }\n    };\n    Audio.prototype.audioRemovePost = function (src) {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        var absoluteUrl = '';\n        if (isNOU(this.parent.insertAudioSettings.removeUrl) || this.parent.insertAudioSettings.removeUrl === '') {\n            return;\n        }\n        if (src.indexOf('http://') > -1 || src.indexOf('https://') > -1) {\n            absoluteUrl = src;\n        }\n        else {\n            absoluteUrl = new URL(src, document.baseURI).href;\n        }\n        this.removingAudioName = absoluteUrl.replace(/^.*[\\\\/]/, '');\n        var xhr = new XMLHttpRequest();\n        // eslint-disable-next-line @typescript-eslint/tslint/config\n        xhr.addEventListener('readystatechange', function () {\n            if (this.readyState === 4 && this.status === 200) {\n                proxy.triggerPost(this.response);\n            }\n        });\n        xhr.open('GET', absoluteUrl);\n        xhr.responseType = 'blob';\n        xhr.send();\n    };\n    Audio.prototype.triggerPost = function (response) {\n        var removeUrl = this.parent.insertAudioSettings.removeUrl;\n        if (isNOU(removeUrl) || removeUrl === '') {\n            return;\n        }\n        var file = new File([response], this.removingAudioName);\n        var ajax = new Ajax(removeUrl, 'POST', true, null);\n        var formData = new FormData();\n        formData.append('UploadFiles', file);\n        ajax.send(formData);\n    };\n    Audio.prototype.audioClick = function (e) {\n        if (Browser.isDevice) {\n            if (this.isAudioElem(e.target)) {\n                this.contentModule.getEditPanel().setAttribute('contenteditable', 'false');\n                e.target.focus();\n            }\n            else {\n                if (!this.parent.readonly) {\n                    this.contentModule.getEditPanel().setAttribute('contenteditable', 'true');\n                }\n            }\n        }\n        if (this.isAudioElem(e.target)) {\n            this.audEle = e.target.querySelector('audio');\n            e.preventDefault();\n        }\n    };\n    Audio.prototype.onDocumentClick = function (e) {\n        var target = e.target;\n        if (this.isAudioElem(target)) {\n            this.audEle = target.querySelector('audio');\n        }\n        if (!isNullOrUndefined(this.dialogObj) && ((\n        // eslint-disable-next-line\n        !closest(target, '[id=' + \"'\" + this.dialogObj.element.id + \"'\" + ']') && this.parent.toolbarSettings.enable && this.parent.getToolbarElement() &&\n            !this.parent.getToolbarElement().contains(e.target)) ||\n            (this.parent.getToolbarElement() && this.parent.getToolbarElement().contains(e.target) &&\n                !closest(target, '#' + this.parent.getID() + '_toolbar_Audio') &&\n                !target.querySelector('#' + this.parent.getID() + '_toolbar_Audio')))) {\n            /* eslint-disable */\n            if (e.offsetX > e.target.clientWidth || e.offsetY > e.target.clientHeight) {\n            }\n            else {\n                this.parent.notify(events.documentClickClosedBy, { closedBy: \"outside click\" });\n                this.dialogObj.hide({ returnValue: true });\n                this.parent.isBlur = true;\n                dispatchEvent(this.parent.element, 'focusout');\n            }\n            /* eslint-enable */\n        }\n        if (this.contentModule.getEditPanel().querySelector('.' + classes.CLS_AUD_FOCUS)) {\n            if (!this.isAudioElem(e.target) && !isNOU(this.audEle)) {\n                this.audEle.style.outline = '';\n            }\n            else if (!isNOU(this.prevSelectedAudEle) && this.prevSelectedAudEle !== target) {\n                this.prevSelectedAudEle.style.outline = '';\n            }\n        }\n    };\n    Audio.prototype.alignmentSelect = function (e) {\n        var item = e.item;\n        if (!document.body.contains(document.body.querySelector('.e-rte-quick-toolbar')) || item.command !== 'Audios') {\n            return;\n        }\n        var range = this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());\n        var selectNodeEle = this.parent.formatter.editorManager.nodeSelection.getNodeCollection(range);\n        selectNodeEle = [this.audEle];\n        var args = { args: e, selectNode: selectNodeEle };\n        if (this.parent.formatter.getUndoRedoStack().length === 0) {\n            this.parent.formatter.saveData();\n        }\n        switch (item.subCommand) {\n            case 'Inline':\n                this.inline(args);\n                break;\n            case 'Break':\n                this.break(args);\n                break;\n        }\n        if (this.quickToolObj && document.body.contains(this.quickToolObj.audioQTBar.element)) {\n            this.quickToolObj.audioQTBar.hidePopup();\n            removeClass([selectNodeEle[0]], classes.CLS_AUD_FOCUS);\n        }\n    };\n    Audio.prototype.break = function (e) {\n        if (e.selectNode[0].nodeName !== 'AUDIO') {\n            return;\n        }\n        var subCommand = (e.args.item) ?\n            e.args.item.subCommand : 'Break';\n        this.parent.formatter.process(this.parent, e.args, e.args, { selectNode: e.selectNode, subCommand: subCommand });\n    };\n    Audio.prototype.inline = function (e) {\n        if (e.selectNode[0].nodeName !== 'AUDIO') {\n            return;\n        }\n        var subCommand = (e.args.item) ?\n            e.args.item.subCommand : 'Inline';\n        this.parent.formatter.process(this.parent, e.args, e.args, { selectNode: e.selectNode, subCommand: subCommand });\n    };\n    Audio.prototype.editAreaClickHandler = function (e) {\n        if (this.parent.readonly) {\n            this.hideAudioQuickToolbar();\n            return;\n        }\n        var args = e.args;\n        var showOnRightClick = this.parent.quickToolbarSettings.showOnRightClick;\n        if (args.which === 2 || (showOnRightClick && args.which === 1) || (!showOnRightClick && args.which === 3)) {\n            if ((showOnRightClick && args.which === 1) && !isNullOrUndefined(args.target) &&\n                this.isAudioElem(args.target)) {\n                this.parent.formatter.editorManager.nodeSelection.Clear(this.contentModule.getDocument());\n                this.parent.formatter.editorManager.nodeSelection.setSelectionContents(this.contentModule.getDocument(), args.target);\n            }\n            return;\n        }\n        if (this.parent.editorMode === 'HTML' && this.parent.quickToolbarModule && this.parent.quickToolbarModule.audioQTBar) {\n            this.quickToolObj = this.parent.quickToolbarModule;\n            var target = args.target;\n            this.contentModule = this.rendererFactory.getRenderer(RenderType.Content);\n            var isPopupOpen = this.quickToolObj.audioQTBar.element.classList.contains('e-rte-pop');\n            if (this.isAudioElem(target) && this.parent.quickToolbarModule) {\n                if (isPopupOpen) {\n                    return;\n                }\n                this.parent.formatter.editorManager.nodeSelection.Clear(this.contentModule.getDocument());\n                this.parent.formatter.editorManager.nodeSelection.setSelectionContents(this.contentModule.getDocument(), target);\n                if (isIDevice()) {\n                    this.parent.notify(events.selectionSave, e);\n                }\n                target.querySelector('audio').style.outline = '2px solid #4a90e2';\n                this.showAudioQuickToolbar({ args: args, type: 'Audios', elements: [args.target] });\n            }\n            else {\n                this.hideAudioQuickToolbar();\n            }\n        }\n    };\n    Audio.prototype.isAudioElem = function (target) {\n        if (target && target.nodeType !== 3 && target.nodeName !== 'BR' && (target.classList &&\n            (target.classList.contains(classes.CLS_AUDIOWRAP) || target.classList.contains(classes.CLS_CLICKELEM)))) {\n            return true;\n        }\n        else {\n            return false;\n        }\n    };\n    Audio.prototype.showAudioQuickToolbar = function (e) {\n        var _this = this;\n        if (e.type !== 'Audios' || isNullOrUndefined(this.parent.quickToolbarModule)\n            || isNullOrUndefined(this.parent.quickToolbarModule.audioQTBar) || isNullOrUndefined(e.args)) {\n            return;\n        }\n        this.quickToolObj = this.parent.quickToolbarModule;\n        var args = e.args;\n        var target = e.elements;\n        [].forEach.call(e.elements, function (element, index) {\n            if (index === 0) {\n                target = element;\n            }\n        });\n        if (this.isAudioElem(target)) {\n            addClass([target.querySelector('audio')], [classes.CLS_AUD_FOCUS]);\n            target.querySelector('audio').style.outline = '2px solid #4a90e2';\n        }\n        if (this.parent.quickToolbarModule.audioQTBar) {\n            if (e.isNotify) {\n                setTimeout(function () {\n                    _this.parent.formatter.editorManager.nodeSelection.Clear(_this.contentModule.getDocument());\n                    _this.parent.formatter.editorManager.nodeSelection.setSelectionContents(_this.contentModule.getDocument(), target);\n                    _this.quickToolObj.audioQTBar.showPopup(args.pageX - 50, target.getBoundingClientRect().top + 34, target);\n                }, 400);\n            }\n            else {\n                this.quickToolObj.audioQTBar.showPopup(args.pageX - 50, target.getBoundingClientRect().top + 34, target);\n            }\n        }\n    };\n    Audio.prototype.hideAudioQuickToolbar = function () {\n        if (!isNullOrUndefined(this.contentModule.getEditPanel().querySelector('.' + classes.CLS_AUD_FOCUS))) {\n            removeClass([this.contentModule.getEditPanel().querySelector('.' + classes.CLS_AUD_FOCUS)], classes.CLS_AUD_FOCUS);\n            if (!isNOU(this.audEle)) {\n                this.audEle.style.outline = '';\n            }\n            if (this.quickToolObj && this.quickToolObj.audioQTBar && document.body.contains(this.quickToolObj.audioQTBar.element)) {\n                this.quickToolObj.audioQTBar.hidePopup();\n            }\n        }\n    };\n    Audio.prototype.insertingAudio = function (e) {\n        this.insertAudio(e);\n        if (!isNullOrUndefined(this.dialogObj)) {\n            this.dialogObj.element.style.maxHeight = 'inherit';\n            var dialogContent = this.dialogObj.element.querySelector('.e-audio-content');\n            if (!isNullOrUndefined(this.parent.insertAudioSettings.path) || this.parent.editorMode === 'HTML') {\n                document.getElementById(this.rteID + '_insertAudio').focus();\n            }\n            else {\n                dialogContent.querySelector('.e-audio-url').focus();\n            }\n        }\n    };\n    Audio.prototype.insertAudio = function (e) {\n        var _this = this;\n        if (this.dialogObj) {\n            this.dialogObj.hide({ returnValue: true });\n            return;\n        }\n        var audioDialog = this.parent.createElement('div', { className: 'e-rte-audio-dialog', id: this.rteID + '_audio' });\n        this.parent.element.appendChild(audioDialog);\n        var audioInsert = this.i10n.getConstant('dialogInsert');\n        var audiolinkCancel = this.i10n.getConstant('dialogCancel');\n        var audioHeader = this.i10n.getConstant('audioHeader');\n        var selection = e.selection;\n        var selectObj = { selfAudio: this, selection: e.selection, args: e.args, selectParent: e.selectParent };\n        var dialogModel = {\n            header: audioHeader,\n            cssClass: classes.CLS_RTE_ELEMENTS,\n            enableRtl: this.parent.enableRtl,\n            locale: this.parent.locale,\n            showCloseIcon: true, closeOnEscape: true, width: (Browser.isDevice) ? '290px' : '340px',\n            isModal: Browser.isDevice,\n            buttons: [{\n                    click: this.insertAudioUrl.bind(selectObj),\n                    buttonModel: { content: audioInsert, cssClass: 'e-flat e-insertAudio', isPrimary: true, disabled: true }\n                },\n                {\n                    click: function (e) {\n                        _this.cancelDialog(e);\n                    },\n                    buttonModel: { cssClass: 'e-flat e-cancel', content: audiolinkCancel }\n                }],\n            target: (Browser.isDevice) ? document.body : this.parent.element,\n            animationSettings: { effect: 'None' },\n            close: function (event) {\n                if (_this.isAudioUploaded) {\n                    _this.uploadObj.removing();\n                }\n                _this.parent.isBlur = false;\n                if (event && event.event.returnValue) {\n                    if (_this.parent.editorMode === 'HTML') {\n                        selection.restore();\n                    }\n                }\n                _this.dialogObj.destroy();\n                detach(_this.dialogObj.element);\n                _this.dialogRenderObj.close(event);\n                _this.dialogObj = null;\n            }\n        };\n        var dialogContent = this.parent.createElement('div', { className: 'e-audio-content' });\n        if (!isNullOrUndefined(this.parent.insertAudioSettings.path) || this.parent.editorMode === 'HTML') {\n            dialogContent.appendChild(this.audioUpload(e));\n        }\n        var linkHeader = this.parent.createElement('div', { className: 'e-audioheader' });\n        var linkHeaderText = this.i10n.getConstant('audioLinkHeader');\n        if (this.parent.editorMode === 'HTML') {\n            linkHeader.innerHTML = linkHeaderText;\n        }\n        dialogContent.appendChild(linkHeader);\n        dialogContent.appendChild(this.audioUrlPopup(e));\n        if (e.selectNode && e.selectNode[0].nodeType === 1 && this.isAudioElem(e.selectNode[0])) {\n            dialogModel.header = this.parent.localeObj.getConstant('editAudioHeader');\n            dialogModel.content = dialogContent;\n        }\n        else {\n            dialogModel.content = dialogContent;\n        }\n        this.dialogObj = this.dialogRenderObj.render(dialogModel);\n        this.dialogObj.createElement = this.parent.createElement;\n        this.dialogObj.appendTo(audioDialog);\n        if (e.selectNode && e.selectNode[0].nodeType === 1 && this.isAudioElem(e.selectNode[0]) && (e.name === 'insertAudio')) {\n            this.dialogObj.element.querySelector('.e-insertAudio').textContent = this.parent.localeObj.getConstant('dialogUpdate');\n        }\n        audioDialog.style.maxHeight = 'inherit';\n        if (this.quickToolObj) {\n            if (this.quickToolObj.audioQTBar && document.body.contains(this.quickToolObj.audioQTBar.element)) {\n                this.quickToolObj.audioQTBar.hidePopup();\n            }\n            if (this.quickToolObj.inlineQTBar && document.body.contains(this.quickToolObj.inlineQTBar.element)) {\n                this.quickToolObj.inlineQTBar.hidePopup();\n            }\n            if (this.quickToolObj.textQTBar && this.parent.element.ownerDocument.body.contains(this.quickToolObj.textQTBar.element)) {\n                this.quickToolObj.textQTBar.hidePopup();\n            }\n        }\n    };\n    // eslint-disable-next-line\n    Audio.prototype.audioUrlPopup = function (e) {\n        var _this = this;\n        var audioUrl = this.parent.createElement('div', { className: 'audioUrl' });\n        var placeUrl = this.i10n.getConstant('audioUrl');\n        this.inputUrl = this.parent.createElement('input', {\n            className: 'e-input e-audio-url',\n            attrs: { placeholder: placeUrl, spellcheck: 'false', 'aria-label': this.i10n.getConstant('audioLinkHeader') }\n        });\n        this.inputUrl.addEventListener('input', function () {\n            if (!isNOU(_this.inputUrl)) {\n                if (_this.inputUrl.value.length === 0) {\n                    _this.dialogObj.getButtons(0).element.disabled = true;\n                }\n                else {\n                    _this.dialogObj.getButtons(0).element.removeAttribute('disabled');\n                }\n            }\n        });\n        if (e.selectNode && this.isAudioElem(e.selectNode[0])) {\n            var regex = new RegExp(/([^\\S]|^)(((https?\\:\\/\\/)|(www\\.))(\\S+))/gi);\n            var sourceElement = e.selectNode[0].querySelector('source');\n            this.inputUrl.value = sourceElement.src.match(regex) ? sourceElement.src : '';\n        }\n        audioUrl.appendChild(this.inputUrl);\n        return audioUrl;\n    };\n    Audio.prototype.audioUpload = function (e) {\n        var _this = this;\n        var save;\n        var selectParent;\n        // eslint-disable-next-line\n        var proxy = this;\n        var iframe = proxy.parent.iframeSettings.enable;\n        if (proxy.parent.editorMode === 'HTML' && (!iframe && isNullOrUndefined(closest(e.selection.range.startContainer.parentNode, '[id='\n            // eslint-disable-next-line\n            + \"'\" + this.parent.contentModule.getPanel().id + \"'\" + ']'))\n            || (iframe && !hasClass(e.selection.range.startContainer.parentNode.ownerDocument.querySelector('body'), 'e-lib')))) {\n            this.contentModule.getEditPanel().focus();\n            var range = this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());\n            save = this.parent.formatter.editorManager.nodeSelection.save(range, this.parent.contentModule.getDocument());\n            selectParent = this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(range);\n        }\n        else {\n            save = e.selection;\n            selectParent = e.selectParent;\n        }\n        var uploadParentEle = this.parent.createElement('div', { className: 'e-aud-uploadwrap e-droparea' });\n        var deviceAudioUpMsg = this.i10n.getConstant('audioDeviceUploadMessage');\n        var audioUpMsg = this.i10n.getConstant('audioUploadMessage');\n        var span = this.parent.createElement('span', { className: 'e-droptext' });\n        var spanMsg = this.parent.createElement('span', {\n            className: 'e-rte-upload-text', innerHTML: ((Browser.isDevice) ? deviceAudioUpMsg : audioUpMsg)\n        });\n        span.appendChild(spanMsg);\n        var btnEle = this.parent.createElement('button', {\n            className: 'e-browsebtn', id: this.rteID + '_insertAudio', attrs: { autofocus: 'true', type: 'button' }\n        });\n        span.appendChild(btnEle);\n        uploadParentEle.appendChild(span);\n        var browserMsg = this.i10n.getConstant('browse');\n        var button = new Button({ content: browserMsg, enableRtl: this.parent.enableRtl });\n        button.isStringTemplate = true;\n        button.createElement = this.parent.createElement;\n        button.appendTo(btnEle);\n        var btnClick = (Browser.isDevice) ? span : btnEle;\n        EventHandler.add(btnClick, 'click', this.fileSelect, this);\n        var uploadEle = this.parent.createElement('input', {\n            id: this.rteID + '_upload', attrs: { type: 'File', name: 'UploadFiles' }\n        });\n        uploadParentEle.appendChild(uploadEle);\n        var fileName;\n        var selectArgs;\n        var filesData;\n        this.uploadObj = new Uploader({\n            asyncSettings: { saveUrl: this.parent.insertAudioSettings.saveUrl, removeUrl: this.parent.insertAudioSettings.removeUrl },\n            dropArea: span, multiple: false, enableRtl: this.parent.enableRtl,\n            allowedExtensions: this.parent.insertAudioSettings.allowedTypes.toString(),\n            selected: function (e) {\n                proxy.isAudioUploaded = true;\n                selectArgs = e;\n                // eslint-disable-next-line\n                filesData = e.filesData;\n                _this.parent.trigger(events.fileSelected, selectArgs, function (selectArgs) {\n                    if (!selectArgs.cancel) {\n                        _this.checkExtension(selectArgs.filesData[0]);\n                        fileName = selectArgs.filesData[0].name;\n                        if (_this.parent.editorMode === 'HTML' && isNullOrUndefined(_this.parent.insertAudioSettings.path)) {\n                            var reader_1 = new FileReader();\n                            // eslint-disable-next-line\n                            reader_1.addEventListener('load', function (e) {\n                                var url = _this.parent.insertAudioSettings.saveFormat === 'Base64' ? reader_1.result :\n                                    URL.createObjectURL(convertToBlob(reader_1.result));\n                                proxy.uploadUrl = {\n                                    url: url, selection: save, fileName: fileName,\n                                    selectParent: selectParent\n                                };\n                                proxy.inputUrl.setAttribute('disabled', 'true');\n                                if (isNullOrUndefined(proxy.parent.insertAudioSettings.saveUrl) && _this.isAllowedTypes\n                                    && !isNullOrUndefined(_this.dialogObj)) {\n                                    _this.dialogObj.getButtons(0).element.removeAttribute('disabled');\n                                }\n                            });\n                            reader_1.readAsDataURL(selectArgs.filesData[0].rawFile);\n                        }\n                    }\n                });\n            },\n            beforeUpload: function (args) {\n                _this.parent.trigger(events.beforeFileUpload, args);\n            },\n            uploading: function (e) {\n                if (!_this.parent.isServerRendered) {\n                    _this.parent.trigger(events.fileUploading, e);\n                }\n            },\n            success: function (e) {\n                _this.parent.trigger(events.fileUploadSuccess, e, function (e) {\n                    if (!isNullOrUndefined(_this.parent.insertAudioSettings.path)) {\n                        var url = _this.parent.insertAudioSettings.path + e.file.name;\n                        // eslint-disable-next-line\n                        var value = { url: url, selection: save };\n                        proxy.uploadUrl = {\n                            url: url, selection: save, fileName: fileName, selectParent: selectParent\n                        };\n                        proxy.inputUrl.setAttribute('disabled', 'true');\n                    }\n                    if (e.operation === 'upload' && !isNullOrUndefined(_this.dialogObj)) {\n                        _this.dialogObj.getButtons(0).element.removeAttribute('disabled');\n                    }\n                });\n            },\n            failure: function (e) {\n                _this.parent.trigger(events.fileUploadFailed, e);\n            },\n            removing: function () {\n                // eslint-disable-next-line\n                _this.parent.trigger(events.fileRemoving, e, function (e) {\n                    proxy.isAudioUploaded = false;\n                    _this.dialogObj.getButtons(0).element.disabled = true;\n                    proxy.inputUrl.removeAttribute('disabled');\n                    if (proxy.uploadUrl) {\n                        proxy.uploadUrl.url = '';\n                    }\n                });\n            }\n        });\n        this.uploadObj.isStringTemplate = true;\n        this.uploadObj.createElement = this.parent.createElement;\n        this.uploadObj.appendTo(uploadEle);\n        return uploadParentEle;\n    };\n    Audio.prototype.checkExtension = function (e) {\n        if (this.uploadObj.allowedExtensions) {\n            if (this.uploadObj.allowedExtensions.toLocaleLowerCase().indexOf(('.' + e.type).toLocaleLowerCase()) === -1) {\n                this.dialogObj.getButtons(0).element.setAttribute('disabled', 'disabled');\n                this.isAllowedTypes = false;\n            }\n            else {\n                this.isAllowedTypes = true;\n            }\n        }\n    };\n    Audio.prototype.fileSelect = function () {\n        this.dialogObj.element.getElementsByClassName('e-file-select-wrap')[0].querySelector('button').click();\n        return false;\n    };\n    // eslint-disable-next-line\n    Audio.prototype.cancelDialog = function (e) {\n        this.parent.isBlur = false;\n        this.dialogObj.hide({ returnValue: true });\n        if (this.isAudioUploaded) {\n            this.uploadObj.removing();\n        }\n    };\n    // eslint-disable-next-line\n    Audio.prototype.insertAudioUrl = function (e) {\n        var proxy = this.selfAudio;\n        //let audioSelectParent: Node = proxy.uploadUrl.selectParent[0];\n        proxy.isAudioUploaded = false;\n        var url = proxy.inputUrl.value;\n        if (proxy.parent.formatter.getUndoRedoStack().length === 0) {\n            proxy.parent.formatter.saveData();\n        }\n        if (!isNullOrUndefined(proxy.uploadUrl) && proxy.uploadUrl.url !== '') {\n            proxy.uploadUrl.cssClass = (proxy.parent.insertAudioSettings.layoutOption === 'Inline' ?\n                classes.CLS_AUDIOINLINE : classes.CLS_AUDIOBREAK);\n            proxy.dialogObj.hide({ returnValue: false });\n            proxy.parent.formatter.process(proxy.parent, this.args, this.args.originalEvent, proxy.uploadUrl);\n            proxy.uploadUrl.url = '';\n        }\n        else if (url !== '') {\n            if (proxy.parent.editorMode === 'HTML' && isNullOrUndefined(closest(\n            // eslint-disable-next-line\n            this.selection.range.startContainer.parentNode, '[id=' + \"'\" + proxy.contentModule.getPanel().id + \"'\" + ']'))) {\n                proxy.contentModule.getEditPanel().focus();\n                var range = proxy.parent.formatter.editorManager.nodeSelection.getRange(proxy.contentModule.getDocument());\n                this.selection = proxy.parent.formatter.editorManager.nodeSelection.save(range, proxy.contentModule.getDocument());\n                this.selectParent = proxy.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(range);\n            }\n            var name_1 = proxy.parent.editorMode === 'HTML' ? url.split('/')[url.split('/').length - 1] : '';\n            var value = {\n                cssClass: (proxy.parent.insertAudioSettings.layoutOption === 'Inline' ? classes.CLS_AUDIOINLINE : classes.CLS_AUDIOBREAK),\n                url: url, selection: this.selection, fileName: name_1,\n                selectParent: this.selectParent\n            };\n            proxy.parent.formatter.process(proxy.parent, this.args, this.args.originalEvent, value);\n            proxy.dialogObj.hide({ returnValue: false });\n        }\n    };\n    /* eslint-disable */\n    /**\n     * Destroys the ToolBar.\n     *\n     * @method destroy\n     * @returns {void}\n     * @hidden\n\n     */\n    /* eslint-enable */\n    Audio.prototype.destroy = function () {\n        this.prevSelectedAudEle = undefined;\n        this.removeEventListener();\n    };\n    /**\n     * For internal use only - Get the module name.\n     *\n     * @returns {void}\n     * @hidden\n     */\n    Audio.prototype.getModuleName = function () {\n        return 'audio';\n    };\n    return Audio;\n}());\nexport { Audio };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}