{"ast":null,"code":"import { createElement, Browser, isNullOrUndefined, isBlazor } from '@syncfusion/ej2-base';\n/**\n * The `TextMarkupAnnotation` module is used to handle text markup annotation actions of PDF viewer.\n *\n * @hidden\n */\nvar TextMarkupAnnotation = /** @class */function () {\n  /**\n   * @param pdfViewer\n   * @param viewerBase\n   * @private\n   */\n  function TextMarkupAnnotation(pdfViewer, viewerBase) {\n    var _this = this;\n    /**\n     * @private\n     */\n    this.currentTextMarkupAddMode = '';\n    /**\n     * @private\n     */\n    this.selectTextMarkupCurrentPage = null;\n    /**\n     * @private\n     */\n    this.currentTextMarkupAnnotation = null;\n    /**\n     * @private\n     */\n    this.isAddAnnotationProgramatically = false;\n    this.currentAnnotationIndex = null;\n    this.isAnnotationSelect = false;\n    /**\n     * @private\n     */\n    this.isDropletClicked = false;\n    /**\n     * @private\n     */\n    this.isRightDropletClicked = false;\n    /**\n     * @private\n     */\n    this.isLeftDropletClicked = false;\n    /**\n     * @private\n     */\n    this.isSelectionMaintained = false;\n    this.isExtended = false;\n    this.isNewAnnotation = false;\n    this.selectedTextMarkup = null;\n    this.multiPageCollection = [];\n    this.triggerAddEvent = false;\n    /**\n     * @private\n     */\n    this.isSelectedAnnotation = false;\n    this.dropletHeight = 20;\n    // To update the height value of strikethrough and underline annotations for Chinese language (Task ID: 861029).\n    this.strikeoutDifference = -3;\n    this.underlineDifference = 2;\n    /**\n     * @private\n     */\n    this.annotationClickPosition = {};\n    // eslint-disable-next-line\n    this.maintainSelection = function (event) {\n      _this.isDropletClicked = true;\n      _this.pdfViewer.textSelectionModule.initiateSelectionByTouch();\n      _this.isExtended = true;\n      _this.pdfViewer.textSelectionModule.selectionRangeArray = [];\n    };\n    // eslint-disable-next-line\n    this.selectionEnd = function (event) {\n      if (_this.isDropletClicked) {\n        _this.isDropletClicked = false;\n      }\n    };\n    // eslint-disable-next-line\n    this.annotationLeftMove = function (event) {\n      if (_this.isDropletClicked) {\n        _this.isLeftDropletClicked = true;\n      }\n    };\n    // eslint-disable-next-line\n    this.annotationRightMove = function (event) {\n      if (_this.isDropletClicked) {\n        _this.isRightDropletClicked = true;\n      }\n    };\n    this.pdfViewer = pdfViewer;\n    this.pdfViewerBase = viewerBase;\n  }\n  /**\n   * @private\n   */\n  TextMarkupAnnotation.prototype.createAnnotationSelectElement = function () {\n    // eslint-disable-next-line max-len\n    this.dropDivAnnotationLeft = createElement('div', {\n      id: this.pdfViewer.element.id + '_droplet_left',\n      className: 'e-pv-drop'\n    });\n    this.dropDivAnnotationLeft.style.borderRight = '2px solid';\n    // eslint-disable-next-line max-len\n    this.dropDivAnnotationRight = createElement('div', {\n      id: this.pdfViewer.element.id + '_droplet_right',\n      className: 'e-pv-drop'\n    });\n    this.dropDivAnnotationRight.style.borderLeft = '2px solid';\n    this.dropElementLeft = createElement('div', {\n      className: 'e-pv-droplet',\n      id: this.pdfViewer.element.id + '_dropletspan_left'\n    });\n    this.dropElementLeft.style.transform = 'rotate(0deg)';\n    this.dropDivAnnotationLeft.appendChild(this.dropElementLeft);\n    this.dropElementRight = createElement('div', {\n      className: 'e-pv-droplet',\n      id: this.pdfViewer.element.id + '_dropletspan_right'\n    });\n    this.dropElementRight.style.transform = 'rotate(-90deg)';\n    this.dropDivAnnotationRight.appendChild(this.dropElementRight);\n    this.pdfViewerBase.pageContainer.appendChild(this.dropDivAnnotationLeft);\n    this.pdfViewerBase.pageContainer.appendChild(this.dropDivAnnotationRight);\n    this.dropElementLeft.style.top = '20px';\n    this.dropElementRight.style.top = '20px';\n    this.dropElementRight.style.left = '-8px';\n    this.dropElementLeft.style.left = '-8px';\n    this.dropDivAnnotationLeft.style.display = 'none';\n    this.dropDivAnnotationRight.style.display = 'none';\n    this.dropDivAnnotationLeft.addEventListener('mousedown', this.maintainSelection);\n    this.dropDivAnnotationLeft.addEventListener('mousemove', this.annotationLeftMove);\n    this.dropDivAnnotationLeft.addEventListener('mouseup', this.selectionEnd);\n    this.dropDivAnnotationRight.addEventListener('mousedown', this.maintainSelection);\n    this.dropDivAnnotationRight.addEventListener('mousemove', this.annotationRightMove);\n    this.dropDivAnnotationRight.addEventListener('mouseup', this.selectionEnd);\n  };\n  /**\n   * @param target\n   * @param x\n   * @param y\n   * @param target\n   * @param x\n   * @param y\n   * @param target\n   * @param x\n   * @param y\n   * @private\n   */\n  // eslint-disable-next-line\n  TextMarkupAnnotation.prototype.textSelect = function (target, x, y) {\n    if (this.isLeftDropletClicked) {\n      var leftElement = this.dropDivAnnotationRight.getBoundingClientRect();\n      var rightElement = this.dropDivAnnotationLeft.getBoundingClientRect();\n      var clientX = x;\n      var clientY = y;\n      if (target.classList.contains('e-pv-text')) {\n        if (rightElement.top - 25 > leftElement.top) {\n          this.pdfViewer.textSelectionModule.textSelectionOnDrag(target, clientX, clientY, true);\n        } else {\n          this.pdfViewer.textSelectionModule.textSelectionOnDrag(target, clientX, clientY, false);\n        }\n        this.updateLeftposition(clientX, clientY);\n      }\n    } else if (this.isRightDropletClicked) {\n      var leftElement = this.dropDivAnnotationLeft.getBoundingClientRect();\n      var clientX = x;\n      var clientY = y;\n      if (target.classList.contains('e-pv-text')) {\n        if (clientY >= leftElement.top) {\n          this.pdfViewer.textSelectionModule.textSelectionOnDrag(target, clientX, clientY, true);\n        } else {\n          this.pdfViewer.textSelectionModule.textSelectionOnDrag(target, clientX, clientY, false);\n        }\n        this.updatePosition(clientX, clientY);\n      }\n    }\n  };\n  /**\n   * @param hide\n   * @private\n   */\n  TextMarkupAnnotation.prototype.showHideDropletDiv = function (hide) {\n    var type = this.pdfViewer.annotationModule.textMarkupAnnotationModule.currentTextMarkupAddMode;\n    var isEnableResizer = this.isEnableTextMarkupResizer(type);\n    if (isEnableResizer && this.dropDivAnnotationLeft && this.dropDivAnnotationRight) {\n      if (hide) {\n        this.dropDivAnnotationLeft.style.display = 'none';\n        this.dropDivAnnotationRight.style.display = 'none';\n      } else {\n        this.dropDivAnnotationLeft.style.display = '';\n        this.dropDivAnnotationRight.style.display = '';\n        this.updateDropletStyles(type);\n      }\n    }\n  };\n  /**\n   * @param type\n   * @private\n   */\n  TextMarkupAnnotation.prototype.isEnableTextMarkupResizer = function (type) {\n    var isEnableResizer = false;\n    if (type) {\n      if (type === 'Highlight' && this.pdfViewer.highlightSettings.enableTextMarkupResizer) {\n        isEnableResizer = true;\n      } else if (type === 'Underline' && this.pdfViewer.underlineSettings.enableTextMarkupResizer) {\n        isEnableResizer = true;\n      } else if (type === 'Strikethrough' && this.pdfViewer.strikethroughSettings.enableTextMarkupResizer) {\n        isEnableResizer = true;\n      } else if (this.pdfViewer.enableTextMarkupResizer) {\n        isEnableResizer = true;\n      }\n    } else {\n      if (this.pdfViewer.enableTextMarkupResizer) {\n        isEnableResizer = true;\n      } else if (this.pdfViewer.highlightSettings.enableTextMarkupResizer) {\n        isEnableResizer = true;\n      } else if (this.pdfViewer.underlineSettings.enableTextMarkupResizer) {\n        isEnableResizer = true;\n      } else if (this.pdfViewer.strikethroughSettings.enableTextMarkupResizer) {\n        isEnableResizer = true;\n      }\n    }\n    return isEnableResizer;\n  };\n  TextMarkupAnnotation.prototype.updateDropletStyles = function (type) {\n    if (this.isEnableTextMarkupResizer(type) && this.dropDivAnnotationLeft && this.dropDivAnnotationLeft.offsetWidth > 0) {\n      this.dropDivAnnotationLeft.style.width = this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n      this.dropDivAnnotationRight.style.width = this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n      this.dropElementLeft.style.width = this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n      this.dropElementRight.style.width = this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n      this.dropDivAnnotationLeft.style.height = this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n      this.dropDivAnnotationRight.style.height = this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n      this.dropElementLeft.style.height = this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n      this.dropElementRight.style.height = this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n      this.dropElementLeft.style.top = this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n      this.dropElementRight.style.top = this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n    }\n  };\n  TextMarkupAnnotation.prototype.updateAnnotationBounds = function () {\n    this.isSelectionMaintained = false;\n    // eslint-disable-next-line\n    var annotation = this.currentTextMarkupAnnotation;\n    if (annotation && annotation.isMultiSelect) {\n      this.showHideDropletDiv(true);\n      this.updateMultiAnnotBounds(annotation);\n    } else if (annotation && annotation.bounds) {\n      this.retreieveSelection(annotation, null);\n      this.pdfViewer.textSelectionModule.maintainSelection(this.selectTextMarkupCurrentPage, false);\n      this.isSelectionMaintained = true;\n      window.getSelection().removeAllRanges();\n    }\n  };\n  // eslint-disable-next-line\n  TextMarkupAnnotation.prototype.updateMultiAnnotBounds = function (annotation) {\n    if (!annotation.annotpageNumbers) {\n      var annotationList = this.getAnnotations(annotation.pageNumber, null);\n      if (annotationList) {\n        for (var z = 0; z < annotationList.length; z++) {\n          if (annotationList[z].annotName === annotation.annotName) {\n            annotation = annotationList[z];\n            break;\n          }\n        }\n      }\n    }\n    var lowestNumber = annotation.annotpageNumbers[0];\n    var highestNumber = annotation.annotpageNumbers[0];\n    for (var p = 0; p < annotation.annotpageNumbers.length; p++) {\n      var currentPage = annotation.annotpageNumbers[p];\n      if (currentPage >= highestNumber) {\n        highestNumber = currentPage;\n      }\n      if (currentPage <= lowestNumber) {\n        lowestNumber = currentPage;\n      }\n    }\n    for (var k = lowestNumber; k <= highestNumber; k++) {\n      var annotationList = this.getAnnotations(k, null);\n      if (annotationList) {\n        for (var j = 0; j < annotation.annotNameCollection.length; j++) {\n          // eslint-disable-next-line\n          var currentAnnot = annotation.annotNameCollection[j];\n          for (var z = 0; z < annotationList.length; z++) {\n            if (annotationList[z].annotName === currentAnnot) {\n              // eslint-disable-next-line\n              var newAnnotation = annotationList[z];\n              this.retreieveSelection(newAnnotation, null);\n              this.pdfViewer.textSelectionModule.maintainSelection(newAnnotation.pageNumber, false);\n            }\n          }\n        }\n      }\n    }\n    this.isSelectionMaintained = true;\n    window.getSelection().removeAllRanges();\n  };\n  // eslint-disable-next-line\n  TextMarkupAnnotation.prototype.retreieveSelection = function (annotation, element) {\n    for (var k = 0; k < annotation.bounds.length; k++) {\n      // eslint-disable-next-line\n      var bound = annotation.bounds[k];\n      var x = (bound.left ? bound.left : bound.Left) * this.pdfViewerBase.getZoomFactor();\n      var y = (bound.top ? bound.top : bound.Top) * this.pdfViewerBase.getZoomFactor();\n      var width = (bound.width ? bound.width : bound.Width) * this.pdfViewerBase.getZoomFactor();\n      var height = bound.height ? bound.height : bound.Height;\n      // eslint-disable-next-line\n      var textLayer = this.pdfViewerBase.getElement('_textLayer_' + annotation.pageNumber);\n      if (textLayer) {\n        // eslint-disable-next-line\n        var textDivs = textLayer.childNodes;\n        for (var n = 0; n < textDivs.length; n++) {\n          if (textDivs[n]) {\n            // eslint-disable-next-line\n            var rangebounds = textDivs[n].getBoundingClientRect();\n            var top_1 = this.getClientValueTop(rangebounds.top, annotation.pageNumber);\n            // eslint-disable-next-line max-len\n            var currentLeft = rangebounds.left - this.pdfViewerBase.getElement('_pageDiv_' + annotation.pageNumber).getBoundingClientRect().left;\n            var totalLeft = currentLeft + rangebounds.width;\n            // eslint-disable-next-line\n            var textDiVLeft = parseInt(textDivs[n].style.left);\n            // eslint-disable-next-line\n            var currentTop = parseInt(textDivs[n].style.top);\n            var isLeftBounds = this.pdfViewer.textSelectionModule.checkLeftBounds(currentLeft, textDiVLeft, totalLeft, x);\n            var isTopBounds = this.pdfViewer.textSelectionModule.checkTopBounds(top_1, currentTop, y);\n            if (isLeftBounds && isTopBounds) {\n              element = textDivs[n];\n              break;\n            }\n          }\n        }\n        if (element != null) {\n          // eslint-disable-next-line\n          var boundingRect = this.pdfViewerBase.getElement('_textLayer_' + annotation.pageNumber).getBoundingClientRect();\n          this.pdfViewer.textSelectionModule.textSelectionOnMouseMove(element, x + boundingRect.left, y + boundingRect.top, false);\n          if (annotation.bounds.length - 1 === k) {\n            // eslint-disable-next-line max-len\n            this.pdfViewer.textSelectionModule.textSelectionOnMouseMove(element, x + boundingRect.left + width, y + boundingRect.top, false);\n          }\n        }\n      }\n    }\n  };\n  /**\n   * @param x\n   * @param y\n   * @param isSelected\n   * @private\n   */\n  TextMarkupAnnotation.prototype.updatePosition = function (x, y, isSelected) {\n    this.showHideDropletDiv(false);\n    var pageTopValue = this.pdfViewerBase.pageSize[this.pdfViewerBase.currentPageNumber - 1].top;\n    var topClientValue = this.getClientValueTop(y, this.pdfViewerBase.currentPageNumber - 1);\n    // eslint-disable-next-line\n    var rightDivElement = document.getElementById(this.pdfViewer.element.id + '_droplet_right');\n    if (isSelected) {\n      // eslint-disable-next-line max-len\n      rightDivElement.style.top = topClientValue * this.pdfViewerBase.getZoomFactor() + pageTopValue * this.pdfViewerBase.getZoomFactor() + 'px';\n    } else {\n      // eslint-disable-next-line max-len\n      rightDivElement.style.top = topClientValue + pageTopValue * this.pdfViewerBase.getZoomFactor() + 'px';\n    }\n    // eslint-disable-next-line max-len\n    rightDivElement.style.left = x + this.pdfViewerBase.viewerContainer.scrollLeft - this.pdfViewerBase.viewerContainer.getBoundingClientRect().left + 'px';\n  };\n  /**\n   * @param x\n   * @param y\n   * @param isSelected\n   * @param x\n   * @param y\n   * @param isSelected\n   * @private\n   */\n  TextMarkupAnnotation.prototype.updateLeftposition = function (x, y, isSelected) {\n    this.showHideDropletDiv(false);\n    var pageTopValue = this.pdfViewerBase.pageSize[this.pdfViewerBase.currentPageNumber - 1].top;\n    var topClientValue = this.getClientValueTop(y, this.pdfViewerBase.currentPageNumber - 1);\n    // eslint-disable-next-line\n    var leftDivElement = document.getElementById(this.pdfViewer.element.id + '_droplet_left');\n    leftDivElement.style.display = '';\n    if (isSelected) {\n      // eslint-disable-next-line max-len\n      leftDivElement.style.top = topClientValue * this.pdfViewerBase.getZoomFactor() + pageTopValue * this.pdfViewerBase.getZoomFactor() + 'px';\n    } else {\n      // eslint-disable-next-line max-len\n      leftDivElement.style.top = topClientValue + pageTopValue * this.pdfViewerBase.getZoomFactor() + 'px';\n    }\n    // eslint-disable-next-line max-len\n    leftDivElement.style.left = x + this.pdfViewerBase.viewerContainer.scrollLeft - this.pdfViewerBase.viewerContainer.getBoundingClientRect().left - this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n  };\n  TextMarkupAnnotation.prototype.getClientValueTop = function (clientValue, pageNumber) {\n    if (this.pdfViewerBase.getElement('_pageDiv_' + pageNumber)) {\n      // eslint-disable-next-line max-len\n      return clientValue - this.pdfViewerBase.getElement('_pageDiv_' + pageNumber).getBoundingClientRect().top;\n    } else {\n      return clientValue;\n    }\n  };\n  /**\n   * @param textMarkupAnnotations\n   * @param pageNumber\n   * @param isImportTextMarkup\n   * @param textMarkupAnnotations\n   * @param pageNumber\n   * @param isImportTextMarkup\n   * @param textMarkupAnnotations\n   * @param pageNumber\n   * @param isImportTextMarkup\n   * @private\n   */\n  // eslint-disable-next-line\n  TextMarkupAnnotation.prototype.renderTextMarkupAnnotationsInPage = function (textMarkupAnnotations, pageNumber, isImportTextMarkup, isAnnotOrderAction) {\n    var canvas = this.pdfViewerBase.getElement('_annotationCanvas_' + pageNumber);\n    if (isImportTextMarkup) {\n      this.renderTextMarkupAnnotations(null, pageNumber, canvas, this.pdfViewerBase.getZoomFactor());\n      this.renderTextMarkupAnnotations(textMarkupAnnotations, pageNumber, canvas, this.pdfViewerBase.getZoomFactor(), true);\n    } else {\n      this.renderTextMarkupAnnotations(textMarkupAnnotations, pageNumber, canvas, this.pdfViewerBase.getZoomFactor(), null, isAnnotOrderAction);\n    }\n  };\n  // eslint-disable-next-line\n  TextMarkupAnnotation.prototype.renderTextMarkupAnnotations = function (textMarkupAnnotations, pageNumber, canvas, factor, isImportAction, isAnnotOrderAction) {\n    if (canvas) {\n      var context = canvas.getContext('2d');\n      context.setTransform(1, 0, 0, 1, 0, 0);\n      context.setLineDash([]);\n      // eslint-disable-next-line\n      var annotations_1;\n      if (!isImportAction && !isAnnotOrderAction) {\n        annotations_1 = this.getAnnotations(pageNumber, textMarkupAnnotations);\n      } else {\n        annotations_1 = textMarkupAnnotations;\n      }\n      if (textMarkupAnnotations) {\n        textMarkupAnnotations.forEach(function (textMarkupAnnotation) {\n          var exists = annotations_1.some(function (existingAnnotation) {\n            return existingAnnotation.annotName === textMarkupAnnotation.AnnotName;\n          });\n          if (!exists) {\n            annotations_1.push(textMarkupAnnotation);\n          }\n        });\n      }\n      if (annotations_1) {\n        var distinctAnnotations = [];\n        for (var i = 0; i < annotations_1.length; i++) {\n          var duplicateFound = false;\n          for (var j = 0; j < distinctAnnotations.length; j++) {\n            if (annotations_1[i].AnnotName === distinctAnnotations[j].AnnotName && annotations_1[i].annotName === distinctAnnotations[j].annotName) {\n              duplicateFound = true;\n              break;\n            }\n          }\n          if (!duplicateFound) {\n            distinctAnnotations.push(annotations_1[i]);\n          }\n        }\n        annotations_1 = distinctAnnotations;\n      }\n      if (annotations_1) {\n        for (var i = 0; i < annotations_1.length; i++) {\n          // eslint-disable-next-line\n          var annotation = annotations_1[i];\n          var annotationObject = null;\n          var isAnnotationRotated = void 0;\n          if (annotation.TextMarkupAnnotationType) {\n            if (isImportAction) {\n              if (this.pdfViewerBase.isJsonImported) {\n                var newArray = [];\n                for (var i_1 = 0; i_1 < annotation.Bounds.length; i_1++) {\n                  // eslint-disable-next-line\n                  annotation.Bounds[i_1] = this.pdfViewerBase.importJsonForRotatedDocuments(annotation.Rotate, pageNumber, annotation.Bounds[i_1], annotation.AnnotationRotation);\n                  annotation.Bounds[i_1].left = annotation.Bounds[i_1].X;\n                  annotation.Bounds[i_1].top = annotation.Bounds[i_1].Y;\n                  newArray.push(annotation.Bounds[i_1]);\n                }\n                annotation.Bounds = newArray;\n                isAnnotationRotated = this.pdfViewerBase.isPageRotated;\n              }\n            }\n            // eslint-disable-next-line max-len\n            annotation.annotationAddMode = this.pdfViewer.annotationModule.findAnnotationMode(annotation, pageNumber, annotation.AnnotType);\n            // eslint-disable-next-line max-len\n            annotation.allowedInteractions = annotation.AllowedInteractions ? annotation.AllowedInteractions : this.pdfViewer.annotationModule.updateAnnotationAllowedInteractions(annotation);\n            // eslint-disable-next-line max-len\n            annotation.AnnotationSettings = annotation.AnnotationSettings ? annotation.AnnotationSettings : this.pdfViewer.annotationModule.updateAnnotationSettings(annotation);\n            // eslint-disable-next-line max-len\n            annotationObject = {\n              textMarkupAnnotationType: annotation.TextMarkupAnnotationType,\n              color: annotation.Color,\n              allowedInteractions: annotation.allowedInteractions,\n              opacity: annotation.Opacity,\n              bounds: annotation.Bounds,\n              author: annotation.Author,\n              subject: annotation.Subject,\n              modifiedDate: annotation.ModifiedDate,\n              note: annotation.Note,\n              rect: annotation.Rect,\n              // eslint-disable-next-line max-len\n              annotName: annotation.AnnotName,\n              comments: this.pdfViewer.annotationModule.getAnnotationComments(annotation.Comments, annotation, annotation.Author),\n              review: {\n                state: annotation.State,\n                stateModel: annotation.StateModel,\n                modifiedDate: annotation.ModifiedDate,\n                author: annotation.Author\n              },\n              shapeAnnotationType: 'textMarkup',\n              pageNumber: pageNumber,\n              textMarkupContent: annotation.TextMarkupContent,\n              textMarkupStartIndex: 0,\n              textMarkupEndIndex: 0,\n              annotationSelectorSettings: this.getSettings(annotation),\n              // eslint-disable-next-line max-len\n              customData: this.pdfViewer.annotation.getCustomData(annotation),\n              annotationAddMode: annotation.annotationAddMode,\n              annotationSettings: annotation.AnnotationSettings,\n              isLocked: annotation.IsLocked,\n              isPrint: annotation.IsPrint,\n              isCommentLock: annotation.IsCommentLock,\n              isAnnotationRotated: isAnnotationRotated,\n              annotationRotation: annotation.AnnotationRotation\n            };\n            if (annotation.IsMultiSelect) {\n              annotationObject.annotNameCollection = annotation.AnnotNameCollection;\n              annotationObject.annotpageNumbers = annotation.AnnotpageNumbers;\n              annotationObject.isMultiSelect = annotation.IsMultiSelect;\n            }\n            if (annotation.textMarkupContent && annotation.textMarkupContent !== '') {\n              annotationObject.textMarkupContent = annotation.textMarkupContent;\n              annotationObject.textMarkupStartIndex = annotation.textMarkupStartIndex;\n              annotationObject.textMarkupEndIndex = annotation.textMarkupEndIndex;\n            }\n            if (isNullOrUndefined(annotation.TextMarkupContent) && isNullOrUndefined(annotation.textMarkupContent)) {\n              var markedBounds = annotation.Bounds[0];\n              var storedData = this.pdfViewerBase.getStoredData(pageNumber, true);\n              if (isNullOrUndefined(storedData)) {\n                this.pdfViewerBase.requestForTextExtraction(pageNumber, annotationObject);\n              } else {\n                var pageCharText = storedData.pageText.split('');\n                var characterBounds = this.pdfViewerBase.textLayer.characterBound[pageNumber];\n                var textMarkupContent = this.pdfViewerBase.textMarkUpContent(markedBounds, pageCharText, characterBounds);\n                annotationObject.textMarkupContent = textMarkupContent;\n              }\n            }\n            this.pdfViewer.annotationModule.storeAnnotations(pageNumber, annotationObject, '_annotations_textMarkup');\n            if (this.isAddAnnotationProgramatically) {\n              // eslint-disable-next-line\n              var settings = {\n                opacity: annotationObject.opacity,\n                author: annotation.author,\n                subject: annotation.subject,\n                modifiedDate: annotation.modifiedDate,\n                // eslint-disable-next-line\n                width: annotationObject.bounds.width,\n                height: annotationObject.bounds.height\n              };\n              this.pdfViewer.fireAnnotationAdd(annotationObject.pageNumber, annotationObject.annotName, annotation.TextMarkupAnnotationType, annotationObject.bounds, settings);\n            }\n          }\n          // eslint-disable-next-line max-len\n          var type = annotation.TextMarkupAnnotationType ? annotation.TextMarkupAnnotationType : annotation.textMarkupAnnotationType;\n          // eslint-disable-next-line\n          var annotBounds = annotation.Bounds ? annotation.Bounds : annotation.bounds;\n          var opacity = annotation.Opacity ? annotation.Opacity : annotation.opacity;\n          var color = annotation.Color ? annotation.Color : annotation.color;\n          var annotationRotation = annotation.AnnotationRotation ? annotation.AnnotationRotation : annotation.annotationRotation;\n          var isPrint = true;\n          if (annotation.TextMarkupAnnotationType) {\n            isPrint = annotation.IsPrint;\n          }\n          if (annotation.textMarkupAnnotationType) {\n            isPrint = annotation.isPrint;\n          }\n          switch (type) {\n            case 'Highlight':\n              this.renderHighlightAnnotation(annotBounds, opacity, color, context, factor, isPrint, pageNumber);\n              break;\n            case 'Strikethrough':\n              this.renderStrikeoutAnnotation(annotBounds, opacity, color, context, factor, pageNumber, isPrint, annotationRotation, annotation.textMarkupContent);\n              break;\n            case 'Underline':\n              this.renderUnderlineAnnotation(annotBounds, opacity, color, context, factor, pageNumber, isPrint, annotationRotation);\n              break;\n          }\n        }\n      }\n      var isMaintainedSelector = false;\n      if (this.currentTextMarkupAnnotation && this.currentTextMarkupAnnotation.annotpageNumbers) {\n        for (var m = 0; m < this.currentTextMarkupAnnotation.annotpageNumbers.length; m++) {\n          if (pageNumber === this.currentTextMarkupAnnotation.annotpageNumbers[m]) {\n            isMaintainedSelector = true;\n            this.isAnnotationSelect = false;\n            break;\n          }\n        }\n      }\n      if (pageNumber === this.selectTextMarkupCurrentPage || isMaintainedSelector) {\n        if (!this.isAnnotationSelect) {\n          this.maintainAnnotationSelection();\n        } else {\n          this.isAnnotationSelect = false;\n        }\n      }\n    }\n  };\n  /**\n   * @param annotation\n   * @private\n   */\n  // eslint-disable-next-line\n  TextMarkupAnnotation.prototype.getSettings = function (annotation) {\n    var selector;\n    if (annotation.AnnotationSelectorSettings) {\n      selector = annotation.AnnotationSelectorSettings;\n    } else {\n      selector = this.getSelector(annotation.TextMarkupAnnotationType);\n    }\n    return selector;\n  };\n  /**\n   * @param type\n   * @private\n   */\n  TextMarkupAnnotation.prototype.drawTextMarkupAnnotations = function (type) {\n    this.isTextMarkupAnnotationMode = true;\n    this.pdfViewer.annotationModule.isFormFieldShape = false;\n    this.currentTextMarkupAddMode = type;\n    var isCleared = true;\n    this.multiPageCollection = [];\n    var selectionObject = this.pdfViewer.textSelectionModule ? this.pdfViewer.textSelectionModule.selectionRangeArray : [];\n    if (selectionObject.length > 0 && !this.isSelectionMaintained) {\n      this.convertSelectionToTextMarkup(type, selectionObject, this.pdfViewerBase.getZoomFactor());\n    }\n    var selection = window.getSelection();\n    var targetElement;\n    if (selection && selection.anchorNode) {\n      targetElement = selection.anchorNode.parentElement;\n    }\n    if (this.isEnableTextMarkupResizer(type) && this.isExtended && window.getSelection().toString()) {\n      var pageBounds = this.getDrawnBounds();\n      if (pageBounds[0] && pageBounds[0].bounds) {\n        // eslint-disable-next-line\n        var currentAnnot = this.currentTextMarkupAnnotation;\n        for (var k = 0; k < pageBounds.length; k++) {\n          if (currentAnnot && currentAnnot.pageNumber === pageBounds[k].pageIndex) {\n            this.currentTextMarkupAnnotation = currentAnnot;\n            this.selectTextMarkupCurrentPage = pageBounds[k].pageIndex;\n            this.updateTextMarkupAnnotationBounds(pageBounds, k);\n          } else {\n            if (currentAnnot) {\n              if (type === '') {\n                type = currentAnnot.textMarkupAnnotationType;\n              }\n            }\n            if (!currentAnnot.isMultiSelect) {\n              var isMultiSelect = false;\n              if (this.isMultiAnnotation(type)) {\n                this.multiPageCollection.push(currentAnnot);\n                isMultiSelect = true;\n              }\n              // eslint-disable-next-line max-len\n              this.drawTextMarkups(type, pageBounds[k].bounds, pageBounds[k].pageIndex, pageBounds[k].rect, this.pdfViewerBase.getZoomFactor(), pageBounds[k].textContent, pageBounds[k].startIndex, pageBounds[k].endIndex, isMultiSelect, targetElement);\n            } else {\n              if (currentAnnot.isMultiSelect && currentAnnot.annotNameCollection) {\n                this.modifyCurrentAnnotation(currentAnnot, pageBounds, k);\n              }\n            }\n          }\n        }\n      }\n    } else if (window.getSelection().toString()) {\n      var pageBounds = this.getDrawnBounds();\n      var isMultiSelect = this.isMultiPageAnnotations(pageBounds, type);\n      if (pageBounds.length > 0) {\n        for (var i = 0; i < pageBounds.length; i++) {\n          if (type === '') {\n            isCleared = false;\n          }\n          // eslint-disable-next-line max-len\n          this.drawTextMarkups(type, pageBounds[i].bounds, pageBounds[i].pageIndex, pageBounds[i].rect, this.pdfViewerBase.getZoomFactor(), pageBounds[i].textContent, pageBounds[i].startIndex, pageBounds[i].endIndex, isMultiSelect, targetElement);\n        }\n      }\n    }\n    if (this.multiPageCollection) {\n      for (var j = 0; j < this.multiPageCollection.length; j++) {\n        this.updateAnnotationNames(this.multiPageCollection[j], this.multiPageCollection[j].pageNumber);\n      }\n    }\n    this.isExtended = false;\n    this.isSelectionMaintained = false;\n    // this.pdfViewerBase.annotationHelper.redoCollection = [];\n    if (isCleared && this.pdfViewer.textSelectionModule) {\n      this.pdfViewer.textSelectionModule.clearTextSelection();\n    }\n    if (this.isEnableTextMarkupResizer(type)) {\n      this.updateAnnotationBounds();\n    }\n  };\n  // eslint-disable-next-line\n  TextMarkupAnnotation.prototype.isMultiPageAnnotations = function (pageBounds, type) {\n    var isMultiSelect = false;\n    for (var n = 0; n < pageBounds.length; n++) {\n      if (pageBounds[n].pageIndex !== pageBounds[0].pageIndex && this.isMultiAnnotation(type)) {\n        isMultiSelect = true;\n        break;\n      }\n    }\n    return isMultiSelect;\n  };\n  TextMarkupAnnotation.prototype.isMultiAnnotation = function (type) {\n    var isSelection = false;\n    if (type === 'Highlight' && this.pdfViewer.highlightSettings.enableMultiPageAnnotation) {\n      isSelection = true;\n    } else if (type === 'Underline' && this.pdfViewer.underlineSettings.enableMultiPageAnnotation) {\n      isSelection = true;\n    } else if (type === 'Strikethrough' && this.pdfViewer.strikethroughSettings.enableMultiPageAnnotation) {\n      isSelection = true;\n    } else if (this.pdfViewer.enableMultiPageAnnotation) {\n      isSelection = true;\n    }\n    return isSelection;\n  };\n  // eslint-disable-next-line\n  TextMarkupAnnotation.prototype.modifyCurrentAnnotation = function (currentAnnot, pageBounds, index) {\n    for (var c = 0; c < currentAnnot.annotNameCollection.length; c++) {\n      // eslint-disable-next-line\n      var currentAnnots = currentAnnot.annotNameCollection[c];\n      var annotationList = this.getAnnotations(pageBounds[index].pageIndex, null);\n      if (annotationList) {\n        for (var z = 0; z < annotationList.length; z++) {\n          if (annotationList[z].annotName === currentAnnots) {\n            this.currentTextMarkupAnnotation = annotationList[z];\n            this.selectTextMarkupCurrentPage = pageBounds[index].pageIndex;\n            this.updateTextMarkupAnnotationBounds(pageBounds, index);\n            break;\n          }\n        }\n      }\n    }\n  };\n  // eslint-disable-next-line\n  TextMarkupAnnotation.prototype.drawAnnotationSelector = function (newAnnotation, annotation, newcanvas) {\n    var newBounds = [];\n    var x = 0;\n    var y = 0;\n    var width = 0;\n    var height = 0;\n    var currentTop = 0;\n    var nextTop = 0;\n    var currentLeft = 0;\n    var nextLeft = 0;\n    var currentRotation = 0;\n    var nextRotation = 0;\n    for (var i = 0; i < newAnnotation.bounds.length; i++) {\n      currentTop = newAnnotation.bounds[i].top ? newAnnotation.bounds[i].top : newAnnotation.bounds[i].Top;\n      nextTop = !isNullOrUndefined(newAnnotation.bounds[i + 1]) ? newAnnotation.bounds[i + 1].top ? newAnnotation.bounds[i + 1].top : newAnnotation.bounds[i + 1].Top : 0;\n      var rotation_0_180_exists = void 0;\n      if (this.pdfViewerBase.clientSideRendering) {\n        currentLeft = newAnnotation.bounds[i].left ? newAnnotation.bounds[i].left : newAnnotation.bounds[i].Left;\n        nextLeft = !isNullOrUndefined(newAnnotation.bounds[i + 1]) ? newAnnotation.bounds[i + 1].left ? newAnnotation.bounds[i + 1].left : newAnnotation.bounds[i + 1].Left : 0;\n        currentRotation = newAnnotation.bounds[i].rotation;\n        nextRotation = !isNullOrUndefined(newAnnotation.bounds[i + 1]) ? newAnnotation.bounds[i + 1].rotation : 0;\n        rotation_0_180_exists = currentRotation == 0 || currentRotation == 180;\n      }\n      if (newAnnotation.bounds.length > 1 && i < newAnnotation.bounds.length - 1 && currentTop === nextTop) {\n        newBounds.push(newAnnotation.bounds[i]);\n      } else {\n        if (i === newAnnotation.bounds.length - 1 || newAnnotation.bounds.length >= 1) {\n          newBounds.push(newAnnotation.bounds[i]);\n        }\n        if (newBounds.length >= 1) {\n          if (this.pdfViewerBase.clientSideRendering) {\n            var boundsLength = newBounds.length - 1;\n            x = newBounds.reduce(function (min, rect) {\n              return (rect.left ? rect.left : rect.Left || 0) < min ? rect.left ? rect.left : rect.Left || 0 : min;\n            }, Infinity);\n            y = newBounds.reduce(function (min, rect) {\n              return (rect.top ? rect.top : rect.Top || 0) < min ? rect.top ? rect.top : rect.Top || 0 : min;\n            }, Infinity);\n            if (rotation_0_180_exists) {\n              height = newBounds[0].height ? newBounds[0].height : newBounds[0].Height;\n              width = newBounds.reduce(function (sum, rect) {\n                return sum + (rect.width ? rect.width : rect.Width || 0);\n              }, 0);\n            } else {\n              width += newBounds[0].width ? newBounds[0].width : newBounds[0].Width;\n              height = newBounds.reduce(function (sum, rect) {\n                return sum + (rect.height ? rect.height : rect.Height || 0);\n              }, 0);\n            }\n          } else {\n            x = newBounds[0].left ? newBounds[0].left : newBounds[0].Left;\n            y = newBounds[0].top ? newBounds[0].top : newBounds[0].Top;\n            height = newBounds[0].height ? newBounds[0].height : newBounds[0].Height;\n            for (var j = 0; j < newBounds.length; j++) {\n              if (!isNaN(newBounds[j].width) && newBounds[j].width > 0 || !isNaN(newBounds[j].Width) && newBounds[j].Width > 0) {\n                width += newBounds[j].width ? newBounds[j].width : newBounds[j].Width;\n              }\n            }\n            if (!newcanvas) {\n              newcanvas = this.pdfViewerBase.getElement('_annotationCanvas_' + newAnnotation.pageNumber);\n            }\n            // eslint-disable-next-line max-len\n            this.drawAnnotationSelectRect(newcanvas, this.getMagnifiedValue(x - 0.5, this.pdfViewerBase.getZoomFactor()), this.getMagnifiedValue(y - 0.5, this.pdfViewerBase.getZoomFactor()), this.getMagnifiedValue(width + 0.5, this.pdfViewerBase.getZoomFactor()), this.getMagnifiedValue(height + 0.5, this.pdfViewerBase.getZoomFactor()), annotation);\n            newBounds = [];\n            width = 0;\n          }\n        }\n        if (this.pdfViewerBase.clientSideRendering) {\n          if (!newcanvas) {\n            newcanvas = this.pdfViewerBase.getElement('_annotationCanvas_' + newAnnotation.pageNumber);\n          }\n          // eslint-disable-next-line max-len\n          this.drawAnnotationSelectRect(newcanvas, this.getMagnifiedValue(x - 0.5, this.pdfViewerBase.getZoomFactor()), this.getMagnifiedValue(y - 0.5, this.pdfViewerBase.getZoomFactor()), this.getMagnifiedValue(width + 0.5, this.pdfViewerBase.getZoomFactor()), this.getMagnifiedValue(height + 0.5, this.pdfViewerBase.getZoomFactor()), annotation);\n          newBounds = [];\n          width = 0;\n          height = 0;\n        }\n      }\n    }\n  };\n  // eslint-disable-next-line\n  TextMarkupAnnotation.prototype.selectMultiPageAnnotations = function (annotation) {\n    for (var k = 0; k < annotation.annotNameCollection.length; k++) {\n      // eslint-disable-next-line\n      var currentAnnot = annotation.annotNameCollection[k];\n      if (currentAnnot !== annotation.annotName) {\n        for (var p = 0; p < annotation.annotpageNumbers.length; p++) {\n          var currentPage = annotation.annotpageNumbers[p];\n          var annotationList = this.getAnnotations(currentPage, null);\n          if (annotationList) {\n            for (var z = 0; z < annotationList.length; z++) {\n              if (annotationList[z].annotName === currentAnnot) {\n                // eslint-disable-next-line\n                var newAnnotation = annotationList[z];\n                this.drawAnnotationSelector(newAnnotation, annotation);\n              }\n            }\n          }\n        }\n      }\n    }\n  };\n  // eslint-disable-next-line\n  TextMarkupAnnotation.prototype.deletMultiPageAnnotation = function (annotation) {\n    for (var k = 0; k < annotation.annotNameCollection.length; k++) {\n      // eslint-disable-next-line\n      var currentAnnot = annotation.annotNameCollection[k];\n      if (currentAnnot !== annotation.annotName) {\n        for (var p = 0; p < annotation.annotpageNumbers.length; p++) {\n          var currentPage = annotation.annotpageNumbers[p];\n          var annotationList = this.getAnnotations(currentPage, null);\n          if (annotationList) {\n            for (var z = 0; z < annotationList.length; z++) {\n              if (annotationList[z].annotName === currentAnnot) {\n                // eslint-disable-next-line\n                var newAnnotation = annotationList[z];\n                var deletedAnnotation = null;\n                deletedAnnotation = annotationList.splice(z, 1)[0];\n                this.pdfViewer.annotationModule.addAction(currentPage, z, deletedAnnotation, 'Text Markup Deleted', null);\n                this.currentAnnotationIndex = z;\n                this.pdfViewer.annotation.stickyNotesAnnotationModule.findPosition(deletedAnnotation, 'textMarkup');\n                var removeDiv = document.getElementById(deletedAnnotation.annotName);\n                if (removeDiv) {\n                  if (removeDiv.parentElement.childElementCount === 1) {\n                    this.pdfViewer.annotationModule.stickyNotesAnnotationModule.updateAccordionContainer(removeDiv);\n                  } else {\n                    removeDiv.remove();\n                  }\n                }\n                this.pdfViewer.annotationModule.updateAnnotationCollection(newAnnotation);\n                this.manageAnnotations(annotationList, currentPage);\n                // eslint-disable-next-line max-len\n                this.pdfViewer.annotationModule.updateImportAnnotationCollection(newAnnotation, newAnnotation.pageNumber, 'textMarkupAnnotation');\n                var annotationId = newAnnotation.annotName;\n                // eslint-disable-next-line\n                var annotationBounds = newAnnotation.bounds;\n                this.pdfViewer.annotationModule.renderAnnotations(currentPage, null, null, null);\n              }\n            }\n          }\n        }\n      }\n    }\n  };\n  // eslint-disable-next-line\n  TextMarkupAnnotation.prototype.modifyMultiPageAnnotations = function (annotation, property, value) {\n    for (var k = 0; k < annotation.annotNameCollection.length; k++) {\n      // eslint-disable-next-line\n      var currentAnnot = annotation.annotNameCollection[k];\n      if (currentAnnot !== annotation.annotName) {\n        for (var p = 0; p < annotation.annotpageNumbers.length; p++) {\n          var currentPage = annotation.annotpageNumbers[p];\n          var annotationList = this.getAnnotations(currentPage, null);\n          if (annotationList) {\n            for (var z = 0; z < annotationList.length; z++) {\n              if (annotationList[z].annotName === currentAnnot) {\n                if (property === 'Color') {\n                  annotationList[z].color = value;\n                } else {\n                  annotationList[z].opacity = value;\n                }\n                annotationList[z].modifiedDate = this.pdfViewer.annotation.stickyNotesAnnotationModule.getDateAndTime();\n                this.currentAnnotationIndex = z;\n                if (status === null || status === 'changed') {\n                  // eslint-disable-next-line max-len\n                  this.pdfViewer.annotationModule.addAction(annotationList[z].pageNumber, z, annotationList[z], 'Text Markup Property modified', property);\n                }\n                this.pdfViewer.annotationModule.stickyNotesAnnotationModule.updateAnnotationModifiedDate(annotationList[z]);\n                this.manageAnnotations(annotationList, currentPage);\n                this.pdfViewer.annotationModule.renderAnnotations(currentPage, null, null, null);\n              }\n            }\n          }\n        }\n      }\n    }\n  };\n  TextMarkupAnnotation.prototype.convertSelectionToTextMarkup = function (type, selectionObject, factor) {\n    var isMultiSelect = false;\n    this.triggerAddEvent = false;\n    this.multiPageCollection = [];\n    for (var i = 0; i < selectionObject.length; i++) {\n      var textValue = selectionObject[i].textContent;\n      // eslint-disable-next-line\n      var indexes = void 0;\n      if (selectionObject[i].startNode === selectionObject[i].endNode) {\n        var parentText = document.getElementById(selectionObject[i].startNode).textContent;\n        indexes = this.getIndexNumbers(selectionObject[i].pageNumber, textValue, parentText);\n      } else {\n        indexes = this.getIndexNumbers(selectionObject[i].pageNumber, textValue);\n      }\n      if (!isMultiSelect) {\n        for (var n = 1; n < selectionObject.length; n++) {\n          if (selectionObject[n].pageNumber !== selectionObject[0].pageNumber && this.isMultiAnnotation(type)) {\n            isMultiSelect = true;\n            break;\n          }\n        }\n      }\n      if (this.isMultiAnnotation(type) && selectionObject.length - 1 === i) {\n        this.triggerAddEvent = true;\n      }\n      // eslint-disable-next-line max-len\n      this.drawTextMarkups(type, selectionObject[i].rectangleBounds, selectionObject[i].pageNumber, selectionObject[i].bound, factor, textValue, indexes.startIndex, indexes.endIndex, isMultiSelect, document.getElementById(selectionObject[i].startNode));\n    }\n  };\n  // eslint-disable-next-line\n  TextMarkupAnnotation.prototype.updateTextMarkupAnnotationBounds = function (pageBounds, currentIndex) {\n    if (this.currentTextMarkupAnnotation) {\n      var pageAnnotations = this.getAnnotations(pageBounds[currentIndex].pageIndex, null);\n      var annotation = null;\n      if (pageAnnotations) {\n        for (var i = 0; i < pageAnnotations.length; i++) {\n          if (JSON.stringify(this.currentTextMarkupAnnotation) === JSON.stringify(pageAnnotations[i])) {\n            pageAnnotations[i].bounds = pageBounds[currentIndex].bounds;\n            pageAnnotations[i].textMarkupContent = pageBounds[currentIndex].textContent;\n            pageAnnotations[i].textMarkupStartIndex = pageBounds[currentIndex].startIndex;\n            pageAnnotations[i].textMarkupEndIndex = pageBounds[currentIndex].endIndex;\n            pageAnnotations[i].modifiedDate = this.pdfViewer.annotation.stickyNotesAnnotationModule.getDateAndTime();\n            annotation = pageAnnotations[i];\n          }\n        }\n        this.manageAnnotations(pageAnnotations, pageBounds[currentIndex].pageIndex);\n        this.currentTextMarkupAnnotation = null;\n        this.pdfViewer.annotationModule.renderAnnotations(pageBounds[currentIndex].pageIndex, null, null, null);\n        this.pdfViewerBase.updateDocumentEditedProperty(true);\n        if (annotation) {\n          // eslint-disable-next-line\n          var settings = {\n            opacity: annotation.opacity,\n            color: annotation.color,\n            author: annotation.author,\n            subject: annotation.subject,\n            modifiedDate: annotation.modifiedDate\n          };\n          // eslint-disable-next-line max-len\n          var multiPageCollection = this.multiPageCollectionList(annotation);\n          if (multiPageCollection.length > 0) {\n            if (pageBounds.length - 1 === currentIndex) {\n              // eslint-disable-next-line max-len\n              this.pdfViewer.fireAnnotationResize(pageBounds[currentIndex].pageIndex, annotation.annotName, annotation.textMarkupAnnotationType, annotation.bounds, settings, annotation.textMarkupContent, annotation.textMarkupStartIndex, annotation.textMarkupEndIndex, null, multiPageCollection);\n            }\n          } else {\n            // eslint-disable-next-line max-len\n            this.pdfViewer.fireAnnotationResize(pageBounds[currentIndex].pageIndex, annotation.annotName, annotation.textMarkupAnnotationType, annotation.bounds, settings, annotation.textMarkupContent, annotation.textMarkupStartIndex, annotation.textMarkupEndIndex, null);\n          }\n        }\n        // eslint-disable-next-line max-len\n        this.currentAnnotationIndex = null;\n        this.selectTextMarkupCurrentPage = null;\n      }\n    }\n  };\n  /**\n   * @param annotation\n   * @private\n   */\n  // eslint-disable-next-line\n  TextMarkupAnnotation.prototype.multiPageCollectionList = function (annotation) {\n    var multiPageCollectionList = [];\n    if (annotation.isMultiSelect && annotation.annotNameCollection) {\n      multiPageCollectionList.push(annotation);\n      for (var k = 0; k < annotation.annotNameCollection.length; k++) {\n        // eslint-disable-next-line\n        var currentAnnot = annotation.annotNameCollection[k];\n        if (currentAnnot !== annotation.annotName) {\n          for (var p = 0; p < annotation.annotpageNumbers.length; p++) {\n            var currentPage = annotation.annotpageNumbers[p];\n            var annotationList = this.getAnnotations(currentPage, null);\n            if (annotationList) {\n              for (var z = 0; z < annotationList.length; z++) {\n                if (annotationList[z].annotName === currentAnnot) {\n                  multiPageCollectionList.push(annotationList[z]);\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n    return multiPageCollectionList;\n  };\n  // eslint-disable-next-line\n  TextMarkupAnnotation.prototype.updateAnnotationNames = function (annotations, pageNumber) {\n    if (annotations) {\n      var pageAnnotations = this.getAnnotations(pageNumber, null);\n      var annotation = null;\n      if (pageAnnotations) {\n        for (var i = 0; i < pageAnnotations.length; i++) {\n          if (annotations.annotName === pageAnnotations[i].annotName) {\n            // eslint-disable-next-line\n            var annotNamesCollections = [];\n            // eslint-disable-next-line\n            var annotpageNumbers = [];\n            for (var p = 0; p < this.multiPageCollection.length; p++) {\n              annotNamesCollections.push(this.multiPageCollection[p].annotName);\n              annotpageNumbers.push(this.multiPageCollection[p].pageNumber);\n            }\n            pageAnnotations[i].isMultiSelect = true;\n            pageAnnotations[i].annotNameCollection = annotNamesCollections;\n            pageAnnotations[i].annotpageNumbers = annotpageNumbers;\n            annotation = pageAnnotations[i];\n          }\n        }\n        this.manageAnnotations(pageAnnotations, pageNumber);\n      }\n    }\n  };\n  // eslint-disable-next-line\n  TextMarkupAnnotation.prototype.updateAnnotationContent = function (annotation, pageBound) {\n    if (annotation) {\n      var pageAnnotations = this.getAnnotations(this.selectTextMarkupCurrentPage, null);\n      var annotation_1 = null;\n      if (pageAnnotations) {\n        for (var i = 0; i < pageAnnotations.length; i++) {\n          if (JSON.stringify(this.currentTextMarkupAnnotation) === JSON.stringify(pageAnnotations[i])) {\n            pageAnnotations[i].textMarkupContent = pageBound.textContent;\n            pageAnnotations[i].textMarkupStartIndex = pageBound.startIndex;\n            pageAnnotations[i].textMarkupEndIndex = pageBound.endIndex;\n            annotation_1 = pageAnnotations[i];\n          }\n          this.pdfViewer.annotationModule.storeAnnotationCollections(pageAnnotations[i], this.selectTextMarkupCurrentPage);\n        }\n        this.manageAnnotations(pageAnnotations, this.selectTextMarkupCurrentPage);\n      }\n    }\n  };\n  // eslint-disable-next-line\n  TextMarkupAnnotation.prototype.drawTextMarkups = function (type, bounds, pageNumber, rect, factor, textContent, startIndex, endIndex, isMultiSelect, targetElement) {\n    var annotation = null;\n    this.isNewAnnotation = false;\n    var author = 'Guest';\n    var subject;\n    var context = this.getPageContext(pageNumber);\n    var modifiedDate = this.pdfViewer.annotation.stickyNotesAnnotationModule.getDateAndTime();\n    this.highlightColor = this.highlightColor ? this.highlightColor : this.pdfViewer.highlightSettings.color ? this.pdfViewer.highlightSettings.color : '#FFDF56';\n    this.underlineColor = this.underlineColor ? this.underlineColor : this.pdfViewer.underlineSettings.color ? this.pdfViewer.underlineSettings.color : '#00ff00';\n    this.strikethroughColor = this.strikethroughColor ? this.strikethroughColor : this.pdfViewer.strikethroughSettings.color ? this.pdfViewer.strikethroughSettings.color : '#ff0000';\n    this.highlightOpacity = this.pdfViewer.highlightSettings.opacity;\n    this.underlineOpacity = this.pdfViewer.underlineSettings.opacity;\n    this.strikethroughOpacity = this.pdfViewer.strikethroughSettings.opacity;\n    this.annotationAddMode = 'UI Drawn Annotation';\n    // eslint-disable-next-line\n    var allowedInteractions;\n    var pageDetails = this.pdfViewerBase.pageSize[pageNumber];\n    var annotationRotate = 0;\n    var pageRotation = this.getAngle(pageDetails.rotation);\n    if (context) {\n      context.setLineDash([]);\n      switch (type) {\n        case 'Highlight':\n          this.isNewAnnotation = true;\n          subject = this.pdfViewer.highlightSettings.subject !== \"\" && this.pdfViewer.highlightSettings.subject ? this.pdfViewer.highlightSettings.subject : this.pdfViewer.annotationSettings.subject ? this.pdfViewer.annotationSettings.subject : 'Highlight';\n          // eslint-disable-next-line max-len\n          author = this.pdfViewer.highlightSettings.author !== 'Guest' && this.pdfViewer.highlightSettings.author ? this.pdfViewer.highlightSettings.author : this.pdfViewer.annotationSettings.author ? this.pdfViewer.annotationSettings.author : 'Guest';\n          allowedInteractions = this.pdfViewer.highlightSettings.allowedInteractions ? this.pdfViewer.highlightSettings.allowedInteractions : ['None'];\n          // eslint-disable-next-line max-len\n          if (isNullOrUndefined(this.highlightOpacity)) {\n            this.highlightOpacity = 1;\n          }\n          annotation = this.getAddedAnnotation(type, this.highlightColor, this.highlightOpacity, bounds, author, subject, modifiedDate, '', false, rect, pageNumber, textContent, startIndex, endIndex, isMultiSelect, allowedInteractions, annotationRotate);\n          if (annotation) {\n            // eslint-disable-next-line max-len\n            this.renderHighlightAnnotation(annotation.bounds, annotation.opacity, annotation.color, context, factor, annotation.isPrint, pageNumber);\n          }\n          break;\n        case 'Strikethrough':\n          this.isNewAnnotation = true;\n          subject = this.pdfViewer.strikethroughSettings.subject !== \"\" && this.pdfViewer.strikethroughSettings.subject ? this.pdfViewer.strikethroughSettings.subject : this.pdfViewer.annotationSettings.subject ? this.pdfViewer.annotationSettings.subject : 'Strikethrough';\n          // eslint-disable-next-line max-len\n          author = this.pdfViewer.strikethroughSettings.author !== 'Guest' && this.pdfViewer.strikethroughSettings.author ? this.pdfViewer.strikethroughSettings.author : this.pdfViewer.annotationSettings.author ? this.pdfViewer.annotationSettings.author : 'Guest';\n          allowedInteractions = this.pdfViewer.strikethroughSettings.allowedInteractions ? this.pdfViewer.strikethroughSettings.allowedInteractions : ['None'];\n          // eslint-disable-next-line max-len\n          if (targetElement && targetElement.style.transform !== '') {\n            if (targetElement.style.transform.startsWith('rotate(90deg)')) {\n              annotationRotate = Math.abs(pageRotation - 90);\n            } else if (targetElement.style.transform.startsWith('rotate(180deg)')) {\n              annotationRotate = Math.abs(pageRotation - 180);\n            } else if (targetElement.style.transform.startsWith('rotate(-90deg)')) {\n              annotationRotate = Math.abs(pageRotation - 270);\n            } else {\n              annotationRotate = pageRotation;\n            }\n          }\n          if (isNullOrUndefined(this.strikethroughOpacity)) {\n            this.strikethroughOpacity = 1;\n          }\n          annotation = this.getAddedAnnotation(type, this.strikethroughColor, this.strikethroughOpacity, bounds, author, subject, modifiedDate, '', false, rect, pageNumber, textContent, startIndex, endIndex, isMultiSelect, allowedInteractions, annotationRotate);\n          if (annotation) {\n            // eslint-disable-next-line max-len\n            this.renderStrikeoutAnnotation(annotation.bounds, annotation.opacity, annotation.color, context, factor, pageNumber, annotation.isPrint, annotation.annotationRotation, annotation.textMarkupContent);\n          }\n          break;\n        case 'Underline':\n          this.isNewAnnotation = true;\n          subject = this.pdfViewer.underlineSettings.subject !== \"\" && this.pdfViewer.underlineSettings.subject ? this.pdfViewer.underlineSettings.subject : this.pdfViewer.annotationSettings.subject ? this.pdfViewer.annotationSettings.subject : 'Underline';\n          // eslint-disable-next-line max-len\n          author = this.pdfViewer.underlineSettings.author !== 'Guest' && this.pdfViewer.underlineSettings.author ? this.pdfViewer.underlineSettings.author : this.pdfViewer.annotationSettings.author ? this.pdfViewer.annotationSettings.author : 'Guest';\n          allowedInteractions = this.pdfViewer.underlineSettings.allowedInteractions ? this.pdfViewer.underlineSettings.allowedInteractions : ['None'];\n          // eslint-disable-next-line max-len\n          if (targetElement && targetElement.style.transform !== '') {\n            if (targetElement.style.transform.startsWith('rotate(90deg)')) {\n              annotationRotate = Math.abs(pageRotation - 90);\n            } else if (targetElement.style.transform.startsWith('rotate(180deg)')) {\n              annotationRotate = Math.abs(pageRotation - 180);\n            } else if (targetElement.style.transform.startsWith('rotate(-90deg)')) {\n              annotationRotate = Math.abs(pageRotation - 270);\n            } else {\n              annotationRotate = pageRotation;\n            }\n          }\n          if (isNullOrUndefined(this.underlineOpacity)) {\n            this.underlineOpacity = 1;\n          }\n          annotation = this.getAddedAnnotation(type, this.underlineColor, this.underlineOpacity, bounds, author, subject, modifiedDate, '', false, rect, pageNumber, textContent, startIndex, endIndex, isMultiSelect, allowedInteractions, annotationRotate);\n          if (annotation) {\n            // eslint-disable-next-line max-len\n            this.renderUnderlineAnnotation(annotation.bounds, annotation.opacity, annotation.color, context, factor, pageNumber, annotation.isPrint, annotation.annotationRotation);\n          }\n          break;\n      }\n      this.isNewAnnotation = false;\n      if (annotation) {\n        this.pdfViewerBase.updateDocumentEditedProperty(true);\n        // eslint-disable-next-line\n        var settings = {\n          opacity: annotation.opacity,\n          color: annotation.color,\n          author: annotation.author,\n          subject: annotation.subject,\n          modifiedDate: annotation.modifiedDate\n        };\n        var index = this.pdfViewer.annotationModule.actionCollection[this.pdfViewer.annotationModule.actionCollection.length - 1].index;\n        // eslint-disable-next-line max-len\n        if (this.isMultiAnnotation(type)) {\n          if (this.triggerAddEvent) {\n            // eslint-disable-next-line max-len\n            this.pdfViewer.fireAnnotationAdd(pageNumber, annotation.annotName, type, annotation.bounds, settings, textContent, startIndex, endIndex, null, this.multiPageCollection);\n          }\n        } else {\n          // eslint-disable-next-line max-len\n          this.pdfViewer.fireAnnotationAdd(pageNumber, annotation.annotName, type, annotation.bounds, settings, textContent, startIndex, endIndex);\n        }\n      }\n      if (Browser.isDevice && !this.pdfViewer.enableDesktopMode && this.pdfViewer.enableToolbar && this.pdfViewer.enableAnnotationToolbar) {\n        this.pdfViewer.toolbarModule.annotationToolbarModule.createPropertyTools(type);\n      }\n    }\n  };\n  TextMarkupAnnotation.prototype.getAngle = function (rotation) {\n    // eslint-disable-next-line\n    var angle = 0;\n    if (rotation) {\n      switch (rotation) {\n        case 0:\n          angle = 0;\n          break;\n        case 1:\n          angle = 90;\n          break;\n        case 2:\n          angle = 180;\n          break;\n        case 3:\n          angle = 270;\n          break;\n      }\n    }\n    return angle;\n  };\n  // eslint-disable-next-line\n  TextMarkupAnnotation.prototype.retreiveTextIndex = function (annotation) {\n    if (annotation.textMarkupContent === '') {\n      this.retreieveSelection(annotation, null);\n      var pageBounds = this.getDrawnBounds();\n      window.getSelection().removeAllRanges();\n      if (pageBounds[0] && pageBounds[0].bounds) {\n        this.updateAnnotationContent(annotation, pageBounds[0]);\n        annotation.textMarkupContent = pageBounds[0].textContent;\n        annotation.textMarkupStartIndex = pageBounds[0].startIndex;\n        annotation.textMarkupEndIndex = pageBounds[0].endIndex;\n      }\n    }\n    return annotation;\n  };\n  // eslint-disable-next-line\n  TextMarkupAnnotation.prototype.renderHighlightAnnotation = function (bounds, opacity, color, context, factor, isPrint, pageIndex) {\n    var zoomRatio = this.pdfViewerBase.getZoomRatio(factor);\n    for (var i = 0; i < bounds.length; i++) {\n      // eslint-disable-next-line\n      var bound = bounds[i];\n      context.beginPath();\n      var x = bound.X ? bound.X : bound.left;\n      var y = bound.Y ? bound.Y : bound.top;\n      var width = bound.Width ? bound.Width : bound.width;\n      var height = bound.Height ? bound.Height : bound.height;\n      var rotation = bound.Rotation ? bound.Rotation : bound.rotation;\n      x = x ? x : bound.x;\n      y = y ? y : bound.y;\n      // The highlighted position is slightly increased. So Subtract -1 from the height. \n      if (this.pdfViewerBase.clientSideRendering) {\n        if (rotation >= 0) {\n          rotation = Math.abs(rotation) / 90;\n        }\n        if (rotation == 0 || rotation == 2) {\n          height = height - 1;\n        } else if (rotation == 1 || rotation == 3) {\n          width = width - 1;\n        }\n      } else {\n        height = height - 1;\n      }\n      if (context.canvas.id === this.pdfViewer.element.id + '_print_annotation_layer_' + pageIndex) {\n        if (isPrint) {\n          // eslint-disable-next-line max-len\n          context.rect(x * zoomRatio, y * zoomRatio, width * zoomRatio, height * zoomRatio);\n          context.globalAlpha = opacity * 0.5;\n          context.closePath();\n          context.fillStyle = color;\n          context.msFillRule = 'nonzero';\n          context.fill();\n        }\n      } else {\n        // eslint-disable-next-line max-len\n        context.rect(x * zoomRatio, y * zoomRatio, width * zoomRatio, height * zoomRatio);\n        context.globalAlpha = opacity * 0.5;\n        context.closePath();\n        context.fillStyle = color;\n        context.msFillRule = 'nonzero';\n        context.fill();\n      }\n    }\n    context.save();\n  };\n  // eslint-disable-next-line\n  TextMarkupAnnotation.prototype.renderStrikeoutAnnotation = function (bounds, opacity, color, context, factor, pageNumber, isPrint, annotationRotation, textContent) {\n    for (var i = 0; i < bounds.length; i++) {\n      // eslint-disable-next-line\n      var bound = this.getProperBounds(bounds[i]);\n      var pageDetails = this.pdfViewerBase.pageSize[pageNumber];\n      var factorRatio = this.pdfViewerBase.getZoomRatio(factor);\n      var rotation = pageDetails.rotation;\n      if (annotationRotation || this.pdfViewerBase.clientSideRendering && bounds[i].rotation) {\n        var pageRotation = this.getAngle(rotation);\n        rotation = this.pdfViewerBase.clientSideRendering ? Math.abs(bounds[i].rotation) / 90 : Math.abs(annotationRotation - pageRotation) / 90;\n      }\n      if (context.canvas.id === this.pdfViewer.element.id + '_print_annotation_layer_' + pageNumber) {\n        if (isPrint) {\n          if (rotation === 1) {\n            // eslint-disable-next-line max-len\n            this.drawLine(opacity, bound.x + bound.width / 2, bound.y, bound.width, bound.height, color, factorRatio, context, pageNumber, this.pdfViewerBase.clientSideRendering ? bounds[i].rotation : annotationRotation, textContent);\n          } else if (rotation === 2) {\n            // eslint-disable-next-line max-len\n            this.drawLine(opacity, bound.x, bound.y + bound.height / 2, bound.width, bound.height, color, factorRatio, context, pageNumber, this.pdfViewerBase.clientSideRendering ? bounds[i].rotation : annotationRotation, textContent);\n          } else if (rotation === 3) {\n            this.drawLine(opacity, bound.x, bound.y, bound.width / 2, bound.height, color, factorRatio, context, pageNumber, this.pdfViewerBase.clientSideRendering ? bounds[i].rotation : annotationRotation, textContent);\n          } else {\n            this.drawLine(opacity, bound.x, bound.y, bound.width, bound.height / 2, color, factorRatio, context, pageNumber, this.pdfViewerBase.clientSideRendering ? bounds[i].rotation : annotationRotation, textContent);\n          }\n        }\n      } else {\n        if (rotation === 1) {\n          // eslint-disable-next-line max-len\n          this.drawLine(opacity, bound.x + bound.width / 2, bound.y, bound.width, bound.height, color, factorRatio, context, pageNumber, this.pdfViewerBase.clientSideRendering ? bounds[i].rotation : annotationRotation, textContent);\n        } else if (rotation === 2) {\n          // eslint-disable-next-line max-len\n          this.drawLine(opacity, bound.x, bound.y + bound.height / 2, bound.width, bound.height, color, factorRatio, context, pageNumber, this.pdfViewerBase.clientSideRendering ? bounds[i].rotation : annotationRotation, textContent);\n        } else if (rotation === 3) {\n          this.drawLine(opacity, bound.x, bound.y, bound.width / 2, bound.height, color, factorRatio, context, pageNumber, this.pdfViewerBase.clientSideRendering ? bounds[i].rotation : annotationRotation, textContent);\n        } else {\n          this.drawLine(opacity, bound.x, bound.y, bound.width, bound.height / 2, color, factorRatio, context, pageNumber, this.pdfViewerBase.clientSideRendering ? bounds[i].rotation : annotationRotation, textContent);\n        }\n      }\n    }\n  };\n  // eslint-disable-next-line\n  TextMarkupAnnotation.prototype.renderUnderlineAnnotation = function (bounds, opacity, color, context, factor, pageNumber, isPrint, annotationRotation) {\n    for (var i = 0; i < bounds.length; i++) {\n      // eslint-disable-next-line\n      var boundValues = this.getProperBounds(bounds[i]);\n      var factorRatio = this.pdfViewerBase.getZoomRatio(factor);\n      if (context.canvas.id === this.pdfViewer.element.id + '_print_annotation_layer_' + pageNumber) {\n        if (isPrint) {\n          // eslint-disable-next-line max-len\n          this.drawLine(opacity, boundValues.x, boundValues.y, boundValues.width, boundValues.height, color, factorRatio, context, pageNumber, this.pdfViewerBase.clientSideRendering ? bounds[i].rotation : annotationRotation);\n        }\n      } else {\n        // eslint-disable-next-line max-len\n        this.drawLine(opacity, boundValues.x, boundValues.y, boundValues.width, boundValues.height, color, factorRatio, context, pageNumber, this.pdfViewerBase.clientSideRendering ? bounds[i].rotation : annotationRotation);\n      }\n    }\n  };\n  // eslint-disable-next-line\n  TextMarkupAnnotation.prototype.getProperBounds = function (bound) {\n    var x = bound.X ? bound.X : bound.left;\n    var y = bound.Y ? bound.Y : bound.top;\n    var width = bound.Width ? bound.Width : bound.width;\n    var height = bound.Height ? bound.Height : bound.height;\n    x = x ? x : bound.x;\n    y = y ? y : bound.y;\n    return {\n      x: x,\n      y: y,\n      width: width,\n      height: height\n    };\n  };\n  TextMarkupAnnotation.prototype.isChineseLanguage = function (textContent) {\n    var chineseRegex = /[\\u4e00-\\u9fff]/;\n    // Check if the text contains Chinese characters\n    var isChinese = chineseRegex.test(textContent);\n    if (isChinese) {\n      return true;\n    } else {\n      return false;\n    }\n  };\n  // eslint-disable-next-line max-len\n  TextMarkupAnnotation.prototype.drawLine = function (opacity, x, y, width, height, color, factor, context, pageNumber, annotationRotation, textContent) {\n    context.globalAlpha = opacity;\n    if (isBlazor()) {\n      y = y - 1;\n    }\n    if (this.isChineseLanguage(textContent)) {\n      height = height - 1.5;\n    }\n    if (!this.pdfViewerBase.clientSideRendering && !this.isChineseLanguage(textContent)) {\n      height = height - 1;\n    }\n    context.beginPath();\n    var pageDetails = this.pdfViewerBase.pageSize[pageNumber];\n    var rotation = pageDetails.rotation;\n    if (annotationRotation || this.pdfViewerBase.clientSideRendering && annotationRotation >= 0) {\n      var pageRotation = this.getAngle(rotation);\n      rotation = this.pdfViewerBase.clientSideRendering ? Math.abs(annotationRotation) / 90 : Math.abs(annotationRotation - pageRotation) / 90;\n    }\n    if (this.pdfViewerBase.clientSideRendering) {\n      if (rotation == 0 || rotation == 2) {\n        height = height - 1;\n      } else if (rotation == 1 || rotation == 3) {\n        width = width - 1;\n      }\n    }\n    if (rotation === 1) {\n      context.moveTo(x * factor, y * factor);\n      context.lineTo(x * factor, (y + height) * factor);\n    } else if (rotation === 2) {\n      context.moveTo(x * factor, y * factor);\n      context.lineTo((width + x) * factor, y * factor);\n    } else if (rotation === 3) {\n      context.moveTo((width + x) * factor, y * factor);\n      context.lineTo((width + x) * factor, (y + height) * factor);\n    } else {\n      context.moveTo(x * factor, (y + height) * factor);\n      context.lineTo((width + x) * factor, (y + height) * factor);\n    }\n    context.lineWidth = 1;\n    context.strokeStyle = color;\n    context.closePath();\n    context.msFillRule = 'nonzero';\n    context.stroke();\n  };\n  /**\n   * @param textMarkupAnnotations\n   * @param pageIndex\n   * @param stampData\n   * @param shapeData\n   * @param measureShapeData\n   * @param stickyData\n   * @param textMarkupAnnotations\n   * @param pageIndex\n   * @param stampData\n   * @param shapeData\n   * @param measureShapeData\n   * @param stickyData\n   * @private\n   */\n  // eslint-disable-next-line\n  TextMarkupAnnotation.prototype.printTextMarkupAnnotations = function (textMarkupAnnotations, pageIndex, stampData, shapeData, measureShapeData, stickyData, freeTextData) {\n    var canvas = createElement('canvas', {\n      id: this.pdfViewer.element.id + '_print_annotation_layer_' + pageIndex\n    });\n    canvas.style.width = 816 + 'px';\n    canvas.style.height = 1056 + 'px';\n    var pageWidth = this.pdfViewerBase.pageSize[pageIndex].width;\n    var pageHeight = this.pdfViewerBase.pageSize[pageIndex].height;\n    var zoom = this.pdfViewerBase.getZoomFactor();\n    var zoomRatio = this.pdfViewerBase.getZoomRatio(zoom);\n    canvas.height = pageHeight * zoomRatio;\n    canvas.width = pageWidth * zoomRatio;\n    // eslint-disable-next-line\n    var textMarkupannotations = this.getAnnotations(pageIndex, null, '_annotations_textMarkup');\n    // eslint-disable-next-line\n    var shapeAnnotation = this.getAnnotations(pageIndex, null, '_annotations_shape');\n    // eslint-disable-next-line\n    var measureShapeAnnotation = this.getAnnotations(pageIndex, null, '_annotations_shape_measure');\n    // eslint-disable-next-line\n    var stampAnnotation = this.getAnnotations(pageIndex, null, '_annotations_stamp');\n    // eslint-disable-next-line\n    var stickyNoteAnnotation = this.getAnnotations(pageIndex, null, '_annotations_sticky');\n    if (stampAnnotation || shapeAnnotation || stickyNoteAnnotation || measureShapeAnnotation) {\n      this.pdfViewer.renderDrawing(canvas, pageIndex);\n    } else {\n      this.pdfViewer.annotation.renderAnnotations(pageIndex, shapeData, measureShapeData, null, canvas, null, null, freeTextData);\n      this.pdfViewer.annotation.stampAnnotationModule.renderStampAnnotations(stampData, pageIndex, canvas);\n      this.pdfViewer.annotation.stickyNotesAnnotationModule.renderStickyNotesAnnotations(stickyData, pageIndex, canvas);\n    }\n    var zoomFactor = this.pdfViewerBase.getZoomFactor();\n    if (textMarkupannotations) {\n      this.renderTextMarkupAnnotations(null, pageIndex, canvas, zoomFactor);\n    } else {\n      this.renderTextMarkupAnnotations(textMarkupAnnotations, pageIndex, canvas, zoomFactor);\n    }\n    var imageSource = canvas.toDataURL();\n    return imageSource;\n  };\n  /**\n   * @private\n   */\n  TextMarkupAnnotation.prototype.saveTextMarkupAnnotations = function () {\n    // eslint-disable-next-line\n    var storeTextMarkupObject = window.sessionStorage.getItem(this.pdfViewerBase.documentId + '_annotations_textMarkup');\n    if (this.pdfViewerBase.isStorageExceed) {\n      storeTextMarkupObject = this.pdfViewerBase.annotationStorage[this.pdfViewerBase.documentId + '_annotations_textMarkup'];\n    }\n    // eslint-disable-next-line\n    var textMarkupAnnotations = new Array();\n    for (var j = 0; j < this.pdfViewerBase.pageCount; j++) {\n      textMarkupAnnotations[j] = [];\n    }\n    if (storeTextMarkupObject && !this.pdfViewer.annotationSettings.skipDownload) {\n      var textMarkupAnnotationCollection = JSON.parse(storeTextMarkupObject);\n      for (var i = 0; i < textMarkupAnnotationCollection.length; i++) {\n        var newArray = [];\n        var pageAnnotationObject = textMarkupAnnotationCollection[i];\n        if (pageAnnotationObject) {\n          var _loop_1 = function (z) {\n            this_1.pdfViewer.annotationModule.updateModifiedDate(pageAnnotationObject.annotations[z]);\n            if (this_1.pdfViewerBase.isJsonExported) {\n              if (pageAnnotationObject.annotations[z].isAnnotationRotated) {\n                pageAnnotationObject.annotations[z].bounds = this_1.getBoundsForSave(pageAnnotationObject.annotations[z].bounds, i);\n              } else {\n                var pageDetails = this_1.pdfViewerBase.pageSize[pageAnnotationObject.pageIndex];\n                if (pageDetails) {\n                  pageAnnotationObject.annotations[z].annotationRotation = pageDetails.rotation;\n                }\n              }\n            }\n            if (this_1.isChineseLanguage(pageAnnotationObject.annotations[z].textMarkupContent)) {\n              if (pageAnnotationObject.annotations[z].bounds.length > 0) {\n                var height_difference_1 = pageAnnotationObject.annotations[z].textMarkupAnnotationType === 'Strikethrough' ? this_1.strikeoutDifference : pageAnnotationObject.annotations[z].textMarkupAnnotationType === 'Underline' ? this_1.underlineDifference : 0;\n                pageAnnotationObject.annotations[z].bounds.forEach(function (bound) {\n                  bound.height = bound.height ? bound.height : bound.Height;\n                  if (bound.height > 0) {\n                    // Update height value\n                    bound.height += height_difference_1;\n                  }\n                });\n              }\n            }\n            // eslint-disable-next-line max-len\n            pageAnnotationObject.annotations[z].bounds = JSON.stringify(this_1.getBoundsForSave(pageAnnotationObject.annotations[z].bounds, i));\n            var colorString = pageAnnotationObject.annotations[z].color;\n            pageAnnotationObject.annotations[z].color = JSON.stringify(this_1.getRgbCode(colorString));\n            pageAnnotationObject.annotations[z].rect = JSON.stringify(pageAnnotationObject.annotations[z].rect);\n          };\n          var this_1 = this;\n          for (var z = 0; pageAnnotationObject.annotations.length > z; z++) {\n            _loop_1(z);\n          }\n          newArray = pageAnnotationObject.annotations;\n        }\n        textMarkupAnnotations[pageAnnotationObject.pageIndex] = newArray;\n      }\n    }\n    return JSON.stringify(textMarkupAnnotations);\n  };\n  /**\n   * @private\n   */\n  TextMarkupAnnotation.prototype.deleteTextMarkupAnnotation = function () {\n    if (this.currentTextMarkupAnnotation) {\n      var isLock = false;\n      if (this.currentTextMarkupAnnotation.annotationSettings) {\n        // eslint-disable-next-line\n        isLock = this.currentTextMarkupAnnotation.annotationSettings.isLock;\n        if (this.pdfViewer.annotationModule.checkAllowedInteractions('Delete', this.currentTextMarkupAnnotation)) {\n          isLock = false;\n        }\n      }\n      if (!isLock) {\n        var deletedAnnotation = null;\n        this.showHideDropletDiv(true);\n        // eslint-disable-next-line\n        var annotation = this.currentTextMarkupAnnotation;\n        if (this.currentTextMarkupAnnotation.isMultiSelect && annotation.annotNameCollection) {\n          this.deletMultiPageAnnotation(annotation);\n        }\n        var pageAnnotations = this.getAnnotations(this.selectTextMarkupCurrentPage, null);\n        if (pageAnnotations) {\n          for (var i = 0; i < pageAnnotations.length; i++) {\n            if (this.currentTextMarkupAnnotation.annotName === pageAnnotations[i].annotName) {\n              deletedAnnotation = pageAnnotations.splice(i, 1)[0];\n              // eslint-disable-next-line max-len\n              this.pdfViewer.annotationModule.addAction(this.selectTextMarkupCurrentPage, i, deletedAnnotation, 'Text Markup Deleted', null);\n              this.currentAnnotationIndex = i;\n              this.pdfViewer.annotation.stickyNotesAnnotationModule.findPosition(deletedAnnotation, 'textMarkup');\n              var removeDiv = document.getElementById(deletedAnnotation.annotName);\n              if (removeDiv) {\n                if (removeDiv.parentElement.childElementCount === 1) {\n                  this.pdfViewer.annotationModule.stickyNotesAnnotationModule.updateAccordionContainer(removeDiv);\n                } else {\n                  removeDiv.remove();\n                }\n              }\n            }\n          }\n          this.pdfViewer.annotationModule.updateAnnotationCollection(this.currentTextMarkupAnnotation);\n          this.manageAnnotations(pageAnnotations, this.selectTextMarkupCurrentPage);\n          // eslint-disable-next-line max-len\n          this.pdfViewer.annotationModule.updateImportAnnotationCollection(this.currentTextMarkupAnnotation, this.currentTextMarkupAnnotation.pageNumber, 'textMarkupAnnotation');\n          var annotationId = this.currentTextMarkupAnnotation.annotName;\n          // eslint-disable-next-line\n          var annotationBounds = this.currentTextMarkupAnnotation.bounds;\n          this.currentTextMarkupAnnotation = null;\n          this.pdfViewer.annotationModule.renderAnnotations(this.selectTextMarkupCurrentPage, null, null, null);\n          this.pdfViewerBase.updateDocumentEditedProperty(true);\n          // eslint-disable-next-line max-len\n          var multiPageCollection = this.multiPageCollectionList(annotation);\n          if (multiPageCollection.length > 0) {\n            multiPageCollection.push(deletedAnnotation);\n            // eslint-disable-next-line max-len\n            this.pdfViewer.fireAnnotationRemove(this.selectTextMarkupCurrentPage, annotationId, deletedAnnotation.textMarkupAnnotationType, annotationBounds, deletedAnnotation.textMarkupContent, deletedAnnotation.textMarkupStartIndex, deletedAnnotation.textMarkupEndIndex, multiPageCollection);\n          } else {\n            // eslint-disable-next-line max-len\n            this.pdfViewer.fireAnnotationRemove(this.selectTextMarkupCurrentPage, annotationId, deletedAnnotation.textMarkupAnnotationType, annotationBounds, deletedAnnotation.textMarkupContent, deletedAnnotation.textMarkupStartIndex, deletedAnnotation.textMarkupEndIndex);\n          }\n          this.currentAnnotationIndex = null;\n          this.selectTextMarkupCurrentPage = null;\n          if (Browser.isDevice && !this.pdfViewer.enableDesktopMode) {\n            // eslint-disable-next-line max-len\n            this.pdfViewer.toolbarModule.annotationToolbarModule.hideMobileAnnotationToolbar();\n            this.pdfViewer.toolbarModule.showToolbar(true);\n          }\n        }\n      }\n    }\n  };\n  /**\n   * @param color\n   * @private\n   */\n  TextMarkupAnnotation.prototype.modifyColorProperty = function (color) {\n    if (this.currentTextMarkupAnnotation) {\n      var pageAnnotations = this.modifyAnnotationProperty('Color', color, null);\n      this.manageAnnotations(pageAnnotations, this.selectTextMarkupCurrentPage);\n      this.pdfViewer.annotationModule.renderAnnotations(this.selectTextMarkupCurrentPage, null, null, null);\n      this.pdfViewerBase.updateDocumentEditedProperty(true);\n      // eslint-disable-next-line\n      var annotation = this.currentTextMarkupAnnotation;\n      // eslint-disable-next-line max-len\n      var multiPageCollection = this.multiPageCollectionList(annotation);\n      if (multiPageCollection.length > 0) {\n        // eslint-disable-next-line max-len\n        this.pdfViewer.fireAnnotationPropertiesChange(this.selectTextMarkupCurrentPage, annotation.annotName, annotation.textMarkupAnnotationType, true, false, false, false, annotation.textMarkupContent, annotation.textMarkupStartIndex, annotation.textMarkupEndIndex, multiPageCollection);\n        this.currentAnnotationIndex = null;\n      } else {\n        // eslint-disable-next-line max-len\n        this.pdfViewer.fireAnnotationPropertiesChange(this.selectTextMarkupCurrentPage, annotation.annotName, annotation.textMarkupAnnotationType, true, false, false, false, annotation.textMarkupContent, annotation.textMarkupStartIndex, annotation.textMarkupEndIndex);\n        this.currentAnnotationIndex = null;\n      }\n    }\n  };\n  /**\n   * @param args\n   * @param isOpacity\n   * @private\n   */\n  TextMarkupAnnotation.prototype.modifyOpacityProperty = function (args, isOpacity) {\n    if (this.currentTextMarkupAnnotation) {\n      var pageAnnotations = void 0;\n      if (!isNullOrUndefined(isOpacity)) {\n        pageAnnotations = this.modifyAnnotationProperty('Opacity', isOpacity, 'changed');\n      } else {\n        pageAnnotations = this.modifyAnnotationProperty('Opacity', args.value / 100, args.name);\n      }\n      if (pageAnnotations) {\n        this.manageAnnotations(pageAnnotations, this.selectTextMarkupCurrentPage);\n        this.pdfViewer.annotationModule.renderAnnotations(this.selectTextMarkupCurrentPage, null, null, null);\n        if (!isNullOrUndefined(isOpacity) || args.name === 'changed') {\n          this.pdfViewerBase.updateDocumentEditedProperty(true);\n          // eslint-disable-next-line\n          var annotation = this.currentTextMarkupAnnotation;\n          // eslint-disable-next-line max-len\n          var multiPageCollection = this.multiPageCollectionList(annotation);\n          if (multiPageCollection.length > 0) {\n            // eslint-disable-next-line max-len\n            this.pdfViewer.fireAnnotationPropertiesChange(this.selectTextMarkupCurrentPage, annotation.annotName, annotation.textMarkupAnnotationType, false, true, false, false, annotation.textMarkupContent, annotation.textMarkupStartIndex, annotation.textMarkupEndIndex, multiPageCollection);\n            this.currentAnnotationIndex = null;\n          } else {\n            // eslint-disable-next-line max-len\n            this.pdfViewer.fireAnnotationPropertiesChange(this.selectTextMarkupCurrentPage, annotation.annotName, annotation.textMarkupAnnotationType, false, true, false, false, annotation.textMarkupContent, annotation.textMarkupStartIndex, annotation.textMarkupEndIndex);\n            this.currentAnnotationIndex = null;\n          }\n        }\n      }\n    }\n  };\n  /**\n   * @param property\n   * @param value\n   * @param status\n   * @param annotName\n   * @private\n   */\n  // eslint-disable-next-line\n  TextMarkupAnnotation.prototype.modifyAnnotationProperty = function (property, value, status, annotName) {\n    // eslint-disable-next-line\n    var annotation = this.currentTextMarkupAnnotation;\n    this.pdfViewer.annotationModule.isFormFieldShape = false;\n    if (annotation.isMultiSelect && annotation.annotNameCollection) {\n      this.modifyMultiPageAnnotations(annotation, property, value);\n    }\n    var pageAnnotations = this.getAnnotations(this.selectTextMarkupCurrentPage, null);\n    if (pageAnnotations) {\n      for (var i = 0; i < pageAnnotations.length; i++) {\n        if (JSON.stringify(this.currentTextMarkupAnnotation) === JSON.stringify(pageAnnotations[i])) {\n          if (property === 'Color') {\n            pageAnnotations[i].color = value;\n          } else if (property === 'Opacity') {\n            pageAnnotations[i].opacity = value;\n          } else if (property === 'AnnotationSettings') {\n            pageAnnotations[i].annotationSettings = {\n              isLock: value\n            };\n          }\n          pageAnnotations[i].modifiedDate = this.pdfViewer.annotation.stickyNotesAnnotationModule.getDateAndTime();\n          this.currentAnnotationIndex = i;\n          if (status === null || status === 'changed') {\n            // eslint-disable-next-line max-len\n            this.pdfViewer.annotationModule.addAction(this.selectTextMarkupCurrentPage, i, this.currentTextMarkupAnnotation, 'Text Markup Property modified', property);\n          }\n          this.currentTextMarkupAnnotation = pageAnnotations[i];\n          this.pdfViewer.annotationModule.stickyNotesAnnotationModule.updateAnnotationModifiedDate(pageAnnotations[i]);\n          this.pdfViewer.annotationModule.storeAnnotationCollections(pageAnnotations[i], this.selectTextMarkupCurrentPage);\n        }\n      }\n    }\n    return pageAnnotations;\n  };\n  /**\n   * @param annotation\n   * @param pageNumber\n   * @param index\n   * @param action\n   * @private\n   */\n  TextMarkupAnnotation.prototype.undoTextMarkupAction = function (annotation, pageNumber, index, action) {\n    var pageAnnotations = this.getAnnotations(pageNumber, null);\n    if (pageAnnotations) {\n      if (action === 'Text Markup Added') {\n        this.pdfViewer.annotation.stickyNotesAnnotationModule.findPosition(pageAnnotations[index], 'textMarkup');\n        // eslint-disable-next-line\n        var removeDiv = document.getElementById(pageAnnotations[index].annotName);\n        if (removeDiv) {\n          if (removeDiv.parentElement.childElementCount === 1) {\n            this.pdfViewer.annotationModule.stickyNotesAnnotationModule.updateAccordionContainer(removeDiv);\n          } else {\n            removeDiv.parentElement.removeChild(removeDiv);\n          }\n        }\n        pageAnnotations.splice(index, 1);\n      } else if (action === 'Text Markup Deleted') {\n        // eslint-disable-next-line max-len\n        this.pdfViewer.annotationModule.stickyNotesAnnotationModule.addAnnotationComments(pageNumber, annotation.shapeAnnotationType);\n        pageAnnotations.splice(index, 0, annotation);\n      }\n    }\n    this.clearCurrentAnnotation();\n    this.pdfViewerBase.updateDocumentEditedProperty(true);\n    this.manageAnnotations(pageAnnotations, pageNumber);\n    this.pdfViewer.annotationModule.renderAnnotations(pageNumber, null, null, null);\n  };\n  /**\n   * @param annotation\n   * @param pageNumber\n   * @param index\n   * @param property\n   * @param isUndoAction\n   * @param annotation\n   * @param pageNumber\n   * @param index\n   * @param property\n   * @param isUndoAction\n   * @param annotation\n   * @param pageNumber\n   * @param index\n   * @param property\n   * @param isUndoAction\n   * @param annotation\n   * @param pageNumber\n   * @param index\n   * @param property\n   * @param isUndoAction\n   * @private\n   */\n  // eslint-disable-next-line max-len\n  TextMarkupAnnotation.prototype.undoRedoPropertyChange = function (annotation, pageNumber, index, property, isUndoAction) {\n    var pageAnnotations = this.getAnnotations(pageNumber, null);\n    if (pageAnnotations) {\n      if (property === 'Color') {\n        var tempColor = pageAnnotations[index].color;\n        pageAnnotations[index].color = annotation.color;\n        annotation.color = tempColor;\n      } else {\n        var tempOpacity = pageAnnotations[index].opacity;\n        pageAnnotations[index].opacity = annotation.opacity;\n        annotation.opacity = tempOpacity;\n      }\n      this.pdfViewer.annotationModule.stickyNotesAnnotationModule.updateAnnotationModifiedDate(annotation, null, true);\n      if (isUndoAction) {\n        annotation.modifiedDate = this.pdfViewer.annotation.stickyNotesAnnotationModule.getDateAndTime();\n      }\n    }\n    this.clearCurrentAnnotation();\n    this.pdfViewerBase.updateDocumentEditedProperty(true);\n    this.manageAnnotations(pageAnnotations, pageNumber);\n    this.pdfViewer.annotationModule.renderAnnotations(pageNumber, null, null, null);\n    return annotation;\n  };\n  /**\n   * @param annotation\n   * @param pageNumber\n   * @param index\n   * @param action\n   * @private\n   */\n  TextMarkupAnnotation.prototype.redoTextMarkupAction = function (annotation, pageNumber, index, action) {\n    var pageAnnotations = this.getAnnotations(pageNumber, null);\n    if (pageAnnotations) {\n      if (action === 'Text Markup Added') {\n        // eslint-disable-next-line max-len\n        this.pdfViewer.annotationModule.stickyNotesAnnotationModule.addAnnotationComments(pageNumber, annotation.shapeAnnotationType);\n        pageAnnotations.push(annotation);\n      } else if (action === 'Text Markup Deleted') {\n        this.pdfViewer.annotation.stickyNotesAnnotationModule.findPosition(pageAnnotations[index], 'textMarkup');\n        // eslint-disable-next-line\n        var removeDiv = document.getElementById(pageAnnotations[index].annotName);\n        if (removeDiv) {\n          if (removeDiv.parentElement.childElementCount === 1) {\n            this.pdfViewer.annotationModule.stickyNotesAnnotationModule.updateAccordionContainer(removeDiv);\n          } else {\n            removeDiv.remove();\n          }\n        }\n        pageAnnotations.splice(index, 1);\n      }\n    }\n    this.clearCurrentAnnotation();\n    this.pdfViewerBase.updateDocumentEditedProperty(true);\n    this.manageAnnotations(pageAnnotations, pageNumber);\n    this.pdfViewer.annotationModule.renderAnnotations(pageNumber, null, null, null);\n  };\n  /**\n   * @param pageNumber\n   * @param note\n   * @param pageNumber\n   * @param note\n   * @private\n   */\n  TextMarkupAnnotation.prototype.saveNoteContent = function (pageNumber, note) {\n    var pageAnnotations = this.getAnnotations(pageNumber, null);\n    if (pageAnnotations) {\n      for (var i = 0; i < pageAnnotations.length; i++) {\n        if (JSON.stringify(this.currentTextMarkupAnnotation) === JSON.stringify(pageAnnotations[i])) {\n          pageAnnotations[i].note = note;\n        }\n      }\n    }\n    this.manageAnnotations(pageAnnotations, pageNumber);\n    this.pdfViewerBase.updateDocumentEditedProperty(true);\n  };\n  TextMarkupAnnotation.prototype.clearCurrentAnnotation = function () {\n    if (!this.isExtended) {\n      if (this.pdfViewer.isMaintainSelection && !this.pdfViewer.textSelectionModule.isTextSelection) {\n        this.selectTextMarkupCurrentPage = this.selectTextMarkupCurrentPage;\n        this.currentTextMarkupAnnotation = this.currentTextMarkupAnnotation;\n      } else {\n        this.selectTextMarkupCurrentPage = null;\n        this.currentTextMarkupAnnotation = null;\n      }\n      var isSkip = false;\n      // eslint-disable-next-line max-len\n      if (this.pdfViewer.annotation.freeTextAnnotationModule && this.pdfViewer.annotation.freeTextAnnotationModule.isInuptBoxInFocus) {\n        isSkip = true;\n      }\n      if (!isSkip) {\n        this.enableAnnotationPropertiesTool(false);\n      }\n    }\n  };\n  /**\n   * @param pageNumber\n   * @param isSelect\n   * @param pageNumber\n   * @param isSelect\n   * @private\n   */\n  TextMarkupAnnotation.prototype.clearCurrentAnnotationSelection = function (pageNumber, isSelect) {\n    if (isSelect) {\n      this.isAnnotationSelect = true;\n    } else {\n      this.isAnnotationSelect = false;\n    }\n    var lowerPageIndex = pageNumber - 2 >= 0 ? pageNumber - 2 : 0;\n    // eslint-disable-next-line max-len\n    var higherPageIndex = pageNumber + 2 < this.pdfViewerBase.pageCount ? pageNumber + 2 : this.pdfViewerBase.pageCount - 1;\n    for (var k = lowerPageIndex; k <= higherPageIndex; k++) {\n      this.clearAnnotationSelection(k);\n    }\n  };\n  // eslint-disable-next-line\n  TextMarkupAnnotation.prototype.getBoundsForSave = function (bounds, pageIndex) {\n    // eslint-disable-next-line\n    var newArray = [];\n    for (var i = 0; i < bounds.length; i++) {\n      // eslint-disable-next-line\n      var bound = this.getAnnotationBounds(bounds[i], pageIndex);\n      newArray.push(bound);\n    }\n    return newArray;\n  };\n  // eslint-disable-next-line\n  TextMarkupAnnotation.prototype.getAnnotationBounds = function (bounds, pageIndex) {\n    var left = bounds.left ? bounds.left : bounds.Left;\n    var top = bounds.top ? bounds.top : bounds.Top;\n    var height = bounds.height ? bounds.height : bounds.Height;\n    var width = bounds.width ? bounds.width : bounds.Width;\n    var pageDetails = this.pdfViewerBase.pageSize[pageIndex];\n    left = left ? left : bounds.x;\n    top = top ? top : bounds.y;\n    if (pageDetails) {\n      if (pageDetails.rotation === 1) {\n        return {\n          left: top,\n          top: pageDetails.width - (left + width),\n          width: height,\n          height: width\n        };\n      } else if (pageDetails.rotation === 2) {\n        // eslint-disable-next-line max-len\n        return {\n          left: pageDetails.width - left - width,\n          top: pageDetails.height - top - height,\n          width: width,\n          height: height\n        };\n      } else if (pageDetails.rotation === 3) {\n        return {\n          left: pageDetails.height - top - height,\n          top: left,\n          width: height,\n          height: width\n        };\n      } else {\n        return {\n          left: left,\n          top: top,\n          width: width,\n          height: height\n        };\n      }\n    } else {\n      return {\n        left: left,\n        top: top,\n        width: width,\n        height: height\n      };\n    }\n  };\n  // eslint-disable-next-line\n  TextMarkupAnnotation.prototype.getRgbCode = function (colorString) {\n    if (!colorString.match(/#([a-z0-9]+)/gi) && !colorString.match(/^rgba?\\((\\d+),\\s*(\\d+),\\s*(\\d+)(?:,\\s*(\\d+(?:\\.\\d+)?))?\\)$/)) {\n      colorString = this.pdfViewer.annotationModule.nameToHash(colorString);\n    }\n    var markupStringArray = colorString.split(',');\n    if (isNullOrUndefined(markupStringArray[1])) {\n      colorString = this.pdfViewer.annotationModule.getValue(colorString, 'rgba');\n      markupStringArray = colorString.split(',');\n    }\n    // eslint-disable-next-line radix\n    var textMarkupR = parseInt(markupStringArray[0].split('(')[1]);\n    // eslint-disable-next-line radix\n    var textMarkupG = parseInt(markupStringArray[1]);\n    // eslint-disable-next-line radix\n    var textMarkupB = parseInt(markupStringArray[2]);\n    // eslint-disable-next-line radix\n    var textMarkupA = parseInt(markupStringArray[3]);\n    return {\n      a: textMarkupA,\n      r: textMarkupR,\n      g: textMarkupG,\n      b: textMarkupB\n    };\n  };\n  TextMarkupAnnotation.prototype.getDrawnBounds = function () {\n    var pageBounds = [];\n    var selection = window.getSelection();\n    if (selection.anchorNode !== null) {\n      var range = document.createRange();\n      var isBackWardSelection = this.pdfViewerBase.textLayer.isBackWardSelection(selection);\n      if (selection.anchorNode === selection.focusNode) {\n        var pageId = this.pdfViewerBase.textLayer.getPageIndex(selection.anchorNode);\n        var startIndex = 0;\n        var endIndex = 0;\n        if (!isNaN(pageId)) {\n          var pageRect = this.pdfViewerBase.getElement('_pageDiv_' + pageId).getBoundingClientRect();\n          if (this.pdfViewerBase.isMixedSizeDocument) {\n            pageRect = this.pdfViewerBase.getElement('_textLayer_' + pageId).getBoundingClientRect();\n          }\n          if (isBackWardSelection) {\n            range.setStart(selection.focusNode, selection.focusOffset);\n            range.setEnd(selection.anchorNode, selection.anchorOffset);\n          } else {\n            if (selection.anchorOffset < selection.focusOffset) {\n              startIndex = selection.anchorOffset;\n              endIndex = selection.focusOffset;\n              range.setStart(selection.anchorNode, selection.anchorOffset);\n              range.setEnd(selection.focusNode, selection.focusOffset);\n            } else {\n              startIndex = selection.focusOffset;\n              endIndex = selection.anchorOffset;\n              range.setStart(selection.focusNode, selection.focusOffset);\n              range.setEnd(selection.anchorNode, selection.anchorOffset);\n            }\n          }\n          var boundingRect = range.getBoundingClientRect();\n          var annotationRotate = 0;\n          if (this.pdfViewerBase.clientSideRendering) {\n            var pageDetails = this.pdfViewerBase.pageSize[pageId];\n            var pageRotation = this.getAngle(pageDetails.rotation);\n            var textElement = void 0;\n            if (range.startContainer.parentElement) {\n              textElement = range.startContainer.parentElement;\n            } else {\n              textElement = range.startContainer.parentNode;\n            }\n            if (textElement && textElement.style.transform !== '') {\n              if (textElement.style.transform.startsWith('rotate(90deg)')) {\n                annotationRotate = 90;\n              } else if (textElement.style.transform.startsWith('rotate(180deg)')) {\n                annotationRotate = 180;\n              } else if (textElement.style.transform.startsWith('rotate(-90deg)') || textElement.style.transform.startsWith('rotate(270deg)')) {\n                annotationRotate = 270;\n              } else {\n                annotationRotate = 0;\n              }\n            }\n          }\n          // eslint-disable-next-line\n          var indexes = this.getIndexNumbers(pageId, range.toString(), range.commonAncestorContainer.textContent.toString());\n          // eslint-disable-next-line max-len\n          var rectangle = {\n            left: this.getDefaultValue(boundingRect.left - pageRect.left),\n            top: this.getDefaultValue(boundingRect.top - pageRect.top),\n            width: this.getDefaultValue(boundingRect.width),\n            height: this.getDefaultValue(boundingRect.height),\n            right: this.getDefaultValue(boundingRect.right - pageRect.left),\n            bottom: this.getDefaultValue(boundingRect.bottom - pageRect.top),\n            rotation: annotationRotate\n          };\n          var rectangleArray = [];\n          rectangleArray.push(rectangle);\n          // eslint-disable-next-line\n          var rect = {\n            left: rectangle.left,\n            top: rectangle.top,\n            right: rectangle.right,\n            bottom: rectangle.bottom,\n            rotation: annotationRotate\n          };\n          pageBounds.push({\n            pageIndex: pageId,\n            bounds: rectangleArray,\n            rect: rect,\n            startIndex: indexes.startIndex,\n            endIndex: indexes.endIndex,\n            textContent: range.toString()\n          });\n        }\n      } else {\n        var startNode = void 0;\n        var endNode = void 0;\n        var selectionStartOffset = void 0;\n        var selectionEndOffset = void 0;\n        if (isBackWardSelection) {\n          startNode = selection.focusNode;\n          selectionStartOffset = selection.focusOffset;\n          endNode = selection.anchorNode;\n          selectionEndOffset = selection.anchorOffset;\n        } else {\n          startNode = selection.anchorNode;\n          selectionStartOffset = selection.anchorOffset;\n          endNode = selection.focusNode;\n          selectionEndOffset = selection.focusOffset;\n        }\n        var anchorPageId = this.pdfViewerBase.textLayer.getPageIndex(startNode);\n        var anchorTextId = this.pdfViewerBase.textLayer.getTextIndex(startNode, anchorPageId);\n        var focusPageId = this.pdfViewerBase.textLayer.getPageIndex(endNode);\n        var focusTextId = this.pdfViewerBase.textLayer.getTextIndex(endNode, focusPageId);\n        var startOffset = 0;\n        var endOffset = 0;\n        var currentId = 0;\n        for (var i = anchorPageId; i <= focusPageId; i++) {\n          var selectionRects = [];\n          var pageStartId = void 0;\n          var pageEndId = void 0;\n          var pageStartOffset = void 0;\n          var pageEndOffset = void 0;\n          var textDivs = this.pdfViewerBase.getElement('_textLayer_' + i).childNodes;\n          var pageRect = this.pdfViewerBase.getElement('_pageDiv_' + i).getBoundingClientRect();\n          if (this.pdfViewerBase.isMixedSizeDocument) {\n            pageRect = this.pdfViewerBase.getElement('_textLayer_' + i).getBoundingClientRect();\n          }\n          if (i === anchorPageId) {\n            currentId = anchorTextId;\n          } else {\n            currentId = 0;\n          }\n          for (var j = currentId; j < textDivs.length; j++) {\n            var textElement = textDivs[j];\n            if (j === currentId) {\n              pageStartId = currentId;\n              pageStartOffset = i === anchorPageId ? selectionStartOffset : 0;\n            } else {\n              pageEndId = j;\n              pageEndOffset = i === focusPageId ? selectionEndOffset : textElement.textContent.length;\n            }\n            if (j === anchorTextId && i === anchorPageId) {\n              startOffset = selectionStartOffset;\n            } else {\n              startOffset = 0;\n            }\n            if (j === focusTextId && i === focusPageId) {\n              endOffset = selectionEndOffset;\n            } else {\n              endOffset = textElement.textContent.length;\n            }\n            for (var k = 0; k < textElement.childNodes.length; k++) {\n              var node = textElement.childNodes[k];\n              range.setStart(node, startOffset);\n              range.setEnd(node, endOffset);\n            }\n            var boundingRect = range.getBoundingClientRect();\n            var annotationRotate = 0;\n            if (this.pdfViewerBase.clientSideRendering) {\n              var pageDetails = this.pdfViewerBase.pageSize[i];\n              var pageRotation = this.getAngle(pageDetails.rotation);\n              if (textElement && textElement.style.transform !== '') {\n                if (textElement.style.transform.startsWith('rotate(90deg)')) {\n                  annotationRotate = 90;\n                } else if (textElement.style.transform.startsWith('rotate(180deg)')) {\n                  annotationRotate = 180;\n                } else if (textElement.style.transform.startsWith('rotate(-90deg)') || textElement.style.transform.startsWith('rotate(270deg)')) {\n                  annotationRotate = 270;\n                } else {\n                  annotationRotate = 0;\n                }\n              }\n            }\n            // eslint-disable-next-line max-len\n            var rectangle = {\n              left: this.getDefaultValue(boundingRect.left - pageRect.left),\n              top: this.getDefaultValue(boundingRect.top - pageRect.top),\n              width: this.getDefaultValue(boundingRect.width),\n              height: this.getDefaultValue(boundingRect.height),\n              right: this.getDefaultValue(boundingRect.right - pageRect.left),\n              bottom: this.getDefaultValue(boundingRect.bottom - pageRect.top),\n              rotation: annotationRotate\n            };\n            selectionRects.push(rectangle);\n            range.detach();\n            if (i === focusPageId && j === focusTextId) {\n              break;\n            }\n          }\n          if (!pageEndId) {\n            pageEndId = pageStartId;\n          }\n          if (!pageEndOffset) {\n            pageEndOffset = endOffset;\n          }\n          var startElementNode = this.pdfViewerBase.getElement('_text_' + i + '_' + pageStartId).childNodes[0];\n          var endElementNode = this.pdfViewerBase.getElement('_text_' + i + '_' + pageEndId).childNodes[0];\n          var pageRange = document.createRange();\n          pageRange.setStart(startElementNode, pageStartOffset);\n          pageRange.setEnd(endElementNode, pageEndOffset);\n          var pageRectBounds = pageRange.getBoundingClientRect();\n          var textValue = pageRange.toString();\n          // eslint-disable-next-line\n          var indexes = this.getIndexNumbers(i, textValue);\n          // eslint-disable-next-line max-len\n          var pageRectangle = {\n            left: this.getDefaultValue(pageRectBounds.left - pageRect.left),\n            top: this.getDefaultValue(pageRectBounds.top - pageRect.top),\n            width: this.getDefaultValue(pageRectBounds.width),\n            height: this.getDefaultValue(pageRectBounds.height),\n            right: this.getDefaultValue(pageRectBounds.right - pageRect.left),\n            bottom: this.getDefaultValue(pageRectBounds.bottom - pageRect.top)\n          };\n          // eslint-disable-next-line\n          var rect = {\n            left: pageRectangle.left,\n            top: pageRectangle.top,\n            right: pageRectangle.right,\n            bottom: pageRectangle.bottom\n          };\n          pageBounds.push({\n            pageIndex: i,\n            bounds: selectionRects,\n            rect: rect,\n            startIndex: indexes.startIndex,\n            endIndex: indexes.endIndex,\n            textContent: textValue\n          });\n        }\n      }\n    }\n    selection.removeAllRanges();\n    return pageBounds;\n  };\n  // eslint-disable-next-line\n  TextMarkupAnnotation.prototype.getIndexNumbers = function (pageNumber, content, parentText) {\n    // eslint-disable-next-line\n    var storedData = this.pdfViewerBase.clientSideRendering ? this.pdfViewerBase.getLinkInformation(pageNumber) : this.pdfViewerBase.getStoredData(pageNumber);\n    var startIndex;\n    var endIndex;\n    if (storedData) {\n      var previousIndex = 0;\n      var pageText = storedData.pageText;\n      for (var p = 0; p < pageNumber; p++) {\n        if (this.pdfViewer.isExtractText) {\n          // eslint-disable-next-line\n          var documentIndex = this.pdfViewer.textSearchModule.documentTextCollection[p][p];\n          var pageTextData = documentIndex.pageText ? documentIndex.pageText : documentIndex.PageText;\n          // eslint-disable-next-line max-len\n          if (this.pdfViewer.textSearchModule && this.pdfViewer.textSearchModule.documentTextCollection && this.pdfViewer.textSearchModule.isTextRetrieved) {\n            if (this.pdfViewer.textSearchModule.documentTextCollection[p]) {\n              previousIndex = previousIndex + pageTextData.length;\n            }\n          } else {\n            // eslint-disable-next-line max-len\n            if (this.pdfViewer.textSearchModule && this.pdfViewer.textSearchModule.documentTextCollection) {\n              if (pageNumber <= this.pdfViewer.textSearchModule.documentTextCollection.length) {\n                if (this.pdfViewer.textSearchModule.documentTextCollection[p]) {\n                  // eslint-disable-next-line max-len\n                  previousIndex = previousIndex + pageTextData.length;\n                }\n              } else {\n                previousIndex = 0;\n                break;\n              }\n            }\n          }\n        }\n      }\n      if (!isNullOrUndefined(parentText)) {\n        var parentIndex = pageText.indexOf(parentText);\n        var initialIndex = parentText.indexOf(content);\n        startIndex = parentIndex + initialIndex + previousIndex;\n      } else {\n        startIndex = pageText.indexOf(content) + previousIndex;\n      }\n      endIndex = startIndex + (content.length - 1);\n    }\n    return {\n      startIndex: startIndex,\n      endIndex: endIndex\n    };\n  };\n  /**\n   * @param pageNumber\n   * @private\n   */\n  TextMarkupAnnotation.prototype.rerenderAnnotationsPinch = function (pageNumber) {\n    var annotCanvas = this.pdfViewerBase.getElement('_annotationCanvas_' + pageNumber);\n    if (annotCanvas) {\n      var oldAnnotCanvas = this.pdfViewerBase.getElement('_old_annotationCanvas_' + pageNumber);\n      if (oldAnnotCanvas) {\n        if (annotCanvas) {\n          oldAnnotCanvas.id = annotCanvas.id;\n          annotCanvas.parentElement.removeChild(annotCanvas);\n        } else {\n          oldAnnotCanvas.id = this.pdfViewer.element.id + '_annotationCanvas_' + pageNumber;\n        }\n        annotCanvas = oldAnnotCanvas;\n      }\n      annotCanvas.style.width = '';\n      annotCanvas.style.height = '';\n      if (this.pdfViewer.restrictZoomRequest) {\n        // eslint-disable-next-line max-len\n        annotCanvas.style.width = this.pdfViewerBase.pageSize[pageNumber].width * this.pdfViewerBase.getZoomFactor() + 'px';\n        // eslint-disable-next-line max-len\n        annotCanvas.style.height = this.pdfViewerBase.pageSize[pageNumber].height * this.pdfViewerBase.getZoomFactor() + 'px';\n      } else {\n        // eslint-disable-next-line max-len\n        annotCanvas.width = this.pdfViewerBase.pageSize[pageNumber].width * this.pdfViewerBase.getZoomFactor();\n        annotCanvas.height = this.pdfViewerBase.pageSize[pageNumber].height * this.pdfViewerBase.getZoomFactor();\n      }\n      this.renderTextMarkupAnnotations(null, pageNumber, annotCanvas, this.pdfViewerBase.getZoomFactor());\n    }\n  };\n  /**\n   * @param pageNumber\n   * @private\n   */\n  TextMarkupAnnotation.prototype.rerenderAnnotations = function (pageNumber) {\n    // eslint-disable-next-line\n    var oldCanvasCollection = document.querySelectorAll('#' + this.pdfViewer.element.id + '_old_annotationCanvas_' + pageNumber);\n    for (var i = 0; i < oldCanvasCollection.length; i++) {\n      if (oldCanvasCollection[i]) {\n        oldCanvasCollection[i].parentElement.removeChild(oldCanvasCollection[i]);\n      }\n    }\n    var newCanvas = this.pdfViewerBase.getElement('_annotationCanvas_' + pageNumber);\n    if (newCanvas) {\n      newCanvas.style.display = 'block';\n    }\n  };\n  /**\n   * @param event\n   * @private\n   */\n  TextMarkupAnnotation.prototype.onTextMarkupAnnotationMouseUp = function (event) {\n    var pageNumber = this.pdfViewer.annotationModule.getEventPageNumber(event);\n    if (!isNullOrUndefined(pageNumber) && !isNaN(pageNumber)) {\n      var canvas = this.pdfViewerBase.getElement('_annotationCanvas_' + pageNumber);\n      if (this.currentTextMarkupAnnotation) {\n        this.selectedTextMarkup = this.currentTextMarkupAnnotation;\n      } else {\n        this.selectedTextMarkup = null;\n      }\n      this.clearCurrentSelectedAnnotation();\n      var currentAnnot = this.getCurrentMarkupAnnotation(event.clientX, event.clientY, pageNumber, canvas);\n      if (currentAnnot && !window.getSelection().toString()) {\n        var isLock = false;\n        var isSelection = false;\n        if (currentAnnot.annotationSettings && currentAnnot.annotationSettings.isLock) {\n          isLock = currentAnnot.annotationSettings.isLock;\n          if (isLock && this.pdfViewer.annotationModule.checkAllowedInteractions('Select', currentAnnot)) {\n            isLock = false;\n            if (this.pdfViewer.annotationModule.checkAllowedInteractions('PropertyChange', currentAnnot)) {\n              isSelection = false;\n            } else {\n              isSelection = true;\n            }\n          }\n        }\n        if (!isLock) {\n          var canvasParentPosition = canvas.parentElement.getBoundingClientRect();\n          var leftClickPosition = event.clientX - canvasParentPosition.left;\n          var topClickPosition = event.clientY - canvasParentPosition.top;\n          this.annotationClickPosition = {\n            x: leftClickPosition,\n            y: topClickPosition\n          };\n          this.selectAnnotation(currentAnnot, canvas, pageNumber, event);\n          if (Browser.isDevice && !this.pdfViewer.enableDesktopMode && this.pdfViewer.enableToolbar && this.pdfViewer.enableAnnotationToolbar) {\n            this.pdfViewer.toolbarModule.annotationToolbarModule.createPropertyTools(this.currentTextMarkupAnnotation.textMarkupAnnotationType);\n          }\n          this.currentTextMarkupAnnotation = currentAnnot;\n          this.selectTextMarkupCurrentPage = pageNumber;\n          if (!isSelection) {\n            this.enableAnnotationPropertiesTool(true);\n          }\n          var commentPanelDiv = document.getElementById(this.pdfViewer.element.id + '_commantPanel');\n          if (commentPanelDiv && commentPanelDiv.style.display === 'block') {\n            // eslint-disable-next-line\n            var accordionExpand = document.getElementById(this.pdfViewer.element.id + '_accordionContainer' + (pageNumber + 1));\n            if (accordionExpand) {\n              accordionExpand.ej2_instances[0].expandItem(true);\n            }\n            // eslint-disable-next-line\n            var comments = document.getElementById(currentAnnot.annotName);\n            if (comments) {\n              comments.firstChild.click();\n            }\n          }\n          if (!isBlazor()) {\n            if (this.pdfViewer.toolbarModule && this.pdfViewer.enableAnnotationToolbar) {\n              this.pdfViewer.toolbarModule.annotationToolbarModule.isToolbarHidden = true;\n              // eslint-disable-next-line max-len\n              this.pdfViewer.toolbarModule.annotationToolbarModule.showAnnotationToolbar(this.pdfViewer.toolbarModule.annotationItem);\n            }\n          }\n        }\n      } else {\n        this.clearCurrentAnnotation();\n      }\n      if (this.pdfViewer.isMaintainSelection && !this.pdfViewer.textSelectionModule.isTextSelection) {\n        if (currentAnnot) {\n          this.clearCurrentAnnotationSelection(pageNumber);\n        }\n      } else {\n        this.clearCurrentAnnotationSelection(pageNumber);\n      }\n    } else {\n      if (!this.pdfViewerBase.isClickedOnScrollBar(event, true)) {\n        this.clearCurrentAnnotation();\n        this.clearCurrentAnnotationSelection(pageNumber);\n      }\n    }\n  };\n  /**\n   * @param event\n   * @private\n   */\n  TextMarkupAnnotation.prototype.onTextMarkupAnnotationTouchEnd = function (event) {\n    var pageNumber = this.pdfViewer.annotationModule.getEventPageNumber(event);\n    if (!isNullOrUndefined(pageNumber) && !isNaN(pageNumber)) {\n      if (this.currentTextMarkupAnnotation) {\n        this.selectedTextMarkup = this.currentTextMarkupAnnotation;\n      } else {\n        this.selectedTextMarkup = null;\n      }\n      this.clearCurrentAnnotationSelection(pageNumber);\n      var touchCanvas = this.pdfViewerBase.getElement('_annotationCanvas_' + pageNumber);\n      this.clearCurrentSelectedAnnotation();\n      // eslint-disable-next-line max-len\n      var currentAnnot = this.getCurrentMarkupAnnotation(event.touches[0].clientX, event.touches[0].clientY, pageNumber, touchCanvas);\n      if (currentAnnot) {\n        var isLock = false;\n        if (currentAnnot.annotationSettings && currentAnnot.annotationSettings.isLock) {\n          isLock = currentAnnot.annotationSettings.isLock;\n        }\n        if (!isLock) {\n          var canvasParentPosition = touchCanvas.parentElement.getBoundingClientRect();\n          var leftClickPosition = event.touches[0].clientX - canvasParentPosition.left;\n          var topClickPosition = event.touches[0].clientY - canvasParentPosition.top;\n          this.annotationClickPosition = {\n            x: leftClickPosition,\n            y: topClickPosition\n          };\n          this.selectAnnotation(currentAnnot, touchCanvas, pageNumber, event);\n          if (Browser.isDevice && !this.pdfViewer.enableDesktopMode && this.pdfViewer.enableToolbar && this.pdfViewer.enableAnnotationToolbar) {\n            this.pdfViewer.toolbarModule.annotationToolbarModule.createPropertyTools(this.currentTextMarkupAnnotation.textMarkupAnnotationType);\n          }\n          this.currentTextMarkupAnnotation = currentAnnot;\n          this.selectTextMarkupCurrentPage = pageNumber;\n          this.enableAnnotationPropertiesTool(true);\n          // eslint-disable-next-line\n          var accordionExpand = document.getElementById(this.pdfViewer.element.id + '_accordionContainer' + (pageNumber + 1));\n          if (accordionExpand) {\n            accordionExpand.ej2_instances[0].expandItem(true);\n          }\n          // eslint-disable-next-line\n          var comments = document.getElementById(currentAnnot.annotName);\n          if (comments) {\n            if (!Browser.isDevice) {\n              comments.firstChild.click();\n            }\n          }\n        }\n      } else {\n        this.clearCurrentAnnotation();\n      }\n      this.clearCurrentAnnotationSelection(pageNumber);\n    } else if (this.selectTextMarkupCurrentPage != null && Browser.isDevice && !this.pdfViewer.enableDesktopMode) {\n      var number = this.selectTextMarkupCurrentPage;\n      this.selectTextMarkupCurrentPage = null;\n      this.clearAnnotationSelection(number);\n    } else {\n      this.clearCurrentAnnotation();\n      this.clearCurrentAnnotationSelection(pageNumber);\n    }\n  };\n  /**\n   * @private\n   */\n  TextMarkupAnnotation.prototype.clearCurrentSelectedAnnotation = function () {\n    if (this.currentTextMarkupAnnotation) {\n      this.clearAnnotationSelection(this.selectTextMarkupCurrentPage);\n      // eslint-disable-next-line\n      var currentAnnot = this.currentTextMarkupAnnotation;\n      this.pdfViewer.fireAnnotationUnSelect(currentAnnot.annotName, currentAnnot.pageNumber, currentAnnot);\n      this.clearCurrentAnnotation();\n    }\n  };\n  /**\n   * @param event\n   * @private\n   */\n  TextMarkupAnnotation.prototype.onTextMarkupAnnotationMouseMove = function (event) {\n    var eventTarget = event.target;\n    // eslint-disable-next-line\n    var pageIndex = parseInt(eventTarget.id.split('_text_')[1]) || parseInt(eventTarget.id.split('_textLayer_')[1]) || parseInt(eventTarget.id.split('_annotationCanvas_')[1]);\n    if (event.target && (eventTarget.id.indexOf('_text') > -1 || eventTarget.id.indexOf('_annotationCanvas') > -1 || eventTarget.classList.contains('e-pv-hyperlink')) && this.pdfViewer.annotation) {\n      pageIndex = this.pdfViewer.annotation.getEventPageNumber(event);\n      var canvas = this.pdfViewerBase.getElement('_annotationCanvas_' + pageIndex);\n      var currentAnnot = this.getCurrentMarkupAnnotation(event.clientX, event.clientY, pageIndex, canvas);\n      if (currentAnnot) {\n        eventTarget.style.cursor = 'pointer';\n        // eslint-disable-next-line\n        var currentPosition = this.pdfViewerBase.getMousePosition(event);\n        // eslint-disable-next-line\n        var relativePosition = this.pdfViewerBase.relativePosition(event);\n        // eslint-disable-next-line\n        var viewerPositions = {\n          left: relativePosition.x,\n          top: relativePosition.y\n        };\n        // eslint-disable-next-line\n        var mousePositions = {\n          left: currentPosition.x,\n          top: currentPosition.y\n        };\n        // eslint-disable-next-line\n        var annotationSettings = {\n          opacity: currentAnnot.opacity,\n          color: currentAnnot.color,\n          author: currentAnnot.author,\n          subject: currentAnnot.subject,\n          modifiedDate: currentAnnot.modifiedDate\n        };\n        // eslint-disable-next-line max-len\n        this.pdfViewerBase.isMousedOver = true;\n        this.pdfViewer.fireAnnotationMouseover(currentAnnot.annotName, currentAnnot.pageNumber, currentAnnot.textMarkupAnnotationType, currentAnnot.bounds, annotationSettings, mousePositions, viewerPositions);\n        // this.showPopupNote(event, currentAnnot);\n      } else {\n        this.pdfViewer.annotationModule.hidePopupNote();\n        if (this.pdfViewerBase.isPanMode && !this.pdfViewerBase.getAnnotationToolStatus()) {\n          eventTarget.style.cursor = 'grab';\n        }\n        if (this.pdfViewerBase.isMousedOver && !this.pdfViewerBase.isFormFieldMousedOver) {\n          this.pdfViewer.fireAnnotationMouseLeave(pageIndex);\n          this.pdfViewerBase.isMousedOver = false;\n        }\n      }\n    }\n  };\n  // eslint-disable-next-line\n  TextMarkupAnnotation.prototype.showPopupNote = function (event, annotation) {\n    if (annotation.note) {\n      // eslint-disable-next-line max-len\n      this.pdfViewer.annotationModule.showPopupNote(event, annotation.color, annotation.author, annotation.note, annotation.textMarkupAnnotationType);\n    }\n  };\n  TextMarkupAnnotation.prototype.getCurrentMarkupAnnotation = function (clientX, clientY, pageNumber, canvas) {\n    var currentTextMarkupAnnotations = [];\n    if (canvas) {\n      var canvasParentPosition = canvas.parentElement.getBoundingClientRect();\n      if (canvas.clientWidth !== canvas.parentElement.clientWidth) {\n        canvasParentPosition = canvas.getBoundingClientRect();\n      }\n      var leftClickPosition = clientX - canvasParentPosition.left;\n      var topClickPosition = clientY - canvasParentPosition.top;\n      var annotationList = this.getAnnotations(pageNumber, null);\n      var isAnnotationGot = false;\n      if (annotationList) {\n        for (var i = 0; i < annotationList.length; i++) {\n          var annotation = annotationList[i];\n          for (var j = 0; j < annotation.bounds.length; j++) {\n            // eslint-disable-next-line\n            var bound = annotation.bounds[j];\n            var left = bound.left ? bound.left : bound.Left;\n            var top_2 = bound.top ? bound.top : bound.Top;\n            var width = bound.width ? bound.width : bound.Width;\n            var height = bound.height ? bound.height : bound.Height;\n            // eslint-disable-next-line max-len\n            if (leftClickPosition >= this.getMagnifiedValue(left, this.pdfViewerBase.getZoomFactor()) && leftClickPosition <= this.getMagnifiedValue(left + width, this.pdfViewerBase.getZoomFactor()) && topClickPosition >= this.getMagnifiedValue(top_2, this.pdfViewerBase.getZoomFactor()) && topClickPosition <= this.getMagnifiedValue(top_2 + height, this.pdfViewerBase.getZoomFactor())) {\n              currentTextMarkupAnnotations.push(annotation);\n              isAnnotationGot = true;\n            } else {\n              if (isAnnotationGot) {\n                isAnnotationGot = false;\n                break;\n              }\n            }\n          }\n        }\n      }\n      var currentAnnot = null;\n      if (currentTextMarkupAnnotations.length > 1) {\n        currentAnnot = this.compareCurrentAnnotations(currentTextMarkupAnnotations);\n      } else if (currentTextMarkupAnnotations.length === 1) {\n        currentAnnot = currentTextMarkupAnnotations[0];\n      }\n      return currentAnnot;\n    } else {\n      return null;\n    }\n  };\n  TextMarkupAnnotation.prototype.compareCurrentAnnotations = function (annotations) {\n    var previousX;\n    var currentAnnotation = null;\n    for (var i = 0; i < annotations.length; i++) {\n      if (i === annotations.length - 1) {\n        break;\n      }\n      // eslint-disable-next-line\n      var firstAnnotBounds = annotations[i].bounds;\n      var firstXposition = firstAnnotBounds[0].left ? firstAnnotBounds[0].left : firstAnnotBounds[0].Left;\n      var firstYposition = firstAnnotBounds[0].top ? firstAnnotBounds[0].top : firstAnnotBounds[0].Top;\n      // eslint-disable-next-line\n      var secondAnnotBounds = annotations[i + 1].bounds;\n      var secondXposition = secondAnnotBounds[0].left ? secondAnnotBounds[0].left : secondAnnotBounds[0].Left;\n      var secondYposition = secondAnnotBounds[0].top ? secondAnnotBounds[0].top : secondAnnotBounds[0].Top;\n      if (firstXposition < secondXposition || firstYposition < secondYposition) {\n        previousX = secondXposition;\n        currentAnnotation = annotations[i + 1];\n      } else {\n        previousX = firstXposition;\n        currentAnnotation = annotations[i];\n      }\n      if (previousX && i === annotations.length - 2) {\n        if (previousX === firstXposition && previousX === secondXposition) {\n          previousX = secondXposition;\n          currentAnnotation = annotations[i + 1];\n        }\n      }\n    }\n    return currentAnnotation;\n  };\n  /**\n   * @param pageNumber\n   * @private\n   */\n  TextMarkupAnnotation.prototype.clearAnnotationSelection = function (pageNumber) {\n    var canvas = this.pdfViewerBase.getElement('_annotationCanvas_' + pageNumber);\n    if (canvas) {\n      var context = canvas.getContext('2d');\n      context.setLineDash([]);\n      this.pdfViewer.annotationModule.renderAnnotations(pageNumber, null, null, null);\n    }\n  };\n  /**\n   * @param annotation\n   * @param canvas\n   * @param pageNumber\n   * @param event\n   * @param isProgrammaticSelection\n   * @param annotation\n   * @param canvas\n   * @param pageNumber\n   * @param event\n   * @param isProgrammaticSelection\n   * @private\n   */\n  // eslint-disable-next-line max-len\n  TextMarkupAnnotation.prototype.selectAnnotation = function (annotation, canvas, pageNumber, event, isProgrammaticSelection) {\n    if (this.pdfViewer.selectedItems.annotations[0]) {\n      this.pdfViewer.clearSelection(this.pdfViewer.selectedItems.annotations[0].pageIndex);\n      this.pdfViewer.clearSelection(this.selectTextMarkupCurrentPage);\n    }\n    var isLock = false;\n    if (annotation.annotationSettings && annotation.annotationSettings.isLock) {\n      isLock = annotation.annotationSettings.isLock;\n      if (isLock && this.pdfViewer.annotationModule.checkAllowedInteractions('Select', annotation)) {\n        isLock = false;\n      }\n    }\n    if (!isLock) {\n      var isCurrentTextMarkup = false;\n      if (!this.currentTextMarkupAnnotation) {\n        isCurrentTextMarkup = true;\n      }\n      if (this.selectedTextMarkup && annotation && !isProgrammaticSelection) {\n        if (this.selectedTextMarkup.annotName === annotation.annotName) {\n          isCurrentTextMarkup = false;\n        } else {\n          isCurrentTextMarkup = true;\n        }\n      }\n      if (!isNaN(pageNumber)) {\n        this.selectTextMarkupCurrentPage = pageNumber;\n        this.currentTextMarkupAnnotation = annotation;\n        annotation = this.retreiveTextIndex(annotation);\n        this.currentTextMarkupAnnotation = annotation;\n      }\n      if (this.isSelectedAnnotation && this.pdfViewer.textSelectionModule) {\n        this.pdfViewerBase.isSelection = true;\n        this.updateAnnotationBounds();\n      }\n      // eslint-disable-next-line\n      var currentEvent = event;\n      if (this.isEnableTextMarkupResizer(annotation.textMarkupAnnotationType) && annotation && currentEvent && !currentEvent.touches) {\n        this.updateCurrentResizerPosition(annotation);\n      }\n      this.drawAnnotationSelector(annotation, this.currentTextMarkupAnnotation, canvas);\n      if (annotation.isMultiSelect && annotation.annotNameCollection) {\n        this.selectMultiPageAnnotations(annotation);\n      }\n      if (annotation.annotName !== '' && !this.isNewAnnotation) {\n        if (isCurrentTextMarkup) {\n          var isSelected = false;\n          if (!currentEvent) {\n            isSelected = true;\n          }\n          // eslint-disable-next-line max-len\n          this.pdfViewer.annotationModule.annotationSelect(annotation.annotName, this.selectTextMarkupCurrentPage, annotation, null, false, isSelected);\n          this.selectedTextMarkup = null;\n        }\n      }\n      if (annotation && this.isEnableTextMarkupResizer(annotation.textMarkupAnnotationType)) {\n        this.isTextMarkupAnnotationMode = true;\n      }\n    }\n  };\n  /**\n   * @param annotation\n   * @private\n   */\n  // eslint-disable-next-line\n  TextMarkupAnnotation.prototype.updateCurrentResizerPosition = function (annotation) {\n    if (!annotation) {\n      annotation = this.currentTextMarkupAnnotation;\n    }\n    if (annotation) {\n      if (this.isEnableTextMarkupResizer(annotation.textMarkupAnnotationType) && annotation) {\n        // eslint-disable-next-line\n        var textElement = this.pdfViewerBase.getElement('_textLayer_' + this.selectTextMarkupCurrentPage);\n        if (textElement) {\n          // eslint-disable-next-line\n          var boundingRect = textElement.getBoundingClientRect();\n          var left = annotation.bounds[0].left ? annotation.bounds[0].left : annotation.bounds[0].Left;\n          var top_3 = annotation.bounds[0].top ? annotation.bounds[0].top : annotation.bounds[0].Top;\n          this.updateLeftposition(left * this.pdfViewerBase.getZoomFactor() + boundingRect.left, boundingRect.top + top_3, true);\n          // eslint-disable-next-line\n          var endPosition = annotation.bounds[annotation.bounds.length - 1];\n          var endLeft = endPosition.left ? endPosition.left : endPosition.Left;\n          var endTop = endPosition.top ? endPosition.top : endPosition.Top;\n          var endWidth = endPosition.width ? endPosition.width : endPosition.Width;\n          // eslint-disable-next-line max-len\n          this.updatePosition((endLeft + endWidth) * this.pdfViewerBase.getZoomFactor() + boundingRect.left, endTop + boundingRect.top, true);\n        }\n      }\n    }\n  };\n  // eslint-disable-next-line\n  TextMarkupAnnotation.prototype.drawAnnotationSelectRect = function (canvas, x, y, width, height, annotation) {\n    var ratio = this.pdfViewerBase.getZoomRatio();\n    if (canvas) {\n      var context = canvas.getContext('2d');\n      context.setTransform(1, 0, 0, 1, 0, 0);\n      context.beginPath();\n      if (typeof annotation.annotationSelectorSettings === 'string') {\n        // eslint-disable-next-line max-len\n        var lineDash = JSON.parse(annotation.annotationSelectorSettings).selectorLineDashArray.length === 0 ? [4] : JSON.parse(annotation.annotationSelectorSettings).selectorLineDashArray;\n        if (lineDash.length > 2) {\n          lineDash = [lineDash[0], lineDash[1]];\n        }\n        context.setLineDash(lineDash);\n        context.globalAlpha = 1;\n        context.rect(x * ratio, y * ratio, width * ratio, height * ratio);\n        context.closePath();\n        // eslint-disable-next-line max-len\n        var borderColor = JSON.parse(annotation.annotationSelectorSettings).selectionBorderColor === '' ? '#0000ff' : JSON.parse(annotation.annotationSelectorSettings).selectionBorderColor;\n        context.strokeStyle = borderColor;\n        // eslint-disable-next-line max-len\n        context.lineWidth = JSON.parse(annotation.annotationSelectorSettings).selectionBorderThickness === 1 ? 1 : annotation.annotationSelectorSettings.selectionBorderThickness;\n        context.stroke();\n        context.save();\n      } else {\n        // eslint-disable-next-line max-len\n        var lineDash = annotation.annotationSelectorSettings.selectorLineDashArray.length === 0 ? [4] : annotation.annotationSelectorSettings.selectorLineDashArray;\n        if (lineDash.length > 2) {\n          lineDash = [lineDash[0], lineDash[1]];\n        }\n        context.setLineDash(lineDash);\n        context.globalAlpha = 1;\n        context.rect(x * ratio, y * ratio, width * ratio, height * ratio);\n        context.closePath();\n        // eslint-disable-next-line max-len\n        var borderColor = annotation.annotationSelectorSettings.selectionBorderColor === '' ? '#0000ff' : annotation.annotationSelectorSettings.selectionBorderColor;\n        context.strokeStyle = borderColor;\n        // eslint-disable-next-line max-len\n        context.lineWidth = annotation.annotationSelectorSettings.selectionBorderThickness ? 1 : annotation.annotationSelectorSettings.selectionBorderThickness;\n        context.stroke();\n        context.save();\n      }\n    }\n  };\n  /**\n   * @param isEnable\n   * @private\n   */\n  TextMarkupAnnotation.prototype.enableAnnotationPropertiesTool = function (isEnable) {\n    if (this.pdfViewer.toolbarModule && this.pdfViewer.toolbarModule.annotationToolbarModule) {\n      // eslint-disable-next-line max-len\n      this.pdfViewer.toolbarModule.annotationToolbarModule.colorDropDownElementInBlazor = this.pdfViewer.element.querySelector('.e-pv-annotation-color-container');\n    }\n    // eslint-disable-next-line max-len\n    if (this.pdfViewer.toolbarModule && this.pdfViewer.toolbarModule.annotationToolbarModule) {\n      if (!Browser.isDevice) {\n        this.pdfViewer.toolbarModule.annotationToolbarModule.createMobileAnnotationToolbar(isEnable);\n      }\n    }\n    // eslint-disable-next-line max-len\n    if (this.pdfViewer.toolbarModule && this.pdfViewer.toolbarModule.annotationToolbarModule && this.pdfViewer.toolbarModule.annotationToolbarModule.isMobileAnnotEnabled && this.pdfViewer.selectedItems.annotations.length === 0) {\n      if (this.pdfViewer.toolbarModule.annotationToolbarModule) {\n        this.pdfViewer.toolbarModule.annotationToolbarModule.selectAnnotationDeleteItem(isEnable);\n        var enable = isEnable;\n        if (this.isTextMarkupAnnotationMode) {\n          enable = true;\n        }\n        this.pdfViewer.toolbarModule.annotationToolbarModule.enableTextMarkupAnnotationPropertiesTools(enable);\n        if (this.currentTextMarkupAnnotation) {\n          if (!isBlazor()) {\n            // eslint-disable-next-line max-len\n            this.pdfViewer.toolbarModule.annotationToolbarModule.updateColorInIcon(this.pdfViewer.toolbarModule.annotationToolbarModule.colorDropDownElement, this.currentTextMarkupAnnotation.color);\n          } else {\n            // eslint-disable-next-line max-len\n            this.pdfViewer.toolbarModule.annotationToolbarModule.updateColorInIcon(this.pdfViewer.toolbarModule.annotationToolbarModule.colorDropDownElementInBlazor, this.currentTextMarkupAnnotation.color);\n          }\n        } else {\n          if (!isNullOrUndefined(this.isTextMarkupAnnotationMode) && !this.isTextMarkupAnnotationMode) {\n            if (!isBlazor()) {\n              // eslint-disable-next-line max-len\n              this.pdfViewer.toolbarModule.annotationToolbarModule.updateColorInIcon(this.pdfViewer.toolbarModule.annotationToolbarModule.colorDropDownElement, '#000000');\n            } else {\n              // eslint-disable-next-line max-len\n              this.pdfViewer.toolbarModule.annotationToolbarModule.updateColorInIcon(this.pdfViewer.toolbarModule.annotationToolbarModule.colorDropDownElementInBlazor, '#000000');\n            }\n          } else {\n            this.pdfViewer.toolbarModule.annotationToolbarModule.setCurrentColorInPicker();\n          }\n        }\n      }\n    }\n  };\n  /**\n   * @private\n   */\n  TextMarkupAnnotation.prototype.maintainAnnotationSelection = function () {\n    if (this.currentTextMarkupAnnotation) {\n      var canvas = this.pdfViewerBase.getElement('_annotationCanvas_' + this.selectTextMarkupCurrentPage);\n      if (canvas) {\n        this.selectAnnotation(this.currentTextMarkupAnnotation, canvas, this.selectTextMarkupCurrentPage);\n      }\n    }\n  };\n  // private storeAnnotations(pageNumber: number, annotation: ITextMarkupAnnotation): number {\n  // eslint-disable-next-line\n  //     let storeObject: any = window.sessionStorage.getItem(this.pdfViewerBase.documentId + '_annotations_textMarkup');\n  //     let index: number = 0;\n  //     if (!storeObject) {\n  //         let markupAnnotation: IPageAnnotations = { pageIndex: pageNumber, annotations: [] };\n  //         markupAnnotation.annotations.push(annotation);\n  //         index = markupAnnotation.annotations.indexOf(annotation);\n  //         let annotationCollection: IPageAnnotations[] = [];\n  //         annotationCollection.push(markupAnnotation);\n  //         let annotationStringified: string = JSON.stringify(annotationCollection);\n  //         window.sessionStorage.setItem(this.pdfViewerBase.documentId + '_annotations_textMarkup', annotationStringified);\n  //     } else {\n  //         let annotObject: IPageAnnotations[] = JSON.parse(storeObject);\n  //         window.sessionStorage.removeItem(this.pdfViewerBase.documentId + '_annotations_textMarkup');\n  //         let pageIndex: number = this.pdfViewer.annotationModule.getPageCollection(annotObject, pageNumber);\n  //         if (annotObject[pageIndex]) {\n  //             (annotObject[pageIndex] as IPageAnnotations).annotations.push(annotation);\n  //             index = (annotObject[pageIndex] as IPageAnnotations).annotations.indexOf(annotation);\n  //         } else {\n  //             let markupAnnotation: IPageAnnotations = { pageIndex: pageNumber, annotations: [] };\n  //             markupAnnotation.annotations.push(annotation);\n  //             index = markupAnnotation.annotations.indexOf(annotation);\n  //             annotObject.push(markupAnnotation);\n  //         }\n  //         let annotationStringified: string = JSON.stringify(annotObject);\n  //         window.sessionStorage.setItem(this.pdfViewerBase.documentId + '_annotations_textMarkup', annotationStringified);\n  //     }\n  //     return index;\n  // }\n  /**\n   * @param pageAnnotations\n   * @param pageNumber\n   * @private\n   */\n  TextMarkupAnnotation.prototype.manageAnnotations = function (pageAnnotations, pageNumber) {\n    // eslint-disable-next-line\n    var storeObject = window.sessionStorage.getItem(this.pdfViewerBase.documentId + '_annotations_textMarkup');\n    if (this.pdfViewerBase.isStorageExceed) {\n      storeObject = this.pdfViewerBase.annotationStorage[this.pdfViewerBase.documentId + '_annotations_textMarkup'];\n    }\n    if (storeObject) {\n      var annotObject = JSON.parse(storeObject);\n      if (!this.pdfViewerBase.isStorageExceed) {\n        window.sessionStorage.removeItem(this.pdfViewerBase.documentId + '_annotations_textMarkup');\n      }\n      var index = this.pdfViewer.annotationModule.getPageCollection(annotObject, pageNumber);\n      if (annotObject[index]) {\n        annotObject[index].annotations = pageAnnotations;\n      }\n      var annotationStringified = JSON.stringify(annotObject);\n      if (this.pdfViewerBase.isStorageExceed) {\n        this.pdfViewerBase.annotationStorage[this.pdfViewerBase.documentId + '_annotations_textMarkup'] = annotationStringified;\n      } else {\n        window.sessionStorage.setItem(this.pdfViewerBase.documentId + '_annotations_textMarkup', annotationStringified);\n      }\n    }\n  };\n  /**\n   * @param pageIndex\n   * @param textMarkupAnnotations\n   * @param id\n   * @param pageIndex\n   * @param textMarkupAnnotations\n   * @param id\n   * @private\n   */\n  // eslint-disable-next-line\n  TextMarkupAnnotation.prototype.getAnnotations = function (pageIndex, textMarkupAnnotations, id) {\n    // eslint-disable-next-line\n    var annotationCollection;\n    // eslint-disable-next-line\n    if (id == null || id == undefined) {\n      id = '_annotations_textMarkup';\n    }\n    // eslint-disable-next-line\n    var storeObject = window.sessionStorage.getItem(this.pdfViewerBase.documentId + id);\n    if (this.pdfViewerBase.isStorageExceed) {\n      storeObject = this.pdfViewerBase.annotationStorage[this.pdfViewerBase.documentId + id];\n    }\n    if (storeObject) {\n      var annotObject = JSON.parse(storeObject);\n      var index = this.pdfViewer.annotationModule.getPageCollection(annotObject, pageIndex);\n      if (annotObject[index]) {\n        annotationCollection = annotObject[index].annotations;\n      } else {\n        annotationCollection = textMarkupAnnotations;\n      }\n    } else {\n      annotationCollection = textMarkupAnnotations;\n    }\n    return annotationCollection;\n  };\n  // eslint-disable-next-line max-len\n  // eslint-disable-next-line\n  TextMarkupAnnotation.prototype.getAddedAnnotation = function (type, color, opacity, bounds, author, subject, predefinedDate, note, isCommentLock, rect, pageNumber, textContent, startIndex, endIndex, isMultiSelect, allowedInteractions, annotationRotate) {\n    // eslint-disable-next-line max-len\n    var modifiedDate = predefinedDate ? predefinedDate : this.pdfViewer.annotation.stickyNotesAnnotationModule.getDateAndTime();\n    var annotationName = this.pdfViewer.annotation.createGUID();\n    var commentsDivid = this.pdfViewer.annotation.stickyNotesAnnotationModule.addComments('textMarkup', pageNumber + 1, type);\n    if (commentsDivid) {\n      document.getElementById(commentsDivid).id = annotationName;\n    }\n    // eslint-disable-next-line\n    var annotationSettings = this.pdfViewer.annotationSettings ? this.pdfViewer.annotationSettings : this.pdfViewer.annotationModule.updateAnnotationSettings(this.pdfViewer.annotation);\n    var isPrint = this.getIsPrintValue(type);\n    var annotation = {\n      // eslint-disable-next-line max-len\n      textMarkupAnnotationType: type,\n      color: color,\n      opacity: opacity,\n      bounds: bounds,\n      author: author,\n      allowedInteractions: allowedInteractions,\n      subject: subject,\n      modifiedDate: modifiedDate,\n      note: note,\n      rect: rect,\n      annotName: annotationName,\n      comments: [],\n      review: {\n        state: '',\n        stateModel: '',\n        author: author,\n        modifiedDate: modifiedDate\n      },\n      shapeAnnotationType: 'textMarkup',\n      pageNumber: pageNumber,\n      // eslint-disable-next-line max-len\n      textMarkupContent: textContent,\n      textMarkupStartIndex: startIndex,\n      textMarkupEndIndex: endIndex,\n      isMultiSelect: isMultiSelect,\n      annotationSelectorSettings: this.getSelector(type),\n      customData: this.pdfViewer.annotation.getTextMarkupData(subject),\n      annotationAddMode: this.annotationAddMode,\n      annotationSettings: annotationSettings,\n      isPrint: isPrint,\n      isCommentLock: isCommentLock,\n      isAnnotationRotated: false,\n      annotationRotation: annotationRotate,\n      isLocked: false\n    };\n    if (isMultiSelect) {\n      this.multiPageCollection.push(annotation);\n    }\n    var isSkip = false;\n    if (isMultiSelect && this.isExtended) {\n      isSkip = true;\n    }\n    if (document.getElementById(annotationName) && !isSkip) {\n      document.getElementById(annotationName).addEventListener('mouseup', this.annotationDivSelect(annotation, pageNumber));\n    }\n    var storedIndex = this.pdfViewer.annotationModule.storeAnnotations(pageNumber, annotation, '_annotations_textMarkup');\n    this.pdfViewer.annotationModule.addAction(pageNumber, storedIndex, annotation, 'Text Markup Added', null);\n    return annotation;\n  };\n  TextMarkupAnnotation.prototype.getSelector = function (type) {\n    var selector = this.pdfViewer.annotationSelectorSettings;\n    if (type === 'Highlight' && this.pdfViewer.highlightSettings.annotationSelectorSettings) {\n      selector = this.pdfViewer.highlightSettings.annotationSelectorSettings;\n    } else if (type === 'Underline' && this.pdfViewer.underlineSettings.annotationSelectorSettings) {\n      selector = this.pdfViewer.underlineSettings.annotationSelectorSettings;\n    } else if (type === 'Strikethrough' && this.pdfViewer.strikethroughSettings.annotationSelectorSettings) {\n      selector = this.pdfViewer.strikethroughSettings.annotationSelectorSettings;\n    }\n    return selector;\n  };\n  TextMarkupAnnotation.prototype.getIsPrintValue = function (type) {\n    var isPrint = true;\n    if (type === 'Highlight') {\n      isPrint = this.pdfViewer.highlightSettings.isPrint;\n    }\n    if (type === 'Underline') {\n      isPrint = this.pdfViewer.underlineSettings.isPrint;\n    }\n    if (type === 'Strikethrough') {\n      isPrint = this.pdfViewer.strikethroughSettings.isPrint;\n    }\n    if (isNullOrUndefined(isPrint)) {\n      isPrint = true;\n    }\n    return isPrint;\n  };\n  // eslint-disable-next-line\n  TextMarkupAnnotation.prototype.annotationDivSelect = function (annotation, pageNumber) {\n    var canvas = this.pdfViewerBase.getElement('_annotationCanvas_' + pageNumber);\n    this.selectAnnotation(annotation, canvas, pageNumber);\n    if (this.pdfViewer.toolbarModule) {\n      if (this.pdfViewer.toolbarModule.annotationToolbarModule && this.pdfViewer.enableAnnotationToolbar) {\n        this.pdfViewer.toolbarModule.annotationToolbarModule.clearShapeMode();\n        this.pdfViewer.toolbarModule.annotationToolbarModule.clearMeasureMode();\n        var isLock = false;\n        if (annotation.annotationSettings && annotation.annotationSettings.isLock) {\n          isLock = annotation.annotationSettings.isLock;\n        }\n        if (isLock) {\n          if (this.pdfViewer.annotationModule.checkAllowedInteractions('PropertyChange', annotation)) {\n            this.pdfViewer.toolbarModule.annotationToolbarModule.enableTextMarkupAnnotationPropertiesTools(true);\n            this.pdfViewer.toolbarModule.annotationToolbarModule.setCurrentColorInPicker();\n          }\n          if (this.pdfViewer.annotationModule.checkAllowedInteractions('Delete', annotation)) {\n            this.pdfViewer.toolbarModule.annotationToolbarModule.selectAnnotationDeleteItem(true);\n          }\n        } else {\n          this.pdfViewer.toolbarModule.annotationToolbarModule.enableTextMarkupAnnotationPropertiesTools(true);\n          this.pdfViewer.toolbarModule.annotationToolbarModule.selectAnnotationDeleteItem(true);\n          this.pdfViewer.toolbarModule.annotationToolbarModule.setCurrentColorInPicker();\n        }\n        this.pdfViewer.toolbarModule.annotationToolbarModule.isToolbarHidden = true;\n        if (!isBlazor()) {\n          this.pdfViewer.toolbarModule.annotationToolbarModule.showAnnotationToolbar(this.pdfViewer.toolbarModule.annotationItem);\n        }\n      }\n    }\n  };\n  TextMarkupAnnotation.prototype.getPageContext = function (pageNumber) {\n    var canvas = this.pdfViewerBase.getElement('_annotationCanvas_' + pageNumber);\n    var context = null;\n    if (canvas) {\n      context = canvas.getContext('2d');\n    }\n    return context;\n  };\n  TextMarkupAnnotation.prototype.getDefaultValue = function (value) {\n    return value / this.pdfViewerBase.getZoomFactor();\n  };\n  TextMarkupAnnotation.prototype.getMagnifiedValue = function (value, factor) {\n    return value * factor;\n  };\n  /**\n   * @param annotation\n   * @param pageNumber\n   * @private\n   */\n  // eslint-disable-next-line\n  TextMarkupAnnotation.prototype.saveImportedTextMarkupAnnotations = function (annotation, pageNumber) {\n    var annotationObject = null;\n    annotation.Author = this.pdfViewer.annotationModule.updateAnnotationAuthor('textMarkup', annotation.Subject);\n    // eslint-disable-next-line max-len\n    annotation.allowedInteractions = this.pdfViewer.annotationModule.updateAnnotationAllowedInteractions(annotation);\n    annotation.AnnotationSettings = annotation.AnnotationSettings ? annotation.AnnotationSettings : this.pdfViewer.annotationModule.updateSettings(this.pdfViewer.customStampSettings);\n    // eslint-disable-next-line max-len\n    annotationObject = {\n      // eslint-disable-next-line max-len\n      textMarkupAnnotationType: annotation.TextMarkupAnnotationType,\n      color: annotation.Color,\n      opacity: annotation.Opacity,\n      allowedInteractions: annotation.allowedInteractions,\n      bounds: annotation.Bounds,\n      author: annotation.Author,\n      subject: annotation.Subject,\n      modifiedDate: annotation.ModifiedDate,\n      note: annotation.Note,\n      rect: annotation.Rect,\n      annotName: annotation.AnnotName,\n      isLocked: annotation.IsLocked,\n      comments: this.pdfViewer.annotationModule.getAnnotationComments(annotation.Comments, annotation, annotation.Author),\n      review: {\n        state: annotation.State,\n        stateModel: annotation.StateModel,\n        modifiedDate: annotation.ModifiedDate,\n        author: annotation.Author\n      },\n      shapeAnnotationType: 'textMarkup',\n      pageNumber: pageNumber,\n      textMarkupContent: '',\n      textMarkupStartIndex: 0,\n      // eslint-disable-next-line max-len\n      textMarkupEndIndex: 0,\n      annotationSelectorSettings: this.getSettings(annotation),\n      customData: this.pdfViewer.annotation.getCustomData(annotation),\n      isMultiSelect: annotation.IsMultiSelect,\n      annotNameCollection: annotation.AnnotNameCollection,\n      annotpageNumbers: annotation.AnnotpageNumbers,\n      // eslint-disable-next-line max-len\n      annotationAddMode: this.annotationAddMode,\n      annotationSettings: annotation.AnnotationSettings,\n      isPrint: annotation.IsPrint,\n      isCommentLock: annotation.IsCommentLock,\n      isAnnotationRotated: false\n    };\n    this.pdfViewer.annotationModule.storeAnnotations(pageNumber, annotationObject, '_annotations_textMarkup');\n  };\n  /**\n   * @param annotation\n   * @param pageNumber\n   * @param annotation\n   * @param pageNumber\n   * @private\n   */\n  // eslint-disable-next-line\n  TextMarkupAnnotation.prototype.updateTextMarkupAnnotationCollections = function (annotation, pageNumber) {\n    // eslint-disable-next-line\n    var annotationObject = null;\n    // eslint-disable-next-line max-len\n    annotation.allowedInteractions = annotation.AllowedInteractions ? annotation.AllowedInteractions : this.pdfViewer.annotationModule.updateAnnotationAllowedInteractions(annotation);\n    annotation.AnnotationSettings = annotation.AnnotationSettings ? annotation.AnnotationSettings : this.pdfViewer.annotationModule.updateSettings(this.pdfViewer.customStampSettings);\n    if (annotation.IsLocked) {\n      annotation.AnnotationSettings.isLock = annotation.IsLocked;\n    }\n    if (annotation.TextMarkupAnnotationType === \"Highlight\") {\n      annotation.AnnotationSelectorSettings = annotation.annotSelectorSettings ? annotation.annotSelectorSettings : this.pdfViewer.highlightSettings.annotationSelectorSettings;\n    } else if (annotation.TextMarkupAnnotationType === \"Underline\") {\n      annotation.AnnotationSelectorSettings = annotation.annotSelectorSettings ? annotation.annotSelectorSettings : this.pdfViewer.underlineSettings.annotationSelectorSettings;\n    } else {\n      annotation.AnnotationSelectorSettings = annotation.annotSelectorSettings ? annotation.annotSelectorSettings : this.pdfViewer.strikethroughSettings.annotationSelectorSettings;\n    }\n    annotationObject = {\n      // eslint-disable-next-line max-len\n      textMarkupAnnotationType: annotation.TextMarkupAnnotationType,\n      allowedInteractions: annotation.allowedInteractions,\n      color: annotation.Color,\n      opacity: annotation.Opacity,\n      bounds: annotation.Bounds,\n      author: annotation.Author,\n      subject: annotation.Subject,\n      modifiedDate: annotation.ModifiedDate,\n      note: annotation.Note,\n      rect: annotation.Rect,\n      annotationId: annotation.AnnotName,\n      comments: this.pdfViewer.annotationModule.getAnnotationComments(annotation.Comments, annotation, annotation.Author),\n      review: {\n        state: annotation.State,\n        stateModel: annotation.StateModel,\n        modifiedDate: annotation.ModifiedDate,\n        author: annotation.Author\n      },\n      shapeAnnotationType: 'textMarkup',\n      pageNumber: pageNumber,\n      isMultiSelect: annotation.IsMultiSelect,\n      annotNameCollection: annotation.AnnotNameCollection,\n      annotpageNumbers: annotation.AnnotpageNumbers,\n      customData: this.pdfViewer.annotation.getCustomData(annotation),\n      annotationSettings: annotation.AnnotationSettings,\n      isLocked: annotation.IsLocked,\n      isPrint: annotation.IsPrint,\n      isCommentLock: annotation.IsCommentLock,\n      annotationSelectorSettings: annotation.AnnotationSelectorSettings\n    };\n    return annotationObject;\n  };\n  /**\n   * @param textMarkUpSettings\n   * @private\n   */\n  // eslint-disable-next-line\n  TextMarkupAnnotation.prototype.updateTextMarkupSettings = function (textMarkUpSettings) {\n    if (textMarkUpSettings === 'highlightSettings') {\n      // eslint-disable-next-line max-len\n      this.highlightColor = this.pdfViewer.highlightSettings.color ? this.pdfViewer.highlightSettings.color : this.highlightColor;\n      // eslint-disable-next-line max-len\n      this.highlightOpacity = this.pdfViewer.highlightSettings.opacity ? this.pdfViewer.highlightSettings.opacity : this.highlightOpacity;\n    }\n    if (textMarkUpSettings === 'underlineSettings') {\n      // eslint-disable-next-line max-len\n      this.underlineColor = this.pdfViewer.underlineSettings.color ? this.pdfViewer.underlineSettings.color : this.underlineColor;\n      // eslint-disable-next-line max-len\n      this.underlineOpacity = this.pdfViewer.underlineSettings.opacity ? this.pdfViewer.underlineSettings.opacity : this.underlineOpacity;\n    }\n    if (textMarkUpSettings === 'strikethroughSettings') {\n      // eslint-disable-next-line max-len\n      this.strikethroughColor = this.pdfViewer.strikethroughSettings.color ? this.pdfViewer.strikethroughSettings.color : this.strikethroughColor;\n      // eslint-disable-next-line max-len\n      this.strikethroughOpacity = this.pdfViewer.strikethroughSettings.opacity ? this.pdfViewer.strikethroughSettings.opacity : this.strikethroughOpacity;\n    }\n  };\n  /**\n   * @private\n   */\n  TextMarkupAnnotation.prototype.clear = function () {\n    this.selectTextMarkupCurrentPage = null;\n    this.currentTextMarkupAnnotation = null;\n    this.annotationClickPosition = null;\n    window.sessionStorage.removeItem(this.pdfViewerBase.documentId + '_annotations_textMarkup');\n  };\n  /**\n   * Get vertex points properties\n   * @private\n   */\n  TextMarkupAnnotation.prototype.getOffsetPoints = function (points) {\n    var offsetPoints = [];\n    //Converting points model into vertex property\n    for (var j = 0; j < points.length; j++) {\n      offsetPoints[j] = {\n        X: points[j].x,\n        Y: points[j].y,\n        Width: points[j].width,\n        Height: points[j].height,\n        Left: points[j].x,\n        Top: points[j].y\n      };\n    }\n    return offsetPoints;\n  };\n  /**\n   * This method used to add annotations with using program.\n   *\n   * @param annotationType - It describes the annotation type\n   * @param annotationObject - It describes type of annotation object\n   * @returns Object\n   * @private\n   */\n  TextMarkupAnnotation.prototype.updateAddAnnotationDetails = function (annotationType, annotationObject) {\n    //Creating new object if annotationObject is null\n    if (!annotationObject) {\n      annotationObject = {\n        pageNumber: 0\n      };\n    }\n    //Initialize the annotation settings\n    var annotSelectorSettings = null;\n    var annotallowedInteractions = null;\n    var textMarkupAnnotationType = '';\n    var annotSettings = null;\n    var color = '';\n    var bounds = [];\n    //Creating the CurrentDate and Annotation name\n    var currentDateString = this.pdfViewer.annotation.stickyNotesAnnotationModule.getDateAndTime();\n    var annotationName = this.pdfViewer.annotation.createGUID();\n    if (annotationType == 'Highlight') {\n      //Creating annotation settings\n      annotSelectorSettings = this.pdfViewer.highlightSettings.annotationSelectorSettings ? this.pdfViewer.highlightSettings.annotationSelectorSettings : this.pdfViewer.annotationSelectorSettings;\n      annotSettings = this.pdfViewer.annotationModule.updateSettings(this.pdfViewer.highlightSettings);\n      annotationObject.author = annotationObject.author ? annotationObject.author : this.pdfViewer.annotationModule.updateAnnotationAuthor('textMarkup', annotationType);\n      annotallowedInteractions = this.pdfViewer.highlightSettings.allowedInteractions ? this.pdfViewer.highlightSettings.allowedInteractions : this.pdfViewer.annotationSettings.allowedInteractions;\n      textMarkupAnnotationType = 'Highlight';\n      color = annotationObject.color ? annotationObject.color : '#ffff00';\n    } else if (annotationType == 'Underline') {\n      //Creating annotation settings\n      annotSelectorSettings = this.pdfViewer.underlineSettings.annotationSelectorSettings ? this.pdfViewer.underlineSettings.annotationSelectorSettings : this.pdfViewer.annotationSelectorSettings;\n      annotSettings = this.pdfViewer.annotationModule.updateSettings(this.pdfViewer.underlineSettings);\n      annotationObject.author = annotationObject.author ? annotationObject.author : this.pdfViewer.annotationModule.updateAnnotationAuthor('textMarkup', annotationType);\n      annotallowedInteractions = this.pdfViewer.underlineSettings.allowedInteractions ? this.pdfViewer.underlineSettings.allowedInteractions : this.pdfViewer.annotationSettings.allowedInteractions;\n      textMarkupAnnotationType = 'Underline';\n      color = annotationObject.color ? annotationObject.color : '#00ff00';\n    } else if (annotationType == 'Strikethrough') {\n      //Creating annotation settings\n      annotSelectorSettings = this.pdfViewer.strikethroughSettings.annotationSelectorSettings ? this.pdfViewer.strikethroughSettings.annotationSelectorSettings : this.pdfViewer.annotationSelectorSettings;\n      annotSettings = this.pdfViewer.annotationModule.updateSettings(this.pdfViewer.strikethroughSettings);\n      annotationObject.author = annotationObject.author ? annotationObject.author : this.pdfViewer.annotationModule.updateAnnotationAuthor('textMarkup', annotationType);\n      annotallowedInteractions = this.pdfViewer.strikethroughSettings.allowedInteractions ? this.pdfViewer.strikethroughSettings.allowedInteractions : this.pdfViewer.annotationSettings.allowedInteractions;\n      textMarkupAnnotationType = 'Strikethrough';\n      color = annotationObject.color ? annotationObject.color : '#ff0000';\n    }\n    annotSettings.isLock = annotationObject.isLock ? annotationObject.isLock : annotSettings.isLock;\n    //Creating the offset points\n    if (annotationObject.bounds) {\n      bounds = this.getOffsetPoints(annotationObject.bounds);\n    } else bounds = [{\n      X: 1,\n      Y: 1,\n      Width: 100,\n      Height: 14,\n      Left: 1,\n      Top: 1,\n      Location: {\n        X: 1,\n        Y: 1\n      },\n      Size: {\n        Height: 14,\n        IsEmpty: false,\n        Width: 100\n      }\n    }];\n    //Creating Annotation objects with it's proper properties       \n    var textMarkupAnnotation = [];\n    var textmarkup = {\n      AllowedInteractions: annotationObject.allowedInteractions ? annotationObject.allowedInteractions : annotallowedInteractions,\n      AnnotName: annotationName,\n      AnnotNameCollection: null,\n      AnnotType: 'textMarkup',\n      AnnotationSelectorSettings: annotationObject.annotationSelectorSettings ? annotationObject.annotationSelectorSettings : annotSelectorSettings,\n      AnnotationSettings: annotSettings,\n      Author: annotationObject.author ? annotationObject.author : 'Guest',\n      Bounds: bounds,\n      Color: annotationObject.color ? annotationObject.color : color,\n      Comments: null,\n      CreatedDate: currentDateString,\n      CustomData: annotationObject.customData ? annotationObject.customData : null,\n      ExistingCustomData: null,\n      EnableMultiPageAnnotation: annotationObject.enableMultiPageAnnotation ? annotationObject.enableMultiPageAnnotation : false,\n      EnableTextMarkupResizer: annotationObject.enableTextMarkupResizer ? annotationObject.enableTextMarkupResizer : false,\n      IsCommentLock: false,\n      IsMultiSelect: false,\n      IsLocked: annotationObject.isLock ? annotationObject.isLock : false,\n      IsLock: annotationObject.isLock ? annotationObject.isLock : false,\n      IsPrint: annotationObject.isPrint ? annotationObject.isPrint : true,\n      ModifiedDate: '',\n      Note: '',\n      Opacity: annotationObject.opacity ? annotationObject.opacity : 1,\n      Rect: {},\n      State: '',\n      StateModel: '',\n      Subject: annotationObject.subject ? annotationObject.subject : textMarkupAnnotationType,\n      TextMarkupAnnotationType: textMarkupAnnotationType\n    };\n    //Adding the annotation object to an array and return it\n    textMarkupAnnotation[0] = textmarkup;\n    return {\n      textMarkupAnnotation: textMarkupAnnotation\n    };\n  };\n  return TextMarkupAnnotation;\n}();\nexport { TextMarkupAnnotation };","map":{"version":3,"names":["createElement","Browser","isNullOrUndefined","isBlazor","TextMarkupAnnotation","pdfViewer","viewerBase","_this","currentTextMarkupAddMode","selectTextMarkupCurrentPage","currentTextMarkupAnnotation","isAddAnnotationProgramatically","currentAnnotationIndex","isAnnotationSelect","isDropletClicked","isRightDropletClicked","isLeftDropletClicked","isSelectionMaintained","isExtended","isNewAnnotation","selectedTextMarkup","multiPageCollection","triggerAddEvent","isSelectedAnnotation","dropletHeight","strikeoutDifference","underlineDifference","annotationClickPosition","maintainSelection","event","textSelectionModule","initiateSelectionByTouch","selectionRangeArray","selectionEnd","annotationLeftMove","annotationRightMove","pdfViewerBase","prototype","createAnnotationSelectElement","dropDivAnnotationLeft","id","element","className","style","borderRight","dropDivAnnotationRight","borderLeft","dropElementLeft","transform","appendChild","dropElementRight","pageContainer","top","left","display","addEventListener","textSelect","target","x","y","leftElement","getBoundingClientRect","rightElement","clientX","clientY","classList","contains","textSelectionOnDrag","updateLeftposition","updatePosition","showHideDropletDiv","hide","type","annotationModule","textMarkupAnnotationModule","isEnableResizer","isEnableTextMarkupResizer","updateDropletStyles","highlightSettings","enableTextMarkupResizer","underlineSettings","strikethroughSettings","offsetWidth","width","getZoomFactor","height","updateAnnotationBounds","annotation","isMultiSelect","updateMultiAnnotBounds","bounds","retreieveSelection","window","getSelection","removeAllRanges","annotpageNumbers","annotationList","getAnnotations","pageNumber","z","length","annotName","lowestNumber","highestNumber","p","currentPage","k","j","annotNameCollection","currentAnnot","newAnnotation","bound","Left","Top","Width","Height","textLayer","getElement","textDivs","childNodes","n","rangebounds","top_1","getClientValueTop","currentLeft","totalLeft","textDiVLeft","parseInt","currentTop","isLeftBounds","checkLeftBounds","isTopBounds","checkTopBounds","boundingRect","textSelectionOnMouseMove","isSelected","pageTopValue","pageSize","currentPageNumber","topClientValue","rightDivElement","document","getElementById","viewerContainer","scrollLeft","leftDivElement","clientValue","renderTextMarkupAnnotationsInPage","textMarkupAnnotations","isImportTextMarkup","isAnnotOrderAction","canvas","renderTextMarkupAnnotations","factor","isImportAction","context","getContext","setTransform","setLineDash","annotations_1","forEach","textMarkupAnnotation","exists","some","existingAnnotation","AnnotName","push","distinctAnnotations","i","duplicateFound","annotationObject","isAnnotationRotated","TextMarkupAnnotationType","isJsonImported","newArray","i_1","Bounds","importJsonForRotatedDocuments","Rotate","AnnotationRotation","X","Y","isPageRotated","annotationAddMode","findAnnotationMode","AnnotType","allowedInteractions","AllowedInteractions","updateAnnotationAllowedInteractions","AnnotationSettings","updateAnnotationSettings","textMarkupAnnotationType","color","Color","opacity","Opacity","author","Author","subject","Subject","modifiedDate","ModifiedDate","note","Note","rect","Rect","comments","getAnnotationComments","Comments","review","state","State","stateModel","StateModel","shapeAnnotationType","textMarkupContent","TextMarkupContent","textMarkupStartIndex","textMarkupEndIndex","annotationSelectorSettings","getSettings","customData","getCustomData","annotationSettings","isLocked","IsLocked","isPrint","IsPrint","isCommentLock","IsCommentLock","annotationRotation","IsMultiSelect","AnnotNameCollection","AnnotpageNumbers","markedBounds","storedData","getStoredData","requestForTextExtraction","pageCharText","pageText","split","characterBounds","characterBound","textMarkUpContent","storeAnnotations","settings","fireAnnotationAdd","annotBounds","renderHighlightAnnotation","renderStrikeoutAnnotation","renderUnderlineAnnotation","isMaintainedSelector","m","maintainAnnotationSelection","selector","AnnotationSelectorSettings","getSelector","drawTextMarkupAnnotations","isTextMarkupAnnotationMode","isFormFieldShape","isCleared","selectionObject","convertSelectionToTextMarkup","selection","targetElement","anchorNode","parentElement","toString","pageBounds","getDrawnBounds","pageIndex","updateTextMarkupAnnotationBounds","isMultiAnnotation","drawTextMarkups","textContent","startIndex","endIndex","modifyCurrentAnnotation","isMultiPageAnnotations","updateAnnotationNames","clearTextSelection","isSelection","enableMultiPageAnnotation","index","c","currentAnnots","drawAnnotationSelector","newcanvas","newBounds","nextTop","nextLeft","currentRotation","nextRotation","rotation_0_180_exists","clientSideRendering","rotation","boundsLength","reduce","min","Infinity","sum","isNaN","drawAnnotationSelectRect","getMagnifiedValue","selectMultiPageAnnotations","deletMultiPageAnnotation","deletedAnnotation","splice","addAction","stickyNotesAnnotationModule","findPosition","removeDiv","childElementCount","updateAccordionContainer","remove","updateAnnotationCollection","manageAnnotations","updateImportAnnotationCollection","annotationId","annotationBounds","renderAnnotations","modifyMultiPageAnnotations","property","value","getDateAndTime","status","updateAnnotationModifiedDate","textValue","indexes","startNode","endNode","parentText","getIndexNumbers","rectangleBounds","currentIndex","pageAnnotations","JSON","stringify","updateDocumentEditedProperty","multiPageCollectionList","fireAnnotationResize","annotations","annotNamesCollections","updateAnnotationContent","pageBound","annotation_1","storeAnnotationCollections","getPageContext","highlightColor","underlineColor","strikethroughColor","highlightOpacity","underlineOpacity","strikethroughOpacity","pageDetails","annotationRotate","pageRotation","getAngle","getAddedAnnotation","startsWith","Math","abs","actionCollection","isDevice","enableDesktopMode","enableToolbar","enableAnnotationToolbar","toolbarModule","annotationToolbarModule","createPropertyTools","angle","retreiveTextIndex","zoomRatio","getZoomRatio","beginPath","Rotation","globalAlpha","closePath","fillStyle","msFillRule","fill","save","getProperBounds","factorRatio","drawLine","boundValues","isChineseLanguage","chineseRegex","isChinese","test","moveTo","lineTo","lineWidth","strokeStyle","stroke","printTextMarkupAnnotations","stampData","shapeData","measureShapeData","stickyData","freeTextData","pageWidth","pageHeight","zoom","textMarkupannotations","shapeAnnotation","measureShapeAnnotation","stampAnnotation","stickyNoteAnnotation","renderDrawing","stampAnnotationModule","renderStampAnnotations","renderStickyNotesAnnotations","zoomFactor","imageSource","toDataURL","saveTextMarkupAnnotations","storeTextMarkupObject","sessionStorage","getItem","documentId","isStorageExceed","annotationStorage","Array","pageCount","skipDownload","textMarkupAnnotationCollection","parse","pageAnnotationObject","_loop_1","this_1","updateModifiedDate","isJsonExported","getBoundsForSave","height_difference_1","colorString","getRgbCode","deleteTextMarkupAnnotation","isLock","checkAllowedInteractions","fireAnnotationRemove","hideMobileAnnotationToolbar","showToolbar","modifyColorProperty","modifyAnnotationProperty","fireAnnotationPropertiesChange","modifyOpacityProperty","args","isOpacity","name","undoTextMarkupAction","action","removeChild","addAnnotationComments","clearCurrentAnnotation","undoRedoPropertyChange","isUndoAction","tempColor","tempOpacity","redoTextMarkupAction","saveNoteContent","isMaintainSelection","isTextSelection","isSkip","freeTextAnnotationModule","isInuptBoxInFocus","enableAnnotationPropertiesTool","clearCurrentAnnotationSelection","isSelect","lowerPageIndex","higherPageIndex","clearAnnotationSelection","getAnnotationBounds","match","nameToHash","markupStringArray","getValue","textMarkupR","textMarkupG","textMarkupB","textMarkupA","a","r","g","b","range","createRange","isBackWardSelection","focusNode","pageId","getPageIndex","pageRect","isMixedSizeDocument","setStart","focusOffset","setEnd","anchorOffset","textElement","startContainer","parentNode","commonAncestorContainer","rectangle","getDefaultValue","right","bottom","rectangleArray","selectionStartOffset","selectionEndOffset","anchorPageId","anchorTextId","getTextIndex","focusPageId","focusTextId","startOffset","endOffset","currentId","selectionRects","pageStartId","pageEndId","pageStartOffset","pageEndOffset","node","detach","startElementNode","endElementNode","pageRange","pageRectBounds","pageRectangle","content","getLinkInformation","previousIndex","isExtractText","documentIndex","textSearchModule","documentTextCollection","pageTextData","PageText","isTextRetrieved","parentIndex","indexOf","initialIndex","rerenderAnnotationsPinch","annotCanvas","oldAnnotCanvas","restrictZoomRequest","rerenderAnnotations","oldCanvasCollection","querySelectorAll","newCanvas","onTextMarkupAnnotationMouseUp","getEventPageNumber","clearCurrentSelectedAnnotation","getCurrentMarkupAnnotation","canvasParentPosition","leftClickPosition","topClickPosition","selectAnnotation","commentPanelDiv","accordionExpand","ej2_instances","expandItem","firstChild","click","isToolbarHidden","showAnnotationToolbar","annotationItem","isClickedOnScrollBar","onTextMarkupAnnotationTouchEnd","touchCanvas","touches","number","fireAnnotationUnSelect","onTextMarkupAnnotationMouseMove","eventTarget","cursor","currentPosition","getMousePosition","relativePosition","viewerPositions","mousePositions","isMousedOver","fireAnnotationMouseover","hidePopupNote","isPanMode","getAnnotationToolStatus","isFormFieldMousedOver","fireAnnotationMouseLeave","showPopupNote","currentTextMarkupAnnotations","clientWidth","isAnnotationGot","top_2","compareCurrentAnnotations","previousX","currentAnnotation","firstAnnotBounds","firstXposition","firstYposition","secondAnnotBounds","secondXposition","secondYposition","isProgrammaticSelection","selectedItems","clearSelection","isCurrentTextMarkup","currentEvent","updateCurrentResizerPosition","annotationSelect","top_3","endPosition","endLeft","endTop","endWidth","ratio","lineDash","selectorLineDashArray","borderColor","selectionBorderColor","selectionBorderThickness","isEnable","colorDropDownElementInBlazor","querySelector","createMobileAnnotationToolbar","isMobileAnnotEnabled","selectAnnotationDeleteItem","enable","enableTextMarkupAnnotationPropertiesTools","updateColorInIcon","colorDropDownElement","setCurrentColorInPicker","storeObject","annotObject","removeItem","getPageCollection","annotationStringified","setItem","annotationCollection","undefined","predefinedDate","annotationName","createGUID","commentsDivid","addComments","getIsPrintValue","getTextMarkupData","annotationDivSelect","storedIndex","clearShapeMode","clearMeasureMode","saveImportedTextMarkupAnnotations","updateAnnotationAuthor","updateSettings","customStampSettings","updateTextMarkupAnnotationCollections","annotSelectorSettings","updateTextMarkupSettings","textMarkUpSettings","clear","getOffsetPoints","points","offsetPoints","updateAddAnnotationDetails","annotationType","annotallowedInteractions","annotSettings","currentDateString","Location","Size","IsEmpty","textmarkup","CreatedDate","CustomData","ExistingCustomData","EnableMultiPageAnnotation","EnableTextMarkupResizer","IsLock"],"sources":["/Users/saleem/Desktop/KClient/Web App/Ver_3.6/User Interface/website_Source files/node_modules/@syncfusion/ej2-pdfviewer/src/pdfviewer/annotation/text-markup-annotation.js"],"sourcesContent":["import { createElement, Browser, isNullOrUndefined, isBlazor } from '@syncfusion/ej2-base';\n/**\n * The `TextMarkupAnnotation` module is used to handle text markup annotation actions of PDF viewer.\n *\n * @hidden\n */\nvar TextMarkupAnnotation = /** @class */ (function () {\n    /**\n     * @param pdfViewer\n     * @param viewerBase\n     * @private\n     */\n    function TextMarkupAnnotation(pdfViewer, viewerBase) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.currentTextMarkupAddMode = '';\n        /**\n         * @private\n         */\n        this.selectTextMarkupCurrentPage = null;\n        /**\n         * @private\n         */\n        this.currentTextMarkupAnnotation = null;\n        /**\n         * @private\n         */\n        this.isAddAnnotationProgramatically = false;\n        this.currentAnnotationIndex = null;\n        this.isAnnotationSelect = false;\n        /**\n         * @private\n         */\n        this.isDropletClicked = false;\n        /**\n         * @private\n         */\n        this.isRightDropletClicked = false;\n        /**\n         * @private\n         */\n        this.isLeftDropletClicked = false;\n        /**\n         * @private\n         */\n        this.isSelectionMaintained = false;\n        this.isExtended = false;\n        this.isNewAnnotation = false;\n        this.selectedTextMarkup = null;\n        this.multiPageCollection = [];\n        this.triggerAddEvent = false;\n        /**\n         * @private\n         */\n        this.isSelectedAnnotation = false;\n        this.dropletHeight = 20;\n        // To update the height value of strikethrough and underline annotations for Chinese language (Task ID: 861029).\n        this.strikeoutDifference = -3;\n        this.underlineDifference = 2;\n        /**\n         * @private\n         */\n        this.annotationClickPosition = {};\n        // eslint-disable-next-line\n        this.maintainSelection = function (event) {\n            _this.isDropletClicked = true;\n            _this.pdfViewer.textSelectionModule.initiateSelectionByTouch();\n            _this.isExtended = true;\n            _this.pdfViewer.textSelectionModule.selectionRangeArray = [];\n        };\n        // eslint-disable-next-line\n        this.selectionEnd = function (event) {\n            if (_this.isDropletClicked) {\n                _this.isDropletClicked = false;\n            }\n        };\n        // eslint-disable-next-line\n        this.annotationLeftMove = function (event) {\n            if (_this.isDropletClicked) {\n                _this.isLeftDropletClicked = true;\n            }\n        };\n        // eslint-disable-next-line\n        this.annotationRightMove = function (event) {\n            if (_this.isDropletClicked) {\n                _this.isRightDropletClicked = true;\n            }\n        };\n        this.pdfViewer = pdfViewer;\n        this.pdfViewerBase = viewerBase;\n    }\n    /**\n     * @private\n     */\n    TextMarkupAnnotation.prototype.createAnnotationSelectElement = function () {\n        // eslint-disable-next-line max-len\n        this.dropDivAnnotationLeft = createElement('div', { id: this.pdfViewer.element.id + '_droplet_left', className: 'e-pv-drop' });\n        this.dropDivAnnotationLeft.style.borderRight = '2px solid';\n        // eslint-disable-next-line max-len\n        this.dropDivAnnotationRight = createElement('div', { id: this.pdfViewer.element.id + '_droplet_right', className: 'e-pv-drop' });\n        this.dropDivAnnotationRight.style.borderLeft = '2px solid';\n        this.dropElementLeft = createElement('div', { className: 'e-pv-droplet', id: this.pdfViewer.element.id + '_dropletspan_left' });\n        this.dropElementLeft.style.transform = 'rotate(0deg)';\n        this.dropDivAnnotationLeft.appendChild(this.dropElementLeft);\n        this.dropElementRight = createElement('div', { className: 'e-pv-droplet', id: this.pdfViewer.element.id + '_dropletspan_right' });\n        this.dropElementRight.style.transform = 'rotate(-90deg)';\n        this.dropDivAnnotationRight.appendChild(this.dropElementRight);\n        this.pdfViewerBase.pageContainer.appendChild(this.dropDivAnnotationLeft);\n        this.pdfViewerBase.pageContainer.appendChild(this.dropDivAnnotationRight);\n        this.dropElementLeft.style.top = '20px';\n        this.dropElementRight.style.top = '20px';\n        this.dropElementRight.style.left = '-8px';\n        this.dropElementLeft.style.left = '-8px';\n        this.dropDivAnnotationLeft.style.display = 'none';\n        this.dropDivAnnotationRight.style.display = 'none';\n        this.dropDivAnnotationLeft.addEventListener('mousedown', this.maintainSelection);\n        this.dropDivAnnotationLeft.addEventListener('mousemove', this.annotationLeftMove);\n        this.dropDivAnnotationLeft.addEventListener('mouseup', this.selectionEnd);\n        this.dropDivAnnotationRight.addEventListener('mousedown', this.maintainSelection);\n        this.dropDivAnnotationRight.addEventListener('mousemove', this.annotationRightMove);\n        this.dropDivAnnotationRight.addEventListener('mouseup', this.selectionEnd);\n    };\n    /**\n     * @param target\n     * @param x\n     * @param y\n     * @param target\n     * @param x\n     * @param y\n     * @param target\n     * @param x\n     * @param y\n     * @private\n     */\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.textSelect = function (target, x, y) {\n        if (this.isLeftDropletClicked) {\n            var leftElement = this.dropDivAnnotationRight.getBoundingClientRect();\n            var rightElement = this.dropDivAnnotationLeft.getBoundingClientRect();\n            var clientX = x;\n            var clientY = y;\n            if (target.classList.contains('e-pv-text')) {\n                if ((rightElement.top - 25) > leftElement.top) {\n                    this.pdfViewer.textSelectionModule.textSelectionOnDrag(target, clientX, clientY, true);\n                }\n                else {\n                    this.pdfViewer.textSelectionModule.textSelectionOnDrag(target, clientX, clientY, false);\n                }\n                this.updateLeftposition(clientX, clientY);\n            }\n        }\n        else if (this.isRightDropletClicked) {\n            var leftElement = this.dropDivAnnotationLeft.getBoundingClientRect();\n            var clientX = x;\n            var clientY = y;\n            if (target.classList.contains('e-pv-text')) {\n                if ((clientY) >= leftElement.top) {\n                    this.pdfViewer.textSelectionModule.textSelectionOnDrag(target, clientX, clientY, true);\n                }\n                else {\n                    this.pdfViewer.textSelectionModule.textSelectionOnDrag(target, clientX, clientY, false);\n                }\n                this.updatePosition(clientX, clientY);\n            }\n        }\n    };\n    /**\n     * @param hide\n     * @private\n     */\n    TextMarkupAnnotation.prototype.showHideDropletDiv = function (hide) {\n        var type = this.pdfViewer.annotationModule.textMarkupAnnotationModule.currentTextMarkupAddMode;\n        var isEnableResizer = this.isEnableTextMarkupResizer(type);\n        if (isEnableResizer && this.dropDivAnnotationLeft && this.dropDivAnnotationRight) {\n            if (hide) {\n                this.dropDivAnnotationLeft.style.display = 'none';\n                this.dropDivAnnotationRight.style.display = 'none';\n            }\n            else {\n                this.dropDivAnnotationLeft.style.display = '';\n                this.dropDivAnnotationRight.style.display = '';\n                this.updateDropletStyles(type);\n            }\n        }\n    };\n    /**\n     * @param type\n     * @private\n     */\n    TextMarkupAnnotation.prototype.isEnableTextMarkupResizer = function (type) {\n        var isEnableResizer = false;\n        if (type) {\n            if (type === 'Highlight' && this.pdfViewer.highlightSettings.enableTextMarkupResizer) {\n                isEnableResizer = true;\n            }\n            else if (type === 'Underline' && this.pdfViewer.underlineSettings.enableTextMarkupResizer) {\n                isEnableResizer = true;\n            }\n            else if (type === 'Strikethrough' && this.pdfViewer.strikethroughSettings.enableTextMarkupResizer) {\n                isEnableResizer = true;\n            }\n            else if (this.pdfViewer.enableTextMarkupResizer) {\n                isEnableResizer = true;\n            }\n        }\n        else {\n            if (this.pdfViewer.enableTextMarkupResizer) {\n                isEnableResizer = true;\n            }\n            else if (this.pdfViewer.highlightSettings.enableTextMarkupResizer) {\n                isEnableResizer = true;\n            }\n            else if (this.pdfViewer.underlineSettings.enableTextMarkupResizer) {\n                isEnableResizer = true;\n            }\n            else if (this.pdfViewer.strikethroughSettings.enableTextMarkupResizer) {\n                isEnableResizer = true;\n            }\n        }\n        return isEnableResizer;\n    };\n    TextMarkupAnnotation.prototype.updateDropletStyles = function (type) {\n        if (this.isEnableTextMarkupResizer(type) && this.dropDivAnnotationLeft && this.dropDivAnnotationLeft.offsetWidth > 0) {\n            this.dropDivAnnotationLeft.style.width = this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n            this.dropDivAnnotationRight.style.width = this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n            this.dropElementLeft.style.width = this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n            this.dropElementRight.style.width = this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n            this.dropDivAnnotationLeft.style.height = this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n            this.dropDivAnnotationRight.style.height = this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n            this.dropElementLeft.style.height = this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n            this.dropElementRight.style.height = this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n            this.dropElementLeft.style.top = this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n            this.dropElementRight.style.top = this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n        }\n    };\n    TextMarkupAnnotation.prototype.updateAnnotationBounds = function () {\n        this.isSelectionMaintained = false;\n        // eslint-disable-next-line\n        var annotation = this.currentTextMarkupAnnotation;\n        if (annotation && annotation.isMultiSelect) {\n            this.showHideDropletDiv(true);\n            this.updateMultiAnnotBounds(annotation);\n        }\n        else if (annotation && annotation.bounds) {\n            this.retreieveSelection(annotation, null);\n            this.pdfViewer.textSelectionModule.maintainSelection(this.selectTextMarkupCurrentPage, false);\n            this.isSelectionMaintained = true;\n            window.getSelection().removeAllRanges();\n        }\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.updateMultiAnnotBounds = function (annotation) {\n        if (!annotation.annotpageNumbers) {\n            var annotationList = this.getAnnotations(annotation.pageNumber, null);\n            if (annotationList) {\n                for (var z = 0; z < annotationList.length; z++) {\n                    if (annotationList[z].annotName === annotation.annotName) {\n                        annotation = annotationList[z];\n                        break;\n                    }\n                }\n            }\n        }\n        var lowestNumber = annotation.annotpageNumbers[0];\n        var highestNumber = annotation.annotpageNumbers[0];\n        for (var p = 0; p < annotation.annotpageNumbers.length; p++) {\n            var currentPage = annotation.annotpageNumbers[p];\n            if (currentPage >= highestNumber) {\n                highestNumber = currentPage;\n            }\n            if (currentPage <= lowestNumber) {\n                lowestNumber = currentPage;\n            }\n        }\n        for (var k = lowestNumber; k <= highestNumber; k++) {\n            var annotationList = this.getAnnotations(k, null);\n            if (annotationList) {\n                for (var j = 0; j < annotation.annotNameCollection.length; j++) {\n                    // eslint-disable-next-line\n                    var currentAnnot = annotation.annotNameCollection[j];\n                    for (var z = 0; z < annotationList.length; z++) {\n                        if (annotationList[z].annotName === currentAnnot) {\n                            // eslint-disable-next-line\n                            var newAnnotation = annotationList[z];\n                            this.retreieveSelection(newAnnotation, null);\n                            this.pdfViewer.textSelectionModule.maintainSelection(newAnnotation.pageNumber, false);\n                        }\n                    }\n                }\n            }\n        }\n        this.isSelectionMaintained = true;\n        window.getSelection().removeAllRanges();\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.retreieveSelection = function (annotation, element) {\n        for (var k = 0; k < annotation.bounds.length; k++) {\n            // eslint-disable-next-line\n            var bound = annotation.bounds[k];\n            var x = (bound.left ? bound.left : bound.Left) * this.pdfViewerBase.getZoomFactor();\n            var y = (bound.top ? bound.top : bound.Top) * this.pdfViewerBase.getZoomFactor();\n            var width = (bound.width ? bound.width : bound.Width) * this.pdfViewerBase.getZoomFactor();\n            var height = bound.height ? bound.height : bound.Height;\n            // eslint-disable-next-line\n            var textLayer = this.pdfViewerBase.getElement('_textLayer_' + annotation.pageNumber);\n            if (textLayer) {\n                // eslint-disable-next-line\n                var textDivs = textLayer.childNodes;\n                for (var n = 0; n < textDivs.length; n++) {\n                    if (textDivs[n]) {\n                        // eslint-disable-next-line\n                        var rangebounds = textDivs[n].getBoundingClientRect();\n                        var top_1 = this.getClientValueTop(rangebounds.top, annotation.pageNumber);\n                        // eslint-disable-next-line max-len\n                        var currentLeft = rangebounds.left - this.pdfViewerBase.getElement('_pageDiv_' + annotation.pageNumber).getBoundingClientRect().left;\n                        var totalLeft = currentLeft + rangebounds.width;\n                        // eslint-disable-next-line\n                        var textDiVLeft = parseInt(textDivs[n].style.left);\n                        // eslint-disable-next-line\n                        var currentTop = parseInt(textDivs[n].style.top);\n                        var isLeftBounds = this.pdfViewer.textSelectionModule.checkLeftBounds(currentLeft, textDiVLeft, totalLeft, x);\n                        var isTopBounds = this.pdfViewer.textSelectionModule.checkTopBounds(top_1, currentTop, y);\n                        if (isLeftBounds && isTopBounds) {\n                            element = textDivs[n];\n                            break;\n                        }\n                    }\n                }\n                if (element != null) {\n                    // eslint-disable-next-line\n                    var boundingRect = this.pdfViewerBase.getElement('_textLayer_' + annotation.pageNumber).getBoundingClientRect();\n                    this.pdfViewer.textSelectionModule.textSelectionOnMouseMove(element, x + boundingRect.left, y + boundingRect.top, false);\n                    if ((annotation.bounds.length - 1) === k) {\n                        // eslint-disable-next-line max-len\n                        this.pdfViewer.textSelectionModule.textSelectionOnMouseMove(element, x + boundingRect.left + width, y + boundingRect.top, false);\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * @param x\n     * @param y\n     * @param isSelected\n     * @private\n     */\n    TextMarkupAnnotation.prototype.updatePosition = function (x, y, isSelected) {\n        this.showHideDropletDiv(false);\n        var pageTopValue = this.pdfViewerBase.pageSize[this.pdfViewerBase.currentPageNumber - 1].top;\n        var topClientValue = this.getClientValueTop(y, this.pdfViewerBase.currentPageNumber - 1);\n        // eslint-disable-next-line\n        var rightDivElement = document.getElementById(this.pdfViewer.element.id + '_droplet_right');\n        if (isSelected) {\n            // eslint-disable-next-line max-len\n            rightDivElement.style.top = topClientValue * this.pdfViewerBase.getZoomFactor() + pageTopValue * this.pdfViewerBase.getZoomFactor() + 'px';\n        }\n        else {\n            // eslint-disable-next-line max-len\n            rightDivElement.style.top = topClientValue + pageTopValue * this.pdfViewerBase.getZoomFactor() + 'px';\n        }\n        // eslint-disable-next-line max-len\n        rightDivElement.style.left = x + this.pdfViewerBase.viewerContainer.scrollLeft - this.pdfViewerBase.viewerContainer.getBoundingClientRect().left + 'px';\n    };\n    /**\n     * @param x\n     * @param y\n     * @param isSelected\n     * @param x\n     * @param y\n     * @param isSelected\n     * @private\n     */\n    TextMarkupAnnotation.prototype.updateLeftposition = function (x, y, isSelected) {\n        this.showHideDropletDiv(false);\n        var pageTopValue = this.pdfViewerBase.pageSize[this.pdfViewerBase.currentPageNumber - 1].top;\n        var topClientValue = this.getClientValueTop(y, this.pdfViewerBase.currentPageNumber - 1);\n        // eslint-disable-next-line\n        var leftDivElement = document.getElementById(this.pdfViewer.element.id + '_droplet_left');\n        leftDivElement.style.display = '';\n        if (isSelected) {\n            // eslint-disable-next-line max-len\n            leftDivElement.style.top = topClientValue * this.pdfViewerBase.getZoomFactor() + pageTopValue * this.pdfViewerBase.getZoomFactor() + 'px';\n        }\n        else {\n            // eslint-disable-next-line max-len\n            leftDivElement.style.top = topClientValue + pageTopValue * this.pdfViewerBase.getZoomFactor() + 'px';\n        }\n        // eslint-disable-next-line max-len\n        leftDivElement.style.left = x + this.pdfViewerBase.viewerContainer.scrollLeft - this.pdfViewerBase.viewerContainer.getBoundingClientRect().left - (this.dropletHeight * this.pdfViewerBase.getZoomFactor()) + 'px';\n    };\n    TextMarkupAnnotation.prototype.getClientValueTop = function (clientValue, pageNumber) {\n        if (this.pdfViewerBase.getElement('_pageDiv_' + pageNumber)) {\n            // eslint-disable-next-line max-len\n            return clientValue - this.pdfViewerBase.getElement('_pageDiv_' + pageNumber).getBoundingClientRect().top;\n        }\n        else {\n            return clientValue;\n        }\n    };\n    /**\n     * @param textMarkupAnnotations\n     * @param pageNumber\n     * @param isImportTextMarkup\n     * @param textMarkupAnnotations\n     * @param pageNumber\n     * @param isImportTextMarkup\n     * @param textMarkupAnnotations\n     * @param pageNumber\n     * @param isImportTextMarkup\n     * @private\n     */\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.renderTextMarkupAnnotationsInPage = function (textMarkupAnnotations, pageNumber, isImportTextMarkup, isAnnotOrderAction) {\n        var canvas = this.pdfViewerBase.getElement('_annotationCanvas_' + pageNumber);\n        if (isImportTextMarkup) {\n            this.renderTextMarkupAnnotations(null, pageNumber, canvas, this.pdfViewerBase.getZoomFactor());\n            this.renderTextMarkupAnnotations(textMarkupAnnotations, pageNumber, canvas, this.pdfViewerBase.getZoomFactor(), true);\n        }\n        else {\n            this.renderTextMarkupAnnotations(textMarkupAnnotations, pageNumber, canvas, this.pdfViewerBase.getZoomFactor(), null, isAnnotOrderAction);\n        }\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.renderTextMarkupAnnotations = function (textMarkupAnnotations, pageNumber, canvas, factor, isImportAction, isAnnotOrderAction) {\n        if (canvas) {\n            var context = canvas.getContext('2d');\n            context.setTransform(1, 0, 0, 1, 0, 0);\n            context.setLineDash([]);\n            // eslint-disable-next-line\n            var annotations_1;\n            if (!isImportAction && !isAnnotOrderAction) {\n                annotations_1 = this.getAnnotations(pageNumber, textMarkupAnnotations);\n            }\n            else {\n                annotations_1 = textMarkupAnnotations;\n            }\n            if (textMarkupAnnotations) {\n                textMarkupAnnotations.forEach(function (textMarkupAnnotation) {\n                    var exists = annotations_1.some(function (existingAnnotation) {\n                        return existingAnnotation.annotName === textMarkupAnnotation.AnnotName;\n                    });\n                    if (!exists) {\n                        annotations_1.push(textMarkupAnnotation);\n                    }\n                });\n            }\n            if (annotations_1) {\n                var distinctAnnotations = [];\n                for (var i = 0; i < annotations_1.length; i++) {\n                    var duplicateFound = false;\n                    for (var j = 0; j < distinctAnnotations.length; j++) {\n                        if (annotations_1[i].AnnotName === distinctAnnotations[j].AnnotName &&\n                            annotations_1[i].annotName === distinctAnnotations[j].annotName) {\n                            duplicateFound = true;\n                            break;\n                        }\n                    }\n                    if (!duplicateFound) {\n                        distinctAnnotations.push(annotations_1[i]);\n                    }\n                }\n                annotations_1 = distinctAnnotations;\n            }\n            if (annotations_1) {\n                for (var i = 0; i < annotations_1.length; i++) {\n                    // eslint-disable-next-line\n                    var annotation = annotations_1[i];\n                    var annotationObject = null;\n                    var isAnnotationRotated = void 0;\n                    if (annotation.TextMarkupAnnotationType) {\n                        if (isImportAction) {\n                            if (this.pdfViewerBase.isJsonImported) {\n                                var newArray = [];\n                                for (var i_1 = 0; i_1 < annotation.Bounds.length; i_1++) {\n                                    // eslint-disable-next-line\n                                    annotation.Bounds[i_1] = this.pdfViewerBase.importJsonForRotatedDocuments(annotation.Rotate, pageNumber, annotation.Bounds[i_1], annotation.AnnotationRotation);\n                                    annotation.Bounds[i_1].left = annotation.Bounds[i_1].X;\n                                    annotation.Bounds[i_1].top = annotation.Bounds[i_1].Y;\n                                    newArray.push(annotation.Bounds[i_1]);\n                                }\n                                annotation.Bounds = newArray;\n                                isAnnotationRotated = this.pdfViewerBase.isPageRotated;\n                            }\n                        }\n                        // eslint-disable-next-line max-len\n                        annotation.annotationAddMode = this.pdfViewer.annotationModule.findAnnotationMode(annotation, pageNumber, annotation.AnnotType);\n                        // eslint-disable-next-line max-len\n                        annotation.allowedInteractions = annotation.AllowedInteractions ? annotation.AllowedInteractions : this.pdfViewer.annotationModule.updateAnnotationAllowedInteractions(annotation);\n                        // eslint-disable-next-line max-len\n                        annotation.AnnotationSettings = annotation.AnnotationSettings ? annotation.AnnotationSettings : this.pdfViewer.annotationModule.updateAnnotationSettings(annotation);\n                        // eslint-disable-next-line max-len\n                        annotationObject = {\n                            textMarkupAnnotationType: annotation.TextMarkupAnnotationType, color: annotation.Color, allowedInteractions: annotation.allowedInteractions, opacity: annotation.Opacity, bounds: annotation.Bounds, author: annotation.Author, subject: annotation.Subject, modifiedDate: annotation.ModifiedDate, note: annotation.Note, rect: annotation.Rect,\n                            // eslint-disable-next-line max-len\n                            annotName: annotation.AnnotName, comments: this.pdfViewer.annotationModule.getAnnotationComments(annotation.Comments, annotation, annotation.Author), review: { state: annotation.State, stateModel: annotation.StateModel, modifiedDate: annotation.ModifiedDate, author: annotation.Author }, shapeAnnotationType: 'textMarkup', pageNumber: pageNumber,\n                            textMarkupContent: annotation.TextMarkupContent, textMarkupStartIndex: 0, textMarkupEndIndex: 0, annotationSelectorSettings: this.getSettings(annotation),\n                            // eslint-disable-next-line max-len\n                            customData: this.pdfViewer.annotation.getCustomData(annotation), annotationAddMode: annotation.annotationAddMode, annotationSettings: annotation.AnnotationSettings, isLocked: annotation.IsLocked, isPrint: annotation.IsPrint, isCommentLock: annotation.IsCommentLock, isAnnotationRotated: isAnnotationRotated, annotationRotation: annotation.AnnotationRotation\n                        };\n                        if (annotation.IsMultiSelect) {\n                            annotationObject.annotNameCollection = annotation.AnnotNameCollection;\n                            annotationObject.annotpageNumbers = annotation.AnnotpageNumbers;\n                            annotationObject.isMultiSelect = annotation.IsMultiSelect;\n                        }\n                        if (annotation.textMarkupContent && annotation.textMarkupContent !== '') {\n                            annotationObject.textMarkupContent = annotation.textMarkupContent;\n                            annotationObject.textMarkupStartIndex = annotation.textMarkupStartIndex;\n                            annotationObject.textMarkupEndIndex = annotation.textMarkupEndIndex;\n                        }\n                        if (isNullOrUndefined(annotation.TextMarkupContent) && isNullOrUndefined(annotation.textMarkupContent)) {\n                            var markedBounds = annotation.Bounds[0];\n                            var storedData = this.pdfViewerBase.getStoredData(pageNumber, true);\n                            if (isNullOrUndefined(storedData)) {\n                                this.pdfViewerBase.requestForTextExtraction(pageNumber, annotationObject);\n                            }\n                            else {\n                                var pageCharText = storedData.pageText.split('');\n                                var characterBounds = this.pdfViewerBase.textLayer.characterBound[pageNumber];\n                                var textMarkupContent = this.pdfViewerBase.textMarkUpContent(markedBounds, pageCharText, characterBounds);\n                                annotationObject.textMarkupContent = textMarkupContent;\n                            }\n                        }\n                        this.pdfViewer.annotationModule.storeAnnotations(pageNumber, annotationObject, '_annotations_textMarkup');\n                        if (this.isAddAnnotationProgramatically) {\n                            // eslint-disable-next-line\n                            var settings = {\n                                opacity: annotationObject.opacity, author: annotation.author, subject: annotation.subject, modifiedDate: annotation.modifiedDate,\n                                // eslint-disable-next-line\n                                width: annotationObject.bounds.width, height: annotationObject.bounds.height\n                            };\n                            this.pdfViewer.fireAnnotationAdd(annotationObject.pageNumber, annotationObject.annotName, annotation.TextMarkupAnnotationType, annotationObject.bounds, settings);\n                        }\n                    }\n                    // eslint-disable-next-line max-len\n                    var type = annotation.TextMarkupAnnotationType ? annotation.TextMarkupAnnotationType : annotation.textMarkupAnnotationType;\n                    // eslint-disable-next-line\n                    var annotBounds = annotation.Bounds ? annotation.Bounds : annotation.bounds;\n                    var opacity = annotation.Opacity ? annotation.Opacity : annotation.opacity;\n                    var color = annotation.Color ? annotation.Color : annotation.color;\n                    var annotationRotation = annotation.AnnotationRotation ? annotation.AnnotationRotation : annotation.annotationRotation;\n                    var isPrint = true;\n                    if (annotation.TextMarkupAnnotationType) {\n                        isPrint = annotation.IsPrint;\n                    }\n                    if (annotation.textMarkupAnnotationType) {\n                        isPrint = annotation.isPrint;\n                    }\n                    switch (type) {\n                        case 'Highlight':\n                            this.renderHighlightAnnotation(annotBounds, opacity, color, context, factor, isPrint, pageNumber);\n                            break;\n                        case 'Strikethrough':\n                            this.renderStrikeoutAnnotation(annotBounds, opacity, color, context, factor, pageNumber, isPrint, annotationRotation, annotation.textMarkupContent);\n                            break;\n                        case 'Underline':\n                            this.renderUnderlineAnnotation(annotBounds, opacity, color, context, factor, pageNumber, isPrint, annotationRotation);\n                            break;\n                    }\n                }\n            }\n            var isMaintainedSelector = false;\n            if (this.currentTextMarkupAnnotation && this.currentTextMarkupAnnotation.annotpageNumbers) {\n                for (var m = 0; m < this.currentTextMarkupAnnotation.annotpageNumbers.length; m++) {\n                    if (pageNumber === this.currentTextMarkupAnnotation.annotpageNumbers[m]) {\n                        isMaintainedSelector = true;\n                        this.isAnnotationSelect = false;\n                        break;\n                    }\n                }\n            }\n            if ((pageNumber === this.selectTextMarkupCurrentPage) || isMaintainedSelector) {\n                if (!this.isAnnotationSelect) {\n                    this.maintainAnnotationSelection();\n                }\n                else {\n                    this.isAnnotationSelect = false;\n                }\n            }\n        }\n    };\n    /**\n     * @param annotation\n     * @private\n     */\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.getSettings = function (annotation) {\n        var selector;\n        if (annotation.AnnotationSelectorSettings) {\n            selector = annotation.AnnotationSelectorSettings;\n        }\n        else {\n            selector = this.getSelector(annotation.TextMarkupAnnotationType);\n        }\n        return selector;\n    };\n    /**\n     * @param type\n     * @private\n     */\n    TextMarkupAnnotation.prototype.drawTextMarkupAnnotations = function (type) {\n        this.isTextMarkupAnnotationMode = true;\n        this.pdfViewer.annotationModule.isFormFieldShape = false;\n        this.currentTextMarkupAddMode = type;\n        var isCleared = true;\n        this.multiPageCollection = [];\n        var selectionObject = this.pdfViewer.textSelectionModule ? this.pdfViewer.textSelectionModule.selectionRangeArray : [];\n        if (selectionObject.length > 0 && !this.isSelectionMaintained) {\n            this.convertSelectionToTextMarkup(type, selectionObject, this.pdfViewerBase.getZoomFactor());\n        }\n        var selection = window.getSelection();\n        var targetElement;\n        if (selection && selection.anchorNode) {\n            targetElement = selection.anchorNode.parentElement;\n        }\n        if (this.isEnableTextMarkupResizer(type) && this.isExtended && window.getSelection().toString()) {\n            var pageBounds = this.getDrawnBounds();\n            if (pageBounds[0] && pageBounds[0].bounds) {\n                // eslint-disable-next-line\n                var currentAnnot = this.currentTextMarkupAnnotation;\n                for (var k = 0; k < pageBounds.length; k++) {\n                    if (currentAnnot && currentAnnot.pageNumber === pageBounds[k].pageIndex) {\n                        this.currentTextMarkupAnnotation = currentAnnot;\n                        this.selectTextMarkupCurrentPage = pageBounds[k].pageIndex;\n                        this.updateTextMarkupAnnotationBounds(pageBounds, k);\n                    }\n                    else {\n                        if (currentAnnot) {\n                            if (type === '') {\n                                type = currentAnnot.textMarkupAnnotationType;\n                            }\n                        }\n                        if (!currentAnnot.isMultiSelect) {\n                            var isMultiSelect = false;\n                            if (this.isMultiAnnotation(type)) {\n                                this.multiPageCollection.push(currentAnnot);\n                                isMultiSelect = true;\n                            }\n                            // eslint-disable-next-line max-len\n                            this.drawTextMarkups(type, pageBounds[k].bounds, pageBounds[k].pageIndex, pageBounds[k].rect, this.pdfViewerBase.getZoomFactor(), pageBounds[k].textContent, pageBounds[k].startIndex, pageBounds[k].endIndex, isMultiSelect, targetElement);\n                        }\n                        else {\n                            if (currentAnnot.isMultiSelect && currentAnnot.annotNameCollection) {\n                                this.modifyCurrentAnnotation(currentAnnot, pageBounds, k);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        else if (window.getSelection().toString()) {\n            var pageBounds = this.getDrawnBounds();\n            var isMultiSelect = this.isMultiPageAnnotations(pageBounds, type);\n            if (pageBounds.length > 0) {\n                for (var i = 0; i < pageBounds.length; i++) {\n                    if (type === '') {\n                        isCleared = false;\n                    }\n                    // eslint-disable-next-line max-len\n                    this.drawTextMarkups(type, pageBounds[i].bounds, pageBounds[i].pageIndex, pageBounds[i].rect, this.pdfViewerBase.getZoomFactor(), pageBounds[i].textContent, pageBounds[i].startIndex, pageBounds[i].endIndex, isMultiSelect, targetElement);\n                }\n            }\n        }\n        if (this.multiPageCollection) {\n            for (var j = 0; j < this.multiPageCollection.length; j++) {\n                this.updateAnnotationNames(this.multiPageCollection[j], this.multiPageCollection[j].pageNumber);\n            }\n        }\n        this.isExtended = false;\n        this.isSelectionMaintained = false;\n        // this.pdfViewerBase.annotationHelper.redoCollection = [];\n        if (isCleared && this.pdfViewer.textSelectionModule) {\n            this.pdfViewer.textSelectionModule.clearTextSelection();\n        }\n        if (this.isEnableTextMarkupResizer(type)) {\n            this.updateAnnotationBounds();\n        }\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.isMultiPageAnnotations = function (pageBounds, type) {\n        var isMultiSelect = false;\n        for (var n = 0; n < pageBounds.length; n++) {\n            if (pageBounds[n].pageIndex !== pageBounds[0].pageIndex && this.isMultiAnnotation(type)) {\n                isMultiSelect = true;\n                break;\n            }\n        }\n        return isMultiSelect;\n    };\n    TextMarkupAnnotation.prototype.isMultiAnnotation = function (type) {\n        var isSelection = false;\n        if (type === 'Highlight' && this.pdfViewer.highlightSettings.enableMultiPageAnnotation) {\n            isSelection = true;\n        }\n        else if (type === 'Underline' && this.pdfViewer.underlineSettings.enableMultiPageAnnotation) {\n            isSelection = true;\n        }\n        else if (type === 'Strikethrough' && this.pdfViewer.strikethroughSettings.enableMultiPageAnnotation) {\n            isSelection = true;\n        }\n        else if (this.pdfViewer.enableMultiPageAnnotation) {\n            isSelection = true;\n        }\n        return isSelection;\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.modifyCurrentAnnotation = function (currentAnnot, pageBounds, index) {\n        for (var c = 0; c < currentAnnot.annotNameCollection.length; c++) {\n            // eslint-disable-next-line\n            var currentAnnots = currentAnnot.annotNameCollection[c];\n            var annotationList = this.getAnnotations(pageBounds[index].pageIndex, null);\n            if (annotationList) {\n                for (var z = 0; z < annotationList.length; z++) {\n                    if (annotationList[z].annotName === currentAnnots) {\n                        this.currentTextMarkupAnnotation = annotationList[z];\n                        this.selectTextMarkupCurrentPage = pageBounds[index].pageIndex;\n                        this.updateTextMarkupAnnotationBounds(pageBounds, index);\n                        break;\n                    }\n                }\n            }\n        }\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.drawAnnotationSelector = function (newAnnotation, annotation, newcanvas) {\n        var newBounds = [];\n        var x = 0;\n        var y = 0;\n        var width = 0;\n        var height = 0;\n        var currentTop = 0;\n        var nextTop = 0;\n        var currentLeft = 0;\n        var nextLeft = 0;\n        var currentRotation = 0;\n        var nextRotation = 0;\n        for (var i = 0; i < newAnnotation.bounds.length; i++) {\n            currentTop = newAnnotation.bounds[i].top ? newAnnotation.bounds[i].top : newAnnotation.bounds[i].Top;\n            nextTop = !isNullOrUndefined(newAnnotation.bounds[i + 1]) ? newAnnotation.bounds[i + 1].top ? newAnnotation.bounds[i + 1].top : newAnnotation.bounds[i + 1].Top : 0;\n            var rotation_0_180_exists = void 0;\n            if (this.pdfViewerBase.clientSideRendering) {\n                currentLeft = newAnnotation.bounds[i].left ? newAnnotation.bounds[i].left : newAnnotation.bounds[i].Left;\n                nextLeft = !isNullOrUndefined(newAnnotation.bounds[i + 1]) ? newAnnotation.bounds[i + 1].left ? newAnnotation.bounds[i + 1].left : newAnnotation.bounds[i + 1].Left : 0;\n                currentRotation = newAnnotation.bounds[i].rotation;\n                nextRotation = !isNullOrUndefined(newAnnotation.bounds[i + 1]) ? newAnnotation.bounds[i + 1].rotation : 0;\n                rotation_0_180_exists = (currentRotation == 0) || (currentRotation == 180);\n            }\n            if (newAnnotation.bounds.length > 1 && i < newAnnotation.bounds.length - 1 && currentTop === nextTop) {\n                newBounds.push(newAnnotation.bounds[i]);\n            }\n            else {\n                if (i === newAnnotation.bounds.length - 1 || newAnnotation.bounds.length >= 1) {\n                    newBounds.push(newAnnotation.bounds[i]);\n                }\n                if (newBounds.length >= 1) {\n                    if (this.pdfViewerBase.clientSideRendering) {\n                        var boundsLength = newBounds.length - 1;\n                        x = newBounds.reduce(function (min, rect) { return (rect.left ? rect.left : rect.Left || 0) < min ? (rect.left ? rect.left : rect.Left || 0) : min; }, Infinity);\n                        y = newBounds.reduce(function (min, rect) { return (rect.top ? rect.top : rect.Top || 0) < min ? (rect.top ? rect.top : rect.Top || 0) : min; }, Infinity);\n                        if (rotation_0_180_exists) {\n                            height = newBounds[0].height ? newBounds[0].height : newBounds[0].Height;\n                            width = newBounds.reduce(function (sum, rect) { return sum + (rect.width ? rect.width : rect.Width || 0); }, 0);\n                        }\n                        else {\n                            width += newBounds[0].width ? newBounds[0].width : newBounds[0].Width;\n                            height = newBounds.reduce(function (sum, rect) { return sum + (rect.height ? rect.height : rect.Height || 0); }, 0);\n                        }\n                    }\n                    else {\n                        x = newBounds[0].left ? newBounds[0].left : newBounds[0].Left;\n                        y = newBounds[0].top ? newBounds[0].top : newBounds[0].Top;\n                        height = newBounds[0].height ? newBounds[0].height : newBounds[0].Height;\n                        for (var j = 0; j < newBounds.length; j++) {\n                            if ((!isNaN(newBounds[j].width) && newBounds[j].width > 0) || (!isNaN(newBounds[j].Width) && newBounds[j].Width > 0)) {\n                                width += newBounds[j].width ? newBounds[j].width : newBounds[j].Width;\n                            }\n                        }\n                        if (!newcanvas) {\n                            newcanvas = this.pdfViewerBase.getElement('_annotationCanvas_' + newAnnotation.pageNumber);\n                        }\n                        // eslint-disable-next-line max-len\n                        this.drawAnnotationSelectRect(newcanvas, this.getMagnifiedValue(x - 0.5, this.pdfViewerBase.getZoomFactor()), this.getMagnifiedValue(y - 0.5, this.pdfViewerBase.getZoomFactor()), this.getMagnifiedValue(width + 0.5, this.pdfViewerBase.getZoomFactor()), this.getMagnifiedValue(height + 0.5, this.pdfViewerBase.getZoomFactor()), annotation);\n                        newBounds = [];\n                        width = 0;\n                    }\n                }\n                if (this.pdfViewerBase.clientSideRendering) {\n                    if (!newcanvas) {\n                        newcanvas = this.pdfViewerBase.getElement('_annotationCanvas_' + newAnnotation.pageNumber);\n                    }\n                    // eslint-disable-next-line max-len\n                    this.drawAnnotationSelectRect(newcanvas, this.getMagnifiedValue(x - 0.5, this.pdfViewerBase.getZoomFactor()), this.getMagnifiedValue(y - 0.5, this.pdfViewerBase.getZoomFactor()), this.getMagnifiedValue(width + 0.5, this.pdfViewerBase.getZoomFactor()), this.getMagnifiedValue(height + 0.5, this.pdfViewerBase.getZoomFactor()), annotation);\n                    newBounds = [];\n                    width = 0;\n                    height = 0;\n                }\n            }\n        }\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.selectMultiPageAnnotations = function (annotation) {\n        for (var k = 0; k < annotation.annotNameCollection.length; k++) {\n            // eslint-disable-next-line\n            var currentAnnot = annotation.annotNameCollection[k];\n            if (currentAnnot !== annotation.annotName) {\n                for (var p = 0; p < annotation.annotpageNumbers.length; p++) {\n                    var currentPage = annotation.annotpageNumbers[p];\n                    var annotationList = this.getAnnotations(currentPage, null);\n                    if (annotationList) {\n                        for (var z = 0; z < annotationList.length; z++) {\n                            if (annotationList[z].annotName === currentAnnot) {\n                                // eslint-disable-next-line\n                                var newAnnotation = annotationList[z];\n                                this.drawAnnotationSelector(newAnnotation, annotation);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.deletMultiPageAnnotation = function (annotation) {\n        for (var k = 0; k < annotation.annotNameCollection.length; k++) {\n            // eslint-disable-next-line\n            var currentAnnot = annotation.annotNameCollection[k];\n            if (currentAnnot !== annotation.annotName) {\n                for (var p = 0; p < annotation.annotpageNumbers.length; p++) {\n                    var currentPage = annotation.annotpageNumbers[p];\n                    var annotationList = this.getAnnotations(currentPage, null);\n                    if (annotationList) {\n                        for (var z = 0; z < annotationList.length; z++) {\n                            if (annotationList[z].annotName === currentAnnot) {\n                                // eslint-disable-next-line\n                                var newAnnotation = annotationList[z];\n                                var deletedAnnotation = null;\n                                deletedAnnotation = annotationList.splice(z, 1)[0];\n                                this.pdfViewer.annotationModule.addAction(currentPage, z, deletedAnnotation, 'Text Markup Deleted', null);\n                                this.currentAnnotationIndex = z;\n                                this.pdfViewer.annotation.stickyNotesAnnotationModule.findPosition(deletedAnnotation, 'textMarkup');\n                                var removeDiv = document.getElementById(deletedAnnotation.annotName);\n                                if (removeDiv) {\n                                    if (removeDiv.parentElement.childElementCount === 1) {\n                                        this.pdfViewer.annotationModule.stickyNotesAnnotationModule.updateAccordionContainer(removeDiv);\n                                    }\n                                    else {\n                                        removeDiv.remove();\n                                    }\n                                }\n                                this.pdfViewer.annotationModule.updateAnnotationCollection(newAnnotation);\n                                this.manageAnnotations(annotationList, currentPage);\n                                // eslint-disable-next-line max-len\n                                this.pdfViewer.annotationModule.updateImportAnnotationCollection(newAnnotation, newAnnotation.pageNumber, 'textMarkupAnnotation');\n                                var annotationId = newAnnotation.annotName;\n                                // eslint-disable-next-line\n                                var annotationBounds = newAnnotation.bounds;\n                                this.pdfViewer.annotationModule.renderAnnotations(currentPage, null, null, null);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.modifyMultiPageAnnotations = function (annotation, property, value) {\n        for (var k = 0; k < annotation.annotNameCollection.length; k++) {\n            // eslint-disable-next-line\n            var currentAnnot = annotation.annotNameCollection[k];\n            if (currentAnnot !== annotation.annotName) {\n                for (var p = 0; p < annotation.annotpageNumbers.length; p++) {\n                    var currentPage = annotation.annotpageNumbers[p];\n                    var annotationList = this.getAnnotations(currentPage, null);\n                    if (annotationList) {\n                        for (var z = 0; z < annotationList.length; z++) {\n                            if (annotationList[z].annotName === currentAnnot) {\n                                if (property === 'Color') {\n                                    annotationList[z].color = value;\n                                }\n                                else {\n                                    annotationList[z].opacity = value;\n                                }\n                                annotationList[z].modifiedDate = this.pdfViewer.annotation.stickyNotesAnnotationModule.getDateAndTime();\n                                this.currentAnnotationIndex = z;\n                                if (status === null || status === 'changed') {\n                                    // eslint-disable-next-line max-len\n                                    this.pdfViewer.annotationModule.addAction(annotationList[z].pageNumber, z, annotationList[z], 'Text Markup Property modified', property);\n                                }\n                                this.pdfViewer.annotationModule.stickyNotesAnnotationModule.updateAnnotationModifiedDate(annotationList[z]);\n                                this.manageAnnotations(annotationList, currentPage);\n                                this.pdfViewer.annotationModule.renderAnnotations(currentPage, null, null, null);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    };\n    TextMarkupAnnotation.prototype.convertSelectionToTextMarkup = function (type, selectionObject, factor) {\n        var isMultiSelect = false;\n        this.triggerAddEvent = false;\n        this.multiPageCollection = [];\n        for (var i = 0; i < selectionObject.length; i++) {\n            var textValue = selectionObject[i].textContent;\n            // eslint-disable-next-line\n            var indexes = void 0;\n            if (selectionObject[i].startNode === selectionObject[i].endNode) {\n                var parentText = document.getElementById(selectionObject[i].startNode).textContent;\n                indexes = this.getIndexNumbers(selectionObject[i].pageNumber, textValue, parentText);\n            }\n            else {\n                indexes = this.getIndexNumbers(selectionObject[i].pageNumber, textValue);\n            }\n            if (!isMultiSelect) {\n                for (var n = 1; n < selectionObject.length; n++) {\n                    if (selectionObject[n].pageNumber !== selectionObject[0].pageNumber && this.isMultiAnnotation(type)) {\n                        isMultiSelect = true;\n                        break;\n                    }\n                }\n            }\n            if (this.isMultiAnnotation(type) && (selectionObject.length - 1) === i) {\n                this.triggerAddEvent = true;\n            }\n            // eslint-disable-next-line max-len\n            this.drawTextMarkups(type, selectionObject[i].rectangleBounds, selectionObject[i].pageNumber, selectionObject[i].bound, factor, textValue, indexes.startIndex, indexes.endIndex, isMultiSelect, document.getElementById(selectionObject[i].startNode));\n        }\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.updateTextMarkupAnnotationBounds = function (pageBounds, currentIndex) {\n        if (this.currentTextMarkupAnnotation) {\n            var pageAnnotations = this.getAnnotations(pageBounds[currentIndex].pageIndex, null);\n            var annotation = null;\n            if (pageAnnotations) {\n                for (var i = 0; i < pageAnnotations.length; i++) {\n                    if (JSON.stringify(this.currentTextMarkupAnnotation) === JSON.stringify(pageAnnotations[i])) {\n                        pageAnnotations[i].bounds = pageBounds[currentIndex].bounds;\n                        pageAnnotations[i].textMarkupContent = pageBounds[currentIndex].textContent;\n                        pageAnnotations[i].textMarkupStartIndex = pageBounds[currentIndex].startIndex;\n                        pageAnnotations[i].textMarkupEndIndex = pageBounds[currentIndex].endIndex;\n                        pageAnnotations[i].modifiedDate = this.pdfViewer.annotation.stickyNotesAnnotationModule.getDateAndTime();\n                        annotation = pageAnnotations[i];\n                    }\n                }\n                this.manageAnnotations(pageAnnotations, pageBounds[currentIndex].pageIndex);\n                this.currentTextMarkupAnnotation = null;\n                this.pdfViewer.annotationModule.renderAnnotations(pageBounds[currentIndex].pageIndex, null, null, null);\n                this.pdfViewerBase.updateDocumentEditedProperty(true);\n                if (annotation) {\n                    // eslint-disable-next-line\n                    var settings = { opacity: annotation.opacity, color: annotation.color, author: annotation.author, subject: annotation.subject, modifiedDate: annotation.modifiedDate };\n                    // eslint-disable-next-line max-len\n                    var multiPageCollection = this.multiPageCollectionList(annotation);\n                    if (multiPageCollection.length > 0) {\n                        if ((pageBounds.length - 1) === currentIndex) {\n                            // eslint-disable-next-line max-len\n                            this.pdfViewer.fireAnnotationResize(pageBounds[currentIndex].pageIndex, annotation.annotName, annotation.textMarkupAnnotationType, annotation.bounds, settings, annotation.textMarkupContent, annotation.textMarkupStartIndex, annotation.textMarkupEndIndex, null, multiPageCollection);\n                        }\n                    }\n                    else {\n                        // eslint-disable-next-line max-len\n                        this.pdfViewer.fireAnnotationResize(pageBounds[currentIndex].pageIndex, annotation.annotName, annotation.textMarkupAnnotationType, annotation.bounds, settings, annotation.textMarkupContent, annotation.textMarkupStartIndex, annotation.textMarkupEndIndex, null);\n                    }\n                }\n                // eslint-disable-next-line max-len\n                this.currentAnnotationIndex = null;\n                this.selectTextMarkupCurrentPage = null;\n            }\n        }\n    };\n    /**\n     * @param annotation\n     * @private\n     */\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.multiPageCollectionList = function (annotation) {\n        var multiPageCollectionList = [];\n        if (annotation.isMultiSelect && annotation.annotNameCollection) {\n            multiPageCollectionList.push(annotation);\n            for (var k = 0; k < annotation.annotNameCollection.length; k++) {\n                // eslint-disable-next-line\n                var currentAnnot = annotation.annotNameCollection[k];\n                if (currentAnnot !== annotation.annotName) {\n                    for (var p = 0; p < annotation.annotpageNumbers.length; p++) {\n                        var currentPage = annotation.annotpageNumbers[p];\n                        var annotationList = this.getAnnotations(currentPage, null);\n                        if (annotationList) {\n                            for (var z = 0; z < annotationList.length; z++) {\n                                if (annotationList[z].annotName === currentAnnot) {\n                                    multiPageCollectionList.push(annotationList[z]);\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        return multiPageCollectionList;\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.updateAnnotationNames = function (annotations, pageNumber) {\n        if (annotations) {\n            var pageAnnotations = this.getAnnotations(pageNumber, null);\n            var annotation = null;\n            if (pageAnnotations) {\n                for (var i = 0; i < pageAnnotations.length; i++) {\n                    if (annotations.annotName === pageAnnotations[i].annotName) {\n                        // eslint-disable-next-line\n                        var annotNamesCollections = [];\n                        // eslint-disable-next-line\n                        var annotpageNumbers = [];\n                        for (var p = 0; p < this.multiPageCollection.length; p++) {\n                            annotNamesCollections.push(this.multiPageCollection[p].annotName);\n                            annotpageNumbers.push(this.multiPageCollection[p].pageNumber);\n                        }\n                        pageAnnotations[i].isMultiSelect = true;\n                        pageAnnotations[i].annotNameCollection = annotNamesCollections;\n                        pageAnnotations[i].annotpageNumbers = annotpageNumbers;\n                        annotation = pageAnnotations[i];\n                    }\n                }\n                this.manageAnnotations(pageAnnotations, pageNumber);\n            }\n        }\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.updateAnnotationContent = function (annotation, pageBound) {\n        if (annotation) {\n            var pageAnnotations = this.getAnnotations(this.selectTextMarkupCurrentPage, null);\n            var annotation_1 = null;\n            if (pageAnnotations) {\n                for (var i = 0; i < pageAnnotations.length; i++) {\n                    if (JSON.stringify(this.currentTextMarkupAnnotation) === JSON.stringify(pageAnnotations[i])) {\n                        pageAnnotations[i].textMarkupContent = pageBound.textContent;\n                        pageAnnotations[i].textMarkupStartIndex = pageBound.startIndex;\n                        pageAnnotations[i].textMarkupEndIndex = pageBound.endIndex;\n                        annotation_1 = pageAnnotations[i];\n                    }\n                    this.pdfViewer.annotationModule.storeAnnotationCollections(pageAnnotations[i], this.selectTextMarkupCurrentPage);\n                }\n                this.manageAnnotations(pageAnnotations, this.selectTextMarkupCurrentPage);\n            }\n        }\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.drawTextMarkups = function (type, bounds, pageNumber, rect, factor, textContent, startIndex, endIndex, isMultiSelect, targetElement) {\n        var annotation = null;\n        this.isNewAnnotation = false;\n        var author = 'Guest';\n        var subject;\n        var context = this.getPageContext(pageNumber);\n        var modifiedDate = this.pdfViewer.annotation.stickyNotesAnnotationModule.getDateAndTime();\n        this.highlightColor = this.highlightColor ? this.highlightColor : this.pdfViewer.highlightSettings.color ? this.pdfViewer.highlightSettings.color : '#FFDF56';\n        this.underlineColor = this.underlineColor ? this.underlineColor : this.pdfViewer.underlineSettings.color ? this.pdfViewer.underlineSettings.color : '#00ff00';\n        this.strikethroughColor = this.strikethroughColor ? this.strikethroughColor : this.pdfViewer.strikethroughSettings.color ? this.pdfViewer.strikethroughSettings.color : '#ff0000';\n        this.highlightOpacity = this.pdfViewer.highlightSettings.opacity;\n        this.underlineOpacity = this.pdfViewer.underlineSettings.opacity;\n        this.strikethroughOpacity = this.pdfViewer.strikethroughSettings.opacity;\n        this.annotationAddMode = 'UI Drawn Annotation';\n        // eslint-disable-next-line\n        var allowedInteractions;\n        var pageDetails = this.pdfViewerBase.pageSize[pageNumber];\n        var annotationRotate = 0;\n        var pageRotation = this.getAngle(pageDetails.rotation);\n        if (context) {\n            context.setLineDash([]);\n            switch (type) {\n                case 'Highlight':\n                    this.isNewAnnotation = true;\n                    subject = (this.pdfViewer.highlightSettings.subject !== \"\" && this.pdfViewer.highlightSettings.subject) ? this.pdfViewer.highlightSettings.subject : this.pdfViewer.annotationSettings.subject ? this.pdfViewer.annotationSettings.subject : 'Highlight';\n                    // eslint-disable-next-line max-len\n                    author = (this.pdfViewer.highlightSettings.author !== 'Guest' && this.pdfViewer.highlightSettings.author) ? this.pdfViewer.highlightSettings.author : this.pdfViewer.annotationSettings.author ? this.pdfViewer.annotationSettings.author : 'Guest';\n                    allowedInteractions = this.pdfViewer.highlightSettings.allowedInteractions ? this.pdfViewer.highlightSettings.allowedInteractions : ['None'];\n                    // eslint-disable-next-line max-len\n                    if (isNullOrUndefined(this.highlightOpacity)) {\n                        this.highlightOpacity = 1;\n                    }\n                    annotation = this.getAddedAnnotation(type, this.highlightColor, this.highlightOpacity, bounds, author, subject, modifiedDate, '', false, rect, pageNumber, textContent, startIndex, endIndex, isMultiSelect, allowedInteractions, annotationRotate);\n                    if (annotation) {\n                        // eslint-disable-next-line max-len\n                        this.renderHighlightAnnotation(annotation.bounds, annotation.opacity, annotation.color, context, factor, annotation.isPrint, pageNumber);\n                    }\n                    break;\n                case 'Strikethrough':\n                    this.isNewAnnotation = true;\n                    subject = (this.pdfViewer.strikethroughSettings.subject !== \"\" && this.pdfViewer.strikethroughSettings.subject) ? this.pdfViewer.strikethroughSettings.subject : this.pdfViewer.annotationSettings.subject ? this.pdfViewer.annotationSettings.subject : 'Strikethrough';\n                    // eslint-disable-next-line max-len\n                    author = (this.pdfViewer.strikethroughSettings.author !== 'Guest' && this.pdfViewer.strikethroughSettings.author) ? this.pdfViewer.strikethroughSettings.author : this.pdfViewer.annotationSettings.author ? this.pdfViewer.annotationSettings.author : 'Guest';\n                    allowedInteractions = this.pdfViewer.strikethroughSettings.allowedInteractions ? this.pdfViewer.strikethroughSettings.allowedInteractions : ['None'];\n                    // eslint-disable-next-line max-len\n                    if (targetElement && targetElement.style.transform !== '') {\n                        if (targetElement.style.transform.startsWith('rotate(90deg)')) {\n                            annotationRotate = Math.abs(pageRotation - 90);\n                        }\n                        else if (targetElement.style.transform.startsWith('rotate(180deg)')) {\n                            annotationRotate = Math.abs(pageRotation - 180);\n                        }\n                        else if (targetElement.style.transform.startsWith('rotate(-90deg)')) {\n                            annotationRotate = Math.abs(pageRotation - 270);\n                        }\n                        else {\n                            annotationRotate = pageRotation;\n                        }\n                    }\n                    if (isNullOrUndefined(this.strikethroughOpacity)) {\n                        this.strikethroughOpacity = 1;\n                    }\n                    annotation = this.getAddedAnnotation(type, this.strikethroughColor, this.strikethroughOpacity, bounds, author, subject, modifiedDate, '', false, rect, pageNumber, textContent, startIndex, endIndex, isMultiSelect, allowedInteractions, annotationRotate);\n                    if (annotation) {\n                        // eslint-disable-next-line max-len\n                        this.renderStrikeoutAnnotation(annotation.bounds, annotation.opacity, annotation.color, context, factor, pageNumber, annotation.isPrint, annotation.annotationRotation, annotation.textMarkupContent);\n                    }\n                    break;\n                case 'Underline':\n                    this.isNewAnnotation = true;\n                    subject = (this.pdfViewer.underlineSettings.subject !== \"\" && this.pdfViewer.underlineSettings.subject) ? this.pdfViewer.underlineSettings.subject : this.pdfViewer.annotationSettings.subject ? this.pdfViewer.annotationSettings.subject : 'Underline';\n                    // eslint-disable-next-line max-len\n                    author = (this.pdfViewer.underlineSettings.author !== 'Guest' && this.pdfViewer.underlineSettings.author) ? this.pdfViewer.underlineSettings.author : this.pdfViewer.annotationSettings.author ? this.pdfViewer.annotationSettings.author : 'Guest';\n                    allowedInteractions = this.pdfViewer.underlineSettings.allowedInteractions ? this.pdfViewer.underlineSettings.allowedInteractions : ['None'];\n                    // eslint-disable-next-line max-len\n                    if (targetElement && targetElement.style.transform !== '') {\n                        if (targetElement.style.transform.startsWith('rotate(90deg)')) {\n                            annotationRotate = Math.abs(pageRotation - 90);\n                        }\n                        else if (targetElement.style.transform.startsWith('rotate(180deg)')) {\n                            annotationRotate = Math.abs(pageRotation - 180);\n                        }\n                        else if (targetElement.style.transform.startsWith('rotate(-90deg)')) {\n                            annotationRotate = Math.abs(pageRotation - 270);\n                        }\n                        else {\n                            annotationRotate = pageRotation;\n                        }\n                    }\n                    if (isNullOrUndefined(this.underlineOpacity)) {\n                        this.underlineOpacity = 1;\n                    }\n                    annotation = this.getAddedAnnotation(type, this.underlineColor, this.underlineOpacity, bounds, author, subject, modifiedDate, '', false, rect, pageNumber, textContent, startIndex, endIndex, isMultiSelect, allowedInteractions, annotationRotate);\n                    if (annotation) {\n                        // eslint-disable-next-line max-len\n                        this.renderUnderlineAnnotation(annotation.bounds, annotation.opacity, annotation.color, context, factor, pageNumber, annotation.isPrint, annotation.annotationRotation);\n                    }\n                    break;\n            }\n            this.isNewAnnotation = false;\n            if (annotation) {\n                this.pdfViewerBase.updateDocumentEditedProperty(true);\n                // eslint-disable-next-line\n                var settings = { opacity: annotation.opacity, color: annotation.color, author: annotation.author, subject: annotation.subject, modifiedDate: annotation.modifiedDate };\n                var index = this.pdfViewer.annotationModule.actionCollection[this.pdfViewer.annotationModule.actionCollection.length - 1].index;\n                // eslint-disable-next-line max-len\n                if (this.isMultiAnnotation(type)) {\n                    if (this.triggerAddEvent) {\n                        // eslint-disable-next-line max-len\n                        this.pdfViewer.fireAnnotationAdd(pageNumber, annotation.annotName, type, annotation.bounds, settings, textContent, startIndex, endIndex, null, this.multiPageCollection);\n                    }\n                }\n                else {\n                    // eslint-disable-next-line max-len\n                    this.pdfViewer.fireAnnotationAdd(pageNumber, annotation.annotName, type, annotation.bounds, settings, textContent, startIndex, endIndex);\n                }\n            }\n            if (Browser.isDevice && !this.pdfViewer.enableDesktopMode && this.pdfViewer.enableToolbar && this.pdfViewer.enableAnnotationToolbar) {\n                this.pdfViewer.toolbarModule.annotationToolbarModule.createPropertyTools(type);\n            }\n        }\n    };\n    TextMarkupAnnotation.prototype.getAngle = function (rotation) {\n        // eslint-disable-next-line\n        var angle = 0;\n        if (rotation) {\n            switch (rotation) {\n                case 0:\n                    angle = 0;\n                    break;\n                case 1:\n                    angle = 90;\n                    break;\n                case 2:\n                    angle = 180;\n                    break;\n                case 3:\n                    angle = 270;\n                    break;\n            }\n        }\n        return angle;\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.retreiveTextIndex = function (annotation) {\n        if (annotation.textMarkupContent === '') {\n            this.retreieveSelection(annotation, null);\n            var pageBounds = this.getDrawnBounds();\n            window.getSelection().removeAllRanges();\n            if (pageBounds[0] && pageBounds[0].bounds) {\n                this.updateAnnotationContent(annotation, pageBounds[0]);\n                annotation.textMarkupContent = pageBounds[0].textContent;\n                annotation.textMarkupStartIndex = pageBounds[0].startIndex;\n                annotation.textMarkupEndIndex = pageBounds[0].endIndex;\n            }\n        }\n        return annotation;\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.renderHighlightAnnotation = function (bounds, opacity, color, context, factor, isPrint, pageIndex) {\n        var zoomRatio = this.pdfViewerBase.getZoomRatio(factor);\n        for (var i = 0; i < bounds.length; i++) {\n            // eslint-disable-next-line\n            var bound = bounds[i];\n            context.beginPath();\n            var x = bound.X ? bound.X : bound.left;\n            var y = bound.Y ? bound.Y : bound.top;\n            var width = bound.Width ? bound.Width : bound.width;\n            var height = bound.Height ? bound.Height : bound.height;\n            var rotation = bound.Rotation ? bound.Rotation : bound.rotation;\n            x = x ? x : bound.x;\n            y = y ? y : bound.y;\n            // The highlighted position is slightly increased. So Subtract -1 from the height. \n            if (this.pdfViewerBase.clientSideRendering) {\n                if (rotation >= 0) {\n                    rotation = Math.abs(rotation) / 90;\n                }\n                if (rotation == 0 || rotation == 2) {\n                    height = height - 1;\n                }\n                else if (rotation == 1 || rotation == 3) {\n                    width = width - 1;\n                }\n            }\n            else {\n                height = height - 1;\n            }\n            if (context.canvas.id === this.pdfViewer.element.id + '_print_annotation_layer_' + pageIndex) {\n                if (isPrint) {\n                    // eslint-disable-next-line max-len\n                    context.rect((x * zoomRatio), (y * zoomRatio), (width * zoomRatio), (height * zoomRatio));\n                    context.globalAlpha = opacity * 0.5;\n                    context.closePath();\n                    context.fillStyle = color;\n                    context.msFillRule = 'nonzero';\n                    context.fill();\n                }\n            }\n            else {\n                // eslint-disable-next-line max-len\n                context.rect((x * zoomRatio), (y * zoomRatio), (width * zoomRatio), (height * zoomRatio));\n                context.globalAlpha = opacity * 0.5;\n                context.closePath();\n                context.fillStyle = color;\n                context.msFillRule = 'nonzero';\n                context.fill();\n            }\n        }\n        context.save();\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.renderStrikeoutAnnotation = function (bounds, opacity, color, context, factor, pageNumber, isPrint, annotationRotation, textContent) {\n        for (var i = 0; i < bounds.length; i++) {\n            // eslint-disable-next-line\n            var bound = this.getProperBounds(bounds[i]);\n            var pageDetails = this.pdfViewerBase.pageSize[pageNumber];\n            var factorRatio = this.pdfViewerBase.getZoomRatio(factor);\n            var rotation = pageDetails.rotation;\n            if (annotationRotation || (this.pdfViewerBase.clientSideRendering && bounds[i].rotation)) {\n                var pageRotation = this.getAngle(rotation);\n                rotation = this.pdfViewerBase.clientSideRendering ? Math.abs(bounds[i].rotation) / 90 : Math.abs(annotationRotation - pageRotation) / 90;\n            }\n            if (context.canvas.id === this.pdfViewer.element.id + '_print_annotation_layer_' + pageNumber) {\n                if (isPrint) {\n                    if (rotation === 1) {\n                        // eslint-disable-next-line max-len\n                        this.drawLine(opacity, (bound.x + (bound.width / 2)), bound.y, bound.width, bound.height, color, factorRatio, context, pageNumber, this.pdfViewerBase.clientSideRendering ? bounds[i].rotation : annotationRotation, textContent);\n                    }\n                    else if (rotation === 2) {\n                        // eslint-disable-next-line max-len\n                        this.drawLine(opacity, bound.x, (bound.y + (bound.height / 2)), bound.width, bound.height, color, factorRatio, context, pageNumber, this.pdfViewerBase.clientSideRendering ? bounds[i].rotation : annotationRotation, textContent);\n                    }\n                    else if (rotation === 3) {\n                        this.drawLine(opacity, bound.x, bound.y, (bound.width / 2), bound.height, color, factorRatio, context, pageNumber, this.pdfViewerBase.clientSideRendering ? bounds[i].rotation : annotationRotation, textContent);\n                    }\n                    else {\n                        this.drawLine(opacity, bound.x, bound.y, bound.width, (bound.height / 2), color, factorRatio, context, pageNumber, this.pdfViewerBase.clientSideRendering ? bounds[i].rotation : annotationRotation, textContent);\n                    }\n                }\n            }\n            else {\n                if (rotation === 1) {\n                    // eslint-disable-next-line max-len\n                    this.drawLine(opacity, (bound.x + (bound.width / 2)), bound.y, bound.width, bound.height, color, factorRatio, context, pageNumber, this.pdfViewerBase.clientSideRendering ? bounds[i].rotation : annotationRotation, textContent);\n                }\n                else if (rotation === 2) {\n                    // eslint-disable-next-line max-len\n                    this.drawLine(opacity, bound.x, (bound.y + (bound.height / 2)), bound.width, bound.height, color, factorRatio, context, pageNumber, this.pdfViewerBase.clientSideRendering ? bounds[i].rotation : annotationRotation, textContent);\n                }\n                else if (rotation === 3) {\n                    this.drawLine(opacity, bound.x, bound.y, (bound.width / 2), bound.height, color, factorRatio, context, pageNumber, this.pdfViewerBase.clientSideRendering ? bounds[i].rotation : annotationRotation, textContent);\n                }\n                else {\n                    this.drawLine(opacity, bound.x, bound.y, bound.width, (bound.height / 2), color, factorRatio, context, pageNumber, this.pdfViewerBase.clientSideRendering ? bounds[i].rotation : annotationRotation, textContent);\n                }\n            }\n        }\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.renderUnderlineAnnotation = function (bounds, opacity, color, context, factor, pageNumber, isPrint, annotationRotation) {\n        for (var i = 0; i < bounds.length; i++) {\n            // eslint-disable-next-line\n            var boundValues = this.getProperBounds(bounds[i]);\n            var factorRatio = this.pdfViewerBase.getZoomRatio(factor);\n            if (context.canvas.id === this.pdfViewer.element.id + '_print_annotation_layer_' + pageNumber) {\n                if (isPrint) {\n                    // eslint-disable-next-line max-len\n                    this.drawLine(opacity, boundValues.x, boundValues.y, boundValues.width, boundValues.height, color, factorRatio, context, pageNumber, this.pdfViewerBase.clientSideRendering ? bounds[i].rotation : annotationRotation);\n                }\n            }\n            else {\n                // eslint-disable-next-line max-len\n                this.drawLine(opacity, boundValues.x, boundValues.y, boundValues.width, boundValues.height, color, factorRatio, context, pageNumber, this.pdfViewerBase.clientSideRendering ? bounds[i].rotation : annotationRotation);\n            }\n        }\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.getProperBounds = function (bound) {\n        var x = bound.X ? bound.X : bound.left;\n        var y = bound.Y ? bound.Y : bound.top;\n        var width = bound.Width ? bound.Width : bound.width;\n        var height = bound.Height ? bound.Height : bound.height;\n        x = x ? x : bound.x;\n        y = y ? y : bound.y;\n        return { x: x, y: y, width: width, height: height };\n    };\n    TextMarkupAnnotation.prototype.isChineseLanguage = function (textContent) {\n        var chineseRegex = /[\\u4e00-\\u9fff]/;\n        // Check if the text contains Chinese characters\n        var isChinese = chineseRegex.test(textContent);\n        if (isChinese) {\n            return true;\n        }\n        else {\n            return false;\n        }\n    };\n    // eslint-disable-next-line max-len\n    TextMarkupAnnotation.prototype.drawLine = function (opacity, x, y, width, height, color, factor, context, pageNumber, annotationRotation, textContent) {\n        context.globalAlpha = opacity;\n        if (isBlazor()) {\n            y = y - 1;\n        }\n        if (this.isChineseLanguage(textContent)) {\n            height = height - 1.5;\n        }\n        if (!this.pdfViewerBase.clientSideRendering && !this.isChineseLanguage(textContent)) {\n            height = height - 1;\n        }\n        context.beginPath();\n        var pageDetails = this.pdfViewerBase.pageSize[pageNumber];\n        var rotation = pageDetails.rotation;\n        if (annotationRotation || (this.pdfViewerBase.clientSideRendering && annotationRotation >= 0)) {\n            var pageRotation = this.getAngle(rotation);\n            rotation = this.pdfViewerBase.clientSideRendering ? Math.abs(annotationRotation) / 90 : Math.abs(annotationRotation - pageRotation) / 90;\n        }\n        if (this.pdfViewerBase.clientSideRendering) {\n            if (rotation == 0 || rotation == 2) {\n                height = height - 1;\n            }\n            else if (rotation == 1 || rotation == 3) {\n                width = width - 1;\n            }\n        }\n        if (rotation === 1) {\n            context.moveTo((x * factor), (y * factor));\n            context.lineTo((x * factor), (y + height) * factor);\n        }\n        else if (rotation === 2) {\n            context.moveTo((x * factor), (y * factor));\n            context.lineTo((width + x) * factor, (y * factor));\n        }\n        else if (rotation === 3) {\n            context.moveTo((width + x) * factor, (y * factor));\n            context.lineTo((width + x) * factor, (y + height) * factor);\n        }\n        else {\n            context.moveTo((x * factor), (y + height) * factor);\n            context.lineTo((width + x) * factor, (y + height) * factor);\n        }\n        context.lineWidth = 1;\n        context.strokeStyle = color;\n        context.closePath();\n        context.msFillRule = 'nonzero';\n        context.stroke();\n    };\n    /**\n     * @param textMarkupAnnotations\n     * @param pageIndex\n     * @param stampData\n     * @param shapeData\n     * @param measureShapeData\n     * @param stickyData\n     * @param textMarkupAnnotations\n     * @param pageIndex\n     * @param stampData\n     * @param shapeData\n     * @param measureShapeData\n     * @param stickyData\n     * @private\n     */\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.printTextMarkupAnnotations = function (textMarkupAnnotations, pageIndex, stampData, shapeData, measureShapeData, stickyData, freeTextData) {\n        var canvas = createElement('canvas', { id: this.pdfViewer.element.id + '_print_annotation_layer_' + pageIndex });\n        canvas.style.width = 816 + 'px';\n        canvas.style.height = 1056 + 'px';\n        var pageWidth = this.pdfViewerBase.pageSize[pageIndex].width;\n        var pageHeight = this.pdfViewerBase.pageSize[pageIndex].height;\n        var zoom = this.pdfViewerBase.getZoomFactor();\n        var zoomRatio = this.pdfViewerBase.getZoomRatio(zoom);\n        canvas.height = pageHeight * zoomRatio;\n        canvas.width = pageWidth * zoomRatio;\n        // eslint-disable-next-line\n        var textMarkupannotations = this.getAnnotations(pageIndex, null, '_annotations_textMarkup');\n        // eslint-disable-next-line\n        var shapeAnnotation = this.getAnnotations(pageIndex, null, '_annotations_shape');\n        // eslint-disable-next-line\n        var measureShapeAnnotation = this.getAnnotations(pageIndex, null, '_annotations_shape_measure');\n        // eslint-disable-next-line\n        var stampAnnotation = this.getAnnotations(pageIndex, null, '_annotations_stamp');\n        // eslint-disable-next-line\n        var stickyNoteAnnotation = this.getAnnotations(pageIndex, null, '_annotations_sticky');\n        if (stampAnnotation || shapeAnnotation || stickyNoteAnnotation || measureShapeAnnotation) {\n            this.pdfViewer.renderDrawing(canvas, pageIndex);\n        }\n        else {\n            this.pdfViewer.annotation.renderAnnotations(pageIndex, shapeData, measureShapeData, null, canvas, null, null, freeTextData);\n            this.pdfViewer.annotation.stampAnnotationModule.renderStampAnnotations(stampData, pageIndex, canvas);\n            this.pdfViewer.annotation.stickyNotesAnnotationModule.renderStickyNotesAnnotations(stickyData, pageIndex, canvas);\n        }\n        var zoomFactor = this.pdfViewerBase.getZoomFactor();\n        if (textMarkupannotations) {\n            this.renderTextMarkupAnnotations(null, pageIndex, canvas, zoomFactor);\n        }\n        else {\n            this.renderTextMarkupAnnotations(textMarkupAnnotations, pageIndex, canvas, zoomFactor);\n        }\n        var imageSource = canvas.toDataURL();\n        return imageSource;\n    };\n    /**\n     * @private\n     */\n    TextMarkupAnnotation.prototype.saveTextMarkupAnnotations = function () {\n        // eslint-disable-next-line\n        var storeTextMarkupObject = window.sessionStorage.getItem(this.pdfViewerBase.documentId + '_annotations_textMarkup');\n        if (this.pdfViewerBase.isStorageExceed) {\n            storeTextMarkupObject = this.pdfViewerBase.annotationStorage[this.pdfViewerBase.documentId + '_annotations_textMarkup'];\n        }\n        // eslint-disable-next-line\n        var textMarkupAnnotations = new Array();\n        for (var j = 0; j < this.pdfViewerBase.pageCount; j++) {\n            textMarkupAnnotations[j] = [];\n        }\n        if (storeTextMarkupObject && !this.pdfViewer.annotationSettings.skipDownload) {\n            var textMarkupAnnotationCollection = JSON.parse(storeTextMarkupObject);\n            for (var i = 0; i < textMarkupAnnotationCollection.length; i++) {\n                var newArray = [];\n                var pageAnnotationObject = textMarkupAnnotationCollection[i];\n                if (pageAnnotationObject) {\n                    var _loop_1 = function (z) {\n                        this_1.pdfViewer.annotationModule.updateModifiedDate(pageAnnotationObject.annotations[z]);\n                        if (this_1.pdfViewerBase.isJsonExported) {\n                            if (pageAnnotationObject.annotations[z].isAnnotationRotated) {\n                                pageAnnotationObject.annotations[z].bounds = this_1.getBoundsForSave(pageAnnotationObject.annotations[z].bounds, i);\n                            }\n                            else {\n                                var pageDetails = this_1.pdfViewerBase.pageSize[pageAnnotationObject.pageIndex];\n                                if (pageDetails) {\n                                    pageAnnotationObject.annotations[z].annotationRotation = pageDetails.rotation;\n                                }\n                            }\n                        }\n                        if (this_1.isChineseLanguage(pageAnnotationObject.annotations[z].textMarkupContent)) {\n                            if (pageAnnotationObject.annotations[z].bounds.length > 0) {\n                                var height_difference_1 = pageAnnotationObject.annotations[z].textMarkupAnnotationType === 'Strikethrough' ? this_1.strikeoutDifference : pageAnnotationObject.annotations[z].textMarkupAnnotationType === 'Underline' ? this_1.underlineDifference : 0;\n                                pageAnnotationObject.annotations[z].bounds.forEach(function (bound) {\n                                    bound.height = bound.height ? bound.height : bound.Height;\n                                    if (bound.height > 0) {\n                                        // Update height value\n                                        bound.height += height_difference_1;\n                                    }\n                                });\n                            }\n                        }\n                        // eslint-disable-next-line max-len\n                        pageAnnotationObject.annotations[z].bounds = JSON.stringify(this_1.getBoundsForSave(pageAnnotationObject.annotations[z].bounds, i));\n                        var colorString = pageAnnotationObject.annotations[z].color;\n                        pageAnnotationObject.annotations[z].color = JSON.stringify(this_1.getRgbCode(colorString));\n                        pageAnnotationObject.annotations[z].rect = JSON.stringify(pageAnnotationObject.annotations[z].rect);\n                    };\n                    var this_1 = this;\n                    for (var z = 0; pageAnnotationObject.annotations.length > z; z++) {\n                        _loop_1(z);\n                    }\n                    newArray = pageAnnotationObject.annotations;\n                }\n                textMarkupAnnotations[pageAnnotationObject.pageIndex] = newArray;\n            }\n        }\n        return JSON.stringify(textMarkupAnnotations);\n    };\n    /**\n     * @private\n     */\n    TextMarkupAnnotation.prototype.deleteTextMarkupAnnotation = function () {\n        if (this.currentTextMarkupAnnotation) {\n            var isLock = false;\n            if (this.currentTextMarkupAnnotation.annotationSettings) {\n                // eslint-disable-next-line\n                isLock = this.currentTextMarkupAnnotation.annotationSettings.isLock;\n                if (this.pdfViewer.annotationModule.checkAllowedInteractions('Delete', this.currentTextMarkupAnnotation)) {\n                    isLock = false;\n                }\n            }\n            if (!isLock) {\n                var deletedAnnotation = null;\n                this.showHideDropletDiv(true);\n                // eslint-disable-next-line\n                var annotation = this.currentTextMarkupAnnotation;\n                if (this.currentTextMarkupAnnotation.isMultiSelect && annotation.annotNameCollection) {\n                    this.deletMultiPageAnnotation(annotation);\n                }\n                var pageAnnotations = this.getAnnotations(this.selectTextMarkupCurrentPage, null);\n                if (pageAnnotations) {\n                    for (var i = 0; i < pageAnnotations.length; i++) {\n                        if (this.currentTextMarkupAnnotation.annotName === pageAnnotations[i].annotName) {\n                            deletedAnnotation = pageAnnotations.splice(i, 1)[0];\n                            // eslint-disable-next-line max-len\n                            this.pdfViewer.annotationModule.addAction(this.selectTextMarkupCurrentPage, i, deletedAnnotation, 'Text Markup Deleted', null);\n                            this.currentAnnotationIndex = i;\n                            this.pdfViewer.annotation.stickyNotesAnnotationModule.findPosition(deletedAnnotation, 'textMarkup');\n                            var removeDiv = document.getElementById(deletedAnnotation.annotName);\n                            if (removeDiv) {\n                                if (removeDiv.parentElement.childElementCount === 1) {\n                                    this.pdfViewer.annotationModule.stickyNotesAnnotationModule.updateAccordionContainer(removeDiv);\n                                }\n                                else {\n                                    removeDiv.remove();\n                                }\n                            }\n                        }\n                    }\n                    this.pdfViewer.annotationModule.updateAnnotationCollection(this.currentTextMarkupAnnotation);\n                    this.manageAnnotations(pageAnnotations, this.selectTextMarkupCurrentPage);\n                    // eslint-disable-next-line max-len\n                    this.pdfViewer.annotationModule.updateImportAnnotationCollection(this.currentTextMarkupAnnotation, this.currentTextMarkupAnnotation.pageNumber, 'textMarkupAnnotation');\n                    var annotationId = this.currentTextMarkupAnnotation.annotName;\n                    // eslint-disable-next-line\n                    var annotationBounds = this.currentTextMarkupAnnotation.bounds;\n                    this.currentTextMarkupAnnotation = null;\n                    this.pdfViewer.annotationModule.renderAnnotations(this.selectTextMarkupCurrentPage, null, null, null);\n                    this.pdfViewerBase.updateDocumentEditedProperty(true);\n                    // eslint-disable-next-line max-len\n                    var multiPageCollection = this.multiPageCollectionList(annotation);\n                    if (multiPageCollection.length > 0) {\n                        multiPageCollection.push(deletedAnnotation);\n                        // eslint-disable-next-line max-len\n                        this.pdfViewer.fireAnnotationRemove(this.selectTextMarkupCurrentPage, annotationId, deletedAnnotation.textMarkupAnnotationType, annotationBounds, deletedAnnotation.textMarkupContent, deletedAnnotation.textMarkupStartIndex, deletedAnnotation.textMarkupEndIndex, multiPageCollection);\n                    }\n                    else {\n                        // eslint-disable-next-line max-len\n                        this.pdfViewer.fireAnnotationRemove(this.selectTextMarkupCurrentPage, annotationId, deletedAnnotation.textMarkupAnnotationType, annotationBounds, deletedAnnotation.textMarkupContent, deletedAnnotation.textMarkupStartIndex, deletedAnnotation.textMarkupEndIndex);\n                    }\n                    this.currentAnnotationIndex = null;\n                    this.selectTextMarkupCurrentPage = null;\n                    if (Browser.isDevice && !this.pdfViewer.enableDesktopMode) {\n                        // eslint-disable-next-line max-len\n                        this.pdfViewer.toolbarModule.annotationToolbarModule.hideMobileAnnotationToolbar();\n                        this.pdfViewer.toolbarModule.showToolbar(true);\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * @param color\n     * @private\n     */\n    TextMarkupAnnotation.prototype.modifyColorProperty = function (color) {\n        if (this.currentTextMarkupAnnotation) {\n            var pageAnnotations = this.modifyAnnotationProperty('Color', color, null);\n            this.manageAnnotations(pageAnnotations, this.selectTextMarkupCurrentPage);\n            this.pdfViewer.annotationModule.renderAnnotations(this.selectTextMarkupCurrentPage, null, null, null);\n            this.pdfViewerBase.updateDocumentEditedProperty(true);\n            // eslint-disable-next-line\n            var annotation = this.currentTextMarkupAnnotation;\n            // eslint-disable-next-line max-len\n            var multiPageCollection = this.multiPageCollectionList(annotation);\n            if (multiPageCollection.length > 0) {\n                // eslint-disable-next-line max-len\n                this.pdfViewer.fireAnnotationPropertiesChange(this.selectTextMarkupCurrentPage, annotation.annotName, annotation.textMarkupAnnotationType, true, false, false, false, annotation.textMarkupContent, annotation.textMarkupStartIndex, annotation.textMarkupEndIndex, multiPageCollection);\n                this.currentAnnotationIndex = null;\n            }\n            else {\n                // eslint-disable-next-line max-len\n                this.pdfViewer.fireAnnotationPropertiesChange(this.selectTextMarkupCurrentPage, annotation.annotName, annotation.textMarkupAnnotationType, true, false, false, false, annotation.textMarkupContent, annotation.textMarkupStartIndex, annotation.textMarkupEndIndex);\n                this.currentAnnotationIndex = null;\n            }\n        }\n    };\n    /**\n     * @param args\n     * @param isOpacity\n     * @private\n     */\n    TextMarkupAnnotation.prototype.modifyOpacityProperty = function (args, isOpacity) {\n        if (this.currentTextMarkupAnnotation) {\n            var pageAnnotations = void 0;\n            if (!(isNullOrUndefined(isOpacity))) {\n                pageAnnotations = this.modifyAnnotationProperty('Opacity', isOpacity, 'changed');\n            }\n            else {\n                pageAnnotations = this.modifyAnnotationProperty('Opacity', args.value / 100, args.name);\n            }\n            if (pageAnnotations) {\n                this.manageAnnotations(pageAnnotations, this.selectTextMarkupCurrentPage);\n                this.pdfViewer.annotationModule.renderAnnotations(this.selectTextMarkupCurrentPage, null, null, null);\n                if (!(isNullOrUndefined(isOpacity)) || args.name === 'changed') {\n                    this.pdfViewerBase.updateDocumentEditedProperty(true);\n                    // eslint-disable-next-line\n                    var annotation = this.currentTextMarkupAnnotation;\n                    // eslint-disable-next-line max-len\n                    var multiPageCollection = this.multiPageCollectionList(annotation);\n                    if (multiPageCollection.length > 0) {\n                        // eslint-disable-next-line max-len\n                        this.pdfViewer.fireAnnotationPropertiesChange(this.selectTextMarkupCurrentPage, annotation.annotName, annotation.textMarkupAnnotationType, false, true, false, false, annotation.textMarkupContent, annotation.textMarkupStartIndex, annotation.textMarkupEndIndex, multiPageCollection);\n                        this.currentAnnotationIndex = null;\n                    }\n                    else {\n                        // eslint-disable-next-line max-len\n                        this.pdfViewer.fireAnnotationPropertiesChange(this.selectTextMarkupCurrentPage, annotation.annotName, annotation.textMarkupAnnotationType, false, true, false, false, annotation.textMarkupContent, annotation.textMarkupStartIndex, annotation.textMarkupEndIndex);\n                        this.currentAnnotationIndex = null;\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * @param property\n     * @param value\n     * @param status\n     * @param annotName\n     * @private\n     */\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.modifyAnnotationProperty = function (property, value, status, annotName) {\n        // eslint-disable-next-line\n        var annotation = this.currentTextMarkupAnnotation;\n        this.pdfViewer.annotationModule.isFormFieldShape = false;\n        if (annotation.isMultiSelect && annotation.annotNameCollection) {\n            this.modifyMultiPageAnnotations(annotation, property, value);\n        }\n        var pageAnnotations = this.getAnnotations(this.selectTextMarkupCurrentPage, null);\n        if (pageAnnotations) {\n            for (var i = 0; i < pageAnnotations.length; i++) {\n                if (JSON.stringify(this.currentTextMarkupAnnotation) === JSON.stringify(pageAnnotations[i])) {\n                    if (property === 'Color') {\n                        pageAnnotations[i].color = value;\n                    }\n                    else if (property === 'Opacity') {\n                        pageAnnotations[i].opacity = value;\n                    }\n                    else if (property === 'AnnotationSettings') {\n                        pageAnnotations[i].annotationSettings = { isLock: value };\n                    }\n                    pageAnnotations[i].modifiedDate = this.pdfViewer.annotation.stickyNotesAnnotationModule.getDateAndTime();\n                    this.currentAnnotationIndex = i;\n                    if (status === null || status === 'changed') {\n                        // eslint-disable-next-line max-len\n                        this.pdfViewer.annotationModule.addAction(this.selectTextMarkupCurrentPage, i, this.currentTextMarkupAnnotation, 'Text Markup Property modified', property);\n                    }\n                    this.currentTextMarkupAnnotation = pageAnnotations[i];\n                    this.pdfViewer.annotationModule.stickyNotesAnnotationModule.updateAnnotationModifiedDate(pageAnnotations[i]);\n                    this.pdfViewer.annotationModule.storeAnnotationCollections(pageAnnotations[i], this.selectTextMarkupCurrentPage);\n                }\n            }\n        }\n        return pageAnnotations;\n    };\n    /**\n     * @param annotation\n     * @param pageNumber\n     * @param index\n     * @param action\n     * @private\n     */\n    TextMarkupAnnotation.prototype.undoTextMarkupAction = function (annotation, pageNumber, index, action) {\n        var pageAnnotations = this.getAnnotations(pageNumber, null);\n        if (pageAnnotations) {\n            if (action === 'Text Markup Added') {\n                this.pdfViewer.annotation.stickyNotesAnnotationModule.findPosition(pageAnnotations[index], 'textMarkup');\n                // eslint-disable-next-line\n                var removeDiv = document.getElementById(pageAnnotations[index].annotName);\n                if (removeDiv) {\n                    if (removeDiv.parentElement.childElementCount === 1) {\n                        this.pdfViewer.annotationModule.stickyNotesAnnotationModule.updateAccordionContainer(removeDiv);\n                    }\n                    else {\n                        removeDiv.parentElement.removeChild(removeDiv);\n                    }\n                }\n                pageAnnotations.splice(index, 1);\n            }\n            else if (action === 'Text Markup Deleted') {\n                // eslint-disable-next-line max-len\n                this.pdfViewer.annotationModule.stickyNotesAnnotationModule.addAnnotationComments(pageNumber, annotation.shapeAnnotationType);\n                pageAnnotations.splice(index, 0, annotation);\n            }\n        }\n        this.clearCurrentAnnotation();\n        this.pdfViewerBase.updateDocumentEditedProperty(true);\n        this.manageAnnotations(pageAnnotations, pageNumber);\n        this.pdfViewer.annotationModule.renderAnnotations(pageNumber, null, null, null);\n    };\n    /**\n     * @param annotation\n     * @param pageNumber\n     * @param index\n     * @param property\n     * @param isUndoAction\n     * @param annotation\n     * @param pageNumber\n     * @param index\n     * @param property\n     * @param isUndoAction\n     * @param annotation\n     * @param pageNumber\n     * @param index\n     * @param property\n     * @param isUndoAction\n     * @param annotation\n     * @param pageNumber\n     * @param index\n     * @param property\n     * @param isUndoAction\n     * @private\n     */\n    // eslint-disable-next-line max-len\n    TextMarkupAnnotation.prototype.undoRedoPropertyChange = function (annotation, pageNumber, index, property, isUndoAction) {\n        var pageAnnotations = this.getAnnotations(pageNumber, null);\n        if (pageAnnotations) {\n            if (property === 'Color') {\n                var tempColor = pageAnnotations[index].color;\n                pageAnnotations[index].color = annotation.color;\n                annotation.color = tempColor;\n            }\n            else {\n                var tempOpacity = pageAnnotations[index].opacity;\n                pageAnnotations[index].opacity = annotation.opacity;\n                annotation.opacity = tempOpacity;\n            }\n            this.pdfViewer.annotationModule.stickyNotesAnnotationModule.updateAnnotationModifiedDate(annotation, null, true);\n            if (isUndoAction) {\n                annotation.modifiedDate = this.pdfViewer.annotation.stickyNotesAnnotationModule.getDateAndTime();\n            }\n        }\n        this.clearCurrentAnnotation();\n        this.pdfViewerBase.updateDocumentEditedProperty(true);\n        this.manageAnnotations(pageAnnotations, pageNumber);\n        this.pdfViewer.annotationModule.renderAnnotations(pageNumber, null, null, null);\n        return annotation;\n    };\n    /**\n     * @param annotation\n     * @param pageNumber\n     * @param index\n     * @param action\n     * @private\n     */\n    TextMarkupAnnotation.prototype.redoTextMarkupAction = function (annotation, pageNumber, index, action) {\n        var pageAnnotations = this.getAnnotations(pageNumber, null);\n        if (pageAnnotations) {\n            if (action === 'Text Markup Added') {\n                // eslint-disable-next-line max-len\n                this.pdfViewer.annotationModule.stickyNotesAnnotationModule.addAnnotationComments(pageNumber, annotation.shapeAnnotationType);\n                pageAnnotations.push(annotation);\n            }\n            else if (action === 'Text Markup Deleted') {\n                this.pdfViewer.annotation.stickyNotesAnnotationModule.findPosition(pageAnnotations[index], 'textMarkup');\n                // eslint-disable-next-line\n                var removeDiv = document.getElementById(pageAnnotations[index].annotName);\n                if (removeDiv) {\n                    if (removeDiv.parentElement.childElementCount === 1) {\n                        this.pdfViewer.annotationModule.stickyNotesAnnotationModule.updateAccordionContainer(removeDiv);\n                    }\n                    else {\n                        removeDiv.remove();\n                    }\n                }\n                pageAnnotations.splice(index, 1);\n            }\n        }\n        this.clearCurrentAnnotation();\n        this.pdfViewerBase.updateDocumentEditedProperty(true);\n        this.manageAnnotations(pageAnnotations, pageNumber);\n        this.pdfViewer.annotationModule.renderAnnotations(pageNumber, null, null, null);\n    };\n    /**\n     * @param pageNumber\n     * @param note\n     * @param pageNumber\n     * @param note\n     * @private\n     */\n    TextMarkupAnnotation.prototype.saveNoteContent = function (pageNumber, note) {\n        var pageAnnotations = this.getAnnotations(pageNumber, null);\n        if (pageAnnotations) {\n            for (var i = 0; i < pageAnnotations.length; i++) {\n                if (JSON.stringify(this.currentTextMarkupAnnotation) === JSON.stringify(pageAnnotations[i])) {\n                    pageAnnotations[i].note = note;\n                }\n            }\n        }\n        this.manageAnnotations(pageAnnotations, pageNumber);\n        this.pdfViewerBase.updateDocumentEditedProperty(true);\n    };\n    TextMarkupAnnotation.prototype.clearCurrentAnnotation = function () {\n        if (!this.isExtended) {\n            if (this.pdfViewer.isMaintainSelection && !this.pdfViewer.textSelectionModule.isTextSelection) {\n                this.selectTextMarkupCurrentPage = this.selectTextMarkupCurrentPage;\n                this.currentTextMarkupAnnotation = this.currentTextMarkupAnnotation;\n            }\n            else {\n                this.selectTextMarkupCurrentPage = null;\n                this.currentTextMarkupAnnotation = null;\n            }\n            var isSkip = false;\n            // eslint-disable-next-line max-len\n            if (this.pdfViewer.annotation.freeTextAnnotationModule && this.pdfViewer.annotation.freeTextAnnotationModule.isInuptBoxInFocus) {\n                isSkip = true;\n            }\n            if (!isSkip) {\n                this.enableAnnotationPropertiesTool(false);\n            }\n        }\n    };\n    /**\n     * @param pageNumber\n     * @param isSelect\n     * @param pageNumber\n     * @param isSelect\n     * @private\n     */\n    TextMarkupAnnotation.prototype.clearCurrentAnnotationSelection = function (pageNumber, isSelect) {\n        if (isSelect) {\n            this.isAnnotationSelect = true;\n        }\n        else {\n            this.isAnnotationSelect = false;\n        }\n        var lowerPageIndex = (pageNumber - 2) >= 0 ? (pageNumber - 2) : 0;\n        // eslint-disable-next-line max-len\n        var higherPageIndex = (pageNumber + 2) < this.pdfViewerBase.pageCount ? (pageNumber + 2) : this.pdfViewerBase.pageCount - 1;\n        for (var k = lowerPageIndex; k <= higherPageIndex; k++) {\n            this.clearAnnotationSelection(k);\n        }\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.getBoundsForSave = function (bounds, pageIndex) {\n        // eslint-disable-next-line\n        var newArray = [];\n        for (var i = 0; i < bounds.length; i++) {\n            // eslint-disable-next-line\n            var bound = this.getAnnotationBounds(bounds[i], pageIndex);\n            newArray.push(bound);\n        }\n        return newArray;\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.getAnnotationBounds = function (bounds, pageIndex) {\n        var left = bounds.left ? bounds.left : bounds.Left;\n        var top = bounds.top ? bounds.top : bounds.Top;\n        var height = bounds.height ? bounds.height : bounds.Height;\n        var width = bounds.width ? bounds.width : bounds.Width;\n        var pageDetails = this.pdfViewerBase.pageSize[pageIndex];\n        left = left ? left : bounds.x;\n        top = top ? top : bounds.y;\n        if (pageDetails) {\n            if (pageDetails.rotation === 1) {\n                return { left: top, top: pageDetails.width - (left + width), width: height, height: width };\n            }\n            else if (pageDetails.rotation === 2) {\n                // eslint-disable-next-line max-len\n                return { left: pageDetails.width - left - width, top: pageDetails.height - top - height, width: width, height: height };\n            }\n            else if (pageDetails.rotation === 3) {\n                return { left: pageDetails.height - top - height, top: left, width: height, height: width };\n            }\n            else {\n                return { left: left, top: top, width: width, height: height };\n            }\n        }\n        else {\n            return { left: left, top: top, width: width, height: height };\n        }\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.getRgbCode = function (colorString) {\n        if (!colorString.match(/#([a-z0-9]+)/gi) && !colorString.match(/^rgba?\\((\\d+),\\s*(\\d+),\\s*(\\d+)(?:,\\s*(\\d+(?:\\.\\d+)?))?\\)$/)) {\n            colorString = this.pdfViewer.annotationModule.nameToHash(colorString);\n        }\n        var markupStringArray = colorString.split(',');\n        if (isNullOrUndefined(markupStringArray[1])) {\n            colorString = this.pdfViewer.annotationModule.getValue(colorString, 'rgba');\n            markupStringArray = colorString.split(',');\n        }\n        // eslint-disable-next-line radix\n        var textMarkupR = parseInt(markupStringArray[0].split('(')[1]);\n        // eslint-disable-next-line radix\n        var textMarkupG = parseInt(markupStringArray[1]);\n        // eslint-disable-next-line radix\n        var textMarkupB = parseInt(markupStringArray[2]);\n        // eslint-disable-next-line radix\n        var textMarkupA = parseInt(markupStringArray[3]);\n        return { a: textMarkupA, r: textMarkupR, g: textMarkupG, b: textMarkupB };\n    };\n    TextMarkupAnnotation.prototype.getDrawnBounds = function () {\n        var pageBounds = [];\n        var selection = window.getSelection();\n        if (selection.anchorNode !== null) {\n            var range = document.createRange();\n            var isBackWardSelection = this.pdfViewerBase.textLayer.isBackWardSelection(selection);\n            if (selection.anchorNode === selection.focusNode) {\n                var pageId = this.pdfViewerBase.textLayer.getPageIndex(selection.anchorNode);\n                var startIndex = 0;\n                var endIndex = 0;\n                if (!isNaN(pageId)) {\n                    var pageRect = this.pdfViewerBase.getElement('_pageDiv_' + pageId).getBoundingClientRect();\n                    if (this.pdfViewerBase.isMixedSizeDocument) {\n                        pageRect = this.pdfViewerBase.getElement('_textLayer_' + pageId).getBoundingClientRect();\n                    }\n                    if (isBackWardSelection) {\n                        range.setStart(selection.focusNode, selection.focusOffset);\n                        range.setEnd(selection.anchorNode, selection.anchorOffset);\n                    }\n                    else {\n                        if (selection.anchorOffset < selection.focusOffset) {\n                            startIndex = selection.anchorOffset;\n                            endIndex = selection.focusOffset;\n                            range.setStart(selection.anchorNode, selection.anchorOffset);\n                            range.setEnd(selection.focusNode, selection.focusOffset);\n                        }\n                        else {\n                            startIndex = selection.focusOffset;\n                            endIndex = selection.anchorOffset;\n                            range.setStart(selection.focusNode, selection.focusOffset);\n                            range.setEnd(selection.anchorNode, selection.anchorOffset);\n                        }\n                    }\n                    var boundingRect = range.getBoundingClientRect();\n                    var annotationRotate = 0;\n                    if (this.pdfViewerBase.clientSideRendering) {\n                        var pageDetails = this.pdfViewerBase.pageSize[pageId];\n                        var pageRotation = this.getAngle(pageDetails.rotation);\n                        var textElement = void 0;\n                        if (range.startContainer.parentElement) {\n                            textElement = range.startContainer.parentElement;\n                        }\n                        else {\n                            textElement = range.startContainer.parentNode;\n                        }\n                        if (textElement && textElement.style.transform !== '') {\n                            if (textElement.style.transform.startsWith('rotate(90deg)')) {\n                                annotationRotate = 90;\n                            }\n                            else if (textElement.style.transform.startsWith('rotate(180deg)')) {\n                                annotationRotate = 180;\n                            }\n                            else if (textElement.style.transform.startsWith('rotate(-90deg)') || textElement.style.transform.startsWith('rotate(270deg)')) {\n                                annotationRotate = 270;\n                            }\n                            else {\n                                annotationRotate = 0;\n                            }\n                        }\n                    }\n                    // eslint-disable-next-line\n                    var indexes = this.getIndexNumbers(pageId, range.toString(), range.commonAncestorContainer.textContent.toString());\n                    // eslint-disable-next-line max-len\n                    var rectangle = { left: this.getDefaultValue(boundingRect.left - pageRect.left), top: this.getDefaultValue(boundingRect.top - pageRect.top), width: this.getDefaultValue(boundingRect.width), height: this.getDefaultValue(boundingRect.height), right: this.getDefaultValue(boundingRect.right - pageRect.left), bottom: this.getDefaultValue(boundingRect.bottom - pageRect.top), rotation: annotationRotate };\n                    var rectangleArray = [];\n                    rectangleArray.push(rectangle);\n                    // eslint-disable-next-line\n                    var rect = { left: rectangle.left, top: rectangle.top, right: rectangle.right, bottom: rectangle.bottom, rotation: annotationRotate };\n                    pageBounds.push({ pageIndex: pageId, bounds: rectangleArray, rect: rect, startIndex: indexes.startIndex, endIndex: indexes.endIndex, textContent: range.toString() });\n                }\n            }\n            else {\n                var startNode = void 0;\n                var endNode = void 0;\n                var selectionStartOffset = void 0;\n                var selectionEndOffset = void 0;\n                if (isBackWardSelection) {\n                    startNode = selection.focusNode;\n                    selectionStartOffset = selection.focusOffset;\n                    endNode = selection.anchorNode;\n                    selectionEndOffset = selection.anchorOffset;\n                }\n                else {\n                    startNode = selection.anchorNode;\n                    selectionStartOffset = selection.anchorOffset;\n                    endNode = selection.focusNode;\n                    selectionEndOffset = selection.focusOffset;\n                }\n                var anchorPageId = this.pdfViewerBase.textLayer.getPageIndex(startNode);\n                var anchorTextId = this.pdfViewerBase.textLayer.getTextIndex(startNode, anchorPageId);\n                var focusPageId = this.pdfViewerBase.textLayer.getPageIndex(endNode);\n                var focusTextId = this.pdfViewerBase.textLayer.getTextIndex(endNode, focusPageId);\n                var startOffset = 0;\n                var endOffset = 0;\n                var currentId = 0;\n                for (var i = anchorPageId; i <= focusPageId; i++) {\n                    var selectionRects = [];\n                    var pageStartId = void 0;\n                    var pageEndId = void 0;\n                    var pageStartOffset = void 0;\n                    var pageEndOffset = void 0;\n                    var textDivs = this.pdfViewerBase.getElement('_textLayer_' + i).childNodes;\n                    var pageRect = this.pdfViewerBase.getElement('_pageDiv_' + i).getBoundingClientRect();\n                    if (this.pdfViewerBase.isMixedSizeDocument) {\n                        pageRect = this.pdfViewerBase.getElement('_textLayer_' + i).getBoundingClientRect();\n                    }\n                    if (i === anchorPageId) {\n                        currentId = anchorTextId;\n                    }\n                    else {\n                        currentId = 0;\n                    }\n                    for (var j = currentId; j < textDivs.length; j++) {\n                        var textElement = textDivs[j];\n                        if (j === currentId) {\n                            pageStartId = currentId;\n                            pageStartOffset = (i === anchorPageId) ? selectionStartOffset : 0;\n                        }\n                        else {\n                            pageEndId = j;\n                            pageEndOffset = (i === focusPageId) ? selectionEndOffset : textElement.textContent.length;\n                        }\n                        if (j === anchorTextId && i === anchorPageId) {\n                            startOffset = selectionStartOffset;\n                        }\n                        else {\n                            startOffset = 0;\n                        }\n                        if (j === focusTextId && i === focusPageId) {\n                            endOffset = selectionEndOffset;\n                        }\n                        else {\n                            endOffset = textElement.textContent.length;\n                        }\n                        for (var k = 0; k < textElement.childNodes.length; k++) {\n                            var node = textElement.childNodes[k];\n                            range.setStart(node, startOffset);\n                            range.setEnd(node, endOffset);\n                        }\n                        var boundingRect = range.getBoundingClientRect();\n                        var annotationRotate = 0;\n                        if (this.pdfViewerBase.clientSideRendering) {\n                            var pageDetails = this.pdfViewerBase.pageSize[i];\n                            var pageRotation = this.getAngle(pageDetails.rotation);\n                            if (textElement && textElement.style.transform !== '') {\n                                if (textElement.style.transform.startsWith('rotate(90deg)')) {\n                                    annotationRotate = 90;\n                                }\n                                else if (textElement.style.transform.startsWith('rotate(180deg)')) {\n                                    annotationRotate = 180;\n                                }\n                                else if (textElement.style.transform.startsWith('rotate(-90deg)') || textElement.style.transform.startsWith('rotate(270deg)')) {\n                                    annotationRotate = 270;\n                                }\n                                else {\n                                    annotationRotate = 0;\n                                }\n                            }\n                        }\n                        // eslint-disable-next-line max-len\n                        var rectangle = { left: this.getDefaultValue(boundingRect.left - pageRect.left), top: this.getDefaultValue(boundingRect.top - pageRect.top), width: this.getDefaultValue(boundingRect.width), height: this.getDefaultValue(boundingRect.height), right: this.getDefaultValue(boundingRect.right - pageRect.left), bottom: this.getDefaultValue(boundingRect.bottom - pageRect.top), rotation: annotationRotate };\n                        selectionRects.push(rectangle);\n                        range.detach();\n                        if (i === focusPageId && j === focusTextId) {\n                            break;\n                        }\n                    }\n                    if (!pageEndId) {\n                        pageEndId = pageStartId;\n                    }\n                    if (!pageEndOffset) {\n                        pageEndOffset = endOffset;\n                    }\n                    var startElementNode = this.pdfViewerBase.getElement('_text_' + i + '_' + pageStartId).childNodes[0];\n                    var endElementNode = this.pdfViewerBase.getElement('_text_' + i + '_' + pageEndId).childNodes[0];\n                    var pageRange = document.createRange();\n                    pageRange.setStart(startElementNode, pageStartOffset);\n                    pageRange.setEnd(endElementNode, pageEndOffset);\n                    var pageRectBounds = pageRange.getBoundingClientRect();\n                    var textValue = pageRange.toString();\n                    // eslint-disable-next-line\n                    var indexes = this.getIndexNumbers(i, textValue);\n                    // eslint-disable-next-line max-len\n                    var pageRectangle = { left: this.getDefaultValue(pageRectBounds.left - pageRect.left), top: this.getDefaultValue(pageRectBounds.top - pageRect.top), width: this.getDefaultValue(pageRectBounds.width), height: this.getDefaultValue(pageRectBounds.height), right: this.getDefaultValue(pageRectBounds.right - pageRect.left), bottom: this.getDefaultValue(pageRectBounds.bottom - pageRect.top) };\n                    // eslint-disable-next-line\n                    var rect = { left: pageRectangle.left, top: pageRectangle.top, right: pageRectangle.right, bottom: pageRectangle.bottom };\n                    pageBounds.push({ pageIndex: i, bounds: selectionRects, rect: rect, startIndex: indexes.startIndex, endIndex: indexes.endIndex, textContent: textValue });\n                }\n            }\n        }\n        selection.removeAllRanges();\n        return pageBounds;\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.getIndexNumbers = function (pageNumber, content, parentText) {\n        // eslint-disable-next-line\n        var storedData = this.pdfViewerBase.clientSideRendering ? this.pdfViewerBase.getLinkInformation(pageNumber) : this.pdfViewerBase.getStoredData(pageNumber);\n        var startIndex;\n        var endIndex;\n        if (storedData) {\n            var previousIndex = 0;\n            var pageText = storedData.pageText;\n            for (var p = 0; p < pageNumber; p++) {\n                if (this.pdfViewer.isExtractText) {\n                    // eslint-disable-next-line\n                    var documentIndex = this.pdfViewer.textSearchModule.documentTextCollection[p][p];\n                    var pageTextData = documentIndex.pageText ? documentIndex.pageText : documentIndex.PageText;\n                    // eslint-disable-next-line max-len\n                    if (this.pdfViewer.textSearchModule && this.pdfViewer.textSearchModule.documentTextCollection && this.pdfViewer.textSearchModule.isTextRetrieved) {\n                        if (this.pdfViewer.textSearchModule.documentTextCollection[p]) {\n                            previousIndex = previousIndex + pageTextData.length;\n                        }\n                    }\n                    else {\n                        // eslint-disable-next-line max-len\n                        if (this.pdfViewer.textSearchModule && this.pdfViewer.textSearchModule.documentTextCollection) {\n                            if (pageNumber <= this.pdfViewer.textSearchModule.documentTextCollection.length) {\n                                if (this.pdfViewer.textSearchModule.documentTextCollection[p]) {\n                                    // eslint-disable-next-line max-len\n                                    previousIndex = previousIndex + pageTextData.length;\n                                }\n                            }\n                            else {\n                                previousIndex = 0;\n                                break;\n                            }\n                        }\n                    }\n                }\n            }\n            if (!isNullOrUndefined(parentText)) {\n                var parentIndex = pageText.indexOf(parentText);\n                var initialIndex = parentText.indexOf(content);\n                startIndex = (parentIndex + initialIndex) + previousIndex;\n            }\n            else {\n                startIndex = (pageText.indexOf(content)) + previousIndex;\n            }\n            endIndex = startIndex + (content.length - 1);\n        }\n        return { startIndex: startIndex, endIndex: endIndex };\n    };\n    /**\n     * @param pageNumber\n     * @private\n     */\n    TextMarkupAnnotation.prototype.rerenderAnnotationsPinch = function (pageNumber) {\n        var annotCanvas = this.pdfViewerBase.getElement('_annotationCanvas_' + pageNumber);\n        if (annotCanvas) {\n            var oldAnnotCanvas = this.pdfViewerBase.getElement('_old_annotationCanvas_' + pageNumber);\n            if (oldAnnotCanvas) {\n                if (annotCanvas) {\n                    oldAnnotCanvas.id = annotCanvas.id;\n                    annotCanvas.parentElement.removeChild(annotCanvas);\n                }\n                else {\n                    oldAnnotCanvas.id = this.pdfViewer.element.id + '_annotationCanvas_' + pageNumber;\n                }\n                annotCanvas = oldAnnotCanvas;\n            }\n            annotCanvas.style.width = '';\n            annotCanvas.style.height = '';\n            if (this.pdfViewer.restrictZoomRequest) {\n                // eslint-disable-next-line max-len\n                annotCanvas.style.width = this.pdfViewerBase.pageSize[pageNumber].width * this.pdfViewerBase.getZoomFactor() + 'px';\n                // eslint-disable-next-line max-len\n                annotCanvas.style.height = this.pdfViewerBase.pageSize[pageNumber].height * this.pdfViewerBase.getZoomFactor() + 'px';\n            }\n            else {\n                // eslint-disable-next-line max-len\n                annotCanvas.width = this.pdfViewerBase.pageSize[pageNumber].width * this.pdfViewerBase.getZoomFactor();\n                annotCanvas.height = this.pdfViewerBase.pageSize[pageNumber].height * this.pdfViewerBase.getZoomFactor();\n            }\n            this.renderTextMarkupAnnotations(null, pageNumber, annotCanvas, this.pdfViewerBase.getZoomFactor());\n        }\n    };\n    /**\n     * @param pageNumber\n     * @private\n     */\n    TextMarkupAnnotation.prototype.rerenderAnnotations = function (pageNumber) {\n        // eslint-disable-next-line\n        var oldCanvasCollection = document.querySelectorAll('#' + this.pdfViewer.element.id + '_old_annotationCanvas_' + pageNumber);\n        for (var i = 0; i < oldCanvasCollection.length; i++) {\n            if (oldCanvasCollection[i]) {\n                oldCanvasCollection[i].parentElement.removeChild(oldCanvasCollection[i]);\n            }\n        }\n        var newCanvas = this.pdfViewerBase.getElement('_annotationCanvas_' + pageNumber);\n        if (newCanvas) {\n            newCanvas.style.display = 'block';\n        }\n    };\n    /**\n     * @param event\n     * @private\n     */\n    TextMarkupAnnotation.prototype.onTextMarkupAnnotationMouseUp = function (event) {\n        var pageNumber = this.pdfViewer.annotationModule.getEventPageNumber(event);\n        if (!isNullOrUndefined(pageNumber) && !isNaN(pageNumber)) {\n            var canvas = this.pdfViewerBase.getElement('_annotationCanvas_' + pageNumber);\n            if (this.currentTextMarkupAnnotation) {\n                this.selectedTextMarkup = this.currentTextMarkupAnnotation;\n            }\n            else {\n                this.selectedTextMarkup = null;\n            }\n            this.clearCurrentSelectedAnnotation();\n            var currentAnnot = this.getCurrentMarkupAnnotation(event.clientX, event.clientY, pageNumber, canvas);\n            if (currentAnnot && !window.getSelection().toString()) {\n                var isLock = false;\n                var isSelection = false;\n                if (currentAnnot.annotationSettings && currentAnnot.annotationSettings.isLock) {\n                    isLock = currentAnnot.annotationSettings.isLock;\n                    if (isLock && this.pdfViewer.annotationModule.checkAllowedInteractions('Select', currentAnnot)) {\n                        isLock = false;\n                        if (this.pdfViewer.annotationModule.checkAllowedInteractions('PropertyChange', currentAnnot)) {\n                            isSelection = false;\n                        }\n                        else {\n                            isSelection = true;\n                        }\n                    }\n                }\n                if (!isLock) {\n                    var canvasParentPosition = canvas.parentElement.getBoundingClientRect();\n                    var leftClickPosition = event.clientX - canvasParentPosition.left;\n                    var topClickPosition = event.clientY - canvasParentPosition.top;\n                    this.annotationClickPosition = { x: leftClickPosition, y: topClickPosition };\n                    this.selectAnnotation(currentAnnot, canvas, pageNumber, event);\n                    if (Browser.isDevice && !this.pdfViewer.enableDesktopMode && this.pdfViewer.enableToolbar && this.pdfViewer.enableAnnotationToolbar) {\n                        this.pdfViewer.toolbarModule.annotationToolbarModule.createPropertyTools(this.currentTextMarkupAnnotation.textMarkupAnnotationType);\n                    }\n                    this.currentTextMarkupAnnotation = currentAnnot;\n                    this.selectTextMarkupCurrentPage = pageNumber;\n                    if (!isSelection) {\n                        this.enableAnnotationPropertiesTool(true);\n                    }\n                    var commentPanelDiv = document.getElementById(this.pdfViewer.element.id + '_commantPanel');\n                    if (commentPanelDiv && commentPanelDiv.style.display === 'block') {\n                        // eslint-disable-next-line\n                        var accordionExpand = document.getElementById(this.pdfViewer.element.id + '_accordionContainer' + (pageNumber + 1));\n                        if (accordionExpand) {\n                            accordionExpand.ej2_instances[0].expandItem(true);\n                        }\n                        // eslint-disable-next-line\n                        var comments = document.getElementById(currentAnnot.annotName);\n                        if (comments) {\n                            comments.firstChild.click();\n                        }\n                    }\n                    if (!isBlazor()) {\n                        if (this.pdfViewer.toolbarModule && this.pdfViewer.enableAnnotationToolbar) {\n                            this.pdfViewer.toolbarModule.annotationToolbarModule.isToolbarHidden = true;\n                            // eslint-disable-next-line max-len\n                            this.pdfViewer.toolbarModule.annotationToolbarModule.showAnnotationToolbar(this.pdfViewer.toolbarModule.annotationItem);\n                        }\n                    }\n                }\n            }\n            else {\n                this.clearCurrentAnnotation();\n            }\n            if (this.pdfViewer.isMaintainSelection && !this.pdfViewer.textSelectionModule.isTextSelection) {\n                if (currentAnnot) {\n                    this.clearCurrentAnnotationSelection(pageNumber);\n                }\n            }\n            else {\n                this.clearCurrentAnnotationSelection(pageNumber);\n            }\n        }\n        else {\n            if (!this.pdfViewerBase.isClickedOnScrollBar(event, true)) {\n                this.clearCurrentAnnotation();\n                this.clearCurrentAnnotationSelection(pageNumber);\n            }\n        }\n    };\n    /**\n     * @param event\n     * @private\n     */\n    TextMarkupAnnotation.prototype.onTextMarkupAnnotationTouchEnd = function (event) {\n        var pageNumber = this.pdfViewer.annotationModule.getEventPageNumber(event);\n        if (!isNullOrUndefined(pageNumber) && !isNaN(pageNumber)) {\n            if (this.currentTextMarkupAnnotation) {\n                this.selectedTextMarkup = this.currentTextMarkupAnnotation;\n            }\n            else {\n                this.selectedTextMarkup = null;\n            }\n            this.clearCurrentAnnotationSelection(pageNumber);\n            var touchCanvas = this.pdfViewerBase.getElement('_annotationCanvas_' + pageNumber);\n            this.clearCurrentSelectedAnnotation();\n            // eslint-disable-next-line max-len\n            var currentAnnot = this.getCurrentMarkupAnnotation(event.touches[0].clientX, event.touches[0].clientY, pageNumber, touchCanvas);\n            if (currentAnnot) {\n                var isLock = false;\n                if (currentAnnot.annotationSettings && currentAnnot.annotationSettings.isLock) {\n                    isLock = currentAnnot.annotationSettings.isLock;\n                }\n                if (!isLock) {\n                    var canvasParentPosition = touchCanvas.parentElement.getBoundingClientRect();\n                    var leftClickPosition = event.touches[0].clientX - canvasParentPosition.left;\n                    var topClickPosition = event.touches[0].clientY - canvasParentPosition.top;\n                    this.annotationClickPosition = { x: leftClickPosition, y: topClickPosition };\n                    this.selectAnnotation(currentAnnot, touchCanvas, pageNumber, event);\n                    if (Browser.isDevice && !this.pdfViewer.enableDesktopMode && this.pdfViewer.enableToolbar && this.pdfViewer.enableAnnotationToolbar) {\n                        this.pdfViewer.toolbarModule.annotationToolbarModule.createPropertyTools(this.currentTextMarkupAnnotation.textMarkupAnnotationType);\n                    }\n                    this.currentTextMarkupAnnotation = currentAnnot;\n                    this.selectTextMarkupCurrentPage = pageNumber;\n                    this.enableAnnotationPropertiesTool(true);\n                    // eslint-disable-next-line\n                    var accordionExpand = document.getElementById(this.pdfViewer.element.id + '_accordionContainer' + (pageNumber + 1));\n                    if (accordionExpand) {\n                        accordionExpand.ej2_instances[0].expandItem(true);\n                    }\n                    // eslint-disable-next-line\n                    var comments = document.getElementById(currentAnnot.annotName);\n                    if (comments) {\n                        if (!Browser.isDevice) {\n                            comments.firstChild.click();\n                        }\n                    }\n                }\n            }\n            else {\n                this.clearCurrentAnnotation();\n            }\n            this.clearCurrentAnnotationSelection(pageNumber);\n        }\n        else if (this.selectTextMarkupCurrentPage != null && (Browser.isDevice && !this.pdfViewer.enableDesktopMode)) {\n            var number = this.selectTextMarkupCurrentPage;\n            this.selectTextMarkupCurrentPage = null;\n            this.clearAnnotationSelection(number);\n        }\n        else {\n            this.clearCurrentAnnotation();\n            this.clearCurrentAnnotationSelection(pageNumber);\n        }\n    };\n    /**\n     * @private\n     */\n    TextMarkupAnnotation.prototype.clearCurrentSelectedAnnotation = function () {\n        if (this.currentTextMarkupAnnotation) {\n            this.clearAnnotationSelection(this.selectTextMarkupCurrentPage);\n            // eslint-disable-next-line\n            var currentAnnot = this.currentTextMarkupAnnotation;\n            this.pdfViewer.fireAnnotationUnSelect(currentAnnot.annotName, currentAnnot.pageNumber, currentAnnot);\n            this.clearCurrentAnnotation();\n        }\n    };\n    /**\n     * @param event\n     * @private\n     */\n    TextMarkupAnnotation.prototype.onTextMarkupAnnotationMouseMove = function (event) {\n        var eventTarget = event.target;\n        // eslint-disable-next-line\n        var pageIndex = parseInt(eventTarget.id.split('_text_')[1]) || parseInt(eventTarget.id.split('_textLayer_')[1]) || parseInt(eventTarget.id.split('_annotationCanvas_')[1]);\n        if (event.target && (eventTarget.id.indexOf('_text') > -1 || eventTarget.id.indexOf('_annotationCanvas') > -1 || eventTarget.classList.contains('e-pv-hyperlink')) && this.pdfViewer.annotation) {\n            pageIndex = this.pdfViewer.annotation.getEventPageNumber(event);\n            var canvas = this.pdfViewerBase.getElement('_annotationCanvas_' + pageIndex);\n            var currentAnnot = this.getCurrentMarkupAnnotation(event.clientX, event.clientY, pageIndex, canvas);\n            if (currentAnnot) {\n                eventTarget.style.cursor = 'pointer';\n                // eslint-disable-next-line\n                var currentPosition = this.pdfViewerBase.getMousePosition(event);\n                // eslint-disable-next-line\n                var relativePosition = this.pdfViewerBase.relativePosition(event);\n                // eslint-disable-next-line\n                var viewerPositions = { left: relativePosition.x, top: relativePosition.y };\n                // eslint-disable-next-line\n                var mousePositions = { left: currentPosition.x, top: currentPosition.y };\n                // eslint-disable-next-line\n                var annotationSettings = { opacity: currentAnnot.opacity, color: currentAnnot.color, author: currentAnnot.author, subject: currentAnnot.subject, modifiedDate: currentAnnot.modifiedDate };\n                // eslint-disable-next-line max-len\n                this.pdfViewerBase.isMousedOver = true;\n                this.pdfViewer.fireAnnotationMouseover(currentAnnot.annotName, currentAnnot.pageNumber, currentAnnot.textMarkupAnnotationType, currentAnnot.bounds, annotationSettings, mousePositions, viewerPositions);\n                // this.showPopupNote(event, currentAnnot);\n            }\n            else {\n                this.pdfViewer.annotationModule.hidePopupNote();\n                if (this.pdfViewerBase.isPanMode && !this.pdfViewerBase.getAnnotationToolStatus()) {\n                    eventTarget.style.cursor = 'grab';\n                }\n                if (this.pdfViewerBase.isMousedOver && !this.pdfViewerBase.isFormFieldMousedOver) {\n                    this.pdfViewer.fireAnnotationMouseLeave(pageIndex);\n                    this.pdfViewerBase.isMousedOver = false;\n                }\n            }\n        }\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.showPopupNote = function (event, annotation) {\n        if (annotation.note) {\n            // eslint-disable-next-line max-len\n            this.pdfViewer.annotationModule.showPopupNote(event, annotation.color, annotation.author, annotation.note, annotation.textMarkupAnnotationType);\n        }\n    };\n    TextMarkupAnnotation.prototype.getCurrentMarkupAnnotation = function (clientX, clientY, pageNumber, canvas) {\n        var currentTextMarkupAnnotations = [];\n        if (canvas) {\n            var canvasParentPosition = canvas.parentElement.getBoundingClientRect();\n            if (canvas.clientWidth !== canvas.parentElement.clientWidth) {\n                canvasParentPosition = canvas.getBoundingClientRect();\n            }\n            var leftClickPosition = clientX - canvasParentPosition.left;\n            var topClickPosition = clientY - canvasParentPosition.top;\n            var annotationList = this.getAnnotations(pageNumber, null);\n            var isAnnotationGot = false;\n            if (annotationList) {\n                for (var i = 0; i < annotationList.length; i++) {\n                    var annotation = annotationList[i];\n                    for (var j = 0; j < annotation.bounds.length; j++) {\n                        // eslint-disable-next-line\n                        var bound = annotation.bounds[j];\n                        var left = bound.left ? bound.left : bound.Left;\n                        var top_2 = bound.top ? bound.top : bound.Top;\n                        var width = bound.width ? bound.width : bound.Width;\n                        var height = bound.height ? bound.height : bound.Height;\n                        // eslint-disable-next-line max-len\n                        if (leftClickPosition >= this.getMagnifiedValue(left, this.pdfViewerBase.getZoomFactor()) && leftClickPosition <= this.getMagnifiedValue(left + width, this.pdfViewerBase.getZoomFactor()) && topClickPosition >= this.getMagnifiedValue(top_2, this.pdfViewerBase.getZoomFactor()) && topClickPosition <= this.getMagnifiedValue(top_2 + height, this.pdfViewerBase.getZoomFactor())) {\n                            currentTextMarkupAnnotations.push(annotation);\n                            isAnnotationGot = true;\n                        }\n                        else {\n                            if (isAnnotationGot) {\n                                isAnnotationGot = false;\n                                break;\n                            }\n                        }\n                    }\n                }\n            }\n            var currentAnnot = null;\n            if (currentTextMarkupAnnotations.length > 1) {\n                currentAnnot = this.compareCurrentAnnotations(currentTextMarkupAnnotations);\n            }\n            else if (currentTextMarkupAnnotations.length === 1) {\n                currentAnnot = currentTextMarkupAnnotations[0];\n            }\n            return currentAnnot;\n        }\n        else {\n            return null;\n        }\n    };\n    TextMarkupAnnotation.prototype.compareCurrentAnnotations = function (annotations) {\n        var previousX;\n        var currentAnnotation = null;\n        for (var i = 0; i < annotations.length; i++) {\n            if (i === annotations.length - 1) {\n                break;\n            }\n            // eslint-disable-next-line\n            var firstAnnotBounds = annotations[i].bounds;\n            var firstXposition = firstAnnotBounds[0].left ? firstAnnotBounds[0].left : firstAnnotBounds[0].Left;\n            var firstYposition = firstAnnotBounds[0].top ? firstAnnotBounds[0].top : firstAnnotBounds[0].Top;\n            // eslint-disable-next-line\n            var secondAnnotBounds = annotations[i + 1].bounds;\n            var secondXposition = secondAnnotBounds[0].left ? secondAnnotBounds[0].left : secondAnnotBounds[0].Left;\n            var secondYposition = secondAnnotBounds[0].top ? secondAnnotBounds[0].top : secondAnnotBounds[0].Top;\n            if ((firstXposition < secondXposition) || (firstYposition < secondYposition)) {\n                previousX = secondXposition;\n                currentAnnotation = annotations[i + 1];\n            }\n            else {\n                previousX = firstXposition;\n                currentAnnotation = annotations[i];\n            }\n            if (previousX && (i === (annotations.length - 2))) {\n                if ((previousX === firstXposition) && (previousX === secondXposition)) {\n                    previousX = secondXposition;\n                    currentAnnotation = annotations[i + 1];\n                }\n            }\n        }\n        return currentAnnotation;\n    };\n    /**\n     * @param pageNumber\n     * @private\n     */\n    TextMarkupAnnotation.prototype.clearAnnotationSelection = function (pageNumber) {\n        var canvas = this.pdfViewerBase.getElement('_annotationCanvas_' + pageNumber);\n        if (canvas) {\n            var context = canvas.getContext('2d');\n            context.setLineDash([]);\n            this.pdfViewer.annotationModule.renderAnnotations(pageNumber, null, null, null);\n        }\n    };\n    /**\n     * @param annotation\n     * @param canvas\n     * @param pageNumber\n     * @param event\n     * @param isProgrammaticSelection\n     * @param annotation\n     * @param canvas\n     * @param pageNumber\n     * @param event\n     * @param isProgrammaticSelection\n     * @private\n     */\n    // eslint-disable-next-line max-len\n    TextMarkupAnnotation.prototype.selectAnnotation = function (annotation, canvas, pageNumber, event, isProgrammaticSelection) {\n        if (this.pdfViewer.selectedItems.annotations[0]) {\n            this.pdfViewer.clearSelection(this.pdfViewer.selectedItems.annotations[0].pageIndex);\n            this.pdfViewer.clearSelection(this.selectTextMarkupCurrentPage);\n        }\n        var isLock = false;\n        if (annotation.annotationSettings && annotation.annotationSettings.isLock) {\n            isLock = annotation.annotationSettings.isLock;\n            if (isLock && this.pdfViewer.annotationModule.checkAllowedInteractions('Select', annotation)) {\n                isLock = false;\n            }\n        }\n        if (!isLock) {\n            var isCurrentTextMarkup = false;\n            if (!this.currentTextMarkupAnnotation) {\n                isCurrentTextMarkup = true;\n            }\n            if (this.selectedTextMarkup && annotation && !isProgrammaticSelection) {\n                if (this.selectedTextMarkup.annotName === annotation.annotName) {\n                    isCurrentTextMarkup = false;\n                }\n                else {\n                    isCurrentTextMarkup = true;\n                }\n            }\n            if (!isNaN(pageNumber)) {\n                this.selectTextMarkupCurrentPage = pageNumber;\n                this.currentTextMarkupAnnotation = annotation;\n                annotation = this.retreiveTextIndex(annotation);\n                this.currentTextMarkupAnnotation = annotation;\n            }\n            if (this.isSelectedAnnotation && this.pdfViewer.textSelectionModule) {\n                this.pdfViewerBase.isSelection = true;\n                this.updateAnnotationBounds();\n            }\n            // eslint-disable-next-line\n            var currentEvent = event;\n            if (this.isEnableTextMarkupResizer(annotation.textMarkupAnnotationType) && annotation && currentEvent && !currentEvent.touches) {\n                this.updateCurrentResizerPosition(annotation);\n            }\n            this.drawAnnotationSelector(annotation, this.currentTextMarkupAnnotation, canvas);\n            if (annotation.isMultiSelect && annotation.annotNameCollection) {\n                this.selectMultiPageAnnotations(annotation);\n            }\n            if (annotation.annotName !== '' && !this.isNewAnnotation) {\n                if (isCurrentTextMarkup) {\n                    var isSelected = false;\n                    if (!currentEvent) {\n                        isSelected = true;\n                    }\n                    // eslint-disable-next-line max-len\n                    this.pdfViewer.annotationModule.annotationSelect(annotation.annotName, this.selectTextMarkupCurrentPage, annotation, null, false, isSelected);\n                    this.selectedTextMarkup = null;\n                }\n            }\n            if (annotation && this.isEnableTextMarkupResizer(annotation.textMarkupAnnotationType)) {\n                this.isTextMarkupAnnotationMode = true;\n            }\n        }\n    };\n    /**\n     * @param annotation\n     * @private\n     */\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.updateCurrentResizerPosition = function (annotation) {\n        if (!annotation) {\n            annotation = this.currentTextMarkupAnnotation;\n        }\n        if (annotation) {\n            if (this.isEnableTextMarkupResizer(annotation.textMarkupAnnotationType) && annotation) {\n                // eslint-disable-next-line\n                var textElement = this.pdfViewerBase.getElement('_textLayer_' + this.selectTextMarkupCurrentPage);\n                if (textElement) {\n                    // eslint-disable-next-line\n                    var boundingRect = textElement.getBoundingClientRect();\n                    var left = annotation.bounds[0].left ? annotation.bounds[0].left : annotation.bounds[0].Left;\n                    var top_3 = annotation.bounds[0].top ? annotation.bounds[0].top : annotation.bounds[0].Top;\n                    this.updateLeftposition(left * this.pdfViewerBase.getZoomFactor() + boundingRect.left, (boundingRect.top + top_3), true);\n                    // eslint-disable-next-line\n                    var endPosition = annotation.bounds[annotation.bounds.length - 1];\n                    var endLeft = endPosition.left ? endPosition.left : endPosition.Left;\n                    var endTop = endPosition.top ? endPosition.top : endPosition.Top;\n                    var endWidth = endPosition.width ? endPosition.width : endPosition.Width;\n                    // eslint-disable-next-line max-len\n                    this.updatePosition((endLeft + endWidth) * this.pdfViewerBase.getZoomFactor() + boundingRect.left, (endTop + boundingRect.top), true);\n                }\n            }\n        }\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.drawAnnotationSelectRect = function (canvas, x, y, width, height, annotation) {\n        var ratio = this.pdfViewerBase.getZoomRatio();\n        if (canvas) {\n            var context = canvas.getContext('2d');\n            context.setTransform(1, 0, 0, 1, 0, 0);\n            context.beginPath();\n            if (typeof (annotation).annotationSelectorSettings === 'string') {\n                // eslint-disable-next-line max-len\n                var lineDash = JSON.parse(annotation.annotationSelectorSettings).selectorLineDashArray.length === 0 ? [4] : JSON.parse(annotation.annotationSelectorSettings).selectorLineDashArray;\n                if (lineDash.length > 2) {\n                    lineDash = [lineDash[0], lineDash[1]];\n                }\n                context.setLineDash(lineDash);\n                context.globalAlpha = 1;\n                context.rect(x * ratio, y * ratio, width * ratio, height * ratio);\n                context.closePath();\n                // eslint-disable-next-line max-len\n                var borderColor = JSON.parse(annotation.annotationSelectorSettings).selectionBorderColor === '' ? '#0000ff' : JSON.parse(annotation.annotationSelectorSettings).selectionBorderColor;\n                context.strokeStyle = borderColor;\n                // eslint-disable-next-line max-len\n                context.lineWidth = JSON.parse(annotation.annotationSelectorSettings).selectionBorderThickness === 1 ? 1 : (annotation.annotationSelectorSettings).selectionBorderThickness;\n                context.stroke();\n                context.save();\n            }\n            else {\n                // eslint-disable-next-line max-len\n                var lineDash = (annotation.annotationSelectorSettings).selectorLineDashArray.length === 0 ? [4] : (annotation.annotationSelectorSettings).selectorLineDashArray;\n                if (lineDash.length > 2) {\n                    lineDash = [lineDash[0], lineDash[1]];\n                }\n                context.setLineDash(lineDash);\n                context.globalAlpha = 1;\n                context.rect(x * ratio, y * ratio, width * ratio, height * ratio);\n                context.closePath();\n                // eslint-disable-next-line max-len\n                var borderColor = (annotation.annotationSelectorSettings).selectionBorderColor === '' ? '#0000ff' : (annotation.annotationSelectorSettings).selectionBorderColor;\n                context.strokeStyle = borderColor;\n                // eslint-disable-next-line max-len\n                context.lineWidth = (annotation.annotationSelectorSettings).selectionBorderThickness ? 1 : (annotation.annotationSelectorSettings).selectionBorderThickness;\n                context.stroke();\n                context.save();\n            }\n        }\n    };\n    /**\n     * @param isEnable\n     * @private\n     */\n    TextMarkupAnnotation.prototype.enableAnnotationPropertiesTool = function (isEnable) {\n        if (this.pdfViewer.toolbarModule && this.pdfViewer.toolbarModule.annotationToolbarModule) {\n            // eslint-disable-next-line max-len\n            this.pdfViewer.toolbarModule.annotationToolbarModule.colorDropDownElementInBlazor = this.pdfViewer.element.querySelector('.e-pv-annotation-color-container');\n        }\n        // eslint-disable-next-line max-len\n        if (this.pdfViewer.toolbarModule && this.pdfViewer.toolbarModule.annotationToolbarModule) {\n            if (!Browser.isDevice) {\n                this.pdfViewer.toolbarModule.annotationToolbarModule.createMobileAnnotationToolbar(isEnable);\n            }\n        }\n        // eslint-disable-next-line max-len\n        if (this.pdfViewer.toolbarModule && this.pdfViewer.toolbarModule.annotationToolbarModule && this.pdfViewer.toolbarModule.annotationToolbarModule.isMobileAnnotEnabled && this.pdfViewer.selectedItems.annotations.length === 0) {\n            if (this.pdfViewer.toolbarModule.annotationToolbarModule) {\n                this.pdfViewer.toolbarModule.annotationToolbarModule.selectAnnotationDeleteItem(isEnable);\n                var enable = isEnable;\n                if (this.isTextMarkupAnnotationMode) {\n                    enable = true;\n                }\n                this.pdfViewer.toolbarModule.annotationToolbarModule.enableTextMarkupAnnotationPropertiesTools(enable);\n                if (this.currentTextMarkupAnnotation) {\n                    if (!isBlazor()) {\n                        // eslint-disable-next-line max-len\n                        this.pdfViewer.toolbarModule.annotationToolbarModule.updateColorInIcon(this.pdfViewer.toolbarModule.annotationToolbarModule.colorDropDownElement, this.currentTextMarkupAnnotation.color);\n                    }\n                    else {\n                        // eslint-disable-next-line max-len\n                        this.pdfViewer.toolbarModule.annotationToolbarModule.updateColorInIcon(this.pdfViewer.toolbarModule.annotationToolbarModule.colorDropDownElementInBlazor, this.currentTextMarkupAnnotation.color);\n                    }\n                }\n                else {\n                    if (!isNullOrUndefined(this.isTextMarkupAnnotationMode) && !this.isTextMarkupAnnotationMode) {\n                        if (!isBlazor()) {\n                            // eslint-disable-next-line max-len\n                            this.pdfViewer.toolbarModule.annotationToolbarModule.updateColorInIcon(this.pdfViewer.toolbarModule.annotationToolbarModule.colorDropDownElement, '#000000');\n                        }\n                        else {\n                            // eslint-disable-next-line max-len\n                            this.pdfViewer.toolbarModule.annotationToolbarModule.updateColorInIcon(this.pdfViewer.toolbarModule.annotationToolbarModule.colorDropDownElementInBlazor, '#000000');\n                        }\n                    }\n                    else {\n                        this.pdfViewer.toolbarModule.annotationToolbarModule.setCurrentColorInPicker();\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TextMarkupAnnotation.prototype.maintainAnnotationSelection = function () {\n        if (this.currentTextMarkupAnnotation) {\n            var canvas = this.pdfViewerBase.getElement('_annotationCanvas_' + this.selectTextMarkupCurrentPage);\n            if (canvas) {\n                this.selectAnnotation(this.currentTextMarkupAnnotation, canvas, this.selectTextMarkupCurrentPage);\n            }\n        }\n    };\n    // private storeAnnotations(pageNumber: number, annotation: ITextMarkupAnnotation): number {\n    // eslint-disable-next-line\n    //     let storeObject: any = window.sessionStorage.getItem(this.pdfViewerBase.documentId + '_annotations_textMarkup');\n    //     let index: number = 0;\n    //     if (!storeObject) {\n    //         let markupAnnotation: IPageAnnotations = { pageIndex: pageNumber, annotations: [] };\n    //         markupAnnotation.annotations.push(annotation);\n    //         index = markupAnnotation.annotations.indexOf(annotation);\n    //         let annotationCollection: IPageAnnotations[] = [];\n    //         annotationCollection.push(markupAnnotation);\n    //         let annotationStringified: string = JSON.stringify(annotationCollection);\n    //         window.sessionStorage.setItem(this.pdfViewerBase.documentId + '_annotations_textMarkup', annotationStringified);\n    //     } else {\n    //         let annotObject: IPageAnnotations[] = JSON.parse(storeObject);\n    //         window.sessionStorage.removeItem(this.pdfViewerBase.documentId + '_annotations_textMarkup');\n    //         let pageIndex: number = this.pdfViewer.annotationModule.getPageCollection(annotObject, pageNumber);\n    //         if (annotObject[pageIndex]) {\n    //             (annotObject[pageIndex] as IPageAnnotations).annotations.push(annotation);\n    //             index = (annotObject[pageIndex] as IPageAnnotations).annotations.indexOf(annotation);\n    //         } else {\n    //             let markupAnnotation: IPageAnnotations = { pageIndex: pageNumber, annotations: [] };\n    //             markupAnnotation.annotations.push(annotation);\n    //             index = markupAnnotation.annotations.indexOf(annotation);\n    //             annotObject.push(markupAnnotation);\n    //         }\n    //         let annotationStringified: string = JSON.stringify(annotObject);\n    //         window.sessionStorage.setItem(this.pdfViewerBase.documentId + '_annotations_textMarkup', annotationStringified);\n    //     }\n    //     return index;\n    // }\n    /**\n     * @param pageAnnotations\n     * @param pageNumber\n     * @private\n     */\n    TextMarkupAnnotation.prototype.manageAnnotations = function (pageAnnotations, pageNumber) {\n        // eslint-disable-next-line\n        var storeObject = window.sessionStorage.getItem(this.pdfViewerBase.documentId + '_annotations_textMarkup');\n        if (this.pdfViewerBase.isStorageExceed) {\n            storeObject = this.pdfViewerBase.annotationStorage[this.pdfViewerBase.documentId + '_annotations_textMarkup'];\n        }\n        if (storeObject) {\n            var annotObject = JSON.parse(storeObject);\n            if (!this.pdfViewerBase.isStorageExceed) {\n                window.sessionStorage.removeItem(this.pdfViewerBase.documentId + '_annotations_textMarkup');\n            }\n            var index = this.pdfViewer.annotationModule.getPageCollection(annotObject, pageNumber);\n            if (annotObject[index]) {\n                annotObject[index].annotations = pageAnnotations;\n            }\n            var annotationStringified = JSON.stringify(annotObject);\n            if (this.pdfViewerBase.isStorageExceed) {\n                this.pdfViewerBase.annotationStorage[this.pdfViewerBase.documentId + '_annotations_textMarkup'] = annotationStringified;\n            }\n            else {\n                window.sessionStorage.setItem(this.pdfViewerBase.documentId + '_annotations_textMarkup', annotationStringified);\n            }\n        }\n    };\n    /**\n     * @param pageIndex\n     * @param textMarkupAnnotations\n     * @param id\n     * @param pageIndex\n     * @param textMarkupAnnotations\n     * @param id\n     * @private\n     */\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.getAnnotations = function (pageIndex, textMarkupAnnotations, id) {\n        // eslint-disable-next-line\n        var annotationCollection;\n        // eslint-disable-next-line\n        if (id == null || id == undefined) {\n            id = '_annotations_textMarkup';\n        }\n        // eslint-disable-next-line\n        var storeObject = window.sessionStorage.getItem(this.pdfViewerBase.documentId + id);\n        if (this.pdfViewerBase.isStorageExceed) {\n            storeObject = this.pdfViewerBase.annotationStorage[this.pdfViewerBase.documentId + id];\n        }\n        if (storeObject) {\n            var annotObject = JSON.parse(storeObject);\n            var index = this.pdfViewer.annotationModule.getPageCollection(annotObject, pageIndex);\n            if (annotObject[index]) {\n                annotationCollection = annotObject[index].annotations;\n            }\n            else {\n                annotationCollection = textMarkupAnnotations;\n            }\n        }\n        else {\n            annotationCollection = textMarkupAnnotations;\n        }\n        return annotationCollection;\n    };\n    // eslint-disable-next-line max-len\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.getAddedAnnotation = function (type, color, opacity, bounds, author, subject, predefinedDate, note, isCommentLock, rect, pageNumber, textContent, startIndex, endIndex, isMultiSelect, allowedInteractions, annotationRotate) {\n        // eslint-disable-next-line max-len\n        var modifiedDate = predefinedDate ? predefinedDate : this.pdfViewer.annotation.stickyNotesAnnotationModule.getDateAndTime();\n        var annotationName = this.pdfViewer.annotation.createGUID();\n        var commentsDivid = this.pdfViewer.annotation.stickyNotesAnnotationModule.addComments('textMarkup', pageNumber + 1, type);\n        if (commentsDivid) {\n            document.getElementById(commentsDivid).id = annotationName;\n        }\n        // eslint-disable-next-line\n        var annotationSettings = this.pdfViewer.annotationSettings ? this.pdfViewer.annotationSettings : this.pdfViewer.annotationModule.updateAnnotationSettings(this.pdfViewer.annotation);\n        var isPrint = this.getIsPrintValue(type);\n        var annotation = {\n            // eslint-disable-next-line max-len\n            textMarkupAnnotationType: type, color: color, opacity: opacity, bounds: bounds, author: author, allowedInteractions: allowedInteractions, subject: subject, modifiedDate: modifiedDate, note: note, rect: rect,\n            annotName: annotationName, comments: [], review: { state: '', stateModel: '', author: author, modifiedDate: modifiedDate }, shapeAnnotationType: 'textMarkup', pageNumber: pageNumber,\n            // eslint-disable-next-line max-len\n            textMarkupContent: textContent, textMarkupStartIndex: startIndex, textMarkupEndIndex: endIndex, isMultiSelect: isMultiSelect, annotationSelectorSettings: this.getSelector(type),\n            customData: this.pdfViewer.annotation.getTextMarkupData(subject), annotationAddMode: this.annotationAddMode, annotationSettings: annotationSettings, isPrint: isPrint, isCommentLock: isCommentLock, isAnnotationRotated: false, annotationRotation: annotationRotate,\n            isLocked: false\n        };\n        if (isMultiSelect) {\n            this.multiPageCollection.push(annotation);\n        }\n        var isSkip = false;\n        if (isMultiSelect && this.isExtended) {\n            isSkip = true;\n        }\n        if (document.getElementById(annotationName) && !isSkip) {\n            document.getElementById(annotationName).addEventListener('mouseup', this.annotationDivSelect(annotation, pageNumber));\n        }\n        var storedIndex = this.pdfViewer.annotationModule.storeAnnotations(pageNumber, annotation, '_annotations_textMarkup');\n        this.pdfViewer.annotationModule.addAction(pageNumber, storedIndex, annotation, 'Text Markup Added', null);\n        return annotation;\n    };\n    TextMarkupAnnotation.prototype.getSelector = function (type) {\n        var selector = this.pdfViewer.annotationSelectorSettings;\n        if (type === 'Highlight' && this.pdfViewer.highlightSettings.annotationSelectorSettings) {\n            selector = this.pdfViewer.highlightSettings.annotationSelectorSettings;\n        }\n        else if (type === 'Underline' && this.pdfViewer.underlineSettings.annotationSelectorSettings) {\n            selector = this.pdfViewer.underlineSettings.annotationSelectorSettings;\n        }\n        else if (type === 'Strikethrough' && this.pdfViewer.strikethroughSettings.annotationSelectorSettings) {\n            selector = this.pdfViewer.strikethroughSettings.annotationSelectorSettings;\n        }\n        return selector;\n    };\n    TextMarkupAnnotation.prototype.getIsPrintValue = function (type) {\n        var isPrint = true;\n        if (type === 'Highlight') {\n            isPrint = this.pdfViewer.highlightSettings.isPrint;\n        }\n        if (type === 'Underline') {\n            isPrint = this.pdfViewer.underlineSettings.isPrint;\n        }\n        if (type === 'Strikethrough') {\n            isPrint = this.pdfViewer.strikethroughSettings.isPrint;\n        }\n        if (isNullOrUndefined(isPrint)) {\n            isPrint = true;\n        }\n        return isPrint;\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.annotationDivSelect = function (annotation, pageNumber) {\n        var canvas = this.pdfViewerBase.getElement('_annotationCanvas_' + pageNumber);\n        this.selectAnnotation(annotation, canvas, pageNumber);\n        if (this.pdfViewer.toolbarModule) {\n            if (this.pdfViewer.toolbarModule.annotationToolbarModule && this.pdfViewer.enableAnnotationToolbar) {\n                this.pdfViewer.toolbarModule.annotationToolbarModule.clearShapeMode();\n                this.pdfViewer.toolbarModule.annotationToolbarModule.clearMeasureMode();\n                var isLock = false;\n                if (annotation.annotationSettings && annotation.annotationSettings.isLock) {\n                    isLock = annotation.annotationSettings.isLock;\n                }\n                if (isLock) {\n                    if (this.pdfViewer.annotationModule.checkAllowedInteractions('PropertyChange', annotation)) {\n                        this.pdfViewer.toolbarModule.annotationToolbarModule.enableTextMarkupAnnotationPropertiesTools(true);\n                        this.pdfViewer.toolbarModule.annotationToolbarModule.setCurrentColorInPicker();\n                    }\n                    if (this.pdfViewer.annotationModule.checkAllowedInteractions('Delete', annotation)) {\n                        this.pdfViewer.toolbarModule.annotationToolbarModule.selectAnnotationDeleteItem(true);\n                    }\n                }\n                else {\n                    this.pdfViewer.toolbarModule.annotationToolbarModule.enableTextMarkupAnnotationPropertiesTools(true);\n                    this.pdfViewer.toolbarModule.annotationToolbarModule.selectAnnotationDeleteItem(true);\n                    this.pdfViewer.toolbarModule.annotationToolbarModule.setCurrentColorInPicker();\n                }\n                this.pdfViewer.toolbarModule.annotationToolbarModule.isToolbarHidden = true;\n                if (!isBlazor()) {\n                    this.pdfViewer.toolbarModule.annotationToolbarModule.showAnnotationToolbar(this.pdfViewer.toolbarModule.annotationItem);\n                }\n            }\n        }\n    };\n    TextMarkupAnnotation.prototype.getPageContext = function (pageNumber) {\n        var canvas = this.pdfViewerBase.getElement('_annotationCanvas_' + pageNumber);\n        var context = null;\n        if (canvas) {\n            context = canvas.getContext('2d');\n        }\n        return context;\n    };\n    TextMarkupAnnotation.prototype.getDefaultValue = function (value) {\n        return value / this.pdfViewerBase.getZoomFactor();\n    };\n    TextMarkupAnnotation.prototype.getMagnifiedValue = function (value, factor) {\n        return value * factor;\n    };\n    /**\n     * @param annotation\n     * @param pageNumber\n     * @private\n     */\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.saveImportedTextMarkupAnnotations = function (annotation, pageNumber) {\n        var annotationObject = null;\n        annotation.Author = this.pdfViewer.annotationModule.updateAnnotationAuthor('textMarkup', annotation.Subject);\n        // eslint-disable-next-line max-len\n        annotation.allowedInteractions = this.pdfViewer.annotationModule.updateAnnotationAllowedInteractions(annotation);\n        annotation.AnnotationSettings = annotation.AnnotationSettings ? annotation.AnnotationSettings : this.pdfViewer.annotationModule.updateSettings(this.pdfViewer.customStampSettings);\n        // eslint-disable-next-line max-len\n        annotationObject = {\n            // eslint-disable-next-line max-len\n            textMarkupAnnotationType: annotation.TextMarkupAnnotationType, color: annotation.Color, opacity: annotation.Opacity, allowedInteractions: annotation.allowedInteractions, bounds: annotation.Bounds, author: annotation.Author, subject: annotation.Subject, modifiedDate: annotation.ModifiedDate, note: annotation.Note, rect: annotation.Rect,\n            annotName: annotation.AnnotName, isLocked: annotation.IsLocked, comments: this.pdfViewer.annotationModule.getAnnotationComments(annotation.Comments, annotation, annotation.Author), review: { state: annotation.State, stateModel: annotation.StateModel, modifiedDate: annotation.ModifiedDate, author: annotation.Author },\n            shapeAnnotationType: 'textMarkup',\n            pageNumber: pageNumber, textMarkupContent: '', textMarkupStartIndex: 0,\n            // eslint-disable-next-line max-len\n            textMarkupEndIndex: 0, annotationSelectorSettings: this.getSettings(annotation), customData: this.pdfViewer.annotation.getCustomData(annotation),\n            isMultiSelect: annotation.IsMultiSelect, annotNameCollection: annotation.AnnotNameCollection, annotpageNumbers: annotation.AnnotpageNumbers,\n            // eslint-disable-next-line max-len\n            annotationAddMode: this.annotationAddMode, annotationSettings: annotation.AnnotationSettings, isPrint: annotation.IsPrint, isCommentLock: annotation.IsCommentLock, isAnnotationRotated: false\n        };\n        this.pdfViewer.annotationModule.storeAnnotations(pageNumber, annotationObject, '_annotations_textMarkup');\n    };\n    /**\n     * @param annotation\n     * @param pageNumber\n     * @param annotation\n     * @param pageNumber\n     * @private\n     */\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.updateTextMarkupAnnotationCollections = function (annotation, pageNumber) {\n        // eslint-disable-next-line\n        var annotationObject = null;\n        // eslint-disable-next-line max-len\n        annotation.allowedInteractions = annotation.AllowedInteractions ? annotation.AllowedInteractions : this.pdfViewer.annotationModule.updateAnnotationAllowedInteractions(annotation);\n        annotation.AnnotationSettings = annotation.AnnotationSettings ? annotation.AnnotationSettings : this.pdfViewer.annotationModule.updateSettings(this.pdfViewer.customStampSettings);\n        if (annotation.IsLocked) {\n            annotation.AnnotationSettings.isLock = annotation.IsLocked;\n        }\n        if (annotation.TextMarkupAnnotationType === \"Highlight\") {\n            annotation.AnnotationSelectorSettings = annotation.annotSelectorSettings ? annotation.annotSelectorSettings : this.pdfViewer.highlightSettings.annotationSelectorSettings;\n        }\n        else if (annotation.TextMarkupAnnotationType === \"Underline\") {\n            annotation.AnnotationSelectorSettings = annotation.annotSelectorSettings ? annotation.annotSelectorSettings : this.pdfViewer.underlineSettings.annotationSelectorSettings;\n        }\n        else {\n            annotation.AnnotationSelectorSettings = annotation.annotSelectorSettings ? annotation.annotSelectorSettings : this.pdfViewer.strikethroughSettings.annotationSelectorSettings;\n        }\n        annotationObject = {\n            // eslint-disable-next-line max-len\n            textMarkupAnnotationType: annotation.TextMarkupAnnotationType, allowedInteractions: annotation.allowedInteractions, color: annotation.Color, opacity: annotation.Opacity, bounds: annotation.Bounds, author: annotation.Author, subject: annotation.Subject, modifiedDate: annotation.ModifiedDate, note: annotation.Note, rect: annotation.Rect,\n            annotationId: annotation.AnnotName, comments: this.pdfViewer.annotationModule.getAnnotationComments(annotation.Comments, annotation, annotation.Author), review: { state: annotation.State, stateModel: annotation.StateModel, modifiedDate: annotation.ModifiedDate, author: annotation.Author }, shapeAnnotationType: 'textMarkup', pageNumber: pageNumber, isMultiSelect: annotation.IsMultiSelect, annotNameCollection: annotation.AnnotNameCollection, annotpageNumbers: annotation.AnnotpageNumbers, customData: this.pdfViewer.annotation.getCustomData(annotation),\n            annotationSettings: annotation.AnnotationSettings, isLocked: annotation.IsLocked, isPrint: annotation.IsPrint, isCommentLock: annotation.IsCommentLock, annotationSelectorSettings: annotation.AnnotationSelectorSettings\n        };\n        return annotationObject;\n    };\n    /**\n     * @param textMarkUpSettings\n     * @private\n     */\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.updateTextMarkupSettings = function (textMarkUpSettings) {\n        if (textMarkUpSettings === 'highlightSettings') {\n            // eslint-disable-next-line max-len\n            this.highlightColor = this.pdfViewer.highlightSettings.color ? this.pdfViewer.highlightSettings.color : this.highlightColor;\n            // eslint-disable-next-line max-len\n            this.highlightOpacity = this.pdfViewer.highlightSettings.opacity ? this.pdfViewer.highlightSettings.opacity : this.highlightOpacity;\n        }\n        if (textMarkUpSettings === 'underlineSettings') {\n            // eslint-disable-next-line max-len\n            this.underlineColor = this.pdfViewer.underlineSettings.color ? this.pdfViewer.underlineSettings.color : this.underlineColor;\n            // eslint-disable-next-line max-len\n            this.underlineOpacity = this.pdfViewer.underlineSettings.opacity ? this.pdfViewer.underlineSettings.opacity : this.underlineOpacity;\n        }\n        if (textMarkUpSettings === 'strikethroughSettings') {\n            // eslint-disable-next-line max-len\n            this.strikethroughColor = this.pdfViewer.strikethroughSettings.color ? this.pdfViewer.strikethroughSettings.color : this.strikethroughColor;\n            // eslint-disable-next-line max-len\n            this.strikethroughOpacity = this.pdfViewer.strikethroughSettings.opacity ? this.pdfViewer.strikethroughSettings.opacity : this.strikethroughOpacity;\n        }\n    };\n    /**\n     * @private\n     */\n    TextMarkupAnnotation.prototype.clear = function () {\n        this.selectTextMarkupCurrentPage = null;\n        this.currentTextMarkupAnnotation = null;\n        this.annotationClickPosition = null;\n        window.sessionStorage.removeItem(this.pdfViewerBase.documentId + '_annotations_textMarkup');\n    };\n    /**\n     * Get vertex points properties\n     * @private\n     */\n    TextMarkupAnnotation.prototype.getOffsetPoints = function (points) {\n        var offsetPoints = [];\n        //Converting points model into vertex property\n        for (var j = 0; j < points.length; j++) {\n            offsetPoints[j] = { X: points[j].x, Y: points[j].y, Width: points[j].width, Height: points[j].height, Left: points[j].x, Top: points[j].y };\n        }\n        return offsetPoints;\n    };\n    /**\n     * This method used to add annotations with using program.\n     *\n     * @param annotationType - It describes the annotation type\n     * @param annotationObject - It describes type of annotation object\n     * @returns Object\n     * @private\n     */\n    TextMarkupAnnotation.prototype.updateAddAnnotationDetails = function (annotationType, annotationObject) {\n        //Creating new object if annotationObject is null\n        if (!annotationObject) {\n            annotationObject = { pageNumber: 0 };\n        }\n        //Initialize the annotation settings\n        var annotSelectorSettings = null;\n        var annotallowedInteractions = null;\n        var textMarkupAnnotationType = '';\n        var annotSettings = null;\n        var color = '';\n        var bounds = [];\n        //Creating the CurrentDate and Annotation name\n        var currentDateString = this.pdfViewer.annotation.stickyNotesAnnotationModule.getDateAndTime();\n        var annotationName = this.pdfViewer.annotation.createGUID();\n        if (annotationType == 'Highlight') {\n            //Creating annotation settings\n            annotSelectorSettings = this.pdfViewer.highlightSettings.annotationSelectorSettings ? this.pdfViewer.highlightSettings.annotationSelectorSettings : this.pdfViewer.annotationSelectorSettings;\n            annotSettings = this.pdfViewer.annotationModule.updateSettings(this.pdfViewer.highlightSettings);\n            annotationObject.author = annotationObject.author ? annotationObject.author : this.pdfViewer.annotationModule.updateAnnotationAuthor('textMarkup', annotationType);\n            annotallowedInteractions = this.pdfViewer.highlightSettings.allowedInteractions ? this.pdfViewer.highlightSettings.allowedInteractions : this.pdfViewer.annotationSettings.allowedInteractions;\n            textMarkupAnnotationType = 'Highlight';\n            color = annotationObject.color ? annotationObject.color : '#ffff00';\n        }\n        else if (annotationType == 'Underline') {\n            //Creating annotation settings\n            annotSelectorSettings = this.pdfViewer.underlineSettings.annotationSelectorSettings ? this.pdfViewer.underlineSettings.annotationSelectorSettings : this.pdfViewer.annotationSelectorSettings;\n            annotSettings = this.pdfViewer.annotationModule.updateSettings(this.pdfViewer.underlineSettings);\n            annotationObject.author = annotationObject.author ? annotationObject.author : this.pdfViewer.annotationModule.updateAnnotationAuthor('textMarkup', annotationType);\n            annotallowedInteractions = this.pdfViewer.underlineSettings.allowedInteractions ? this.pdfViewer.underlineSettings.allowedInteractions : this.pdfViewer.annotationSettings.allowedInteractions;\n            textMarkupAnnotationType = 'Underline';\n            color = annotationObject.color ? annotationObject.color : '#00ff00';\n        }\n        else if (annotationType == 'Strikethrough') {\n            //Creating annotation settings\n            annotSelectorSettings = this.pdfViewer.strikethroughSettings.annotationSelectorSettings ? this.pdfViewer.strikethroughSettings.annotationSelectorSettings : this.pdfViewer.annotationSelectorSettings;\n            annotSettings = this.pdfViewer.annotationModule.updateSettings(this.pdfViewer.strikethroughSettings);\n            annotationObject.author = annotationObject.author ? annotationObject.author : this.pdfViewer.annotationModule.updateAnnotationAuthor('textMarkup', annotationType);\n            annotallowedInteractions = this.pdfViewer.strikethroughSettings.allowedInteractions ? this.pdfViewer.strikethroughSettings.allowedInteractions : this.pdfViewer.annotationSettings.allowedInteractions;\n            textMarkupAnnotationType = 'Strikethrough';\n            color = annotationObject.color ? annotationObject.color : '#ff0000';\n        }\n        annotSettings.isLock = annotationObject.isLock ? annotationObject.isLock : annotSettings.isLock;\n        //Creating the offset points\n        if (annotationObject.bounds) {\n            bounds = this.getOffsetPoints(annotationObject.bounds);\n        }\n        else\n            bounds = [{ X: 1, Y: 1, Width: 100, Height: 14, Left: 1, Top: 1, Location: { X: 1, Y: 1 }, Size: { Height: 14, IsEmpty: false, Width: 100 } }];\n        //Creating Annotation objects with it's proper properties       \n        var textMarkupAnnotation = [];\n        var textmarkup = {\n            AllowedInteractions: annotationObject.allowedInteractions ? annotationObject.allowedInteractions : annotallowedInteractions,\n            AnnotName: annotationName,\n            AnnotNameCollection: null,\n            AnnotType: 'textMarkup',\n            AnnotationSelectorSettings: annotationObject.annotationSelectorSettings ? annotationObject.annotationSelectorSettings : annotSelectorSettings,\n            AnnotationSettings: annotSettings,\n            Author: annotationObject.author ? annotationObject.author : 'Guest',\n            Bounds: bounds,\n            Color: annotationObject.color ? annotationObject.color : color,\n            Comments: null,\n            CreatedDate: currentDateString,\n            CustomData: annotationObject.customData ? annotationObject.customData : null,\n            ExistingCustomData: null,\n            EnableMultiPageAnnotation: annotationObject.enableMultiPageAnnotation ? annotationObject.enableMultiPageAnnotation : false,\n            EnableTextMarkupResizer: annotationObject.enableTextMarkupResizer ? annotationObject.enableTextMarkupResizer : false,\n            IsCommentLock: false,\n            IsMultiSelect: false,\n            IsLocked: annotationObject.isLock ? annotationObject.isLock : false,\n            IsLock: annotationObject.isLock ? annotationObject.isLock : false,\n            IsPrint: annotationObject.isPrint ? annotationObject.isPrint : true,\n            ModifiedDate: '',\n            Note: '',\n            Opacity: annotationObject.opacity ? annotationObject.opacity : 1,\n            Rect: {},\n            State: '',\n            StateModel: '',\n            Subject: annotationObject.subject ? annotationObject.subject : textMarkupAnnotationType,\n            TextMarkupAnnotationType: textMarkupAnnotationType,\n        };\n        //Adding the annotation object to an array and return it\n        textMarkupAnnotation[0] = textmarkup;\n        return { textMarkupAnnotation: textMarkupAnnotation };\n    };\n    return TextMarkupAnnotation;\n}());\nexport { TextMarkupAnnotation };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}