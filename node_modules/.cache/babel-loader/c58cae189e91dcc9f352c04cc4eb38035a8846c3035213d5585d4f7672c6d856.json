{"ast":null,"code":"/* eslint-disable */\nimport { Browser, isBlazor, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { getDiagramElement } from '@syncfusion/ej2-drawings';\n/**\n * Magnification module\n */\nvar Magnification = /** @class */function () {\n  /**\n   * @param pdfViewer\n   * @param viewerBase\n   * @private\n   */\n  function Magnification(pdfViewer, viewerBase) {\n    /**\n     * @private\n     */\n    this.zoomFactor = 1;\n    /**\n     * @private\n     */\n    this.previousZoomFactor = 1;\n    this.scrollWidth = 25;\n    this.zoomPercentages = [10, 25, 50, 75, 100, 125, 150, 200, 400];\n    this.isNotPredefinedZoom = false;\n    this.pinchStep = 0;\n    this.reRenderPageNumber = 0;\n    // eslint-disable-next-line\n    this.magnifyPageRerenderTimer = null;\n    // eslint-disable-next-line\n    this.rerenderOnScrollTimer = null;\n    // eslint-disable-next-line\n    this.rerenderInterval = null;\n    this.touchCenterX = 0;\n    this.touchCenterY = 0;\n    this.mouseCenterX = 0;\n    this.mouseCenterY = 0;\n    this.pageRerenderCount = 0;\n    this.imageObjects = [];\n    this.topValue = 0;\n    this.isTapToFitZoom = false;\n    /**\n     * @private\n     */\n    this.fitType = null;\n    /**\n     * @private\n     */\n    this.isPinchZoomed = false;\n    /**\n     * @private\n     */\n    this.isPagePinchZoomed = false;\n    /**\n     * @private\n     */\n    this.isRerenderCanvasCreated = false;\n    /**\n     * @private\n     */\n    this.isMagnified = false;\n    /**\n     * @private\n     */\n    this.isPagesZoomed = false;\n    /**\n     * @private\n     */\n    this.isPinchScrolled = false;\n    /**\n     * @private\n     */\n    this.isAutoZoom = false;\n    /**\n     * @private\n     */\n    this.isDoubleTapZoom = false;\n    /**\n     * @private\n     */\n    this.isFormFieldPageZoomed = false;\n    this.isWebkitMobile = false;\n    this.isFitToPageMode = true;\n    this.pdfViewer = pdfViewer;\n    this.pdfViewerBase = viewerBase;\n    this.zoomLevel = 2;\n    // eslint-disable-next-line max-len\n  }\n  /**\n   * Zoom the PDF document to the given zoom value\n   *\n   * @param  {number} zoomValue - Specifies the Zoom Value for magnify the PDF document\n   * @returns void\n   */\n  Magnification.prototype.zoomTo = function (zoomValue) {\n    var MaximumZoomPercentage = 400;\n    var MinmumZoomPercentage = 10;\n    if (zoomValue < MinmumZoomPercentage) {\n      zoomValue = MinmumZoomPercentage;\n    } else if (zoomValue > MaximumZoomPercentage) {\n      zoomValue = MaximumZoomPercentage;\n    }\n    this.fitType = null;\n    this.isNotPredefinedZoom = false;\n    if (this.isAutoZoom && this.isInitialLoading) {\n      this.pdfViewerBase.onWindowResize();\n    } else {\n      this.isAutoZoom = false;\n      this.onZoomChanged(zoomValue);\n    }\n    this.isInitialLoading = false;\n  };\n  /**\n   * Magnifies the page to the next value in the zoom drop down list.\n   *\n   * @returns void\n   */\n  Magnification.prototype.zoomIn = function () {\n    if (this.fitType || this.isNotPredefinedZoom) {\n      this.zoomLevel = this.lowerZoomLevel;\n      this.fitType = null;\n    }\n    this.isNotPredefinedZoom = false;\n    if (this.zoomLevel >= 8) {\n      this.zoomLevel = 8;\n    } else {\n      this.zoomLevel++;\n    }\n    this.isAutoZoom = false;\n    this.onZoomChanged(this.zoomPercentages[this.zoomLevel]);\n  };\n  /**\n   * Magnifies the page to the previous value in the zoom drop down list.\n   *\n   * @returns void\n   */\n  Magnification.prototype.zoomOut = function () {\n    if (this.fitType || this.isNotPredefinedZoom) {\n      this.zoomLevel = this.higherZoomLevel;\n      this.fitType = null;\n    }\n    this.isNotPredefinedZoom = false;\n    if (this.zoomLevel <= 0) {\n      this.zoomLevel = 0;\n    } else {\n      this.zoomLevel--;\n    }\n    this.isAutoZoom = false;\n    this.onZoomChanged(this.zoomPercentages[this.zoomLevel]);\n  };\n  /**\n   * Scales the page to fit the page width to the width of the container in the control.\n   *\n   * @returns void\n   */\n  Magnification.prototype.fitToWidth = function () {\n    this.isAutoZoom = false;\n    var zoomValue = this.calculateFitZoomFactor('fitToWidth');\n    this.onZoomChanged(zoomValue);\n  };\n  /**\n   * @private\n   */\n  Magnification.prototype.fitToAuto = function () {\n    this.isAutoZoom = true;\n    var zoomValue = this.calculateFitZoomFactor('fitToWidth');\n    this.onZoomChanged(zoomValue);\n  };\n  /**\n   * Scales the page to fit the page in the container in the control.\n   *\n   * @param  {number} zoomValue - Defines the Zoom Value for fit the page in the Container\n   * @returns void\n   */\n  Magnification.prototype.fitToPage = function () {\n    var zoomValue = this.calculateFitZoomFactor('fitToPage');\n    if (zoomValue !== null) {\n      this.isAutoZoom = false;\n      this.onZoomChanged(zoomValue);\n      if (Browser.isDevice && !this.pdfViewer.enableDesktopMode) {\n        if (this.pdfViewerBase.isWebkitMobile) {\n          this.pdfViewerBase.viewerContainer.style.overflowY = 'auto';\n        } else {\n          this.pdfViewerBase.viewerContainer.style.overflowY = 'hidden';\n        }\n      } else {\n        this.pdfViewerBase.viewerContainer.style.overflowY = 'auto';\n      }\n      if (this.pdfViewerBase.pageSize[this.pdfViewerBase.currentPageNumber - 1]) {\n        // eslint-disable-next-line max-len\n        this.pdfViewerBase.viewerContainer.scrollTop = this.pdfViewerBase.pageSize[this.pdfViewerBase.currentPageNumber - 1].top * this.zoomFactor;\n      }\n    }\n  };\n  /**\n   * Returns zoom factor for the fit zooms.\n   *\n   * @param type\n   */\n  Magnification.prototype.calculateFitZoomFactor = function (type) {\n    var viewerWidth = this.pdfViewerBase.viewerContainer.getBoundingClientRect().width;\n    var viewerHeight = this.pdfViewerBase.viewerContainer.getBoundingClientRect().height;\n    if (viewerWidth === 0 && viewerHeight === 0) {\n      viewerWidth = parseFloat(this.pdfViewer.width.toString());\n      viewerHeight = parseFloat(this.pdfViewer.height.toString());\n    }\n    if (isNaN(viewerHeight) || isNaN(viewerWidth)) {\n      return null;\n    }\n    this.fitType = type;\n    if (this.fitType === 'fitToWidth') {\n      var scaleX = (viewerWidth - this.scrollWidth) / this.pdfViewerBase.highestWidth;\n      if (this.isAutoZoom) {\n        this.fitType = null;\n        scaleX = Math.min(1, scaleX);\n        if (scaleX === 1) {\n          this.zoomLevel = 2;\n        }\n      }\n      // eslint-disable-next-line radix\n      return parseInt((scaleX * 100).toString());\n    } else {\n      this.isFitToPageMode = true;\n      var pageLeft = 10;\n      var scaleX = (viewerWidth - this.scrollWidth - pageLeft) / this.pdfViewerBase.highestWidth;\n      var scaleY = viewerHeight / this.pdfViewerBase.highestHeight;\n      if (scaleY > scaleX) {\n        scaleY = scaleX;\n        this.isFitToPageMode = false;\n      }\n      // eslint-disable-next-line radix\n      return parseInt((scaleY * 100).toString());\n    }\n  };\n  /**\n   * Initiating cursor based zoom.\n   * @private\n   */\n  Magnification.prototype.initiateMouseZoom = function (pointX, pointY, zoomValue) {\n    var pointInViewer = this.positionInViewer(pointX, pointY);\n    this.mouseCenterX = pointInViewer.x;\n    this.mouseCenterY = pointInViewer.y;\n    this.zoomTo(zoomValue);\n  };\n  /**\n   * Performs pinch in operation\n   */\n  Magnification.prototype.pinchIn = function () {\n    this.fitType = null;\n    var temporaryZoomFactor = this.zoomFactor - this.pinchStep;\n    if (temporaryZoomFactor < 4 && temporaryZoomFactor > 2) {\n      temporaryZoomFactor = this.zoomFactor - this.pinchStep;\n    }\n    if (temporaryZoomFactor <= 1.5) {\n      temporaryZoomFactor = this.zoomFactor - this.pinchStep / 1.5;\n    }\n    if (temporaryZoomFactor < 0.25) {\n      temporaryZoomFactor = 0.25;\n    }\n    this.isPinchZoomed = true;\n    this.onZoomChanged(temporaryZoomFactor * 100);\n    this.isTapToFitZoom = true;\n    if (Browser.isDevice && !this.pdfViewer.enableDesktopMode && this.zoomFactor * 100 === 50) {\n      var zoomValue = this.calculateFitZoomFactor('fitToWidth');\n      this.fitType = null;\n      if (zoomValue <= 50) {\n        this.fitToWidth();\n      }\n    }\n  };\n  /**\n   * Performs pinch out operation\n   */\n  Magnification.prototype.pinchOut = function () {\n    this.fitType = null;\n    var temporaryZoomFactor = this.zoomFactor + this.pinchStep;\n    if (Browser.isDevice && !this.pdfViewer.enableDesktopMode) {\n      if (temporaryZoomFactor > 4) {\n        temporaryZoomFactor = 4;\n      }\n    } else {\n      if (temporaryZoomFactor > 2) {\n        temporaryZoomFactor = temporaryZoomFactor + this.pinchStep;\n      }\n      if (temporaryZoomFactor > 4) {\n        temporaryZoomFactor = 4;\n      }\n    }\n    this.isTapToFitZoom = true;\n    this.isPinchZoomed = true;\n    this.onZoomChanged(temporaryZoomFactor * 100);\n  };\n  /**\n   * returns zoom level for the zoom factor.\n   *\n   * @param zoomFactor\n   */\n  Magnification.prototype.getZoomLevel = function (zoomFactor) {\n    var min = 0;\n    var max = this.zoomPercentages.length - 1;\n    while (min <= max && !(min === 0 && max === 0)) {\n      var mid = Math.round((min + max) / 2);\n      if (this.zoomPercentages[mid] <= zoomFactor) {\n        min = mid + 1;\n      } else if (this.zoomPercentages[mid] >= zoomFactor) {\n        max = mid - 1;\n      }\n    }\n    this.higherZoomLevel = min;\n    this.lowerZoomLevel = max;\n    return max;\n  };\n  /**\n   * @private\n   */\n  Magnification.prototype.checkZoomFactor = function () {\n    return this.zoomPercentages.indexOf(this.zoomFactor * 100) > -1;\n  };\n  /**\n   * Executes when the zoom or pinch operation is performed\n   *\n   * @param zoomValue\n   */\n  Magnification.prototype.onZoomChanged = function (zoomValue) {\n    if (zoomValue) {\n      if (this.pdfViewer.annotationModule) {\n        this.pdfViewer.annotationModule.closePopupMenu();\n      }\n      this.previousZoomFactor = this.zoomFactor;\n      this.zoomLevel = this.getZoomLevel(zoomValue);\n      this.zoomFactor = this.getZoomFactor(zoomValue);\n      if (this.zoomFactor <= 0.25) {\n        this.pdfViewerBase.isMinimumZoom = true;\n      } else {\n        this.pdfViewerBase.isMinimumZoom = false;\n      }\n      if (!isNullOrUndefined(this.pdfViewerBase.viewerContainer)) {\n        if (Browser.isDevice && !this.pdfViewer.enableDesktopMode) {\n          if (this.pdfViewerBase.isWebkitMobile) {\n            this.pdfViewerBase.viewerContainer.style.overflowY = 'auto';\n          } else {\n            this.pdfViewerBase.viewerContainer.style.overflowY = 'hidden';\n          }\n        } else {\n          this.pdfViewerBase.viewerContainer.style.overflowY = 'auto';\n        }\n      }\n      if (this.pdfViewerBase.pageCount > 0) {\n        if (this.previousZoomFactor !== this.zoomFactor) {\n          if (!this.isPinchZoomed) {\n            this.magnifyPages();\n          } else {\n            if (Browser.isDevice && !this.pdfViewer.enableDesktopMode) {\n              // eslint-disable-next-line max-len\n              this.pdfViewerBase.mobilePageNoContainer.style.left = this.pdfViewer.element.clientWidth / 2 - parseFloat(this.pdfViewerBase.mobilePageNoContainer.style.width) / 2 + 'px';\n            }\n            this.responsivePages();\n          }\n        }\n        if (!isBlazor()) {\n          if (this.pdfViewer.toolbarModule) {\n            this.pdfViewer.toolbarModule.updateZoomButtons();\n          }\n        }\n        if (!this.isInitialLoading) {\n          if (this.previousZoomFactor !== this.zoomFactor) {\n            // eslint-disable-next-line\n            this.pdfViewer.zoomValue = parseInt((this.zoomFactor * 100).toString());\n            this.pdfViewer.fireZoomChange();\n          }\n        }\n      }\n      if (this.pdfViewer.toolbarModule) {\n        this.pdfViewer.toolbarModule.updateZoomPercentage(this.zoomFactor);\n      }\n      if (!this.isInitialLoading) {\n        if (this.previousZoomFactor !== this.zoomFactor) {\n          this.pdfViewer.zoomValue = parseInt((this.zoomFactor * 100).toString());\n          this.pdfViewer.fireZoomChange();\n        }\n      }\n      if (Browser.isDevice && !this.pdfViewer.enableDesktopMode && this.isPinchZoomed) {\n        // eslint-disable-next-line radix\n        var zoomPercentage = parseInt((this.zoomFactor * 100).toString()) + '%';\n        this.pdfViewerBase.navigationPane.createTooltipMobile(zoomPercentage);\n      }\n    }\n  };\n  /**\n   * @param clientX\n   * @param clientY\n   * @private\n   */\n  Magnification.prototype.setTouchPoints = function (clientX, clientY) {\n    var pointInViewer = this.positionInViewer(clientX, clientY);\n    this.touchCenterX = pointInViewer.x;\n    this.touchCenterY = pointInViewer.y;\n  };\n  /**\n   * @param pointX1\n   * @param pointY1\n   * @param pointX2\n   * @param pointY2\n   * @param pointX1\n   * @param pointY1\n   * @param pointX2\n   * @param pointY2\n   * @param pointX1\n   * @param pointY1\n   * @param pointX2\n   * @param pointY2\n   * @param pointX1\n   * @param pointY1\n   * @param pointX2\n   * @param pointY2\n   * @private\n   */\n  Magnification.prototype.initiatePinchMove = function (pointX1, pointY1, pointX2, pointY2) {\n    this.isPinchScrolled = false;\n    this.isMagnified = false;\n    this.reRenderPageNumber = this.pdfViewerBase.currentPageNumber;\n    var pointInViewer = this.positionInViewer((pointX1 + pointX2) / 2, (pointY1 + pointY2) / 2);\n    this.touchCenterX = pointInViewer.x;\n    this.touchCenterY = pointInViewer.y;\n    this.zoomOverPages(pointX1, pointY1, pointX2, pointY2);\n  };\n  Magnification.prototype.magnifyPages = function () {\n    var _this = this;\n    this.clearRerenderTimer();\n    this.pdfViewerBase.showPageLoadingIndicator(this.pdfViewerBase.currentPageNumber - 1, true);\n    if (!this.isPagesZoomed) {\n      this.reRenderPageNumber = this.pdfViewerBase.currentPageNumber;\n    }\n    if (!this.pdfViewerBase.documentLoaded && !this.pdfViewerBase.isInitialPageMode) {\n      this.isPagesZoomed = true;\n    }\n    var scrollValue = this.pdfViewerBase.viewerContainer.scrollTop;\n    if (this.pdfViewer.textSelectionModule) {\n      this.pdfViewer.textSelectionModule.maintainSelectionOnZoom(false, true);\n    }\n    if (this.pdfViewer.formDesignerModule && !this.pdfViewerBase.documentLoaded && !this.pdfViewerBase.isDocumentLoaded) {\n      this.isFormFieldPageZoomed = true;\n    }\n    if (!this.isInitialLoading) {\n      this.isMagnified = true;\n    }\n    this.updatePageLocation();\n    this.resizeCanvas(this.reRenderPageNumber);\n    this.calculateScrollValuesOnMouse(scrollValue);\n    if (this.pdfViewer.textSelectionModule) {\n      this.pdfViewer.textSelectionModule.resizeTouchElements();\n    }\n    // eslint-disable-next-line\n    var annotModule = this.pdfViewer.annotationModule;\n    if (annotModule && annotModule.textMarkupAnnotationModule) {\n      this.pdfViewer.annotationModule.textMarkupAnnotationModule.updateCurrentResizerPosition();\n    }\n    if (this.pdfViewerBase.pageSize.length > 0) {\n      // eslint-disable-next-line max-len\n      this.pdfViewerBase.pageContainer.style.height = this.topValue + this.pdfViewerBase.getPageHeight(this.pdfViewerBase.pageSize.length - 1) + 'px';\n      // eslint-disable-next-line\n      var proxy_1 = this;\n      this.pdfViewerBase.renderedPagesList = [];\n      this.pdfViewerBase.pinchZoomStorage = [];\n      if (!this.pdfViewerBase.documentLoaded) {\n        this.magnifyPageRerenderTimer = setTimeout(function () {\n          proxy_1.rerenderMagnifiedPages();\n          _this.pdfViewerBase.showPageLoadingIndicator(_this.pdfViewerBase.currentPageNumber - 1, false);\n        }, 800);\n      }\n    }\n  };\n  Magnification.prototype.updatePageLocation = function () {\n    this.topValue = 0;\n    for (var i = 1; i < this.pdfViewerBase.pageSize.length; i++) {\n      this.topValue += (this.pdfViewerBase.pageSize[i].height + this.pdfViewerBase.pageGap) * this.zoomFactor;\n    }\n    var limit;\n    if (this.pdfViewer.initialRenderPages > 10) {\n      limit = this.pdfViewer.initialRenderPages <= this.pdfViewerBase.pageCount ? this.pdfViewer.initialRenderPages : this.pdfViewerBase.pageCount;\n    } else {\n      limit = this.pdfViewerBase.pageCount < 10 ? this.pdfViewerBase.pageCount : 10;\n    }\n    for (var i = 0; i < limit; i++) {\n      this.updatePageContainer(i, this.pdfViewerBase.getPageWidth(i), this.pdfViewerBase.getPageHeight(i), this.pdfViewerBase.getPageTop(i), true);\n    }\n  };\n  Magnification.prototype.updatePageContainer = function (pageNumber, pageWidth, pageHeight, topValue, isReRender) {\n    // eslint-disable-next-line\n    var pageDiv = this.pdfViewerBase.getElement('_pageDiv_' + pageNumber);\n    if (pageDiv) {\n      pageDiv.style.width = pageWidth + 'px';\n      pageDiv.style.height = pageHeight + 'px';\n      // eslint-disable-next-line\n      var textLayerDiv = this.pdfViewerBase.getElement('_textLayer_' + pageNumber);\n      if (textLayerDiv) {\n        textLayerDiv.style.width = pageWidth + 'px';\n        textLayerDiv.style.height = pageHeight + 'px';\n      }\n      pageDiv.style.width = pageWidth + 'px';\n      pageDiv.style.height = pageHeight + 'px';\n      if (this.pdfViewer.enableRtl) {\n        pageDiv.style.right = this.pdfViewerBase.updateLeftPosition(pageNumber) + 'px';\n      } else {\n        pageDiv.style.left = this.pdfViewerBase.updateLeftPosition(pageNumber) + 'px';\n      }\n      pageDiv.style.top = topValue + 'px';\n      this.pdfViewerBase.pageContainer.style.width = this.pdfViewerBase.viewerContainer.clientWidth + 'px';\n      this.pdfViewerBase.renderPageCanvas(pageDiv, pageWidth, pageHeight, pageNumber, 'block');\n    }\n  };\n  Magnification.prototype.clearRerenderTimer = function () {\n    clearTimeout(this.rerenderOnScrollTimer);\n    clearTimeout(this.magnifyPageRerenderTimer);\n    this.clearIntervalTimer();\n    this.isPinchScrolled = false;\n  };\n  /**\n   * @private\n   */\n  Magnification.prototype.clearIntervalTimer = function () {\n    clearInterval(this.rerenderInterval);\n    this.rerenderInterval = null;\n    this.clearRendering();\n    var oldCanvases = document.querySelectorAll('canvas[id*=\"' + this.pdfViewer.element.id + '_oldCanvas_\"]');\n    for (var i = 0; i < oldCanvases.length; i++) {\n      // eslint-disable-next-line\n      var pageNumber = parseInt(oldCanvases[i].id.split('_oldCanvas_')[1]);\n      var pageCanvas = this.pdfViewerBase.getElement('_pageCanvas_' + pageNumber);\n      if (pageCanvas) {\n        oldCanvases[i].id = pageCanvas.id;\n        pageCanvas.parentElement.removeChild(pageCanvas);\n      } else {\n        oldCanvases[i].id = this.pdfViewer.element.id + '_pageCanvas_' + pageNumber;\n      }\n      if (this.pdfViewerBase.isTextMarkupAnnotationModule()) {\n        this.pdfViewer.annotationModule.textMarkupAnnotationModule.rerenderAnnotationsPinch(i);\n      }\n    }\n    this.isRerenderCanvasCreated = false;\n  };\n  /**\n   * @param image\n   * @private\n   */\n  Magnification.prototype.pushImageObjects = function (image) {\n    if (!isNullOrUndefined(this.imageObjects)) {\n      this.imageObjects && this.imageObjects.push(image);\n    }\n  };\n  Magnification.prototype.clearRendering = function () {\n    if (this.imageObjects) {\n      for (var j = 0; j < this.imageObjects.length; j++) {\n        if (this.imageObjects[j]) {\n          this.imageObjects[j].onload = null;\n        }\n      }\n      this.imageObjects = [];\n    }\n  };\n  Magnification.prototype.rerenderMagnifiedPages = function () {\n    if ((this.pdfViewerBase.isInitialLoaded || this.pdfViewerBase.isDocumentLoaded) && !this.pdfViewerBase.isInitialPageMode) {\n      this.renderInSeparateThread(this.reRenderPageNumber);\n      this.isPagesZoomed = false;\n    } else if (this.pdfViewerBase.isInitialPageMode) {\n      this.pageRerenderCount = 0;\n      this.pdfViewerBase.renderedPagesList = [];\n      this.pdfViewerBase.pinchZoomStorage = [];\n      this.isMagnified = false;\n      this.pdfViewerBase.pageViewScrollChanged(this.reRenderPageNumber);\n      this.pdfViewerBase.isInitialPageMode = false;\n    }\n  };\n  Magnification.prototype.renderInSeparateThread = function (pageNumber) {\n    var _this = this;\n    this.designNewCanvas(pageNumber);\n    this.pageRerenderCount = 0;\n    this.pdfViewerBase.renderedPagesList = [];\n    this.pdfViewerBase.pinchZoomStorage = [];\n    this.isMagnified = false;\n    this.pdfViewerBase.pageViewScrollChanged(this.reRenderPageNumber);\n    // eslint-disable-next-line\n    var proxy = this;\n    this.rerenderInterval = setInterval(function () {\n      _this.initiateRerender(proxy);\n    }, 1);\n  };\n  Magnification.prototype.responsivePages = function () {\n    this.isPagesZoomed = true;\n    this.clearRerenderTimer();\n    if (this.pdfViewer.textSelectionModule) {\n      this.pdfViewer.textSelectionModule.clearTextSelection();\n    }\n    if (this.pdfViewer.textSearchModule) {\n      this.pdfViewer.textSearchModule.clearAllOccurrences();\n    }\n    var scrollValue = this.pdfViewerBase.viewerContainer.scrollTop;\n    this.isAutoZoom = false;\n    this.updatePageLocation();\n    // eslint-disable-next-line max-len\n    this.pdfViewerBase.pageContainer.style.height = this.topValue + this.pdfViewerBase.pageSize[this.pdfViewerBase.pageSize.length - 1].height * this.zoomFactor + 'px';\n    this.resizeCanvas(this.pdfViewerBase.currentPageNumber);\n    if (this.pdfViewerBase.textLayer && this.pdfViewer.formDesignerModule) {\n      this.pdfViewerBase.textLayer.clearTextLayers(true);\n    }\n    if (this.isPinchZoomed) {\n      this.calculateScrollValues(scrollValue);\n    }\n    this.pdfViewerBase.renderedPagesList = [];\n    this.pdfViewerBase.pinchZoomStorage = [];\n    if (this.pdfViewer.formFieldsModule && !this.pdfViewer.formDesignerModule) {\n      var proxy_2 = this;\n      if (!this.pdfViewerBase.documentLoaded) {\n        this.magnifyPageRerenderTimer = setTimeout(function () {\n          proxy_2.rerenderMagnifiedPages();\n        }, 800);\n      }\n    }\n  };\n  Magnification.prototype.calculateScrollValues = function (scrollValue) {\n    var pageIndex = this.pdfViewerBase.currentPageNumber - 1;\n    var currentPageCanvas = this.pdfViewerBase.getElement('_pageDiv_' + pageIndex);\n    if (currentPageCanvas) {\n      var pointInViewer = void 0;\n      var currentPageBounds = currentPageCanvas.getBoundingClientRect();\n      if (this.pdfViewer.enableRtl && !this.isDoubleTapZoom) {\n        pointInViewer = this.positionInViewer(currentPageBounds.right, currentPageBounds.top);\n      } else {\n        pointInViewer = this.positionInViewer(currentPageBounds.left, currentPageBounds.top);\n      }\n      var currentPageBoundsLeft = pointInViewer.x;\n      var currentPageBoundsTop = pointInViewer.y;\n      // update scroll top for the viewer container based on pinch zoom factor\n      var previousPageTop = currentPageBoundsTop * this.previousZoomFactor;\n      var canvasPreviousY = scrollValue + this.touchCenterY;\n      // eslint-disable-next-line max-len\n      var canvasCurrentY = currentPageBoundsTop * this.zoomFactor + (canvasPreviousY - previousPageTop < 0 ? canvasPreviousY - previousPageTop : (canvasPreviousY -\n      // eslint-disable-next-line max-len\n      previousPageTop) * (this.zoomFactor / this.previousZoomFactor));\n      var pageGapValue = this.zoomFactor - this.previousZoomFactor > 0 ? -this.pdfViewerBase.pageGap * (this.zoomFactor / this.previousZoomFactor) : this.pdfViewerBase.pageGap * (this.previousZoomFactor / this.zoomFactor);\n      this.pdfViewerBase.viewerContainer.scrollTop = canvasCurrentY - this.touchCenterY + pageGapValue / this.pdfViewerBase.zoomInterval;\n      // update scroll left for the viewer container based on pinch zoom factor\n      var previousWidthFactor = currentPageBounds.width * this.previousZoomFactor / currentPageBounds.width;\n      var scaleCorrectionFactor = this.zoomFactor / previousWidthFactor - 1;\n      var scrollX_1 = this.touchCenterX - currentPageBoundsLeft;\n      if (this.pdfViewerBase.isMixedSizeDocument && this.pdfViewerBase.highestWidth * this.pdfViewerBase.getZoomFactor() > this.pdfViewerBase.viewerContainer.clientWidth) {\n        this.pdfViewerBase.viewerContainer.scrollLeft = (this.pdfViewerBase.pageContainer.offsetWidth - this.pdfViewerBase.viewerContainer.clientWidth) / 2;\n      } else {\n        this.pdfViewerBase.viewerContainer.scrollLeft += scrollX_1 * scaleCorrectionFactor;\n      }\n    }\n  };\n  Magnification.prototype.calculateScrollValuesOnMouse = function (scrollValue) {\n    var pageIndex = this.pdfViewerBase.currentPageNumber - 1;\n    var currentPageCanvas = this.pdfViewerBase.getElement('_pageDiv_' + pageIndex);\n    if (currentPageCanvas) {\n      var pointInViewer = void 0;\n      var currentPageBounds = currentPageCanvas.getBoundingClientRect();\n      if (this.pdfViewer.enableRtl) {\n        pointInViewer = this.positionInViewer(currentPageBounds.right, currentPageBounds.top);\n      } else {\n        pointInViewer = this.positionInViewer(currentPageBounds.left, currentPageBounds.top);\n      }\n      var currentPageBoundsLeft = pointInViewer.x;\n      var currentPageBoundsTop = pointInViewer.y;\n      // update scroll top for the viewer container based on mouse zoom factor\n      var previousPageTop = currentPageBoundsTop * this.previousZoomFactor;\n      var canvasPreviousY = scrollValue + this.mouseCenterY;\n      // eslint-disable-next-line max-len\n      var canvasCurrentY = currentPageBoundsTop * this.zoomFactor + (canvasPreviousY - previousPageTop) * (this.zoomFactor / this.previousZoomFactor);\n      // eslint-disable-next-line max-len\n      var pageGapValue = this.pdfViewerBase.pageGap * (this.zoomFactor / this.previousZoomFactor);\n      if (this.pdfViewerBase.isTouchPad && !this.pdfViewerBase.isMacSafari) {\n        pageGapValue = pageGapValue / this.pdfViewerBase.zoomInterval;\n      }\n      this.pdfViewerBase.viewerContainer.scrollTop = canvasCurrentY - this.mouseCenterY + pageGapValue;\n      // update scroll left for the viewer container based on mouse zoom factor\n      var previousWidthFactor = currentPageBounds.width * this.previousZoomFactor / currentPageBounds.width;\n      var scaleCorrectionFactor = this.zoomFactor / previousWidthFactor - 1;\n      var scrollX_2 = this.mouseCenterX - currentPageBoundsLeft;\n      if (this.pdfViewerBase.isMixedSizeDocument && this.pdfViewerBase.highestWidth * this.pdfViewerBase.getZoomFactor() > this.pdfViewerBase.viewerContainer.clientWidth) {\n        this.pdfViewerBase.viewerContainer.scrollLeft = (this.pdfViewerBase.pageContainer.offsetWidth - this.pdfViewerBase.viewerContainer.clientWidth) / 2;\n      } else {\n        this.pdfViewerBase.viewerContainer.scrollLeft += scrollX_2 * scaleCorrectionFactor;\n      }\n    }\n  };\n  Magnification.prototype.rerenderOnScroll = function () {\n    var _this = this;\n    this.isPinchZoomed = false;\n    if (this.isPinchScrolled) {\n      this.rerenderOnScrollTimer = null;\n      this.isPinchScrolled = false;\n      this.reRenderPageNumber = this.pdfViewerBase.currentPageNumber;\n      this.pdfViewerBase.renderedPagesList = [];\n      this.pdfViewerBase.pinchZoomStorage = [];\n      var pageDivs = document.querySelectorAll('img[id*=\"' + this.pdfViewer.element.id + '_pageCanvas_\"]');\n      var viewPortWidth = 816;\n      for (var i = 0; i < pageDivs.length; i++) {\n        // eslint-disable-next-line radix\n        var pageNumber = parseInt(pageDivs[i].id.split('_pageCanvas_')[1]);\n        var pageWidth = this.pdfViewerBase.pageSize[pageNumber].width;\n        if (viewPortWidth < pageWidth && this.pdfViewer.tileRenderingSettings.enableTileRendering) {\n          if (this.pdfViewer.restrictZoomRequest) {\n            pageDivs[i].style.width = pageWidth * this.pdfViewerBase.getZoomFactor() + 'px';\n            // eslint-disable-next-line max-len\n            pageDivs[i].style.height = this.pdfViewerBase.pageSize[pageNumber].height * this.pdfViewerBase.getZoomFactor() + 'px';\n          } else {\n            pageDivs[i].style.width = pageWidth * this.pdfViewerBase.getZoomFactor() + 'px';\n            // eslint-disable-next-line max-len\n            pageDivs[i].style.height = this.pdfViewerBase.pageSize[pageNumber].height * this.pdfViewerBase.getZoomFactor() + 'px';\n          }\n        }\n      }\n      if (this.pdfViewerBase.textLayer) {\n        var textLayers = document.querySelectorAll('div[id*=\"' + this.pdfViewer.element.id + '_textLayer_\"]');\n        for (var i = 0; i < textLayers.length; i++) {\n          textLayers[i].style.display = 'block';\n        }\n      }\n      if (this.pdfViewerBase.isTextMarkupAnnotationModule()) {\n        // eslint-disable-next-line max-len\n        var annotationLayers = document.querySelectorAll('canvas[id*=\"' + this.pdfViewer.element.id + '_annotationCanvas_\"]');\n        for (var j = 0; j < annotationLayers.length; j++) {\n          var pageNumber = annotationLayers[j].id.split('_annotationCanvas_')[1];\n          // eslint-disable-next-line radix\n          this.pdfViewer.annotationModule.textMarkupAnnotationModule.rerenderAnnotationsPinch(parseInt(pageNumber));\n        }\n      }\n      if (Browser.isDevice) {\n        if (this.pdfViewer.formDesignerModule) {\n          var fomrFieldCollection = void 0;\n          var pageNumber_1 = this.pdfViewer.currentPageNumber;\n          fomrFieldCollection = this.pdfViewer.formFieldCollection.filter(function (data) {\n            return data.pageNumber === pageNumber_1;\n          });\n          for (var i = 0; i < fomrFieldCollection.length; i++) {\n            document.querySelectorAll(\"[id^=\" + fomrFieldCollection[parseInt(i.toString(), 10)].id + \"]\").forEach(function (formField) {\n              return formField.style.display = 'none';\n            });\n          }\n        } else {\n          document.querySelectorAll(\"[id^=\\\"pdfViewerinput_\\\"]\").forEach(function (formField) {\n            return formField.parentElement.style.display = 'none';\n          });\n        }\n      }\n      this.pdfViewerBase.pageViewScrollChanged(this.reRenderPageNumber);\n      this.isPagePinchZoomed = false;\n      this.rerenderOnScrollTimer = setTimeout(function () {\n        _this.pdfViewerBase.pageViewScrollChanged(_this.reRenderPageNumber);\n      }, 300);\n    }\n  };\n  /**\n   * @private\n   */\n  Magnification.prototype.pinchMoveScroll = function () {\n    var _this = this;\n    if (this.isRerenderCanvasCreated) {\n      this.clearIntervalTimer();\n    }\n    if (this.isPagesZoomed || !this.isRerenderCanvasCreated && this.isPagePinchZoomed) {\n      this.clearRendering();\n      this.isPagesZoomed = false;\n      clearTimeout(this.magnifyPageRerenderTimer);\n      this.isPinchScrolled = true;\n      this.isFormFieldPageZoomed = true;\n      this.rerenderOnScrollTimer = setTimeout(function () {\n        _this.rerenderOnScroll();\n      }, 100);\n    }\n  };\n  // eslint-disable-next-line\n  Magnification.prototype.initiateRerender = function (proxy) {\n    var isReRender = false;\n    if (this.previousZoomFactor < 0.4 || this.pdfViewerBase.isMinimumZoom) {\n      isReRender = true;\n    }\n    // eslint-disable-next-line max-len\n    if ((proxy.pageRerenderCount === proxy.pdfViewerBase.reRenderedCount || isReRender) && proxy.pageRerenderCount !== 0 && proxy.pdfViewerBase.reRenderedCount !== 0) {\n      proxy.reRenderAfterPinch(this.reRenderPageNumber);\n      proxy.isFormFieldPageZoomed = false;\n    }\n  };\n  Magnification.prototype.reRenderAfterPinch = function (currentPageIndex) {\n    this.pageRerenderCount = 0;\n    var lowerPageValue = currentPageIndex - 3;\n    var higherPageValue = currentPageIndex + 1;\n    if (this.pdfViewerBase.isMinimumZoom) {\n      lowerPageValue = currentPageIndex - 4;\n      higherPageValue = currentPageIndex + 4;\n    }\n    lowerPageValue = lowerPageValue > 0 ? lowerPageValue : 0;\n    higherPageValue = higherPageValue < this.pdfViewerBase.pageCount ? higherPageValue : this.pdfViewerBase.pageCount - 1;\n    for (var i = lowerPageValue; i <= higherPageValue; i++) {\n      var pageDiv = this.pdfViewerBase.getElement('_pageDiv_' + i);\n      var pageCanvas = this.pdfViewerBase.getElement('_pageCanvas_' + i);\n      var oldCanvas = this.pdfViewerBase.getElement('_oldCanvas_' + i);\n      if (oldCanvas) {\n        oldCanvas.parentNode.removeChild(oldCanvas);\n      }\n      if (this.pdfViewerBase.isTextMarkupAnnotationModule()) {\n        this.pdfViewer.annotationModule.textMarkupAnnotationModule.rerenderAnnotations(i);\n      } else if (this.pdfViewer.formDesignerModule) {\n        this.rerenderAnnotations(i);\n        this.pdfViewer.renderDrawing(undefined, currentPageIndex);\n      }\n      if (pageDiv) {\n        pageDiv.style.visibility = 'visible';\n      }\n    }\n    this.isRerenderCanvasCreated = false;\n    this.isPagePinchZoomed = false;\n    if (this.pdfViewerBase.reRenderedCount !== 0) {\n      this.pdfViewerBase.reRenderedCount = 0;\n      this.pageRerenderCount = 0;\n      clearInterval(this.rerenderInterval);\n      this.rerenderInterval = null;\n    }\n    this.imageObjects = [];\n  };\n  /**\n   * @param pageNumber\n   * @private\n   */\n  Magnification.prototype.rerenderAnnotations = function (pageNumber) {\n    // eslint-disable-next-line\n    var oldCanvasCollection = document.querySelectorAll('#' + this.pdfViewer.element.id + '_old_annotationCanvas_' + pageNumber);\n    for (var i = 0; i < oldCanvasCollection.length; i++) {\n      if (oldCanvasCollection[i]) {\n        oldCanvasCollection[i].parentElement.removeChild(oldCanvasCollection[i]);\n      }\n    }\n    var newCanvas = this.pdfViewerBase.getElement('_annotationCanvas_' + pageNumber);\n    if (newCanvas) {\n      newCanvas.style.display = 'block';\n    }\n  };\n  Magnification.prototype.designNewCanvas = function (currentPageIndex) {\n    if (this.pdfViewerBase.textLayer) {\n      this.pdfViewerBase.textLayer.clearTextLayers();\n    }\n    var lowerPageValue = currentPageIndex - 3;\n    var higherPageValue = currentPageIndex + 1; // jshint ignore:line\n    if (this.pdfViewerBase.isMinimumZoom) {\n      lowerPageValue = currentPageIndex - 4;\n      higherPageValue = currentPageIndex + 4;\n    }\n    lowerPageValue = lowerPageValue > 0 ? lowerPageValue : 0;\n    higherPageValue = higherPageValue < this.pdfViewerBase.pageCount ? higherPageValue : this.pdfViewerBase.pageCount - 1;\n    for (var i = lowerPageValue; i <= higherPageValue; i++) {\n      var canvas = this.pdfViewerBase.getElement('_pageCanvas_' + i);\n      var width = this.pdfViewerBase.pageSize[i].width * this.zoomFactor;\n      var height = this.pdfViewerBase.pageSize[i].height * this.zoomFactor;\n      if (canvas && !this.pdfViewer.restrictZoomRequest) {\n        // eslint-disable-next-line max-len\n        this.pdfViewerBase.renderPageCanvas(this.pdfViewerBase.getElement('_pageDiv_' + i), width, height, i, 'none');\n      } else if (!this.pdfViewer.restrictZoomRequest) {\n        // eslint-disable-next-line max-len\n        this.pdfViewerBase.renderPageCanvas(this.pdfViewerBase.getElement('_pageDiv_' + i), width, height, i, 'none');\n      }\n    }\n    this.isRerenderCanvasCreated = true;\n  };\n  /**\n   * @private\n   */\n  Magnification.prototype.pageRerenderOnMouseWheel = function () {\n    var _this = this;\n    if (this.isRerenderCanvasCreated) {\n      this.clearIntervalTimer();\n      clearTimeout(this.magnifyPageRerenderTimer);\n      if (!this.isPinchScrolled) {\n        this.isPinchScrolled = true;\n        this.rerenderOnScrollTimer = setTimeout(function () {\n          _this.rerenderOnScroll();\n        }, 100);\n      }\n    }\n  };\n  /**\n   * @private\n   */\n  Magnification.prototype.renderCountIncrement = function () {\n    if (this.isRerenderCanvasCreated) {\n      this.pageRerenderCount++;\n    }\n  };\n  /**\n   * @private\n   */\n  Magnification.prototype.rerenderCountIncrement = function () {\n    if (this.pageRerenderCount > 0) {\n      this.pdfViewerBase.reRenderedCount++;\n    }\n  };\n  /**\n   * @param pageNumber\n   * @private\n   */\n  Magnification.prototype.resizeCanvas = function (pageNumber) {\n    var annotationModule = this.pdfViewer.annotationModule;\n    if (annotationModule && annotationModule.inkAnnotationModule && annotationModule.inkAnnotationModule.outputString !== '') {\n      // eslint-disable-next-line\n      annotationModule.inkAnnotationModule.inkPathDataCollection.push({\n        pathData: annotationModule.inkAnnotationModule.outputString,\n        zoomFactor: annotationModule.inkAnnotationModule.inkAnnotationInitialZoom\n      });\n      annotationModule.inkAnnotationModule.outputString = '';\n    }\n    if (annotationModule && annotationModule.freeTextAnnotationModule) {\n      // eslint-disable-next-line\n      var currentPosition = {\n        x: annotationModule.freeTextAnnotationModule.currentPosition[0],\n        y: annotationModule.freeTextAnnotationModule.currentPosition[1],\n        width: annotationModule.freeTextAnnotationModule.currentPosition[2],\n        height: annotationModule.freeTextAnnotationModule.currentPosition[3]\n      };\n      annotationModule.freeTextAnnotationModule.addInputInZoom(currentPosition);\n    }\n    var lowerPageValue = pageNumber - 3;\n    var higherPageValue = pageNumber + 3;\n    if (this.pdfViewerBase.isMinimumZoom) {\n      lowerPageValue = pageNumber - 4;\n      higherPageValue = pageNumber + 4;\n    }\n    if (this.pdfViewer.initialRenderPages > this.pdfViewerBase.pageRenderCount) {\n      lowerPageValue = 0;\n      higherPageValue = higherPageValue < this.pdfViewer.initialRenderPages ? this.pdfViewer.initialRenderPages <= this.pdfViewerBase.pageCount ? this.pdfViewer.initialRenderPages : this.pdfViewerBase.pageCount : higherPageValue < this.pdfViewerBase.pageCount ? higherPageValue : this.pdfViewerBase.pageCount - 1;\n    } else {\n      lowerPageValue = lowerPageValue > 0 ? lowerPageValue : 0;\n      higherPageValue = higherPageValue < this.pdfViewerBase.pageCount ? higherPageValue : this.pdfViewerBase.pageCount - 1;\n    }\n    for (var i = lowerPageValue; i <= higherPageValue; i++) {\n      var pageDiv = this.pdfViewerBase.getElement('_pageDiv_' + i);\n      var textLayer = document.getElementById(this.pdfViewer.element.id + '_textLayer_' + i);\n      if (pageDiv) {\n        if (lowerPageValue <= i && i <= higherPageValue) {\n          var isSelectionAvailable = false;\n          if (this.pdfViewer.textSelectionModule) {\n            isSelectionAvailable = this.pdfViewer.textSelectionModule.isSelectionAvailableOnScroll(i);\n          }\n          if (this.pdfViewerBase.pageSize[i] != null) {\n            var width = this.pdfViewerBase.pageSize[i].width * this.zoomFactor;\n            var height = this.pdfViewerBase.pageSize[i].height * this.zoomFactor;\n            pageDiv.style.width = width + 'px';\n            pageDiv.style.height = height + 'px';\n            // eslint-disable-next-line max-len\n            pageDiv.style.top = this.pdfViewerBase.pageSize[i].top * this.zoomFactor + 'px';\n            if (this.pdfViewer.enableRtl) {\n              pageDiv.style.right = this.pdfViewerBase.updateLeftPosition(i) + 'px';\n            } else {\n              pageDiv.style.left = this.pdfViewerBase.updateLeftPosition(i) + 'px';\n            }\n            var canvas = this.pdfViewerBase.getElement('_pageCanvas_' + i);\n            if (canvas) {\n              canvas.style.width = width + 'px';\n              canvas.style.height = height + 'px';\n              if (this.pdfViewer.annotation) {\n                this.pdfViewer.annotationModule.resizeAnnotations(width, height, i);\n              } else if (this.pdfViewer.formDesignerModule) {\n                this.pdfViewer.formDesignerModule.resizeAnnotations(width, height, i);\n              }\n            }\n            var zoomFactor = this.pdfViewerBase.retrieveCurrentZoomFactor();\n            var tileCount = this.pdfViewerBase.getTileCount(this.pdfViewerBase.pageSize[i].width);\n            var noTileX = void 0;\n            var noTileY = void 0;\n            noTileX = noTileY = tileCount;\n            var tileSettings = this.pdfViewer.tileRenderingSettings;\n            if (tileSettings.enableTileRendering && tileSettings.x > 0 && tileSettings.y > 0) {\n              if (1200 < this.pdfViewerBase.pageSize[i].width || this.pdfViewerBase.getZoomFactor() > 2) {\n                noTileX = tileSettings.x;\n                noTileY = tileSettings.y;\n              }\n            }\n            var tileRequestCount = noTileX * noTileY;\n            if (tileRequestCount === 1) {\n              var storedData = void 0;\n              if (this.pdfViewerBase.clientSideRendering) {\n                storedData = this.pdfViewerBase.getWindowSessionStorage(i, zoomFactor) ? this.pdfViewerBase.getWindowSessionStorage(i, zoomFactor) : this.pdfViewerBase.getPinchZoomPage(i);\n              } else {\n                storedData = this.pdfViewerBase.getLinkInformation(i) ? this.pdfViewerBase.getLinkInformation(i) : this.pdfViewerBase.getWindowSessionStorage(i, zoomFactor);\n              }\n              if (storedData) {\n                storedData = this.pdfViewerBase.clientSideRendering && typeof storedData === 'object' ? storedData : JSON.parse(storedData);\n                var imageData = storedData['image'];\n                if (imageData) {\n                  canvas.src = imageData;\n                  canvas.style.display = 'block';\n                  var oldCanvases = document.querySelectorAll('img[id*=\"' + this.pdfViewer.element.id + '_tileimg_' + i + '_\"]');\n                  var pageCanvas = this.pdfViewerBase.getElement('_pageDiv_' + i);\n                  for (var k = 0; k < oldCanvases.length; k++) {\n                    var tileImgId = oldCanvases[k].id.split('_');\n                    if (parseFloat(tileImgId[tileImgId.length - 3]) != this.pdfViewerBase.getZoomFactor()) pageCanvas.removeChild(oldCanvases[k]);\n                  }\n                  var oldPageDiv = document.querySelectorAll('img[id*=\"' + this.pdfViewer.element.id + '_oldCanvas\"]');\n                  for (var j = 0; j < oldPageDiv.length; j++) {\n                    pageDiv.removeChild(oldPageDiv[j]);\n                  }\n                }\n                this.pdfViewerBase.isReRenderRequired = false;\n              } else {\n                this.pdfViewerBase.isReRenderRequired = true;\n              }\n            } else {\n              var oldCanvases = document.querySelectorAll('img[id*=\"' + this.pdfViewer.element.id + '_tileimg_' + i + '_\"]');\n              for (var l = 0; l < oldCanvases.length; l++) {\n                var tileImgId = oldCanvases[l].id.split('_');\n                var tileX = parseFloat(tileImgId[tileImgId.length - 2]);\n                var tileY = parseFloat(tileImgId[tileImgId.length - 1]);\n                // eslint-disable-next-line\n                var tileData = this.pdfViewerBase.clientSideRendering ? JSON.parse(this.pdfViewerBase.getStoredTileImageDetails(i, tileX, tileY, zoomFactor)) : JSON.parse(this.pdfViewerBase.getWindowSessionStorageTile(i, tileX, tileY, zoomFactor));\n                if (tileData && tileData.zoomFactor) {\n                  zoomFactor = tileData.zoomFactor;\n                }\n                if (parseFloat(tileImgId[tileImgId.length - 4]) === i) {\n                  canvas.style.display = 'none';\n                  var node = oldCanvases[l];\n                  // Make sure it's really an Element\n                  if (node.nodeType == Node.ELEMENT_NODE) {\n                    var dataScaleFactor = 1.5;\n                    if (!isNullOrUndefined(tileData)) {\n                      dataScaleFactor = !isNullOrUndefined(tileData.scaleFactor) ? tileData.scaleFactor : 1.5;\n                    }\n                    var pageWidth = this.pdfViewerBase.pageSize[i].width;\n                    var serverImageWidth = pageWidth * zoomFactor * dataScaleFactor;\n                    var serverImageHeight = this.pdfViewerBase.pageSize[i].height * zoomFactor * dataScaleFactor;\n                    var tilewidth = serverImageWidth / noTileX;\n                    var tileHeight = serverImageHeight / noTileY;\n                    var originalWidth = tilewidth;\n                    var originalLeft = parseFloat(tileImgId[tileImgId.length - 2]) * tilewidth;\n                    var originalTop = parseFloat(tileImgId[tileImgId.length - 1]) * tileHeight;\n                    node.width = originalWidth * this.pdfViewerBase.getZoomFactor() / zoomFactor / dataScaleFactor;\n                    node.style.width = originalWidth * this.pdfViewerBase.getZoomFactor() / zoomFactor / dataScaleFactor + 'px';\n                    node.style.left = originalLeft * this.pdfViewerBase.getZoomFactor() / zoomFactor / dataScaleFactor + 'px';\n                    node.style.top = originalTop * this.pdfViewerBase.getZoomFactor() / zoomFactor / dataScaleFactor + 'px';\n                    node.id = this.pdfViewer.element.id + '_tileimg_' + i + '_' + this.pdfViewerBase.getZoomFactor() + '_' + tileX + '_' + tileY;\n                    if (tileData) {\n                      var imageData = tileData['image'];\n                      if (imageData) {\n                        node.src = imageData;\n                      }\n                      this.pdfViewerBase.isReRenderRequired = false;\n                    } else {\n                      this.pdfViewerBase.isReRenderRequired = true;\n                    }\n                  }\n                }\n              }\n              if (oldCanvases.length === 0) {\n                this.pdfViewerBase.isReRenderRequired = true;\n              }\n            }\n            var aElement = pageDiv.getElementsByTagName('a');\n            if (aElement.length !== 0) {\n              for (var index = aElement.length - 1; index >= 0; index--) {\n                aElement[index].parentNode.removeChild(aElement[index]);\n              }\n            }\n            if (textLayer) {\n              textLayer.style.width = width + 'px';\n              textLayer.style.height = height + 'px';\n              if (this.pdfViewer.textSelectionModule) {\n                if (this.isPinchZoomed) {\n                  textLayer.style.display = 'none';\n                } else if (this.isMagnified) {\n                  var lowerValue = pageNumber - 2 === 0 ? 0 : pageNumber - 2;\n                  // eslint-disable-next-line max-len\n                  var higherValue = pageNumber === this.pdfViewerBase.pageCount ? this.pdfViewerBase.pageCount - 1 : pageNumber + 1;\n                  if (lowerValue <= i && i <= higherValue && (this.pdfViewer.textSelectionModule.isTextSelection && isSelectionAvailable || this.pdfViewerBase.textLayer.getTextSearchStatus() || this.pdfViewerBase.isInitialPageMode)) {\n                    this.pdfViewerBase.textLayer.resizeTextContentsOnZoom(i);\n                    if (this.pdfViewer.textSelectionModule.isTextSelection && isSelectionAvailable) {\n                      this.pdfViewer.textSelectionModule.applySelectionRangeOnScroll(i);\n                    }\n                  } else {\n                    textLayer.style.display = 'none';\n                  }\n                } else {\n                  textLayer.style.display = 'block';\n                }\n              }\n              this.pdfViewerBase.applyElementStyles(textLayer, i);\n            }\n            var adornerSvg = getDiagramElement(this.pdfViewer.element.id + '_textLayer_' + i);\n            if (adornerSvg) {\n              var adonerLayer = getDiagramElement(this.pdfViewer.element.id + i + '_diagramAdorner_svg');\n              if (adonerLayer) {\n                adonerLayer.style.width = width + 'px';\n                adonerLayer.style.height = height + 'px';\n              }\n              var diagramAdornerLayer = getDiagramElement(this.pdfViewer.element.id + i + '_diagramAdornerLayer');\n              if (diagramAdornerLayer) {\n                diagramAdornerLayer.style.width = width + 'px';\n                diagramAdornerLayer.style.height = height + 'px';\n              }\n              adornerSvg.style.width = width + 'px';\n              adornerSvg.style.height = height + 'px';\n              this.pdfViewer.renderSelector(i, this.pdfViewer.annotationSelectorSettings);\n              this.pdfViewerBase.applyElementStyles(diagramAdornerLayer, i);\n            }\n          }\n        }\n      }\n    }\n  };\n  Magnification.prototype.zoomOverPages = function (pointX1, pointY1, pointX2, pointY2) {\n    // eslint-disable-next-line\n    var currentDifference = Math.sqrt(Math.pow(pointX1 - pointX2, 2) + Math.pow(pointY1 - pointY2, 2));\n    if (this.previousTouchDifference > -1) {\n      if (currentDifference > this.previousTouchDifference) {\n        this.pinchStep = this.getPinchStep(currentDifference, this.previousTouchDifference);\n        this.pinchOut();\n      } else if (currentDifference < this.previousTouchDifference) {\n        this.pinchStep = this.getPinchStep(this.previousTouchDifference, currentDifference);\n        this.pinchIn();\n      }\n    }\n    this.previousTouchDifference = currentDifference;\n  };\n  /**\n   * @private\n   */\n  Magnification.prototype.pinchMoveEnd = function () {\n    this.touchCenterX = 0;\n    this.touchCenterY = 0;\n    this.previousTouchDifference = -1;\n    if (this.isPinchZoomed) {\n      this.isPinchScrolled = false;\n      this.isPagePinchZoomed = true;\n      this.pinchMoveScroll();\n    }\n  };\n  /**\n   * @param event\n   * @private\n   */\n  // eslint-disable-next-line\n  Magnification.prototype.fitPageScrollMouseWheel = function (event) {\n    if (this.fitType === 'fitToPage') {\n      this.isMagnified = false;\n      event.preventDefault();\n      if (event.deltaY > 0) {\n        this.downwardScrollFitPage(this.pdfViewerBase.currentPageNumber - 1);\n      } else {\n        this.upwardScrollFitPage(this.pdfViewerBase.currentPageNumber - 1);\n      }\n    }\n  };\n  /**\n   * @param event\n   * @private\n   */\n  Magnification.prototype.magnifyBehaviorKeyDown = function (event) {\n    var isMac = navigator.platform.match(/(Mac|iPhone|iPod|iPad)/i) ? true : false;\n    var isCommandKey = isMac ? event.metaKey : false;\n    switch (event.keyCode) {\n      case 38: // up arrow\n      case 37: // left arrow\n      case 33:\n        // page up\n        if (this.fitType === 'fitToPage' && !((event.ctrlKey || isCommandKey) && event.shiftKey)) {\n          event.preventDefault();\n          this.upwardScrollFitPage(this.pdfViewerBase.currentPageNumber - 1);\n        }\n        break;\n      case 40: // down arrow\n      case 39: // right arrow\n      case 34:\n        // page down\n        if (this.fitType === 'fitToPage' && !((event.ctrlKey || isCommandKey) && event.shiftKey)) {\n          event.preventDefault();\n          this.downwardScrollFitPage(this.pdfViewerBase.currentPageNumber - 1);\n        }\n        break;\n      case 187:\n        // equal key\n        if (event.ctrlKey || isCommandKey) {\n          event.preventDefault();\n          this.zoomIn();\n        }\n        break;\n      case 189:\n        // minus key\n        if (event.ctrlKey || isCommandKey) {\n          event.preventDefault();\n          this.zoomOut();\n        }\n        break;\n      case 48:\n        // zero key\n        if ((event.ctrlKey || isCommandKey) && !event.shiftKey) {\n          event.preventDefault();\n          this.fitToPage();\n        }\n        break;\n      case 49:\n        // one key\n        if ((event.ctrlKey || isCommandKey) && !event.shiftKey) {\n          event.preventDefault();\n          this.zoomTo(100);\n        }\n        break;\n      default:\n        break;\n    }\n  };\n  Magnification.prototype.upwardScrollFitPage = function (currentPageIndex) {\n    if (currentPageIndex > 0) {\n      this.pdfViewerBase.getElement('_pageDiv_' + (currentPageIndex - 1)).style.visibility = 'visible';\n      this.pdfViewerBase.viewerContainer.scrollTop = this.pdfViewerBase.pageSize[currentPageIndex - 1].top * this.zoomFactor;\n      if (this.isFitToPageMode) {\n        this.pdfViewerBase.getElement('_pageDiv_' + currentPageIndex).style.visibility = 'hidden';\n      }\n    }\n  };\n  /**\n   * @param currentPageIndex\n   * @private\n   */\n  Magnification.prototype.updatePagesForFitPage = function (currentPageIndex) {\n    if (this.fitType === 'fitToPage') {\n      if (this.isFitToPageMode) {\n        if (currentPageIndex > 0 && this.pdfViewerBase.getElement('_pageDiv_' + (currentPageIndex - 1))) {\n          this.pdfViewerBase.getElement('_pageDiv_' + (currentPageIndex - 1)).style.visibility = 'hidden';\n        }\n        // eslint-disable-next-line max-len\n        if (currentPageIndex < this.pdfViewerBase.pageCount - 1 && this.pdfViewerBase.getElement('_pageDiv_' + (currentPageIndex + 1))) {\n          this.pdfViewerBase.getElement('_pageDiv_' + (currentPageIndex + 1)).style.visibility = 'hidden';\n        }\n      }\n    }\n  };\n  /**\n   * @private\n   */\n  Magnification.prototype.onDoubleTapMagnification = function () {\n    var _this = this;\n    if (this.pdfViewer.toolbarModule && isBlazor()) {\n      this.pdfViewer.toolbarModule.showToolbar(true);\n    }\n    var scrollValue = this.pdfViewerBase.viewerContainer.scrollTop;\n    if (!this.pdfViewer.selectedItems.annotations[0]) {\n      this.isDoubleTapZoom = true;\n      if (!this.isTapToFitZoom) {\n        if (this.zoomFactor < 2) {\n          this.zoomTo(200);\n        } else {\n          this.fitToWidth();\n        }\n      } else {\n        this.fitToWidth();\n      }\n      this.calculateScrollValues(scrollValue);\n      this.isTapToFitZoom = !this.isTapToFitZoom;\n      setTimeout(function () {\n        _this.isMagnified = false;\n      }, 500);\n      this.isDoubleTapZoom = false;\n    } else {\n      if (isBlazor()) {\n        // eslint-disable-next-line max-len\n        if (this.pdfViewer.selectedItems.annotations[0] && this.pdfViewer.selectedItems.annotations[0].shapeAnnotationType === 'FreeText') {\n          var elmtPosition = {};\n          elmtPosition.x = this.pdfViewer.selectedItems.annotations[0].bounds.x;\n          elmtPosition.y = this.pdfViewer.selectedItems.annotations[0].bounds.y;\n          // eslint-disable-next-line max-len\n          this.pdfViewer.annotation.freeTextAnnotationModule.addInuptElemet(elmtPosition, this.pdfViewer.selectedItems.annotations[0]);\n        }\n      }\n    }\n  };\n  Magnification.prototype.downwardScrollFitPage = function (currentPageIndex) {\n    if (currentPageIndex !== this.pdfViewerBase.pageCount - 1) {\n      this.pdfViewerBase.getElement('_pageDiv_' + (currentPageIndex + 1)).style.visibility = 'visible';\n      this.pdfViewerBase.viewerContainer.scrollTop = this.pdfViewerBase.pageSize[currentPageIndex + 1].top * this.zoomFactor;\n      if (this.isFitToPageMode) {\n        if (currentPageIndex + 1 === this.pdfViewerBase.pageCount - 1) {\n          this.pdfViewerBase.getElement('_pageDiv_' + currentPageIndex).style.visibility = 'hidden';\n        } else {\n          this.pdfViewerBase.getElement('_pageDiv_' + (currentPageIndex + 2)).style.visibility = 'hidden';\n        }\n      }\n    }\n  };\n  Magnification.prototype.getMagnifiedValue = function (value) {\n    return value / this.previousZoomFactor * this.zoomFactor;\n  };\n  /**\n   * @private\n   */\n  Magnification.prototype.destroy = function () {\n    this.imageObjects = undefined;\n  };\n  /**\n   * returns zoom factor when the zoom percent is passed.\n   *\n   * @param zoomValue\n   */\n  Magnification.prototype.getZoomFactor = function (zoomValue) {\n    return zoomValue / 100;\n  };\n  /**\n   * @private\n   */\n  Magnification.prototype.getModuleName = function () {\n    return 'Magnification';\n  };\n  /**\n  * Returns the pinch step value.\n  * @param higherValue\n  * @param lowerValue\n  */\n  Magnification.prototype.getPinchStep = function (higherValue, lowerValue) {\n    var defaultPinchStep = 0.02; // Default pinch step value.\n    var higherPinchStep = 1; // higher pinch step value.\n    var pinchstep = (higherValue - lowerValue) / 100;\n    if (pinchstep < defaultPinchStep) {\n      pinchstep = defaultPinchStep;\n    } else if (pinchstep > higherPinchStep) {\n      pinchstep = 0.1; // set the pinch step as 0.1 if the pinch reaches the higher pinch step value.\n    }\n    return pinchstep;\n  };\n  /**\n  * @private\n  * Brings the given rectangular region to view and zooms in the document to fit the region in client area (view port).\n  *\n  * @param {Rect} zoomRect - Specifies the region in client coordinates that is to be brought to view.\n  */\n  Magnification.prototype.zoomToRect = function (zoomRect) {\n    var desiredScaleFactor;\n    var pdfViewerBase = this.pdfViewerBase;\n    var viewerContainer = pdfViewerBase.viewerContainer;\n    var pdfViewer = this.pdfViewer;\n    if (zoomRect.width > 0 && zoomRect.height > 0) {\n      var location_1 = {\n        x: zoomRect.x,\n        y: zoomRect.y\n      };\n      var pageNumber = pdfViewer.getPageNumberFromClientPoint(location_1);\n      if (pageNumber > 0) {\n        var desiredHorizontalScale = viewerContainer.getBoundingClientRect().width / zoomRect.width;\n        var desiredVerticalScale = viewerContainer.getBoundingClientRect().height / zoomRect.height;\n        if (desiredHorizontalScale < desiredVerticalScale) {\n          desiredScaleFactor = desiredHorizontalScale;\n        } else {\n          desiredScaleFactor = desiredVerticalScale;\n        }\n        var zoomValue = 100; // default zoom value\n        var zoomPercentage = pdfViewerBase.getZoomFactor() * 100;\n        zoomValue = zoomPercentage * desiredScaleFactor;\n        var prevScrollTop = viewerContainer.scrollTop;\n        var prevScrollLeft = viewerContainer.scrollLeft;\n        // Zoom to desired zoom value.\n        this.zoomTo(zoomValue);\n        viewerContainer.scrollTop = prevScrollTop;\n        viewerContainer.scrollLeft = prevScrollLeft;\n        var zoomFactor = pdfViewerBase.getZoomFactor();\n        var pagepoint = {\n          x: zoomRect.x,\n          y: zoomRect.y\n        };\n        // Convert the client point to page point.\n        pagepoint = pdfViewer.convertClientPointToPagePoint(pagepoint, pageNumber);\n        pdfViewerBase.updateScrollTop(pageNumber - 1);\n        // To adjust the container to the left position.\n        viewerContainer.scrollLeft = (pagepoint.x - prevScrollLeft) * zoomFactor;\n        // To adjust the container to the top position.\n        viewerContainer.scrollTop = (pagepoint.y + pdfViewerBase.pageSize[pageNumber - 1].top - prevScrollTop) * zoomFactor;\n      }\n    }\n  };\n  /**\n  * Returns Point value respect to Main container.\n  * @param PointX\n  * @param PointY\n  */\n  Magnification.prototype.positionInViewer = function (pointX, pointY) {\n    var mainRect = this.pdfViewerBase.mainContainer.getBoundingClientRect();\n    return {\n      x: pointX - mainRect.left,\n      y: pointY - mainRect.top\n    };\n  };\n  return Magnification;\n}();\nexport { Magnification };","map":{"version":3,"names":["Browser","isBlazor","isNullOrUndefined","getDiagramElement","Magnification","pdfViewer","viewerBase","zoomFactor","previousZoomFactor","scrollWidth","zoomPercentages","isNotPredefinedZoom","pinchStep","reRenderPageNumber","magnifyPageRerenderTimer","rerenderOnScrollTimer","rerenderInterval","touchCenterX","touchCenterY","mouseCenterX","mouseCenterY","pageRerenderCount","imageObjects","topValue","isTapToFitZoom","fitType","isPinchZoomed","isPagePinchZoomed","isRerenderCanvasCreated","isMagnified","isPagesZoomed","isPinchScrolled","isAutoZoom","isDoubleTapZoom","isFormFieldPageZoomed","isWebkitMobile","isFitToPageMode","pdfViewerBase","zoomLevel","prototype","zoomTo","zoomValue","MaximumZoomPercentage","MinmumZoomPercentage","isInitialLoading","onWindowResize","onZoomChanged","zoomIn","lowerZoomLevel","zoomOut","higherZoomLevel","fitToWidth","calculateFitZoomFactor","fitToAuto","fitToPage","isDevice","enableDesktopMode","viewerContainer","style","overflowY","pageSize","currentPageNumber","scrollTop","top","type","viewerWidth","getBoundingClientRect","width","viewerHeight","height","parseFloat","toString","isNaN","scaleX","highestWidth","Math","min","parseInt","pageLeft","scaleY","highestHeight","initiateMouseZoom","pointX","pointY","pointInViewer","positionInViewer","x","y","pinchIn","temporaryZoomFactor","pinchOut","getZoomLevel","max","length","mid","round","checkZoomFactor","indexOf","annotationModule","closePopupMenu","getZoomFactor","isMinimumZoom","pageCount","magnifyPages","mobilePageNoContainer","left","element","clientWidth","responsivePages","toolbarModule","updateZoomButtons","fireZoomChange","updateZoomPercentage","zoomPercentage","navigationPane","createTooltipMobile","setTouchPoints","clientX","clientY","initiatePinchMove","pointX1","pointY1","pointX2","pointY2","zoomOverPages","_this","clearRerenderTimer","showPageLoadingIndicator","documentLoaded","isInitialPageMode","scrollValue","textSelectionModule","maintainSelectionOnZoom","formDesignerModule","isDocumentLoaded","updatePageLocation","resizeCanvas","calculateScrollValuesOnMouse","resizeTouchElements","annotModule","textMarkupAnnotationModule","updateCurrentResizerPosition","pageContainer","getPageHeight","proxy_1","renderedPagesList","pinchZoomStorage","setTimeout","rerenderMagnifiedPages","i","pageGap","limit","initialRenderPages","updatePageContainer","getPageWidth","getPageTop","pageNumber","pageWidth","pageHeight","isReRender","pageDiv","getElement","textLayerDiv","enableRtl","right","updateLeftPosition","renderPageCanvas","clearTimeout","clearIntervalTimer","clearInterval","clearRendering","oldCanvases","document","querySelectorAll","id","split","pageCanvas","parentElement","removeChild","isTextMarkupAnnotationModule","rerenderAnnotationsPinch","pushImageObjects","image","push","j","onload","isInitialLoaded","renderInSeparateThread","pageViewScrollChanged","designNewCanvas","proxy","setInterval","initiateRerender","clearTextSelection","textSearchModule","clearAllOccurrences","textLayer","clearTextLayers","calculateScrollValues","formFieldsModule","proxy_2","pageIndex","currentPageCanvas","currentPageBounds","currentPageBoundsLeft","currentPageBoundsTop","previousPageTop","canvasPreviousY","canvasCurrentY","pageGapValue","zoomInterval","previousWidthFactor","scaleCorrectionFactor","scrollX_1","isMixedSizeDocument","scrollLeft","offsetWidth","isTouchPad","isMacSafari","scrollX_2","rerenderOnScroll","pageDivs","viewPortWidth","tileRenderingSettings","enableTileRendering","restrictZoomRequest","textLayers","display","annotationLayers","fomrFieldCollection","pageNumber_1","formFieldCollection","filter","data","forEach","formField","pinchMoveScroll","reRenderedCount","reRenderAfterPinch","currentPageIndex","lowerPageValue","higherPageValue","oldCanvas","parentNode","rerenderAnnotations","renderDrawing","undefined","visibility","oldCanvasCollection","newCanvas","canvas","pageRerenderOnMouseWheel","renderCountIncrement","rerenderCountIncrement","inkAnnotationModule","outputString","inkPathDataCollection","pathData","inkAnnotationInitialZoom","freeTextAnnotationModule","currentPosition","addInputInZoom","pageRenderCount","getElementById","isSelectionAvailable","isSelectionAvailableOnScroll","annotation","resizeAnnotations","retrieveCurrentZoomFactor","tileCount","getTileCount","noTileX","noTileY","tileSettings","tileRequestCount","storedData","clientSideRendering","getWindowSessionStorage","getPinchZoomPage","getLinkInformation","JSON","parse","imageData","src","k","tileImgId","oldPageDiv","isReRenderRequired","l","tileX","tileY","tileData","getStoredTileImageDetails","getWindowSessionStorageTile","node","nodeType","Node","ELEMENT_NODE","dataScaleFactor","scaleFactor","serverImageWidth","serverImageHeight","tilewidth","tileHeight","originalWidth","originalLeft","originalTop","aElement","getElementsByTagName","index","lowerValue","higherValue","isTextSelection","getTextSearchStatus","resizeTextContentsOnZoom","applySelectionRangeOnScroll","applyElementStyles","adornerSvg","adonerLayer","diagramAdornerLayer","renderSelector","annotationSelectorSettings","currentDifference","sqrt","pow","previousTouchDifference","getPinchStep","pinchMoveEnd","fitPageScrollMouseWheel","event","preventDefault","deltaY","downwardScrollFitPage","upwardScrollFitPage","magnifyBehaviorKeyDown","isMac","navigator","platform","match","isCommandKey","metaKey","keyCode","ctrlKey","shiftKey","updatePagesForFitPage","onDoubleTapMagnification","showToolbar","selectedItems","annotations","shapeAnnotationType","elmtPosition","bounds","addInuptElemet","getMagnifiedValue","value","destroy","getModuleName","defaultPinchStep","higherPinchStep","pinchstep","zoomToRect","zoomRect","desiredScaleFactor","location_1","getPageNumberFromClientPoint","desiredHorizontalScale","desiredVerticalScale","prevScrollTop","prevScrollLeft","pagepoint","convertClientPointToPagePoint","updateScrollTop","mainRect","mainContainer"],"sources":["/Users/saleem/Desktop/KClient/Web App/Ver_3.6/User Interface/website_Source files/node_modules/@syncfusion/ej2-pdfviewer/src/pdfviewer/magnification/magnification.js"],"sourcesContent":["/* eslint-disable */\nimport { Browser, isBlazor, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { getDiagramElement } from '@syncfusion/ej2-drawings';\n/**\n * Magnification module\n */\nvar Magnification = /** @class */ (function () {\n    /**\n     * @param pdfViewer\n     * @param viewerBase\n     * @private\n     */\n    function Magnification(pdfViewer, viewerBase) {\n        /**\n         * @private\n         */\n        this.zoomFactor = 1;\n        /**\n         * @private\n         */\n        this.previousZoomFactor = 1;\n        this.scrollWidth = 25;\n        this.zoomPercentages = [10, 25, 50, 75, 100, 125, 150, 200, 400];\n        this.isNotPredefinedZoom = false;\n        this.pinchStep = 0;\n        this.reRenderPageNumber = 0;\n        // eslint-disable-next-line\n        this.magnifyPageRerenderTimer = null;\n        // eslint-disable-next-line\n        this.rerenderOnScrollTimer = null;\n        // eslint-disable-next-line\n        this.rerenderInterval = null;\n        this.touchCenterX = 0;\n        this.touchCenterY = 0;\n        this.mouseCenterX = 0;\n        this.mouseCenterY = 0;\n        this.pageRerenderCount = 0;\n        this.imageObjects = [];\n        this.topValue = 0;\n        this.isTapToFitZoom = false;\n        /**\n         * @private\n         */\n        this.fitType = null;\n        /**\n         * @private\n         */\n        this.isPinchZoomed = false;\n        /**\n         * @private\n         */\n        this.isPagePinchZoomed = false;\n        /**\n         * @private\n         */\n        this.isRerenderCanvasCreated = false;\n        /**\n         * @private\n         */\n        this.isMagnified = false;\n        /**\n         * @private\n         */\n        this.isPagesZoomed = false;\n        /**\n         * @private\n         */\n        this.isPinchScrolled = false;\n        /**\n         * @private\n         */\n        this.isAutoZoom = false;\n        /**\n         * @private\n         */\n        this.isDoubleTapZoom = false;\n        /**\n         * @private\n         */\n        this.isFormFieldPageZoomed = false;\n        this.isWebkitMobile = false;\n        this.isFitToPageMode = true;\n        this.pdfViewer = pdfViewer;\n        this.pdfViewerBase = viewerBase;\n        this.zoomLevel = 2;\n        // eslint-disable-next-line max-len\n    }\n    /**\n     * Zoom the PDF document to the given zoom value\n     *\n     * @param  {number} zoomValue - Specifies the Zoom Value for magnify the PDF document\n     * @returns void\n     */\n    Magnification.prototype.zoomTo = function (zoomValue) {\n        var MaximumZoomPercentage = 400;\n        var MinmumZoomPercentage = 10;\n        if (zoomValue < MinmumZoomPercentage) {\n            zoomValue = MinmumZoomPercentage;\n        }\n        else if (zoomValue > MaximumZoomPercentage) {\n            zoomValue = MaximumZoomPercentage;\n        }\n        this.fitType = null;\n        this.isNotPredefinedZoom = false;\n        if (this.isAutoZoom && this.isInitialLoading) {\n            this.pdfViewerBase.onWindowResize();\n        }\n        else {\n            this.isAutoZoom = false;\n            this.onZoomChanged(zoomValue);\n        }\n        this.isInitialLoading = false;\n    };\n    /**\n     * Magnifies the page to the next value in the zoom drop down list.\n     *\n     * @returns void\n     */\n    Magnification.prototype.zoomIn = function () {\n        if (this.fitType || this.isNotPredefinedZoom) {\n            this.zoomLevel = this.lowerZoomLevel;\n            this.fitType = null;\n        }\n        this.isNotPredefinedZoom = false;\n        if (this.zoomLevel >= 8) {\n            this.zoomLevel = 8;\n        }\n        else {\n            this.zoomLevel++;\n        }\n        this.isAutoZoom = false;\n        this.onZoomChanged(this.zoomPercentages[this.zoomLevel]);\n    };\n    /**\n     * Magnifies the page to the previous value in the zoom drop down list.\n     *\n     * @returns void\n     */\n    Magnification.prototype.zoomOut = function () {\n        if (this.fitType || this.isNotPredefinedZoom) {\n            this.zoomLevel = this.higherZoomLevel;\n            this.fitType = null;\n        }\n        this.isNotPredefinedZoom = false;\n        if (this.zoomLevel <= 0) {\n            this.zoomLevel = 0;\n        }\n        else {\n            this.zoomLevel--;\n        }\n        this.isAutoZoom = false;\n        this.onZoomChanged(this.zoomPercentages[this.zoomLevel]);\n    };\n    /**\n     * Scales the page to fit the page width to the width of the container in the control.\n     *\n     * @returns void\n     */\n    Magnification.prototype.fitToWidth = function () {\n        this.isAutoZoom = false;\n        var zoomValue = this.calculateFitZoomFactor('fitToWidth');\n        this.onZoomChanged(zoomValue);\n    };\n    /**\n     * @private\n     */\n    Magnification.prototype.fitToAuto = function () {\n        this.isAutoZoom = true;\n        var zoomValue = this.calculateFitZoomFactor('fitToWidth');\n        this.onZoomChanged(zoomValue);\n    };\n    /**\n     * Scales the page to fit the page in the container in the control.\n     *\n     * @param  {number} zoomValue - Defines the Zoom Value for fit the page in the Container\n     * @returns void\n     */\n    Magnification.prototype.fitToPage = function () {\n        var zoomValue = this.calculateFitZoomFactor('fitToPage');\n        if (zoomValue !== null) {\n            this.isAutoZoom = false;\n            this.onZoomChanged(zoomValue);\n            if (Browser.isDevice && !this.pdfViewer.enableDesktopMode) {\n                if (this.pdfViewerBase.isWebkitMobile) {\n                    this.pdfViewerBase.viewerContainer.style.overflowY = 'auto';\n                }\n                else {\n                    this.pdfViewerBase.viewerContainer.style.overflowY = 'hidden';\n                }\n            }\n            else {\n                this.pdfViewerBase.viewerContainer.style.overflowY = 'auto';\n            }\n            if (this.pdfViewerBase.pageSize[this.pdfViewerBase.currentPageNumber - 1]) {\n                // eslint-disable-next-line max-len\n                this.pdfViewerBase.viewerContainer.scrollTop = this.pdfViewerBase.pageSize[this.pdfViewerBase.currentPageNumber - 1].top * this.zoomFactor;\n            }\n        }\n    };\n    /**\n     * Returns zoom factor for the fit zooms.\n     *\n     * @param type\n     */\n    Magnification.prototype.calculateFitZoomFactor = function (type) {\n        var viewerWidth = this.pdfViewerBase.viewerContainer.getBoundingClientRect().width;\n        var viewerHeight = this.pdfViewerBase.viewerContainer.getBoundingClientRect().height;\n        if (viewerWidth === 0 && viewerHeight === 0) {\n            viewerWidth = parseFloat(this.pdfViewer.width.toString());\n            viewerHeight = parseFloat(this.pdfViewer.height.toString());\n        }\n        if (isNaN(viewerHeight) || isNaN(viewerWidth)) {\n            return null;\n        }\n        this.fitType = type;\n        if (this.fitType === 'fitToWidth') {\n            var scaleX = ((viewerWidth - this.scrollWidth) / this.pdfViewerBase.highestWidth);\n            if (this.isAutoZoom) {\n                this.fitType = null;\n                scaleX = Math.min(1, scaleX);\n                if (scaleX === 1) {\n                    this.zoomLevel = 2;\n                }\n            }\n            // eslint-disable-next-line radix\n            return parseInt((scaleX * 100).toString());\n        }\n        else {\n            this.isFitToPageMode = true;\n            var pageLeft = 10;\n            var scaleX = ((viewerWidth - this.scrollWidth - pageLeft) / this.pdfViewerBase.highestWidth);\n            var scaleY = (viewerHeight / this.pdfViewerBase.highestHeight);\n            if (scaleY > scaleX) {\n                scaleY = scaleX;\n                this.isFitToPageMode = false;\n            }\n            // eslint-disable-next-line radix\n            return parseInt((scaleY * 100).toString());\n        }\n    };\n    /**\n     * Initiating cursor based zoom.\n     * @private\n     */\n    Magnification.prototype.initiateMouseZoom = function (pointX, pointY, zoomValue) {\n        var pointInViewer = this.positionInViewer(pointX, pointY);\n        this.mouseCenterX = pointInViewer.x;\n        this.mouseCenterY = pointInViewer.y;\n        this.zoomTo(zoomValue);\n    };\n    /**\n     * Performs pinch in operation\n     */\n    Magnification.prototype.pinchIn = function () {\n        this.fitType = null;\n        var temporaryZoomFactor = this.zoomFactor - this.pinchStep;\n        if (temporaryZoomFactor < 4 && temporaryZoomFactor > 2) {\n            temporaryZoomFactor = this.zoomFactor - this.pinchStep;\n        }\n        if (temporaryZoomFactor <= 1.5) {\n            temporaryZoomFactor = this.zoomFactor - (this.pinchStep / 1.5);\n        }\n        if (temporaryZoomFactor < 0.25) {\n            temporaryZoomFactor = 0.25;\n        }\n        this.isPinchZoomed = true;\n        this.onZoomChanged(temporaryZoomFactor * 100);\n        this.isTapToFitZoom = true;\n        if ((Browser.isDevice && !this.pdfViewer.enableDesktopMode) && (this.zoomFactor * 100) === 50) {\n            var zoomValue = this.calculateFitZoomFactor('fitToWidth');\n            this.fitType = null;\n            if (zoomValue <= 50) {\n                this.fitToWidth();\n            }\n        }\n    };\n    /**\n     * Performs pinch out operation\n     */\n    Magnification.prototype.pinchOut = function () {\n        this.fitType = null;\n        var temporaryZoomFactor = this.zoomFactor + this.pinchStep;\n        if (Browser.isDevice && !this.pdfViewer.enableDesktopMode) {\n            if (temporaryZoomFactor > 4) {\n                temporaryZoomFactor = 4;\n            }\n        }\n        else {\n            if (temporaryZoomFactor > 2) {\n                temporaryZoomFactor = temporaryZoomFactor + this.pinchStep;\n            }\n            if (temporaryZoomFactor > 4) {\n                temporaryZoomFactor = 4;\n            }\n        }\n        this.isTapToFitZoom = true;\n        this.isPinchZoomed = true;\n        this.onZoomChanged(temporaryZoomFactor * 100);\n    };\n    /**\n     * returns zoom level for the zoom factor.\n     *\n     * @param zoomFactor\n     */\n    Magnification.prototype.getZoomLevel = function (zoomFactor) {\n        var min = 0;\n        var max = this.zoomPercentages.length - 1;\n        while ((min <= max) && !(min === 0 && max === 0)) {\n            var mid = Math.round((min + max) / 2);\n            if (this.zoomPercentages[mid] <= zoomFactor) {\n                min = mid + 1;\n            }\n            else if (this.zoomPercentages[mid] >= zoomFactor) {\n                max = mid - 1;\n            }\n        }\n        this.higherZoomLevel = min;\n        this.lowerZoomLevel = max;\n        return max;\n    };\n    /**\n     * @private\n     */\n    Magnification.prototype.checkZoomFactor = function () {\n        return this.zoomPercentages.indexOf(this.zoomFactor * 100) > -1;\n    };\n    /**\n     * Executes when the zoom or pinch operation is performed\n     *\n     * @param zoomValue\n     */\n    Magnification.prototype.onZoomChanged = function (zoomValue) {\n        if (zoomValue) {\n            if (this.pdfViewer.annotationModule) {\n                this.pdfViewer.annotationModule.closePopupMenu();\n            }\n            this.previousZoomFactor = this.zoomFactor;\n            this.zoomLevel = this.getZoomLevel(zoomValue);\n            this.zoomFactor = this.getZoomFactor(zoomValue);\n            if (this.zoomFactor <= 0.25) {\n                this.pdfViewerBase.isMinimumZoom = true;\n            }\n            else {\n                this.pdfViewerBase.isMinimumZoom = false;\n            }\n            if (!isNullOrUndefined(this.pdfViewerBase.viewerContainer)) {\n                if (Browser.isDevice && !this.pdfViewer.enableDesktopMode) {\n                    if (this.pdfViewerBase.isWebkitMobile) {\n                        this.pdfViewerBase.viewerContainer.style.overflowY = 'auto';\n                    }\n                    else {\n                        this.pdfViewerBase.viewerContainer.style.overflowY = 'hidden';\n                    }\n                }\n                else {\n                    this.pdfViewerBase.viewerContainer.style.overflowY = 'auto';\n                }\n            }\n            if (this.pdfViewerBase.pageCount > 0) {\n                if ((this.previousZoomFactor !== this.zoomFactor)) {\n                    if (!this.isPinchZoomed) {\n                        this.magnifyPages();\n                    }\n                    else {\n                        if (Browser.isDevice && !this.pdfViewer.enableDesktopMode) {\n                            // eslint-disable-next-line max-len\n                            this.pdfViewerBase.mobilePageNoContainer.style.left = (this.pdfViewer.element.clientWidth / 2) - (parseFloat(this.pdfViewerBase.mobilePageNoContainer.style.width) / 2) + 'px';\n                        }\n                        this.responsivePages();\n                    }\n                }\n                if (!isBlazor()) {\n                    if (this.pdfViewer.toolbarModule) {\n                        this.pdfViewer.toolbarModule.updateZoomButtons();\n                    }\n                }\n                if (!this.isInitialLoading) {\n                    if (this.previousZoomFactor !== this.zoomFactor) {\n                        // eslint-disable-next-line\n                        this.pdfViewer.zoomValue = parseInt((this.zoomFactor * 100).toString());\n                        this.pdfViewer.fireZoomChange();\n                    }\n                }\n            }\n            if (this.pdfViewer.toolbarModule) {\n                this.pdfViewer.toolbarModule.updateZoomPercentage(this.zoomFactor);\n            }\n            if (!this.isInitialLoading) {\n                if (this.previousZoomFactor !== this.zoomFactor) {\n                    this.pdfViewer.zoomValue = parseInt((this.zoomFactor * 100).toString());\n                    this.pdfViewer.fireZoomChange();\n                }\n            }\n            if ((Browser.isDevice && !this.pdfViewer.enableDesktopMode) && this.isPinchZoomed) {\n                // eslint-disable-next-line radix\n                var zoomPercentage = parseInt((this.zoomFactor * 100).toString()) + '%';\n                this.pdfViewerBase.navigationPane.createTooltipMobile(zoomPercentage);\n            }\n        }\n    };\n    /**\n     * @param clientX\n     * @param clientY\n     * @private\n     */\n    Magnification.prototype.setTouchPoints = function (clientX, clientY) {\n        var pointInViewer = this.positionInViewer(clientX, clientY);\n        this.touchCenterX = pointInViewer.x;\n        this.touchCenterY = pointInViewer.y;\n    };\n    /**\n     * @param pointX1\n     * @param pointY1\n     * @param pointX2\n     * @param pointY2\n     * @param pointX1\n     * @param pointY1\n     * @param pointX2\n     * @param pointY2\n     * @param pointX1\n     * @param pointY1\n     * @param pointX2\n     * @param pointY2\n     * @param pointX1\n     * @param pointY1\n     * @param pointX2\n     * @param pointY2\n     * @private\n     */\n    Magnification.prototype.initiatePinchMove = function (pointX1, pointY1, pointX2, pointY2) {\n        this.isPinchScrolled = false;\n        this.isMagnified = false;\n        this.reRenderPageNumber = this.pdfViewerBase.currentPageNumber;\n        var pointInViewer = this.positionInViewer((pointX1 + pointX2) / 2, (pointY1 + pointY2) / 2);\n        this.touchCenterX = pointInViewer.x;\n        this.touchCenterY = pointInViewer.y;\n        this.zoomOverPages(pointX1, pointY1, pointX2, pointY2);\n    };\n    Magnification.prototype.magnifyPages = function () {\n        var _this = this;\n        this.clearRerenderTimer();\n        this.pdfViewerBase.showPageLoadingIndicator(this.pdfViewerBase.currentPageNumber - 1, true);\n        if (!this.isPagesZoomed) {\n            this.reRenderPageNumber = this.pdfViewerBase.currentPageNumber;\n        }\n        if (!this.pdfViewerBase.documentLoaded && !this.pdfViewerBase.isInitialPageMode) {\n            this.isPagesZoomed = true;\n        }\n        var scrollValue = this.pdfViewerBase.viewerContainer.scrollTop;\n        if (this.pdfViewer.textSelectionModule) {\n            this.pdfViewer.textSelectionModule.maintainSelectionOnZoom(false, true);\n        }\n        if (this.pdfViewer.formDesignerModule && !this.pdfViewerBase.documentLoaded && !this.pdfViewerBase.isDocumentLoaded) {\n            this.isFormFieldPageZoomed = true;\n        }\n        if (!this.isInitialLoading) {\n            this.isMagnified = true;\n        }\n        this.updatePageLocation();\n        this.resizeCanvas(this.reRenderPageNumber);\n        this.calculateScrollValuesOnMouse(scrollValue);\n        if (this.pdfViewer.textSelectionModule) {\n            this.pdfViewer.textSelectionModule.resizeTouchElements();\n        }\n        // eslint-disable-next-line\n        var annotModule = this.pdfViewer.annotationModule;\n        if (annotModule && annotModule.textMarkupAnnotationModule) {\n            this.pdfViewer.annotationModule.textMarkupAnnotationModule.updateCurrentResizerPosition();\n        }\n        if (this.pdfViewerBase.pageSize.length > 0) {\n            // eslint-disable-next-line max-len\n            this.pdfViewerBase.pageContainer.style.height = this.topValue + this.pdfViewerBase.getPageHeight(this.pdfViewerBase.pageSize.length - 1) + 'px';\n            // eslint-disable-next-line\n            var proxy_1 = this;\n            this.pdfViewerBase.renderedPagesList = [];\n            this.pdfViewerBase.pinchZoomStorage = [];\n            if (!this.pdfViewerBase.documentLoaded) {\n                this.magnifyPageRerenderTimer = setTimeout(function () {\n                    proxy_1.rerenderMagnifiedPages();\n                    _this.pdfViewerBase.showPageLoadingIndicator(_this.pdfViewerBase.currentPageNumber - 1, false);\n                }, 800);\n            }\n        }\n    };\n    Magnification.prototype.updatePageLocation = function () {\n        this.topValue = 0;\n        for (var i = 1; i < this.pdfViewerBase.pageSize.length; i++) {\n            this.topValue += (this.pdfViewerBase.pageSize[i].height + this.pdfViewerBase.pageGap) * this.zoomFactor;\n        }\n        var limit;\n        if (this.pdfViewer.initialRenderPages > 10) {\n            limit = this.pdfViewer.initialRenderPages <= this.pdfViewerBase.pageCount ? this.pdfViewer.initialRenderPages : this.pdfViewerBase.pageCount;\n        }\n        else {\n            limit = this.pdfViewerBase.pageCount < 10 ? this.pdfViewerBase.pageCount : 10;\n        }\n        for (var i = 0; i < limit; i++) {\n            this.updatePageContainer(i, this.pdfViewerBase.getPageWidth(i), this.pdfViewerBase.getPageHeight(i), this.pdfViewerBase.getPageTop(i), true);\n        }\n    };\n    Magnification.prototype.updatePageContainer = function (pageNumber, pageWidth, pageHeight, topValue, isReRender) {\n        // eslint-disable-next-line\n        var pageDiv = this.pdfViewerBase.getElement('_pageDiv_' + pageNumber);\n        if (pageDiv) {\n            pageDiv.style.width = pageWidth + 'px';\n            pageDiv.style.height = pageHeight + 'px';\n            // eslint-disable-next-line\n            var textLayerDiv = this.pdfViewerBase.getElement('_textLayer_' + pageNumber);\n            if (textLayerDiv) {\n                textLayerDiv.style.width = pageWidth + 'px';\n                textLayerDiv.style.height = pageHeight + 'px';\n            }\n            pageDiv.style.width = pageWidth + 'px';\n            pageDiv.style.height = pageHeight + 'px';\n            if (this.pdfViewer.enableRtl) {\n                pageDiv.style.right = this.pdfViewerBase.updateLeftPosition(pageNumber) + 'px';\n            }\n            else {\n                pageDiv.style.left = this.pdfViewerBase.updateLeftPosition(pageNumber) + 'px';\n            }\n            pageDiv.style.top = topValue + 'px';\n            this.pdfViewerBase.pageContainer.style.width = this.pdfViewerBase.viewerContainer.clientWidth + 'px';\n            this.pdfViewerBase.renderPageCanvas(pageDiv, pageWidth, pageHeight, pageNumber, 'block');\n        }\n    };\n    Magnification.prototype.clearRerenderTimer = function () {\n        clearTimeout(this.rerenderOnScrollTimer);\n        clearTimeout(this.magnifyPageRerenderTimer);\n        this.clearIntervalTimer();\n        this.isPinchScrolled = false;\n    };\n    /**\n     * @private\n     */\n    Magnification.prototype.clearIntervalTimer = function () {\n        clearInterval(this.rerenderInterval);\n        this.rerenderInterval = null;\n        this.clearRendering();\n        var oldCanvases = document.querySelectorAll('canvas[id*=\"' + this.pdfViewer.element.id + '_oldCanvas_\"]');\n        for (var i = 0; i < oldCanvases.length; i++) {\n            // eslint-disable-next-line\n            var pageNumber = parseInt(oldCanvases[i].id.split('_oldCanvas_')[1]);\n            var pageCanvas = this.pdfViewerBase.getElement('_pageCanvas_' + pageNumber);\n            if (pageCanvas) {\n                oldCanvases[i].id = pageCanvas.id;\n                pageCanvas.parentElement.removeChild(pageCanvas);\n            }\n            else {\n                oldCanvases[i].id = this.pdfViewer.element.id + '_pageCanvas_' + pageNumber;\n            }\n            if (this.pdfViewerBase.isTextMarkupAnnotationModule()) {\n                this.pdfViewer.annotationModule.textMarkupAnnotationModule.rerenderAnnotationsPinch(i);\n            }\n        }\n        this.isRerenderCanvasCreated = false;\n    };\n    /**\n     * @param image\n     * @private\n     */\n    Magnification.prototype.pushImageObjects = function (image) {\n        if (!isNullOrUndefined(this.imageObjects)) {\n            this.imageObjects && this.imageObjects.push(image);\n        }\n    };\n    Magnification.prototype.clearRendering = function () {\n        if (this.imageObjects) {\n            for (var j = 0; j < this.imageObjects.length; j++) {\n                if (this.imageObjects[j]) {\n                    this.imageObjects[j].onload = null;\n                }\n            }\n            this.imageObjects = [];\n        }\n    };\n    Magnification.prototype.rerenderMagnifiedPages = function () {\n        if ((this.pdfViewerBase.isInitialLoaded || this.pdfViewerBase.isDocumentLoaded) && !this.pdfViewerBase.isInitialPageMode) {\n            this.renderInSeparateThread(this.reRenderPageNumber);\n            this.isPagesZoomed = false;\n        }\n        else if (this.pdfViewerBase.isInitialPageMode) {\n            this.pageRerenderCount = 0;\n            this.pdfViewerBase.renderedPagesList = [];\n            this.pdfViewerBase.pinchZoomStorage = [];\n            this.isMagnified = false;\n            this.pdfViewerBase.pageViewScrollChanged(this.reRenderPageNumber);\n            this.pdfViewerBase.isInitialPageMode = false;\n        }\n    };\n    Magnification.prototype.renderInSeparateThread = function (pageNumber) {\n        var _this = this;\n        this.designNewCanvas(pageNumber);\n        this.pageRerenderCount = 0;\n        this.pdfViewerBase.renderedPagesList = [];\n        this.pdfViewerBase.pinchZoomStorage = [];\n        this.isMagnified = false;\n        this.pdfViewerBase.pageViewScrollChanged(this.reRenderPageNumber);\n        // eslint-disable-next-line\n        var proxy = this;\n        this.rerenderInterval = setInterval(function () {\n            _this.initiateRerender(proxy);\n        }, 1);\n    };\n    Magnification.prototype.responsivePages = function () {\n        this.isPagesZoomed = true;\n        this.clearRerenderTimer();\n        if (this.pdfViewer.textSelectionModule) {\n            this.pdfViewer.textSelectionModule.clearTextSelection();\n        }\n        if (this.pdfViewer.textSearchModule) {\n            this.pdfViewer.textSearchModule.clearAllOccurrences();\n        }\n        var scrollValue = this.pdfViewerBase.viewerContainer.scrollTop;\n        this.isAutoZoom = false;\n        this.updatePageLocation();\n        // eslint-disable-next-line max-len\n        this.pdfViewerBase.pageContainer.style.height = this.topValue + this.pdfViewerBase.pageSize[this.pdfViewerBase.pageSize.length - 1].height * this.zoomFactor + 'px';\n        this.resizeCanvas(this.pdfViewerBase.currentPageNumber);\n        if (this.pdfViewerBase.textLayer && this.pdfViewer.formDesignerModule) {\n            this.pdfViewerBase.textLayer.clearTextLayers(true);\n        }\n        if (this.isPinchZoomed) {\n            this.calculateScrollValues(scrollValue);\n        }\n        this.pdfViewerBase.renderedPagesList = [];\n        this.pdfViewerBase.pinchZoomStorage = [];\n        if (this.pdfViewer.formFieldsModule && !this.pdfViewer.formDesignerModule) {\n            var proxy_2 = this;\n            if (!this.pdfViewerBase.documentLoaded) {\n                this.magnifyPageRerenderTimer = setTimeout(function () {\n                    proxy_2.rerenderMagnifiedPages();\n                }, 800);\n            }\n        }\n    };\n    Magnification.prototype.calculateScrollValues = function (scrollValue) {\n        var pageIndex = this.pdfViewerBase.currentPageNumber - 1;\n        var currentPageCanvas = this.pdfViewerBase.getElement('_pageDiv_' + pageIndex);\n        if (currentPageCanvas) {\n            var pointInViewer = void 0;\n            var currentPageBounds = currentPageCanvas.getBoundingClientRect();\n            if (this.pdfViewer.enableRtl && !this.isDoubleTapZoom) {\n                pointInViewer = this.positionInViewer(currentPageBounds.right, currentPageBounds.top);\n            }\n            else {\n                pointInViewer = this.positionInViewer(currentPageBounds.left, currentPageBounds.top);\n            }\n            var currentPageBoundsLeft = pointInViewer.x;\n            var currentPageBoundsTop = pointInViewer.y;\n            // update scroll top for the viewer container based on pinch zoom factor\n            var previousPageTop = (currentPageBoundsTop) * this.previousZoomFactor;\n            var canvasPreviousY = scrollValue + this.touchCenterY;\n            // eslint-disable-next-line max-len\n            var canvasCurrentY = (currentPageBoundsTop) * this.zoomFactor + ((canvasPreviousY - previousPageTop) < 0 ? canvasPreviousY - previousPageTop : (canvasPreviousY -\n                // eslint-disable-next-line max-len\n                previousPageTop) * (this.zoomFactor / this.previousZoomFactor));\n            var pageGapValue = this.zoomFactor - this.previousZoomFactor > 0 ? -this.pdfViewerBase.pageGap * (this.zoomFactor / this.previousZoomFactor) : this.pdfViewerBase.pageGap * (this.previousZoomFactor / this.zoomFactor);\n            this.pdfViewerBase.viewerContainer.scrollTop = canvasCurrentY - this.touchCenterY + pageGapValue / this.pdfViewerBase.zoomInterval;\n            // update scroll left for the viewer container based on pinch zoom factor\n            var previousWidthFactor = (currentPageBounds.width * this.previousZoomFactor) / currentPageBounds.width;\n            var scaleCorrectionFactor = this.zoomFactor / previousWidthFactor - 1;\n            var scrollX_1 = this.touchCenterX - currentPageBoundsLeft;\n            if (this.pdfViewerBase.isMixedSizeDocument && (this.pdfViewerBase.highestWidth * this.pdfViewerBase.getZoomFactor()) > this.pdfViewerBase.viewerContainer.clientWidth) {\n                this.pdfViewerBase.viewerContainer.scrollLeft = (this.pdfViewerBase.pageContainer.offsetWidth - this.pdfViewerBase.viewerContainer.clientWidth) / 2;\n            }\n            else {\n                this.pdfViewerBase.viewerContainer.scrollLeft += scrollX_1 * scaleCorrectionFactor;\n            }\n        }\n    };\n    Magnification.prototype.calculateScrollValuesOnMouse = function (scrollValue) {\n        var pageIndex = this.pdfViewerBase.currentPageNumber - 1;\n        var currentPageCanvas = this.pdfViewerBase.getElement('_pageDiv_' + pageIndex);\n        if (currentPageCanvas) {\n            var pointInViewer = void 0;\n            var currentPageBounds = currentPageCanvas.getBoundingClientRect();\n            if (this.pdfViewer.enableRtl) {\n                pointInViewer = this.positionInViewer(currentPageBounds.right, currentPageBounds.top);\n            }\n            else {\n                pointInViewer = this.positionInViewer(currentPageBounds.left, currentPageBounds.top);\n            }\n            var currentPageBoundsLeft = pointInViewer.x;\n            var currentPageBoundsTop = pointInViewer.y;\n            // update scroll top for the viewer container based on mouse zoom factor\n            var previousPageTop = (currentPageBoundsTop) * this.previousZoomFactor;\n            var canvasPreviousY = scrollValue + this.mouseCenterY;\n            // eslint-disable-next-line max-len\n            var canvasCurrentY = (currentPageBoundsTop) * this.zoomFactor + ((canvasPreviousY - previousPageTop) * (this.zoomFactor / this.previousZoomFactor));\n            // eslint-disable-next-line max-len\n            var pageGapValue = this.pdfViewerBase.pageGap * (this.zoomFactor / this.previousZoomFactor);\n            if (this.pdfViewerBase.isTouchPad && !this.pdfViewerBase.isMacSafari) {\n                pageGapValue = pageGapValue / this.pdfViewerBase.zoomInterval;\n            }\n            this.pdfViewerBase.viewerContainer.scrollTop = canvasCurrentY - this.mouseCenterY + pageGapValue;\n            // update scroll left for the viewer container based on mouse zoom factor\n            var previousWidthFactor = (currentPageBounds.width * this.previousZoomFactor) / currentPageBounds.width;\n            var scaleCorrectionFactor = this.zoomFactor / previousWidthFactor - 1;\n            var scrollX_2 = this.mouseCenterX - currentPageBoundsLeft;\n            if (this.pdfViewerBase.isMixedSizeDocument && (this.pdfViewerBase.highestWidth * this.pdfViewerBase.getZoomFactor()) > this.pdfViewerBase.viewerContainer.clientWidth) {\n                this.pdfViewerBase.viewerContainer.scrollLeft = (this.pdfViewerBase.pageContainer.offsetWidth - this.pdfViewerBase.viewerContainer.clientWidth) / 2;\n            }\n            else {\n                this.pdfViewerBase.viewerContainer.scrollLeft += scrollX_2 * scaleCorrectionFactor;\n            }\n        }\n    };\n    Magnification.prototype.rerenderOnScroll = function () {\n        var _this = this;\n        this.isPinchZoomed = false;\n        if (this.isPinchScrolled) {\n            this.rerenderOnScrollTimer = null;\n            this.isPinchScrolled = false;\n            this.reRenderPageNumber = this.pdfViewerBase.currentPageNumber;\n            this.pdfViewerBase.renderedPagesList = [];\n            this.pdfViewerBase.pinchZoomStorage = [];\n            var pageDivs = document.querySelectorAll('img[id*=\"' + this.pdfViewer.element.id + '_pageCanvas_\"]');\n            var viewPortWidth = 816;\n            for (var i = 0; i < pageDivs.length; i++) {\n                // eslint-disable-next-line radix\n                var pageNumber = parseInt(pageDivs[i].id.split('_pageCanvas_')[1]);\n                var pageWidth = this.pdfViewerBase.pageSize[pageNumber].width;\n                if ((viewPortWidth < pageWidth) && this.pdfViewer.tileRenderingSettings.enableTileRendering) {\n                    if (this.pdfViewer.restrictZoomRequest) {\n                        pageDivs[i].style.width = pageWidth * this.pdfViewerBase.getZoomFactor() + 'px';\n                        // eslint-disable-next-line max-len\n                        pageDivs[i].style.height = this.pdfViewerBase.pageSize[pageNumber].height * this.pdfViewerBase.getZoomFactor() + 'px';\n                    }\n                    else {\n                        pageDivs[i].style.width = pageWidth * this.pdfViewerBase.getZoomFactor() + 'px';\n                        // eslint-disable-next-line max-len\n                        pageDivs[i].style.height = this.pdfViewerBase.pageSize[pageNumber].height * this.pdfViewerBase.getZoomFactor() + 'px';\n                    }\n                }\n            }\n            if (this.pdfViewerBase.textLayer) {\n                var textLayers = document.querySelectorAll('div[id*=\"' + this.pdfViewer.element.id + '_textLayer_\"]');\n                for (var i = 0; i < textLayers.length; i++) {\n                    textLayers[i].style.display = 'block';\n                }\n            }\n            if (this.pdfViewerBase.isTextMarkupAnnotationModule()) {\n                // eslint-disable-next-line max-len\n                var annotationLayers = document.querySelectorAll('canvas[id*=\"' + this.pdfViewer.element.id + '_annotationCanvas_\"]');\n                for (var j = 0; j < annotationLayers.length; j++) {\n                    var pageNumber = annotationLayers[j].id.split('_annotationCanvas_')[1];\n                    // eslint-disable-next-line radix\n                    this.pdfViewer.annotationModule.textMarkupAnnotationModule.rerenderAnnotationsPinch(parseInt(pageNumber));\n                }\n            }\n            if (Browser.isDevice) {\n                if (this.pdfViewer.formDesignerModule) {\n                    var fomrFieldCollection = void 0;\n                    var pageNumber_1 = this.pdfViewer.currentPageNumber;\n                    fomrFieldCollection = this.pdfViewer.formFieldCollection.filter(function (data) { return data.pageNumber === pageNumber_1; });\n                    for (var i = 0; i < fomrFieldCollection.length; i++) {\n                        document.querySelectorAll(\"[id^=\" + fomrFieldCollection[parseInt(i.toString(), 10)].id + \"]\").forEach(function (formField) { return formField.style.display = 'none'; });\n                    }\n                }\n                else {\n                    document.querySelectorAll(\"[id^=\\\"pdfViewerinput_\\\"]\").forEach(function (formField) { return formField.parentElement.style.display = 'none'; });\n                }\n            }\n            this.pdfViewerBase.pageViewScrollChanged(this.reRenderPageNumber);\n            this.isPagePinchZoomed = false;\n            this.rerenderOnScrollTimer = setTimeout(function () {\n                _this.pdfViewerBase.pageViewScrollChanged(_this.reRenderPageNumber);\n            }, 300);\n        }\n    };\n    /**\n     * @private\n     */\n    Magnification.prototype.pinchMoveScroll = function () {\n        var _this = this;\n        if (this.isRerenderCanvasCreated) {\n            this.clearIntervalTimer();\n        }\n        if (this.isPagesZoomed || (!this.isRerenderCanvasCreated && this.isPagePinchZoomed)) {\n            this.clearRendering();\n            this.isPagesZoomed = false;\n            clearTimeout(this.magnifyPageRerenderTimer);\n            this.isPinchScrolled = true;\n            this.isFormFieldPageZoomed = true;\n            this.rerenderOnScrollTimer = setTimeout(function () {\n                _this.rerenderOnScroll();\n            }, 100);\n        }\n    };\n    // eslint-disable-next-line\n    Magnification.prototype.initiateRerender = function (proxy) {\n        var isReRender = false;\n        if (this.previousZoomFactor < 0.4 || this.pdfViewerBase.isMinimumZoom) {\n            isReRender = true;\n        }\n        // eslint-disable-next-line max-len\n        if (((proxy.pageRerenderCount === proxy.pdfViewerBase.reRenderedCount) || isReRender) && proxy.pageRerenderCount !== 0 && proxy.pdfViewerBase.reRenderedCount !== 0) {\n            proxy.reRenderAfterPinch(this.reRenderPageNumber);\n            proxy.isFormFieldPageZoomed = false;\n        }\n    };\n    Magnification.prototype.reRenderAfterPinch = function (currentPageIndex) {\n        this.pageRerenderCount = 0;\n        var lowerPageValue = currentPageIndex - 3;\n        var higherPageValue = currentPageIndex + 1;\n        if (this.pdfViewerBase.isMinimumZoom) {\n            lowerPageValue = currentPageIndex - 4;\n            higherPageValue = currentPageIndex + 4;\n        }\n        lowerPageValue = (lowerPageValue > 0) ? lowerPageValue : 0;\n        higherPageValue = (higherPageValue < this.pdfViewerBase.pageCount) ? higherPageValue : (this.pdfViewerBase.pageCount - 1);\n        for (var i = lowerPageValue; i <= higherPageValue; i++) {\n            var pageDiv = this.pdfViewerBase.getElement('_pageDiv_' + i);\n            var pageCanvas = this.pdfViewerBase.getElement('_pageCanvas_' + i);\n            var oldCanvas = this.pdfViewerBase.getElement('_oldCanvas_' + i);\n            if (oldCanvas) {\n                oldCanvas.parentNode.removeChild(oldCanvas);\n            }\n            if (this.pdfViewerBase.isTextMarkupAnnotationModule()) {\n                this.pdfViewer.annotationModule.textMarkupAnnotationModule.rerenderAnnotations(i);\n            }\n            else if (this.pdfViewer.formDesignerModule) {\n                this.rerenderAnnotations(i);\n                this.pdfViewer.renderDrawing(undefined, currentPageIndex);\n            }\n            if (pageDiv) {\n                pageDiv.style.visibility = 'visible';\n            }\n        }\n        this.isRerenderCanvasCreated = false;\n        this.isPagePinchZoomed = false;\n        if (this.pdfViewerBase.reRenderedCount !== 0) {\n            this.pdfViewerBase.reRenderedCount = 0;\n            this.pageRerenderCount = 0;\n            clearInterval(this.rerenderInterval);\n            this.rerenderInterval = null;\n        }\n        this.imageObjects = [];\n    };\n    /**\n     * @param pageNumber\n     * @private\n     */\n    Magnification.prototype.rerenderAnnotations = function (pageNumber) {\n        // eslint-disable-next-line\n        var oldCanvasCollection = document.querySelectorAll('#' + this.pdfViewer.element.id + '_old_annotationCanvas_' + pageNumber);\n        for (var i = 0; i < oldCanvasCollection.length; i++) {\n            if (oldCanvasCollection[i]) {\n                oldCanvasCollection[i].parentElement.removeChild(oldCanvasCollection[i]);\n            }\n        }\n        var newCanvas = this.pdfViewerBase.getElement('_annotationCanvas_' + pageNumber);\n        if (newCanvas) {\n            newCanvas.style.display = 'block';\n        }\n    };\n    Magnification.prototype.designNewCanvas = function (currentPageIndex) {\n        if (this.pdfViewerBase.textLayer) {\n            this.pdfViewerBase.textLayer.clearTextLayers();\n        }\n        var lowerPageValue = currentPageIndex - 3;\n        var higherPageValue = currentPageIndex + 1; // jshint ignore:line\n        if (this.pdfViewerBase.isMinimumZoom) {\n            lowerPageValue = currentPageIndex - 4;\n            higherPageValue = currentPageIndex + 4;\n        }\n        lowerPageValue = (lowerPageValue > 0) ? lowerPageValue : 0;\n        higherPageValue = (higherPageValue < this.pdfViewerBase.pageCount) ? higherPageValue : (this.pdfViewerBase.pageCount - 1);\n        for (var i = lowerPageValue; i <= higherPageValue; i++) {\n            var canvas = this.pdfViewerBase.getElement('_pageCanvas_' + i);\n            var width = this.pdfViewerBase.pageSize[i].width * this.zoomFactor;\n            var height = this.pdfViewerBase.pageSize[i].height * this.zoomFactor;\n            if (canvas && !this.pdfViewer.restrictZoomRequest) {\n                // eslint-disable-next-line max-len\n                this.pdfViewerBase.renderPageCanvas(this.pdfViewerBase.getElement('_pageDiv_' + i), width, height, i, 'none');\n            }\n            else if (!this.pdfViewer.restrictZoomRequest) {\n                // eslint-disable-next-line max-len\n                this.pdfViewerBase.renderPageCanvas(this.pdfViewerBase.getElement('_pageDiv_' + i), width, height, i, 'none');\n            }\n        }\n        this.isRerenderCanvasCreated = true;\n    };\n    /**\n     * @private\n     */\n    Magnification.prototype.pageRerenderOnMouseWheel = function () {\n        var _this = this;\n        if (this.isRerenderCanvasCreated) {\n            this.clearIntervalTimer();\n            clearTimeout(this.magnifyPageRerenderTimer);\n            if (!this.isPinchScrolled) {\n                this.isPinchScrolled = true;\n                this.rerenderOnScrollTimer = setTimeout(function () {\n                    _this.rerenderOnScroll();\n                }, 100);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Magnification.prototype.renderCountIncrement = function () {\n        if (this.isRerenderCanvasCreated) {\n            this.pageRerenderCount++;\n        }\n    };\n    /**\n     * @private\n     */\n    Magnification.prototype.rerenderCountIncrement = function () {\n        if (this.pageRerenderCount > 0) {\n            this.pdfViewerBase.reRenderedCount++;\n        }\n    };\n    /**\n     * @param pageNumber\n     * @private\n     */\n    Magnification.prototype.resizeCanvas = function (pageNumber) {\n        var annotationModule = this.pdfViewer.annotationModule;\n        if (annotationModule && annotationModule.inkAnnotationModule && annotationModule.inkAnnotationModule.outputString !== '') {\n            // eslint-disable-next-line\n            annotationModule.inkAnnotationModule.inkPathDataCollection.push({ pathData: annotationModule.inkAnnotationModule.outputString, zoomFactor: annotationModule.inkAnnotationModule.inkAnnotationInitialZoom });\n            annotationModule.inkAnnotationModule.outputString = '';\n        }\n        if (annotationModule && annotationModule.freeTextAnnotationModule) {\n            // eslint-disable-next-line\n            var currentPosition = { x: annotationModule.freeTextAnnotationModule.currentPosition[0], y: annotationModule.freeTextAnnotationModule.currentPosition[1], width: annotationModule.freeTextAnnotationModule.currentPosition[2], height: annotationModule.freeTextAnnotationModule.currentPosition[3] };\n            annotationModule.freeTextAnnotationModule.addInputInZoom(currentPosition);\n        }\n        var lowerPageValue = pageNumber - 3;\n        var higherPageValue = pageNumber + 3;\n        if (this.pdfViewerBase.isMinimumZoom) {\n            lowerPageValue = pageNumber - 4;\n            higherPageValue = pageNumber + 4;\n        }\n        if (this.pdfViewer.initialRenderPages > this.pdfViewerBase.pageRenderCount) {\n            lowerPageValue = 0;\n            higherPageValue = (higherPageValue < this.pdfViewer.initialRenderPages) ? (this.pdfViewer.initialRenderPages <= this.pdfViewerBase.pageCount) ? this.pdfViewer.initialRenderPages : this.pdfViewerBase.pageCount : (higherPageValue < this.pdfViewerBase.pageCount) ? higherPageValue : (this.pdfViewerBase.pageCount - 1);\n        }\n        else {\n            lowerPageValue = (lowerPageValue > 0) ? lowerPageValue : 0;\n            higherPageValue = (higherPageValue < this.pdfViewerBase.pageCount) ? higherPageValue : (this.pdfViewerBase.pageCount - 1);\n        }\n        for (var i = lowerPageValue; i <= higherPageValue; i++) {\n            var pageDiv = this.pdfViewerBase.getElement('_pageDiv_' + i);\n            var textLayer = document.getElementById(this.pdfViewer.element.id + '_textLayer_' + i);\n            if (pageDiv) {\n                if ((lowerPageValue <= i) && (i <= higherPageValue)) {\n                    var isSelectionAvailable = false;\n                    if (this.pdfViewer.textSelectionModule) {\n                        isSelectionAvailable = this.pdfViewer.textSelectionModule.isSelectionAvailableOnScroll(i);\n                    }\n                    if (this.pdfViewerBase.pageSize[i] != null) {\n                        var width = this.pdfViewerBase.pageSize[i].width * this.zoomFactor;\n                        var height = this.pdfViewerBase.pageSize[i].height * this.zoomFactor;\n                        pageDiv.style.width = width + 'px';\n                        pageDiv.style.height = height + 'px';\n                        // eslint-disable-next-line max-len\n                        pageDiv.style.top = ((this.pdfViewerBase.pageSize[i].top) * this.zoomFactor) + 'px';\n                        if (this.pdfViewer.enableRtl) {\n                            pageDiv.style.right = this.pdfViewerBase.updateLeftPosition(i) + 'px';\n                        }\n                        else {\n                            pageDiv.style.left = this.pdfViewerBase.updateLeftPosition(i) + 'px';\n                        }\n                        var canvas = this.pdfViewerBase.getElement('_pageCanvas_' + i);\n                        if (canvas) {\n                            canvas.style.width = (width) + 'px';\n                            canvas.style.height = height + 'px';\n                            if (this.pdfViewer.annotation) {\n                                this.pdfViewer.annotationModule.resizeAnnotations(width, height, i);\n                            }\n                            else if (this.pdfViewer.formDesignerModule) {\n                                this.pdfViewer.formDesignerModule.resizeAnnotations(width, height, i);\n                            }\n                        }\n                        var zoomFactor = this.pdfViewerBase.retrieveCurrentZoomFactor();\n                        var tileCount = this.pdfViewerBase.getTileCount(this.pdfViewerBase.pageSize[i].width);\n                        var noTileX = void 0;\n                        var noTileY = void 0;\n                        noTileX = noTileY = tileCount;\n                        var tileSettings = this.pdfViewer.tileRenderingSettings;\n                        if (tileSettings.enableTileRendering && tileSettings.x > 0 && tileSettings.y > 0) {\n                            if ((1200 < this.pdfViewerBase.pageSize[i].width || this.pdfViewerBase.getZoomFactor() > 2)) {\n                                noTileX = tileSettings.x;\n                                noTileY = tileSettings.y;\n                            }\n                        }\n                        var tileRequestCount = noTileX * noTileY;\n                        if (tileRequestCount === 1) {\n                            var storedData = void 0;\n                            if (this.pdfViewerBase.clientSideRendering) {\n                                storedData = this.pdfViewerBase.getWindowSessionStorage(i, zoomFactor) ? this.pdfViewerBase.getWindowSessionStorage(i, zoomFactor) : this.pdfViewerBase.getPinchZoomPage(i);\n                            }\n                            else {\n                                storedData = this.pdfViewerBase.getLinkInformation(i) ? this.pdfViewerBase.getLinkInformation(i) : this.pdfViewerBase.getWindowSessionStorage(i, zoomFactor);\n                            }\n                            if (storedData) {\n                                storedData = this.pdfViewerBase.clientSideRendering && typeof storedData === 'object' ? storedData : JSON.parse(storedData);\n                                var imageData = storedData['image'];\n                                if (imageData) {\n                                    canvas.src = imageData;\n                                    canvas.style.display = 'block';\n                                    var oldCanvases = document.querySelectorAll('img[id*=\"' + this.pdfViewer.element.id + '_tileimg_' + i + '_\"]');\n                                    var pageCanvas = this.pdfViewerBase.getElement('_pageDiv_' + i);\n                                    for (var k = 0; k < oldCanvases.length; k++) {\n                                        var tileImgId = oldCanvases[k].id.split('_');\n                                        if (parseFloat(tileImgId[tileImgId.length - 3]) != this.pdfViewerBase.getZoomFactor())\n                                            pageCanvas.removeChild(oldCanvases[k]);\n                                    }\n                                    var oldPageDiv = document.querySelectorAll('img[id*=\"' + this.pdfViewer.element.id + '_oldCanvas\"]');\n                                    for (var j = 0; j < oldPageDiv.length; j++) {\n                                        pageDiv.removeChild(oldPageDiv[j]);\n                                    }\n                                }\n                                this.pdfViewerBase.isReRenderRequired = false;\n                            }\n                            else {\n                                this.pdfViewerBase.isReRenderRequired = true;\n                            }\n                        }\n                        else {\n                            var oldCanvases = document.querySelectorAll('img[id*=\"' + this.pdfViewer.element.id + '_tileimg_' + i + '_\"]');\n                            for (var l = 0; l < oldCanvases.length; l++) {\n                                var tileImgId = oldCanvases[l].id.split('_');\n                                var tileX = parseFloat(tileImgId[tileImgId.length - 2]);\n                                var tileY = parseFloat(tileImgId[tileImgId.length - 1]);\n                                // eslint-disable-next-line\n                                var tileData = this.pdfViewerBase.clientSideRendering ? JSON.parse(this.pdfViewerBase.getStoredTileImageDetails(i, tileX, tileY, zoomFactor)) : JSON.parse(this.pdfViewerBase.getWindowSessionStorageTile(i, tileX, tileY, zoomFactor));\n                                if (tileData && tileData.zoomFactor) {\n                                    zoomFactor = tileData.zoomFactor;\n                                }\n                                if (parseFloat(tileImgId[tileImgId.length - 4]) === i) {\n                                    canvas.style.display = 'none';\n                                    var node = oldCanvases[l];\n                                    // Make sure it's really an Element\n                                    if (node.nodeType == Node.ELEMENT_NODE) {\n                                        var dataScaleFactor = 1.5;\n                                        if (!isNullOrUndefined(tileData)) {\n                                            dataScaleFactor = (!isNullOrUndefined(tileData.scaleFactor)) ? tileData.scaleFactor : 1.5;\n                                        }\n                                        var pageWidth = this.pdfViewerBase.pageSize[i].width;\n                                        var serverImageWidth = pageWidth * zoomFactor * dataScaleFactor;\n                                        var serverImageHeight = this.pdfViewerBase.pageSize[i].height * zoomFactor * dataScaleFactor;\n                                        var tilewidth = serverImageWidth / noTileX;\n                                        var tileHeight = serverImageHeight / noTileY;\n                                        var originalWidth = tilewidth;\n                                        var originalLeft = parseFloat(tileImgId[tileImgId.length - 2]) * tilewidth;\n                                        var originalTop = parseFloat(tileImgId[tileImgId.length - 1]) * tileHeight;\n                                        node.width = (((originalWidth * this.pdfViewerBase.getZoomFactor()) / zoomFactor) / dataScaleFactor);\n                                        node.style.width = (((originalWidth * this.pdfViewerBase.getZoomFactor()) / zoomFactor) / dataScaleFactor) + 'px';\n                                        node.style.left = (((originalLeft * this.pdfViewerBase.getZoomFactor()) / zoomFactor) / dataScaleFactor) + 'px';\n                                        node.style.top = (((originalTop * this.pdfViewerBase.getZoomFactor()) / zoomFactor) / dataScaleFactor) + 'px';\n                                        node.id = this.pdfViewer.element.id + '_tileimg_' + i + '_' + this.pdfViewerBase.getZoomFactor() + '_' + tileX + '_' + tileY;\n                                        if (tileData) {\n                                            var imageData = tileData['image'];\n                                            if (imageData) {\n                                                node.src = imageData;\n                                            }\n                                            this.pdfViewerBase.isReRenderRequired = false;\n                                        }\n                                        else {\n                                            this.pdfViewerBase.isReRenderRequired = true;\n                                        }\n                                    }\n                                }\n                            }\n                            if (oldCanvases.length === 0) {\n                                this.pdfViewerBase.isReRenderRequired = true;\n                            }\n                        }\n                        var aElement = pageDiv.getElementsByTagName('a');\n                        if (aElement.length !== 0) {\n                            for (var index = aElement.length - 1; index >= 0; index--) {\n                                aElement[index].parentNode.removeChild(aElement[index]);\n                            }\n                        }\n                        if (textLayer) {\n                            textLayer.style.width = width + 'px';\n                            textLayer.style.height = height + 'px';\n                            if (this.pdfViewer.textSelectionModule) {\n                                if (this.isPinchZoomed) {\n                                    textLayer.style.display = 'none';\n                                }\n                                else if (this.isMagnified) {\n                                    var lowerValue = ((pageNumber - 2) === 0) ? 0 : (pageNumber - 2);\n                                    // eslint-disable-next-line max-len\n                                    var higherValue = ((pageNumber) === (this.pdfViewerBase.pageCount)) ? (this.pdfViewerBase.pageCount - 1) : (pageNumber + 1);\n                                    if ((lowerValue <= i) && (i <= higherValue) && ((this.pdfViewer.textSelectionModule.isTextSelection && isSelectionAvailable) || this.pdfViewerBase.textLayer.getTextSearchStatus() || this.pdfViewerBase.isInitialPageMode)) {\n                                        this.pdfViewerBase.textLayer.resizeTextContentsOnZoom(i);\n                                        if (this.pdfViewer.textSelectionModule.isTextSelection && isSelectionAvailable) {\n                                            this.pdfViewer.textSelectionModule.applySelectionRangeOnScroll(i);\n                                        }\n                                    }\n                                    else {\n                                        textLayer.style.display = 'none';\n                                    }\n                                }\n                                else {\n                                    textLayer.style.display = 'block';\n                                }\n                            }\n                            this.pdfViewerBase.applyElementStyles(textLayer, i);\n                        }\n                        var adornerSvg = getDiagramElement(this.pdfViewer.element.id + '_textLayer_' + i);\n                        if (adornerSvg) {\n                            var adonerLayer = getDiagramElement(this.pdfViewer.element.id + i + '_diagramAdorner_svg');\n                            if (adonerLayer) {\n                                adonerLayer.style.width = width + 'px';\n                                adonerLayer.style.height = height + 'px';\n                            }\n                            var diagramAdornerLayer = getDiagramElement(this.pdfViewer.element.id + i + '_diagramAdornerLayer');\n                            if (diagramAdornerLayer) {\n                                diagramAdornerLayer.style.width = width + 'px';\n                                diagramAdornerLayer.style.height = height + 'px';\n                            }\n                            adornerSvg.style.width = width + 'px';\n                            adornerSvg.style.height = height + 'px';\n                            this.pdfViewer.renderSelector(i, this.pdfViewer.annotationSelectorSettings);\n                            this.pdfViewerBase.applyElementStyles(diagramAdornerLayer, i);\n                        }\n                    }\n                }\n            }\n        }\n    };\n    Magnification.prototype.zoomOverPages = function (pointX1, pointY1, pointX2, pointY2) {\n        // eslint-disable-next-line\n        var currentDifference = Math.sqrt(Math.pow((pointX1 - pointX2), 2) + Math.pow((pointY1 - pointY2), 2));\n        if (this.previousTouchDifference > -1) {\n            if (currentDifference > this.previousTouchDifference) {\n                this.pinchStep = this.getPinchStep(currentDifference, this.previousTouchDifference);\n                this.pinchOut();\n            }\n            else if (currentDifference < this.previousTouchDifference) {\n                this.pinchStep = this.getPinchStep(this.previousTouchDifference, currentDifference);\n                this.pinchIn();\n            }\n        }\n        this.previousTouchDifference = currentDifference;\n    };\n    /**\n     * @private\n     */\n    Magnification.prototype.pinchMoveEnd = function () {\n        this.touchCenterX = 0;\n        this.touchCenterY = 0;\n        this.previousTouchDifference = -1;\n        if (this.isPinchZoomed) {\n            this.isPinchScrolled = false;\n            this.isPagePinchZoomed = true;\n            this.pinchMoveScroll();\n        }\n    };\n    /**\n     * @param event\n     * @private\n     */\n    // eslint-disable-next-line\n    Magnification.prototype.fitPageScrollMouseWheel = function (event) {\n        if (this.fitType === 'fitToPage') {\n            this.isMagnified = false;\n            event.preventDefault();\n            if (event.deltaY > 0) {\n                this.downwardScrollFitPage(this.pdfViewerBase.currentPageNumber - 1);\n            }\n            else {\n                this.upwardScrollFitPage(this.pdfViewerBase.currentPageNumber - 1);\n            }\n        }\n    };\n    /**\n     * @param event\n     * @private\n     */\n    Magnification.prototype.magnifyBehaviorKeyDown = function (event) {\n        var isMac = navigator.platform.match(/(Mac|iPhone|iPod|iPad)/i) ? true : false;\n        var isCommandKey = isMac ? event.metaKey : false;\n        switch (event.keyCode) {\n            case 38: // up arrow\n            case 37: // left arrow\n            case 33: // page up\n                if (this.fitType === 'fitToPage' && !((event.ctrlKey || isCommandKey) && event.shiftKey)) {\n                    event.preventDefault();\n                    this.upwardScrollFitPage(this.pdfViewerBase.currentPageNumber - 1);\n                }\n                break;\n            case 40: // down arrow\n            case 39: // right arrow\n            case 34: // page down\n                if (this.fitType === 'fitToPage' && !((event.ctrlKey || isCommandKey) && event.shiftKey)) {\n                    event.preventDefault();\n                    this.downwardScrollFitPage(this.pdfViewerBase.currentPageNumber - 1);\n                }\n                break;\n            case 187: // equal key\n                if (event.ctrlKey || isCommandKey) {\n                    event.preventDefault();\n                    this.zoomIn();\n                }\n                break;\n            case 189: // minus key\n                if (event.ctrlKey || isCommandKey) {\n                    event.preventDefault();\n                    this.zoomOut();\n                }\n                break;\n            case 48: // zero key\n                if ((event.ctrlKey || isCommandKey) && !event.shiftKey) {\n                    event.preventDefault();\n                    this.fitToPage();\n                }\n                break;\n            case 49: // one key\n                if ((event.ctrlKey || isCommandKey) && !event.shiftKey) {\n                    event.preventDefault();\n                    this.zoomTo(100);\n                }\n                break;\n            default:\n                break;\n        }\n    };\n    Magnification.prototype.upwardScrollFitPage = function (currentPageIndex) {\n        if (currentPageIndex > 0) {\n            this.pdfViewerBase.getElement('_pageDiv_' + (currentPageIndex - 1)).style.visibility = 'visible';\n            this.pdfViewerBase.viewerContainer.scrollTop = this.pdfViewerBase.pageSize[currentPageIndex - 1].top * this.zoomFactor;\n            if (this.isFitToPageMode) {\n                this.pdfViewerBase.getElement('_pageDiv_' + (currentPageIndex)).style.visibility = 'hidden';\n            }\n        }\n    };\n    /**\n     * @param currentPageIndex\n     * @private\n     */\n    Magnification.prototype.updatePagesForFitPage = function (currentPageIndex) {\n        if (this.fitType === 'fitToPage') {\n            if (this.isFitToPageMode) {\n                if (currentPageIndex > 0 && this.pdfViewerBase.getElement('_pageDiv_' + (currentPageIndex - 1))) {\n                    this.pdfViewerBase.getElement('_pageDiv_' + (currentPageIndex - 1)).style.visibility = 'hidden';\n                }\n                // eslint-disable-next-line max-len\n                if ((currentPageIndex < (this.pdfViewerBase.pageCount - 1)) && this.pdfViewerBase.getElement('_pageDiv_' + (currentPageIndex + 1))) {\n                    this.pdfViewerBase.getElement('_pageDiv_' + (currentPageIndex + 1)).style.visibility = 'hidden';\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Magnification.prototype.onDoubleTapMagnification = function () {\n        var _this = this;\n        if (this.pdfViewer.toolbarModule && isBlazor()) {\n            this.pdfViewer.toolbarModule.showToolbar(true);\n        }\n        var scrollValue = this.pdfViewerBase.viewerContainer.scrollTop;\n        if (!this.pdfViewer.selectedItems.annotations[0]) {\n            this.isDoubleTapZoom = true;\n            if (!this.isTapToFitZoom) {\n                if (this.zoomFactor < 2) {\n                    this.zoomTo(200);\n                }\n                else {\n                    this.fitToWidth();\n                }\n            }\n            else {\n                this.fitToWidth();\n            }\n            this.calculateScrollValues(scrollValue);\n            this.isTapToFitZoom = !this.isTapToFitZoom;\n            setTimeout(function () { _this.isMagnified = false; }, 500);\n            this.isDoubleTapZoom = false;\n        }\n        else {\n            if (isBlazor()) {\n                // eslint-disable-next-line max-len\n                if (this.pdfViewer.selectedItems.annotations[0] && this.pdfViewer.selectedItems.annotations[0].shapeAnnotationType === 'FreeText') {\n                    var elmtPosition = {};\n                    elmtPosition.x = this.pdfViewer.selectedItems.annotations[0].bounds.x;\n                    elmtPosition.y = this.pdfViewer.selectedItems.annotations[0].bounds.y;\n                    // eslint-disable-next-line max-len\n                    this.pdfViewer.annotation.freeTextAnnotationModule.addInuptElemet(elmtPosition, this.pdfViewer.selectedItems.annotations[0]);\n                }\n            }\n        }\n    };\n    Magnification.prototype.downwardScrollFitPage = function (currentPageIndex) {\n        if (currentPageIndex !== (this.pdfViewerBase.pageCount - 1)) {\n            this.pdfViewerBase.getElement('_pageDiv_' + (currentPageIndex + 1)).style.visibility = 'visible';\n            this.pdfViewerBase.viewerContainer.scrollTop = this.pdfViewerBase.pageSize[currentPageIndex + 1].top * this.zoomFactor;\n            if (this.isFitToPageMode) {\n                if (currentPageIndex + 1 === (this.pdfViewerBase.pageCount - 1)) {\n                    this.pdfViewerBase.getElement('_pageDiv_' + (currentPageIndex)).style.visibility = 'hidden';\n                }\n                else {\n                    this.pdfViewerBase.getElement('_pageDiv_' + (currentPageIndex + 2)).style.visibility = 'hidden';\n                }\n            }\n        }\n    };\n    Magnification.prototype.getMagnifiedValue = function (value) {\n        return (value / this.previousZoomFactor) * this.zoomFactor;\n    };\n    /**\n     * @private\n     */\n    Magnification.prototype.destroy = function () {\n        this.imageObjects = undefined;\n    };\n    /**\n     * returns zoom factor when the zoom percent is passed.\n     *\n     * @param zoomValue\n     */\n    Magnification.prototype.getZoomFactor = function (zoomValue) {\n        return zoomValue / 100;\n    };\n    /**\n     * @private\n     */\n    Magnification.prototype.getModuleName = function () {\n        return 'Magnification';\n    };\n    /**\n    * Returns the pinch step value.\n    * @param higherValue\n    * @param lowerValue\n    */\n    Magnification.prototype.getPinchStep = function (higherValue, lowerValue) {\n        var defaultPinchStep = 0.02; // Default pinch step value.\n        var higherPinchStep = 1; // higher pinch step value.\n        var pinchstep = (higherValue - lowerValue) / 100;\n        if (pinchstep < defaultPinchStep) {\n            pinchstep = defaultPinchStep;\n        }\n        else if (pinchstep > higherPinchStep) {\n            pinchstep = 0.1; // set the pinch step as 0.1 if the pinch reaches the higher pinch step value.\n        }\n        return pinchstep;\n    };\n    /**\n    * @private\n    * Brings the given rectangular region to view and zooms in the document to fit the region in client area (view port).\n    *\n    * @param {Rect} zoomRect - Specifies the region in client coordinates that is to be brought to view.\n    */\n    Magnification.prototype.zoomToRect = function (zoomRect) {\n        var desiredScaleFactor;\n        var pdfViewerBase = this.pdfViewerBase;\n        var viewerContainer = pdfViewerBase.viewerContainer;\n        var pdfViewer = this.pdfViewer;\n        if (zoomRect.width > 0 && zoomRect.height > 0) {\n            var location_1 = { x: zoomRect.x, y: zoomRect.y };\n            var pageNumber = pdfViewer.getPageNumberFromClientPoint(location_1);\n            if (pageNumber > 0) {\n                var desiredHorizontalScale = viewerContainer.getBoundingClientRect().width / zoomRect.width;\n                var desiredVerticalScale = viewerContainer.getBoundingClientRect().height / zoomRect.height;\n                if (desiredHorizontalScale < desiredVerticalScale) {\n                    desiredScaleFactor = desiredHorizontalScale;\n                }\n                else {\n                    desiredScaleFactor = desiredVerticalScale;\n                }\n                var zoomValue = 100; // default zoom value\n                var zoomPercentage = pdfViewerBase.getZoomFactor() * 100;\n                zoomValue = zoomPercentage * desiredScaleFactor;\n                var prevScrollTop = viewerContainer.scrollTop;\n                var prevScrollLeft = viewerContainer.scrollLeft;\n                // Zoom to desired zoom value.\n                this.zoomTo(zoomValue);\n                viewerContainer.scrollTop = prevScrollTop;\n                viewerContainer.scrollLeft = prevScrollLeft;\n                var zoomFactor = pdfViewerBase.getZoomFactor();\n                var pagepoint = { x: zoomRect.x, y: zoomRect.y };\n                // Convert the client point to page point.\n                pagepoint = pdfViewer.convertClientPointToPagePoint(pagepoint, pageNumber);\n                pdfViewerBase.updateScrollTop(pageNumber - 1);\n                // To adjust the container to the left position.\n                viewerContainer.scrollLeft = (pagepoint.x - prevScrollLeft) * zoomFactor;\n                // To adjust the container to the top position.\n                viewerContainer.scrollTop = ((pagepoint.y + pdfViewerBase.pageSize[pageNumber - 1].top) - prevScrollTop) * zoomFactor;\n            }\n        }\n    };\n    /**\n    * Returns Point value respect to Main container.\n    * @param PointX\n    * @param PointY\n    */\n    Magnification.prototype.positionInViewer = function (pointX, pointY) {\n        var mainRect = this.pdfViewerBase.mainContainer.getBoundingClientRect();\n        return { x: pointX - mainRect.left, y: pointY - mainRect.top };\n    };\n    return Magnification;\n}());\nexport { Magnification };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}