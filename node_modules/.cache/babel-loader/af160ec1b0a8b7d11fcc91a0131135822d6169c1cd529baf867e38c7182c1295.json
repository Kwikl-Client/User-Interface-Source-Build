{"ast":null,"code":"import * as events from '../base/constant';\nimport { detach, addClass, isNullOrUndefined as isNOU, removeClass, closest, createElement, EventHandler } from '@syncfusion/ej2-base';\nimport { Popup } from '@syncfusion/ej2-popups';\nimport { Toolbar } from '@syncfusion/ej2-navigations';\nimport { BaseToolbar } from './base-toolbar';\nimport { TextBox } from '@syncfusion/ej2-inputs';\nvar EmojiPicker = /** @class */function () {\n  function EmojiPicker(parent, serviceLocator) {\n    this.parent = parent;\n    this.locator = serviceLocator;\n    this.i10n = serviceLocator.getService('rteLocale');\n    this.renderFactory = this.locator.getService('rendererFactory');\n    this.baseToolbar = new BaseToolbar(this.parent, this.locator);\n    this.addEventListener();\n  }\n  /**\n   * Destroys the Count.\n   *\n   * @function destroy\n   * @returns {void}\n   * @hidden\n    */\n  EmojiPicker.prototype.destroy = function () {\n    this.removeEventListener();\n  };\n  EmojiPicker.prototype.addEventListener = function () {\n    this.parent.on(events.emojiPicker, this.toolbarClick, this);\n    this.parent.on(events.docClick, this.docClick, this);\n    this.parent.on(events.keyDown, this.onkeyPress, this);\n    this.parent.on(events.keyUp, this.onkeyUp, this);\n    this.parent.on(events.contentscroll, this.contentscroll, this);\n    this.parent.on(events.scroll, this.contentscroll, this);\n  };\n  // eslint-disable-next-line\n  EmojiPicker.prototype.toolbarClick = function (args) {\n    var _this = this;\n    var _a, _b;\n    var spanElement;\n    if (!isNOU(this.parent.element.querySelector('.e-emoji'))) {\n      spanElement = this.parent.element.querySelector('.e-emoji');\n    } else if (this.parent.inlineMode.enable) {\n      spanElement = this.parent.element.ownerDocument.querySelector('.e-emoji');\n    }\n    this.divElement = spanElement.closest('div');\n    if (!this.parent.inputElement.contains(this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()).startContainer)) {\n      this.parent.contentModule.getEditPanel().focus();\n    }\n    var range = this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());\n    this.save = this.parent.formatter.editorManager.nodeSelection.save(range, this.parent.contentModule.getDocument());\n    this.clickEvent = args.args;\n    var emojiPicker = this.parent.emojiPickerSettings.iconsSet;\n    if (this.popupObj) {\n      removeClass([this.divElement], 'e-active');\n      if (this.popupObj.element.querySelector('.e-rte-emoji-search') || !this.parent.emojiPickerSettings.showSearchBox) {\n        this.popupObj.hide();\n        return;\n      }\n      this.popupObj.hide();\n    }\n    this.popDiv = this.parent.createElement('div', {\n      className: 'e-rte-emojipicker-popup',\n      id: this.parent.getID() + '_emojiPicker'\n    });\n    if (!isNOU(this.parent.getToolbar()) && !this.parent.inlineMode.enable) {\n      this.parent.getToolbar().appendChild(this.popDiv);\n    } else if (this.parent.inlineMode.enable) {\n      this.parent.inputElement.appendChild(this.popDiv);\n    }\n    EventHandler.add(this.popDiv, 'keydown', this.onKeyDown, this);\n    EventHandler.add(this.popDiv, 'keyup', this.searchFilter, this);\n    var extendEle = this.parent.element.querySelector('.e-toolbar-extended');\n    var zIndex;\n    if (!isNOU(extendEle)) {\n      var computedStyle = window.getComputedStyle(extendEle);\n      zIndex = computedStyle.getPropertyValue('z-index');\n    } else {\n      zIndex = '10001';\n    }\n    var target;\n    var xValue;\n    var yValue;\n    if (!isNOU(args.args) && !this.parent.inlineMode.enable && isNOU(this.parent.quickToolbarSettings.text)) {\n      target = args.args.originalEvent.target;\n      target = target.classList.contains('e-toolbar-item') ? target.firstChild : target.parentElement;\n      xValue = 'left';\n      yValue = 'bottom';\n    } else if (isNOU(args.x) && isNOU(args.y) && !this.parent.inlineMode.enable && isNOU(this.parent.quickToolbarSettings.text)) {\n      target = this.parent.inputElement;\n      if (this.parent.contentModule.getDocument().getSelection().rangeCount > 0) {\n        var coordinates = this.getCoordinates();\n        xValue = coordinates.left;\n        yValue = coordinates.top;\n      }\n    } else if (isNOU(args.x) && isNOU(args.y) && (this.parent.inlineMode.enable || !isNOU(this.parent.quickToolbarSettings.text))) {\n      this.parent.notify(events.hidePopup, {});\n      if (this.parent.contentModule.getDocument().getSelection().rangeCount > 0) {\n        var coordinates = this.getCoordinates();\n        xValue = coordinates.left;\n        yValue = coordinates.top;\n      }\n    } else {\n      target = this.parent.inputElement;\n      xValue = args.x;\n      yValue = args.y;\n    }\n    this.popupObj = new Popup(this.popDiv, {\n      targetType: 'relative',\n      relateTo: target,\n      collision: {\n        X: 'fit',\n        Y: 'none'\n      },\n      offsetY: 8,\n      viewPortElement: this.parent.element,\n      position: {\n        X: xValue,\n        Y: yValue\n      },\n      enableRtl: this.parent.enableRtl,\n      zIndex: parseInt(zIndex, 10) + 1,\n      actionOnScroll: 'hide',\n      // eslint-disable-next-line\n      close: function (event) {\n        _this.parent.isBlur = false;\n        _this.popupObj.destroy();\n        detach(_this.popupObj.element);\n        _this.popupObj = null;\n      }\n    });\n    addClass([this.popupObj.element], 'e-popup-open');\n    this.popupObj.refreshPosition(target);\n    // header search element\n    if ((!isNOU(args.args) || isNOU(args.x) && isNOU(args.y)) && this.parent.emojiPickerSettings.showSearchBox) {\n      var inputEle = createElement('input', {\n        id: 'e-rte-emoji-search',\n        className: 'e-rte-emoji-search'\n      });\n      this.popDiv.append(inputEle);\n      var inputobj = new TextBox({\n        placeholder: this.i10n.getConstant('emojiPickerTypeToFind'),\n        showClearButton: true\n      });\n      inputobj.appendTo(inputEle);\n      inputEle.focus();\n    }\n    var closeIcon = this.popupObj.element.querySelector('.e-clear-icon');\n    if (!isNOU(closeIcon)) {\n      EventHandler.add(closeIcon, 'mousedown', this.searchFilter, this);\n    }\n    // Header emoji toolbar div\n    var emojiToolBar = this.parent.createElement('div', {\n      className: 'e-rte-emojipicker-toolbar'\n    });\n    this.popDiv.appendChild(emojiToolBar);\n    var pushToolBar = [];\n    for (var i = 0; i < this.parent.emojiPickerSettings.iconsSet.length; i++) {\n      if (!isNOU(this.parent.emojiPickerSettings.iconsSet[i].iconCss)) {\n        pushToolBar.push({\n          prefixIcon: this.parent.emojiPickerSettings.iconsSet[i].iconCss,\n          htmlAttributes: (_a = {}, _a['title'] = this.parent.emojiPickerSettings.iconsSet[i].name, _a)\n        });\n      } else {\n        pushToolBar.push({\n          text: '&#x' + this.parent.emojiPickerSettings.iconsSet[i].code + ';',\n          htmlAttributes: (_b = {}, _b['title'] = this.parent.emojiPickerSettings.iconsSet[i].name, _b)\n        });\n      }\n    }\n    var toolbarObj = new Toolbar({\n      items: pushToolBar,\n      clicked: this.emojiToolbarClick.bind(this)\n    });\n    toolbarObj.appendTo(emojiToolBar);\n    // emoji btn div\n    var emojiBtnDiv = this.parent.createElement('div', {\n      className: 'e-rte-emojipicker-btn'\n    });\n    this.popDiv.appendChild(emojiBtnDiv);\n    var height;\n    var popupBorder = window.getComputedStyle(this.popDiv);\n    if (isNOU(args.args) && !(isNOU(args.x) && isNOU(args.y)) || !this.parent.emojiPickerSettings.showSearchBox) {\n      height = this.popDiv.getBoundingClientRect().height - emojiToolBar.getBoundingClientRect().height - 2 * parseFloat(popupBorder.borderWidth) + 'px';\n      emojiBtnDiv.style.setProperty('height', height, 'important');\n    } else {\n      var inputELe = this.parent.element.querySelector('.e-rte-emoji-search').parentElement;\n      var getComputedStyle_1 = window.getComputedStyle(inputELe);\n      height = this.popDiv.getBoundingClientRect().height - emojiToolBar.getBoundingClientRect().height - inputELe.getBoundingClientRect().height - parseFloat(getComputedStyle_1.marginTop) - parseFloat(getComputedStyle_1.marginBottom) - 2 * parseFloat(popupBorder.borderWidth) + 'px';\n      emojiBtnDiv.style.setProperty('height', height, 'important');\n    }\n    for (var i = 0; i < emojiPicker.length; i++) {\n      var emojiGroupDiv = this.parent.createElement('div', {\n        className: 'e-rte-emojipicker-group'\n      });\n      emojiBtnDiv.appendChild(emojiGroupDiv);\n      var emojiName = this.parent.createElement('div', {\n        className: 'e-rte-emojipicker-name'\n      });\n      emojiName.innerText = this.parent.emojiPickerSettings.iconsSet[i].name;\n      emojiName.setAttribute('aria-label', this.parent.emojiPickerSettings.iconsSet[i].name);\n      emojiGroupDiv.appendChild(emojiName);\n      var emojiBtn = this.parent.createElement('div', {\n        className: 'e-rte-emojipickerbtn-group'\n      });\n      emojiGroupDiv.appendChild(emojiBtn);\n      for (var j = 0; j < emojiPicker[i].icons.length; j++) {\n        var button = this.parent.createElement('button', {\n          className: 'e-btn ' + ' ' + 'e-control'\n        });\n        button.innerHTML = this.buttoncode(this.parent.emojiPickerSettings.iconsSet[i].icons[j].code);\n        button.setAttribute('aria-label', this.parent.emojiPickerSettings.iconsSet[i].icons[j].desc);\n        button.setAttribute('title', this.parent.emojiPickerSettings.iconsSet[i].icons[j].desc);\n        emojiBtn.appendChild(button);\n        if (button.innerHTML.length > 2) {\n          button.style.fontSize = '17px';\n        }\n      }\n    }\n    EventHandler.add(emojiBtnDiv, 'scroll', this.scrollEvent, this);\n    EventHandler.add(emojiBtnDiv, 'click', this.emojiBtnClick, this);\n    var emojiButtons = this.parent.element.querySelectorAll('.e-rte-emojipicker-btn button');\n    if (isNOU(this.parent.element.querySelector('.e-rte-emoji-search')) && !isNOU(args.args)) {\n      emojiButtons[0].focus();\n      addClass([emojiButtons[0]], 'e-focus');\n    }\n    var popup = this.parent.element.querySelector('.e-rte-emojipicker-btn');\n    var toolbarName = this.parent.element.querySelectorAll('.e-rte-emojipicker-toolbar button');\n    var scrollTop;\n    if (!isNOU(popup)) {\n      scrollTop = Math.round(popup.scrollTop);\n    }\n    if (scrollTop < toolbarName[0].offsetHeight) {\n      addClass([toolbarName[0]], 'e-selected');\n    }\n    if (this.popupObj) {\n      addClass([this.divElement], 'e-active');\n    }\n  };\n  EmojiPicker.prototype.buttoncode = function (value) {\n    var valueLength = value.split('-');\n    // eslint-disable-next-line\n    var joinedEmoji = valueLength.map(function (cp) {\n      return String.fromCodePoint(parseInt(cp, 16));\n    }).join('\\u200D');\n    return joinedEmoji;\n  };\n  EmojiPicker.prototype.docClick = function (e) {\n    var target = e.args.target;\n    if (target && target.classList && this.popupObj && !closest(target, '[id=' + '\\'' + this.popupObj.element.id + '\\'' + ']') && !target.classList.contains('e-emoji') && !target.classList.contains('e-toolbar-item')) {\n      if (this.popupObj) {\n        removeClass([this.divElement], 'e-active');\n        this.popupObj.hide();\n      }\n    }\n  };\n  EmojiPicker.prototype.scrollEvent = function () {\n    var popup = this.parent.element.querySelector('.e-rte-emojipicker-btn');\n    var emojiSet = this.parent.element.querySelectorAll('.e-rte-emojipicker-group');\n    var toolbarName = this.parent.element.querySelectorAll('.e-rte-emojipicker-toolbar button');\n    var scrollTop;\n    if (!isNOU(popup)) {\n      scrollTop = Math.round(popup.scrollTop);\n    }\n    var firstSetWidth = 0;\n    for (var j = 0; j < toolbarName.length; j++) {\n      if (scrollTop < toolbarName[0].offsetHeight) {\n        if (!isNOU(toolbarName[j + 1])) {\n          removeClass([toolbarName[j + 1]], 'e-selected');\n        }\n        addClass([toolbarName[0]], 'e-selected');\n      }\n    }\n    for (var i = 0; i < emojiSet.length; i++) {\n      // eslint-disable-next-line\n      firstSetWidth += Math.round(emojiSet[i].offsetHeight);\n      if (scrollTop >= firstSetWidth) {\n        for (var k = 0; k < toolbarName.length; k++) {\n          /* eslint-disable */\n          if (toolbarName[k].classList.contains('e-selected')) {\n            removeClass([toolbarName[k]], 'e-selected');\n          }\n          /* eslint-enable */\n        }\n        if (!isNOU(toolbarName[i + 1])) {\n          addClass([toolbarName[i + 1]], 'e-selected');\n        }\n      }\n    }\n  };\n  EmojiPicker.prototype.contentscroll = function () {\n    if (isNOU(this.clickEvent) && this.popupObj) {\n      removeClass([this.divElement], 'e-active');\n      this.popupObj.hide();\n      return;\n    }\n  };\n  EmojiPicker.prototype.emojiToolbarClick = function (e) {\n    var args = {\n      // eslint-disable-next-line\n      text: e.item.htmlAttributes.title\n    };\n    var currentEleName = args.text;\n    var emojiGroups = this.parent.element.querySelectorAll('.e-rte-emojipicker-group');\n    var emojiButtons = this.parent.element.querySelectorAll('.e-rte-emojipicker-btn button');\n    var toolbarName = this.parent.element.querySelectorAll('.e-rte-emojipicker-toolbar button');\n    for (var i = 0; i < toolbarName.length; i++) {\n      /* eslint-disable */\n      if (toolbarName[i].classList.contains('e-selected')) {\n        removeClass([toolbarName[i]], 'e-selected');\n      }\n      /* eslint-enable */\n    }\n    for (var i = 0; i < emojiButtons.length; i++) {\n      if (emojiButtons[i].classList.contains('e-focus')) {\n        removeClass([emojiButtons[i]], 'e-focus');\n      }\n    }\n    // Loop through the selected elements and perform the same operation on each element\n    var emojiGroupsheight = this.parent.element.querySelector('.e-rte-emojipicker-btn');\n    var emojiHeight = 0;\n    // eslint-disable-next-line\n    emojiGroups.forEach(function (group) {\n      var childNodes = group.childNodes[0];\n      var focusBtn = group.childNodes[1].childNodes[0];\n      var ariaLabel = childNodes.getAttribute('aria-label');\n      if (currentEleName === ariaLabel) {\n        if (childNodes) {\n          emojiGroupsheight.scrollTop = emojiHeight + 10;\n          addClass([focusBtn], 'e-focus');\n          focusBtn.focus();\n        }\n      } else {\n        emojiHeight += group.scrollHeight;\n        removeClass([focusBtn], 'e-focus');\n      }\n    });\n  };\n  EmojiPicker.prototype.onKeyDown = function (e) {\n    // Select all emoji buttons\n    var emojiButtons = this.parent.element.querySelectorAll('.e-rte-emojipicker-btn button');\n    var emojiGroups = this.parent.element.querySelectorAll('.e-rte-emojipickerbtn-group');\n    var searchKeyHandler = this.parent.element.querySelector('.e-rte-emojisearch-btn button');\n    if (e.keyCode === 27) {\n      if (this.popupObj) {\n        removeClass([this.divElement], 'e-active');\n        this.popupObj.hide();\n      }\n    }\n    if (e.keyCode === 13) {\n      var activeEle = document.activeElement;\n      if (activeEle.classList.contains('e-btn')) {\n        this.emojiBtnClick(e);\n        e.preventDefault();\n      }\n    }\n    var srcElement = e.srcElement;\n    if (!isNOU(srcElement)) {\n      if (srcElement.classList.contains('e-rte-emoji-search') && e.keyCode === 40) {\n        for (var i = 0; i < emojiButtons.length; i++) {\n          if (emojiButtons[i].classList.contains('e-focus')) {\n            removeClass([emojiButtons[i]], 'e-focus');\n          }\n        }\n      }\n    }\n    if (!isNOU(searchKeyHandler)) {\n      this.filterKeyHandler(e);\n    } else {\n      for (var i = 0; i < emojiButtons.length; i++) {\n        var focusIndex = i;\n        if (emojiButtons[i].classList.contains('e-focus')) {\n          if (e.keyCode === 40) {\n            // Move focus to next row if there is one\n            if (emojiButtons.length - 4 > i) {\n              var count = 0;\n              for (var j = 0; j < emojiGroups.length; j++) {\n                for (var k = 0; k < emojiGroups[j].childNodes.length; k++) {\n                  // eslint-disable-next-line\n                  var childNodes = emojiGroups[j].childNodes[k];\n                  if (childNodes.classList.contains('e-focus') && count !== 1) {\n                    var currentIndex = k;\n                    var lastChild = emojiGroups[j].lastChild;\n                    var lastRowIndex = Math.floor(k % 6);\n                    var lastEleLength = emojiGroups[j].childNodes.length - 1;\n                    var lastEleIndex = Math.floor(lastEleLength % 6);\n                    if (currentIndex !== -1) {\n                      var nextRowIndex = currentIndex + 6;\n                      if (!isNOU(emojiGroups[j].childNodes[nextRowIndex])) {\n                        // next row has six buttons\n                        // handle focus change here\n                        var firstFocusEle = emojiButtons[i];\n                        removeClass([firstFocusEle], 'e-focus');\n                        var focusEle = emojiButtons[focusIndex += 6];\n                        addClass([focusEle], 'e-focus');\n                        focusEle.focus();\n                        break;\n                      } else if (isNOU(emojiGroups[j].childNodes[nextRowIndex]) && !lastChild.classList.contains('e-focus') && lastEleIndex < lastRowIndex) {\n                        var firstFocusEle = emojiButtons[i];\n                        removeClass([firstFocusEle], 'e-focus');\n                        var focusEle = emojiGroups[j].lastChild;\n                        addClass([focusEle], 'e-focus');\n                        focusEle.focus();\n                        count = 1;\n                        break;\n                      } else {\n                        var firstFocusEle = emojiButtons[i];\n                        removeClass([firstFocusEle], 'e-focus');\n                        var focusEle = emojiGroups[j + 1].childNodes[lastRowIndex];\n                        addClass([focusEle], 'e-focus');\n                        focusEle.focus();\n                        count = 1;\n                        break;\n                      }\n                    }\n                  }\n                }\n              }\n              break;\n            }\n          } else if (e.keyCode === 38) {\n            // Move focus to previous row if there is one\n            if (i >= 6) {\n              var count = 0;\n              for (var j = 0; j < emojiGroups.length; j++) {\n                for (var k = 0; k < emojiGroups[j].childNodes.length; k++) {\n                  var childNodes = emojiGroups[j].childNodes[k];\n                  if (childNodes.classList.contains('e-focus') && count !== 1) {\n                    // eslint-disable-next-line\n                    var currentIndex = k;\n                    var previousRowLength = isNOU(emojiGroups[j - 1]) ? null : emojiGroups[j - 1].childNodes.length % 6 || 6;\n                    if (currentIndex !== -1) {\n                      var previousRowIndex = currentIndex - 6;\n                      if (!isNOU(emojiGroups[j].childNodes[previousRowIndex])) {\n                        // previous row has six buttons\n                        // handle focus change here\n                        var firstFocusEle = emojiButtons[i];\n                        removeClass([firstFocusEle], 'e-focus');\n                        var focusEle = emojiButtons[focusIndex -= 6];\n                        addClass([focusEle], 'e-focus');\n                        focusEle.focus();\n                        break;\n                      } else if (isNOU(emojiGroups[j - 1].childNodes[emojiGroups[j - 1].childNodes.length - (previousRowLength - k)])) {\n                        var firstFocusEle = emojiButtons[i];\n                        removeClass([firstFocusEle], 'e-focus');\n                        var focusEle = emojiGroups[j - 1].lastChild;\n                        addClass([focusEle], 'e-focus');\n                        focusEle.focus();\n                        count = 1;\n                        break;\n                      } else {\n                        // previous row has less than six buttons\n                        // handle focus change here\n                        var firstFocusEle = emojiButtons[i];\n                        removeClass([firstFocusEle], 'e-focus');\n                        var focusEle = emojiGroups[j - 1].childNodes[emojiGroups[j - 1].childNodes.length - (previousRowLength - k)];\n                        addClass([focusEle], 'e-focus');\n                        focusEle.focus();\n                        count = 1;\n                        break;\n                      }\n                    }\n                  }\n                }\n              }\n            } else {\n              var firstFocusEle = emojiButtons[i];\n              removeClass([firstFocusEle], 'e-focus');\n              var focusEle = emojiButtons[focusIndex -= 1];\n              var inputELe = this.popupObj.element.querySelector('.e-rte-emoji-search');\n              if (isNOU(focusEle) && !isNOU(inputELe)) {\n                inputELe.focus();\n                break;\n              }\n              addClass([focusEle], 'e-focus');\n              focusEle.focus();\n            }\n            break;\n          } else if (e.keyCode === 39) {\n            // Move focus to next button in current row\n            if (emojiButtons.length !== i + 1) {\n              var firstFocusEle = emojiButtons[i];\n              removeClass([firstFocusEle], 'e-focus');\n              var focusEle = emojiButtons[focusIndex += 1];\n              addClass([focusEle], 'e-focus');\n              emojiButtons[focusIndex].focus();\n            }\n            break;\n          } else if (e.keyCode === 37) {\n            // Move focus to previous button in current row\n            if (i > 0) {\n              var firstFocusEle = emojiButtons[i];\n              removeClass([firstFocusEle], 'e-focus');\n              var focusEle = emojiButtons[focusIndex -= 1];\n              addClass([focusEle], 'e-focus');\n              emojiButtons[focusIndex].focus();\n            }\n            break;\n          }\n        }\n      }\n    }\n    if (e.keyCode === 40) {\n      var firstFocusEle = this.parent.element.querySelector('.e-focus');\n      if (isNOU(firstFocusEle)) {\n        var focusEle = emojiButtons[0];\n        addClass([focusEle], 'e-focus');\n        emojiButtons[0].focus();\n      }\n    }\n  };\n  EmojiPicker.prototype.filterKeyHandler = function (e) {\n    var emojiButtons = this.parent.element.querySelectorAll('.e-rte-emojisearch-btn button');\n    var firstFocusEle = this.parent.element.querySelector('.e-focus');\n    if (isNOU(firstFocusEle) && e.keyCode === 40) {\n      var focusEle = emojiButtons[0];\n      addClass([focusEle], 'e-focus');\n      emojiButtons[0].focus();\n    } else {\n      for (var i = 0; i < emojiButtons.length; i++) {\n        var focusIndex = i;\n        // eslint-disable-next-line\n        var childNodes = emojiButtons[i];\n        if (childNodes.classList.contains('e-focus')) {\n          if (e.keyCode === 38) {\n            if (i >= 6) {\n              var firstFocusEle_1 = emojiButtons[i];\n              removeClass([firstFocusEle_1], 'e-focus');\n              var focusEle = emojiButtons[focusIndex -= 6];\n              addClass([focusEle], 'e-focus');\n              focusEle.focus();\n              break;\n            } else {\n              var firstFocusEle_2 = emojiButtons[i];\n              removeClass([firstFocusEle_2], 'e-focus');\n              var focusEle = emojiButtons[focusIndex -= 1];\n              var inputELe = this.popupObj.element.querySelector('.e-rte-emoji-search');\n              if (isNOU(focusEle) && !isNOU(inputELe)) {\n                inputELe.focus();\n                break;\n              }\n              addClass([focusEle], 'e-focus');\n              focusEle.focus();\n            }\n          } else if (e.keyCode === 40) {\n            if (emojiButtons.length - 6 > i) {\n              var firstFocusEle_3 = emojiButtons[i];\n              removeClass([firstFocusEle_3], 'e-focus');\n              var focusEle = emojiButtons[focusIndex += 6];\n              addClass([focusEle], 'e-focus');\n              focusEle.focus();\n              break;\n            }\n          } else if (e.keyCode === 39) {\n            if (emojiButtons.length !== i + 1) {\n              var firstFocusEle_4 = emojiButtons[i];\n              removeClass([firstFocusEle_4], 'e-focus');\n              var focusEle = emojiButtons[focusIndex += 1];\n              addClass([focusEle], 'e-focus');\n              emojiButtons[focusIndex].focus();\n            }\n            break;\n          } else if (e.keyCode === 37) {\n            if (i > 0) {\n              var firstFocusEle_5 = emojiButtons[i];\n              removeClass([firstFocusEle_5], 'e-focus');\n              var focusEle = emojiButtons[focusIndex -= 1];\n              addClass([focusEle], 'e-focus');\n              emojiButtons[focusIndex].focus();\n              break;\n            }\n          }\n        }\n      }\n    }\n  };\n  EmojiPicker.prototype.searchFilter = function (e, value) {\n    var inputElement = this.parent.element.querySelector('.e-rte-emoji-search');\n    var contentELe = this.parent.element.querySelector('.e-content');\n    if (document.activeElement === inputElement || document.activeElement === contentELe) {\n      var trimmedStr = void 0;\n      if (value !== ':' && !isNOU(value)) {\n        trimmedStr = value.replace(/^:/, '');\n      } else if (!isNOU(value)) {\n        trimmedStr = value;\n      }\n      var inputValue = isNOU(inputElement) ? trimmedStr : inputElement.value;\n      var emojiButtons = this.parent.element.querySelectorAll('.e-rte-emojipicker-btn button');\n      var emojipickerAll = this.parent.element.querySelector('.e-rte-emojipicker-btn');\n      var emojiGroups = this.parent.element.querySelectorAll('.e-rte-emojipicker-group');\n      var toolbarGroup = this.parent.element.querySelector('.e-rte-emojipicker-toolbar');\n      var excludedDiv_1 = this.parent.element.querySelector('.e-rte-emojisearch-btn');\n      var firstChild = this.popDiv.childNodes[0];\n      var getComputedStyle_2 = window.getComputedStyle(firstChild);\n      var inputHeight = firstChild.nodeName === 'SPAN' ? firstChild.getBoundingClientRect().height + parseFloat(getComputedStyle_2.marginTop) + parseFloat(getComputedStyle_2.marginBottom) : 0;\n      var popupBorder = window.getComputedStyle(this.popDiv);\n      // eslint-disable-next-line @typescript-eslint/tslint/config\n      var filteredButtons = isNOU(excludedDiv_1) ? emojiButtons :\n      // eslint-disable-next-line @typescript-eslint/tslint/config\n      Array.from(emojiButtons).filter(function (button) {\n        return !excludedDiv_1.contains(button);\n      });\n      if (inputValue === '' || value === ':') {\n        toolbarGroup.style.display = '';\n        emojipickerAll.style.height = this.popDiv.getBoundingClientRect().height - toolbarGroup.getBoundingClientRect().height - inputHeight - 2 * parseFloat(popupBorder.borderWidth) + 'px';\n        // eslint-disable-next-line @typescript-eslint/tslint/config\n        emojiGroups.forEach(function (element) {\n          element.style.display = '';\n        });\n      } else {\n        // eslint-disable-next-line @typescript-eslint/tslint/config\n        emojiGroups.forEach(function (element) {\n          element.style.display = 'none';\n        });\n        toolbarGroup.style.display = 'none';\n        emojipickerAll.style.height = this.popDiv.getBoundingClientRect().height - inputHeight - 2 * parseFloat(popupBorder.borderWidth) + 'px';\n      }\n      var emojiBtnDiv = this.parent.createElement('div', {\n        className: 'e-rte-emojisearch-btn'\n      });\n      var emojis = this.parent.element.querySelector('.e-rte-emojisearch-btn');\n      if (emojis) {\n        emojis.remove();\n      }\n      var noEmojiObj = this.parent.createElement('div', {\n        className: 'e-rte-emojiSearch-noEmoji'\n      });\n      var noEMoji = true;\n      for (var i = 0; i < filteredButtons.length; i++) {\n        if (!isNOU(filteredButtons[i].getAttribute('title'))) {\n          var title = filteredButtons[i].getAttribute('title').toLowerCase();\n          var titleLength = title.split(' ');\n          for (var j = 0; j < titleLength.length; j++) {\n            if (titleLength[j].startsWith(inputValue.toLowerCase()) && inputValue !== '') {\n              var emoji = filteredButtons[i].cloneNode(true);\n              emojiBtnDiv.appendChild(emoji);\n              noEMoji = false;\n              break;\n            }\n          }\n        }\n      }\n      if (noEMoji && !this.parent.element.querySelector('.e-rte-emojiSearch-noEmoji') && inputValue !== '' && value !== ':') {\n        noEmojiObj.innerHTML = '<span style=\"color: rgba(0, 0, 0, 0.75); font-weight: 500; font-size: 16px;\">' + this.i10n.getConstant('emojiPickerNoResultFound') + ' 😥 </span>' + '<br>' + '<span style=\"color: rgba(0, 0, 0, 0.75);\"> ' + this.i10n.getConstant('emojiPickerTrySomethingElse') + ' ? </span>';\n        noEmojiObj.style.margin = '55px';\n        emojipickerAll.appendChild(noEmojiObj);\n      } else if (!noEMoji && this.parent.element.querySelector('.e-rte-emojiSearch-noEmoji') || inputValue === '' && value === ':' || inputValue === '' && this.parent.element.querySelector('.e-rte-emojiSearch-noEmoji')) {\n        emojipickerAll.removeChild(this.parent.element.querySelector('.e-rte-emojiSearch-noEmoji'));\n      }\n      emojipickerAll.appendChild(emojiBtnDiv);\n    } else {\n      return;\n    }\n  };\n  EmojiPicker.prototype.emojiBtnClick = function (e) {\n    var event = new MouseEvent('mouseleave', {\n      bubbles: true,\n      cancelable: true\n    });\n    // Includes the emote button element tooltip and toolbar tooltip\n    var emotePickerTooltips = this.parent.element.querySelectorAll('.e-rte-emojipicker-popup [data-tooltip-id]');\n    for (var i = 0; i < emotePickerTooltips.length; i++) {\n      emotePickerTooltips[i].dispatchEvent(event);\n    }\n    var targetEle = e.target;\n    if (targetEle.tagName !== 'BUTTON') {\n      return;\n    }\n    targetEle.focus();\n    var startOffset = this.save.startOffset;\n    var textContent = this.save.range.startContainer.textContent;\n    var previousText = textContent.substring(startOffset, startOffset + 1);\n    // When toolbar action is clicked then only restore the range.\n    if (!isNOU(this.clickEvent) || previousText !== ':') {\n      this.save.restore();\n    }\n    if (this.popupObj) {\n      removeClass([this.divElement], 'e-active');\n      this.popupObj.hide();\n    }\n    var originalEvent = e;\n    this.parent.formatter.process(this.parent, {\n      item: {\n        'command': 'EmojiPicker',\n        'subCommand': 'EmojiPicker',\n        value: targetEle.innerHTML\n      }\n    }, e, originalEvent);\n  };\n  EmojiPicker.prototype.onkeyPress = function (e) {\n    var originalEvent = e.args;\n    var selection = this.parent.iframeSettings.enable ? this.parent.contentModule.getPanel().contentWindow.getSelection() : this.parent.contentModule.getDocument().getSelection();\n    if (selection.rangeCount <= 0) {\n      return;\n    }\n    var range = selection.getRangeAt(0);\n    var cursorPos = range.startOffset;\n    var prevChar = selection.focusNode.textContent.substring(cursorPos - 1, cursorPos);\n    var isPrevSpace = /\\s/.test(prevChar);\n    var isPrevColon = selection.focusNode.textContent.substring(cursorPos - 1, cursorPos) === ':';\n    var colon = selection.focusNode.textContent.charAt(cursorPos - 1) === ':';\n    if (originalEvent.keyCode === 186 && originalEvent.shiftKey && (isPrevSpace || selection.focusOffset === 0)) {\n      var coordinates = this.getCoordinates();\n      this.parent.showEmojiPicker(coordinates.left, coordinates.top);\n    }\n    if (originalEvent.keyCode === 8 && colon && this.popupObj) {\n      removeClass([this.divElement], 'e-active');\n      this.popupObj.hide();\n    }\n    if (originalEvent.keyCode === 32 && isPrevColon && this.popupObj) {\n      removeClass([this.divElement], 'e-active');\n      var currentDocument = this.parent.iframeSettings.enable ? this.parent.contentModule.getPanel().ownerDocument : this.parent.contentModule.getDocument();\n      if (this.parent.showTooltip && !isNOU(currentDocument.querySelector('.e-tooltip-wrap'))) {\n        this.parent.notify(events.destroyTooltip, {\n          args: event\n        });\n      }\n      this.popupObj.hide();\n    }\n    if (this.popupObj && (originalEvent.keyCode === 37 || originalEvent.keyCode === 38 || originalEvent.keyCode === 39 || originalEvent.keyCode === 27 || originalEvent.keyCode === 40)) {\n      this.onKeyDown(originalEvent);\n      originalEvent.preventDefault();\n    }\n  };\n  EmojiPicker.prototype.onkeyUp = function (e) {\n    var originalEvent = e.args;\n    var selection = this.parent.iframeSettings.enable ? this.parent.contentModule.getPanel().contentWindow.getSelection() : this.parent.contentModule.getDocument().getSelection();\n    if (selection.rangeCount <= 0) {\n      return;\n    }\n    var range = selection.getRangeAt(0);\n    var cursorPos = range.startOffset;\n    // eslint-disable-next-line\n    var selectedValue;\n    var count = 0;\n    for (var i = cursorPos - 1; i >= cursorPos - 15; i--) {\n      var prevChar = selection.focusNode.textContent.substring(i - 1, i);\n      var isPrevSpace = /:$/.test(prevChar);\n      if (isPrevSpace && !isNOU(this.popDiv) && count === 0) {\n        selectedValue = range.startContainer.textContent.substring(i - 1, cursorPos);\n        this.searchFilter(originalEvent, selectedValue);\n        count = 1;\n      }\n    }\n    var colon = selection.focusNode.textContent.substring(cursorPos - 1, cursorPos);\n    if (colon === ':' && !isNOU(this.popupObj)) {\n      selectedValue = colon;\n      this.searchFilter(originalEvent, selectedValue);\n    }\n  };\n  EmojiPicker.prototype.getCoordinates = function () {\n    var coordinates;\n    var selection = this.parent.iframeSettings.enable ? this.parent.contentModule.getPanel().contentWindow.getSelection() : window.getSelection();\n    var range = selection.getRangeAt(0);\n    var firstChild;\n    if (range.startContainer.nodeName === 'P' || range.startContainer.nodeName === 'DIV') {\n      if (range.startContainer.childNodes[0].nodeName !== '#text') {\n        firstChild = range.startContainer.childNodes[0];\n      }\n    }\n    // eslint-disable-next-line\n    var rect = isNOU(firstChild) ? range.getBoundingClientRect() : firstChild.getBoundingClientRect();\n    var rteContent = this.parent.element.querySelector('.e-rte-content');\n    var rteEle = this.parent.element;\n    var toolbarHeight = rteEle.offsetHeight - rteContent.offsetHeight;\n    var cursorTop = rect.top - this.parent.inputElement.getBoundingClientRect().top;\n    var cursorLeft = rect.left - this.parent.inputElement.getBoundingClientRect().left;\n    var screenHeight = window.innerHeight;\n    var popupHeight = 330;\n    var popupTop = cursorTop;\n    var popupLeft = cursorLeft + rect.width;\n    if (rteEle.getBoundingClientRect().top < 0) {\n      popupTop = popupTop + rteContent.getBoundingClientRect().top - toolbarHeight;\n    }\n    if (rect.top < popupHeight) {\n      // eslint-disable-next-line\n      popupTop = popupTop;\n    } else if (rect.top + popupHeight > screenHeight) {\n      popupTop -= popupHeight + 20;\n    }\n    if (this.parent.inputElement) {\n      coordinates = {\n        top: popupTop + 60,\n        left: popupLeft + 8\n      };\n    }\n    return coordinates;\n  };\n  EmojiPicker.prototype.removeEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n    this.parent.off(events.emojiPicker, this.toolbarClick);\n    this.parent.off(events.docClick, this.docClick);\n    this.parent.off(events.keyDown, this.onkeyPress);\n    this.parent.off(events.keyUp, this.onkeyUp);\n    this.parent.off(events.contentscroll, this.contentscroll);\n    this.parent.off(events.scroll, this.contentscroll);\n  };\n  /**\n   * For internal use only - Get the module name.\n   *\n   * @returns {string} - returns the string value\n   */\n  EmojiPicker.prototype.getModuleName = function () {\n    return 'emojiPicker';\n  };\n  return EmojiPicker;\n}();\nexport { EmojiPicker };","map":{"version":3,"names":["events","detach","addClass","isNullOrUndefined","isNOU","removeClass","closest","createElement","EventHandler","Popup","Toolbar","BaseToolbar","TextBox","EmojiPicker","parent","serviceLocator","locator","i10n","getService","renderFactory","baseToolbar","addEventListener","prototype","destroy","removeEventListener","on","emojiPicker","toolbarClick","docClick","keyDown","onkeyPress","keyUp","onkeyUp","contentscroll","scroll","args","_this","_a","_b","spanElement","element","querySelector","inlineMode","enable","ownerDocument","divElement","inputElement","contains","formatter","editorManager","nodeSelection","getRange","contentModule","getDocument","startContainer","getEditPanel","focus","range","save","clickEvent","emojiPickerSettings","iconsSet","popupObj","showSearchBox","hide","popDiv","className","id","getID","getToolbar","appendChild","add","onKeyDown","searchFilter","extendEle","zIndex","computedStyle","window","getComputedStyle","getPropertyValue","target","xValue","yValue","quickToolbarSettings","text","originalEvent","classList","firstChild","parentElement","x","y","getSelection","rangeCount","coordinates","getCoordinates","left","top","notify","hidePopup","targetType","relateTo","collision","X","Y","offsetY","viewPortElement","position","enableRtl","parseInt","actionOnScroll","close","event","isBlur","refreshPosition","inputEle","append","inputobj","placeholder","getConstant","showClearButton","appendTo","closeIcon","emojiToolBar","pushToolBar","i","length","iconCss","push","prefixIcon","htmlAttributes","name","code","toolbarObj","items","clicked","emojiToolbarClick","bind","emojiBtnDiv","height","popupBorder","getBoundingClientRect","parseFloat","borderWidth","style","setProperty","inputELe","getComputedStyle_1","marginTop","marginBottom","emojiGroupDiv","emojiName","innerText","setAttribute","emojiBtn","j","icons","button","innerHTML","buttoncode","desc","fontSize","scrollEvent","emojiBtnClick","emojiButtons","querySelectorAll","popup","toolbarName","scrollTop","Math","round","offsetHeight","value","valueLength","split","joinedEmoji","map","cp","String","fromCodePoint","join","e","emojiSet","firstSetWidth","k","item","title","currentEleName","emojiGroups","emojiGroupsheight","emojiHeight","forEach","group","childNodes","focusBtn","ariaLabel","getAttribute","scrollHeight","searchKeyHandler","keyCode","activeEle","document","activeElement","preventDefault","srcElement","filterKeyHandler","focusIndex","count","currentIndex","lastChild","lastRowIndex","floor","lastEleLength","lastEleIndex","nextRowIndex","firstFocusEle","focusEle","previousRowLength","previousRowIndex","firstFocusEle_1","firstFocusEle_2","firstFocusEle_3","firstFocusEle_4","firstFocusEle_5","contentELe","trimmedStr","replace","inputValue","emojipickerAll","toolbarGroup","excludedDiv_1","getComputedStyle_2","inputHeight","nodeName","filteredButtons","Array","from","filter","display","emojis","remove","noEmojiObj","noEMoji","toLowerCase","titleLength","startsWith","emoji","cloneNode","margin","removeChild","MouseEvent","bubbles","cancelable","emotePickerTooltips","dispatchEvent","targetEle","tagName","startOffset","textContent","previousText","substring","restore","process","selection","iframeSettings","getPanel","contentWindow","getRangeAt","cursorPos","prevChar","focusNode","isPrevSpace","test","isPrevColon","colon","charAt","shiftKey","focusOffset","showEmojiPicker","currentDocument","showTooltip","destroyTooltip","selectedValue","rect","rteContent","rteEle","toolbarHeight","cursorTop","cursorLeft","screenHeight","innerHeight","popupHeight","popupTop","popupLeft","width","isDestroyed","off","getModuleName"],"sources":["/Users/saleem/Desktop/KClient/Web App/Ver_3.6/User Interface/website_Source files/node_modules/@syncfusion/ej2-richtexteditor/src/rich-text-editor/actions/emoji-picker.js"],"sourcesContent":["import * as events from '../base/constant';\nimport { detach, addClass, isNullOrUndefined as isNOU, removeClass, closest, createElement, EventHandler } from '@syncfusion/ej2-base';\nimport { Popup } from '@syncfusion/ej2-popups';\nimport { Toolbar } from '@syncfusion/ej2-navigations';\nimport { BaseToolbar } from './base-toolbar';\nimport { TextBox } from '@syncfusion/ej2-inputs';\nvar EmojiPicker = /** @class */ (function () {\n    function EmojiPicker(parent, serviceLocator) {\n        this.parent = parent;\n        this.locator = serviceLocator;\n        this.i10n = serviceLocator.getService('rteLocale');\n        this.renderFactory = this.locator.getService('rendererFactory');\n        this.baseToolbar = new BaseToolbar(this.parent, this.locator);\n        this.addEventListener();\n    }\n    /**\n     * Destroys the Count.\n     *\n     * @function destroy\n     * @returns {void}\n     * @hidden\n\n     */\n    EmojiPicker.prototype.destroy = function () {\n        this.removeEventListener();\n    };\n    EmojiPicker.prototype.addEventListener = function () {\n        this.parent.on(events.emojiPicker, this.toolbarClick, this);\n        this.parent.on(events.docClick, this.docClick, this);\n        this.parent.on(events.keyDown, this.onkeyPress, this);\n        this.parent.on(events.keyUp, this.onkeyUp, this);\n        this.parent.on(events.contentscroll, this.contentscroll, this);\n        this.parent.on(events.scroll, this.contentscroll, this);\n    };\n    // eslint-disable-next-line\n    EmojiPicker.prototype.toolbarClick = function (args) {\n        var _this = this;\n        var _a, _b;\n        var spanElement;\n        if (!isNOU(this.parent.element.querySelector('.e-emoji'))) {\n            spanElement = this.parent.element.querySelector('.e-emoji');\n        }\n        else if (this.parent.inlineMode.enable) {\n            spanElement = this.parent.element.ownerDocument.querySelector('.e-emoji');\n        }\n        this.divElement = spanElement.closest('div');\n        if (!(this.parent.inputElement.contains(this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()).startContainer))) {\n            this.parent.contentModule.getEditPanel().focus();\n        }\n        var range = this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());\n        this.save = this.parent.formatter.editorManager.nodeSelection.save(range, this.parent.contentModule.getDocument());\n        this.clickEvent = args.args;\n        var emojiPicker = this.parent.emojiPickerSettings.iconsSet;\n        if (this.popupObj) {\n            removeClass([this.divElement], 'e-active');\n            if (this.popupObj.element.querySelector('.e-rte-emoji-search') || !this.parent.emojiPickerSettings.showSearchBox) {\n                this.popupObj.hide();\n                return;\n            }\n            this.popupObj.hide();\n        }\n        this.popDiv = this.parent.createElement('div', { className: 'e-rte-emojipicker-popup', id: this.parent.getID() + '_emojiPicker' });\n        if (!isNOU(this.parent.getToolbar()) && !this.parent.inlineMode.enable) {\n            this.parent.getToolbar().appendChild(this.popDiv);\n        }\n        else if (this.parent.inlineMode.enable) {\n            this.parent.inputElement.appendChild(this.popDiv);\n        }\n        EventHandler.add(this.popDiv, 'keydown', this.onKeyDown, this);\n        EventHandler.add(this.popDiv, 'keyup', this.searchFilter, this);\n        var extendEle = this.parent.element.querySelector('.e-toolbar-extended');\n        var zIndex;\n        if (!isNOU(extendEle)) {\n            var computedStyle = window.getComputedStyle(extendEle);\n            zIndex = computedStyle.getPropertyValue('z-index');\n        }\n        else {\n            zIndex = '10001';\n        }\n        var target;\n        var xValue;\n        var yValue;\n        if (!isNOU(args.args) && !this.parent.inlineMode.enable &&\n            isNOU(this.parent.quickToolbarSettings.text)) {\n            target = args.args.originalEvent.target;\n            target = target.classList.contains('e-toolbar-item') ? target.firstChild : target.parentElement;\n            xValue = 'left';\n            yValue = 'bottom';\n        }\n        else if (isNOU(args.x) && isNOU(args.y) && !this.parent.inlineMode.enable && isNOU(this.parent.quickToolbarSettings.text)) {\n            target = this.parent.inputElement;\n            if (this.parent.contentModule.getDocument().getSelection().rangeCount > 0) {\n                var coordinates = this.getCoordinates();\n                xValue = coordinates.left;\n                yValue = coordinates.top;\n            }\n        }\n        else if (isNOU(args.x) && isNOU(args.y) && (this.parent.inlineMode.enable || !isNOU(this.parent.quickToolbarSettings.text))) {\n            this.parent.notify(events.hidePopup, {});\n            if (this.parent.contentModule.getDocument().getSelection().rangeCount > 0) {\n                var coordinates = this.getCoordinates();\n                xValue = coordinates.left;\n                yValue = coordinates.top;\n            }\n        }\n        else {\n            target = this.parent.inputElement;\n            xValue = args.x;\n            yValue = args.y;\n        }\n        this.popupObj = new Popup(this.popDiv, {\n            targetType: 'relative',\n            relateTo: target,\n            collision: { X: 'fit', Y: 'none' },\n            offsetY: 8,\n            viewPortElement: this.parent.element,\n            position: { X: xValue, Y: yValue },\n            enableRtl: this.parent.enableRtl,\n            zIndex: parseInt(zIndex, 10) + 1,\n            actionOnScroll: 'hide',\n            // eslint-disable-next-line\n            close: function (event) {\n                _this.parent.isBlur = false;\n                _this.popupObj.destroy();\n                detach(_this.popupObj.element);\n                _this.popupObj = null;\n            }\n        });\n        addClass([this.popupObj.element], 'e-popup-open');\n        this.popupObj.refreshPosition(target);\n        // header search element\n        if ((!isNOU(args.args) || (isNOU(args.x) && isNOU(args.y))) &&\n            this.parent.emojiPickerSettings.showSearchBox) {\n            var inputEle = createElement('input', { id: 'e-rte-emoji-search', className: 'e-rte-emoji-search' });\n            this.popDiv.append(inputEle);\n            var inputobj = new TextBox({\n                placeholder: this.i10n.getConstant('emojiPickerTypeToFind'),\n                showClearButton: true\n            });\n            inputobj.appendTo(inputEle);\n            inputEle.focus();\n        }\n        var closeIcon = this.popupObj.element.querySelector('.e-clear-icon');\n        if (!isNOU(closeIcon)) {\n            EventHandler.add(closeIcon, 'mousedown', this.searchFilter, this);\n        }\n        // Header emoji toolbar div\n        var emojiToolBar = this.parent.createElement('div', { className: 'e-rte-emojipicker-toolbar' });\n        this.popDiv.appendChild(emojiToolBar);\n        var pushToolBar = [];\n        for (var i = 0; i < this.parent.emojiPickerSettings.iconsSet.length; i++) {\n            if (!isNOU(this.parent.emojiPickerSettings.iconsSet[i].iconCss)) {\n                pushToolBar.push({ prefixIcon: this.parent.emojiPickerSettings.iconsSet[i].iconCss, htmlAttributes: (_a = {}, _a['title'] = this.parent.emojiPickerSettings.iconsSet[i].name, _a) });\n            }\n            else {\n                pushToolBar.push({ text: '&#x' + this.parent.emojiPickerSettings.iconsSet[i].code + ';', htmlAttributes: (_b = {}, _b['title'] = this.parent.emojiPickerSettings.iconsSet[i].name, _b) });\n            }\n        }\n        var toolbarObj = new Toolbar({\n            items: pushToolBar,\n            clicked: this.emojiToolbarClick.bind(this)\n        });\n        toolbarObj.appendTo(emojiToolBar);\n        // emoji btn div\n        var emojiBtnDiv = this.parent.createElement('div', { className: 'e-rte-emojipicker-btn' });\n        this.popDiv.appendChild(emojiBtnDiv);\n        var height;\n        var popupBorder = window.getComputedStyle(this.popDiv);\n        if ((isNOU(args.args) && !(isNOU(args.x) && isNOU(args.y))) ||\n            !this.parent.emojiPickerSettings.showSearchBox) {\n            height = (this.popDiv.getBoundingClientRect().height - emojiToolBar.getBoundingClientRect().height - (2 * parseFloat(popupBorder.borderWidth))) + 'px';\n            emojiBtnDiv.style.setProperty('height', height, 'important');\n        }\n        else {\n            var inputELe = this.parent.element.querySelector('.e-rte-emoji-search').parentElement;\n            var getComputedStyle_1 = window.getComputedStyle(inputELe);\n            height = (this.popDiv.getBoundingClientRect().height - emojiToolBar.getBoundingClientRect().height\n                - inputELe.getBoundingClientRect().height\n                - parseFloat(getComputedStyle_1.marginTop) - parseFloat(getComputedStyle_1.marginBottom)\n                - (2 * parseFloat(popupBorder.borderWidth))) + 'px';\n            emojiBtnDiv.style.setProperty('height', height, 'important');\n        }\n        for (var i = 0; i < emojiPicker.length; i++) {\n            var emojiGroupDiv = this.parent.createElement('div', { className: 'e-rte-emojipicker-group' });\n            emojiBtnDiv.appendChild(emojiGroupDiv);\n            var emojiName = this.parent.createElement('div', { className: 'e-rte-emojipicker-name' });\n            emojiName.innerText = this.parent.emojiPickerSettings.iconsSet[i].name;\n            emojiName.setAttribute('aria-label', this.parent.emojiPickerSettings.iconsSet[i].name);\n            emojiGroupDiv.appendChild(emojiName);\n            var emojiBtn = this.parent.createElement('div', { className: 'e-rte-emojipickerbtn-group' });\n            emojiGroupDiv.appendChild(emojiBtn);\n            for (var j = 0; j < emojiPicker[i].icons.length; j++) {\n                var button = this.parent.createElement('button', { className: 'e-btn ' + ' ' + 'e-control' });\n                button.innerHTML = this.buttoncode(this.parent.emojiPickerSettings.iconsSet[i].icons[j].code);\n                button.setAttribute('aria-label', (this.parent.emojiPickerSettings.iconsSet[i].icons[j].desc));\n                button.setAttribute('title', (this.parent.emojiPickerSettings.iconsSet[i].icons[j].desc));\n                emojiBtn.appendChild(button);\n                if (button.innerHTML.length > 2) {\n                    button.style.fontSize = '17px';\n                }\n            }\n        }\n        EventHandler.add(emojiBtnDiv, 'scroll', this.scrollEvent, this);\n        EventHandler.add(emojiBtnDiv, 'click', this.emojiBtnClick, this);\n        var emojiButtons = this.parent.element.querySelectorAll('.e-rte-emojipicker-btn button');\n        if (isNOU(this.parent.element.querySelector('.e-rte-emoji-search')) && !isNOU(args.args)) {\n            emojiButtons[0].focus();\n            addClass([emojiButtons[0]], 'e-focus');\n        }\n        var popup = this.parent.element.querySelector('.e-rte-emojipicker-btn');\n        var toolbarName = this.parent.element.querySelectorAll('.e-rte-emojipicker-toolbar button');\n        var scrollTop;\n        if (!isNOU(popup)) {\n            scrollTop = Math.round(popup.scrollTop);\n        }\n        if (scrollTop < toolbarName[0].offsetHeight) {\n            addClass([toolbarName[0]], 'e-selected');\n        }\n        if (this.popupObj) {\n            addClass([this.divElement], 'e-active');\n        }\n    };\n    EmojiPicker.prototype.buttoncode = function (value) {\n        var valueLength = value.split('-');\n        // eslint-disable-next-line\n        var joinedEmoji = valueLength.map(function (cp) { return String.fromCodePoint(parseInt(cp, 16)); }).join('\\u200D');\n        return joinedEmoji;\n    };\n    EmojiPicker.prototype.docClick = function (e) {\n        var target = e.args.target;\n        if (target && target.classList && ((this.popupObj && !closest(target, '[id=' + '\\'' + this.popupObj.element.id + '\\'' + ']')))\n            && (!target.classList.contains('e-emoji') && !target.classList.contains('e-toolbar-item'))) {\n            if (this.popupObj) {\n                removeClass([this.divElement], 'e-active');\n                this.popupObj.hide();\n            }\n        }\n    };\n    EmojiPicker.prototype.scrollEvent = function () {\n        var popup = this.parent.element.querySelector('.e-rte-emojipicker-btn');\n        var emojiSet = this.parent.element.querySelectorAll('.e-rte-emojipicker-group');\n        var toolbarName = this.parent.element.querySelectorAll('.e-rte-emojipicker-toolbar button');\n        var scrollTop;\n        if (!isNOU(popup)) {\n            scrollTop = Math.round(popup.scrollTop);\n        }\n        var firstSetWidth = 0;\n        for (var j = 0; j < toolbarName.length; j++) {\n            if (scrollTop < toolbarName[0].offsetHeight) {\n                if (!isNOU(toolbarName[j + 1])) {\n                    removeClass([toolbarName[j + 1]], 'e-selected');\n                }\n                addClass([toolbarName[0]], 'e-selected');\n            }\n        }\n        for (var i = 0; i < emojiSet.length; i++) {\n            // eslint-disable-next-line\n            firstSetWidth += Math.round(emojiSet[i].offsetHeight);\n            if (scrollTop >= firstSetWidth) {\n                for (var k = 0; k < toolbarName.length; k++) {\n                    /* eslint-disable */\n                    if (toolbarName[k].classList.contains('e-selected')) {\n                        removeClass([toolbarName[k]], 'e-selected');\n                    }\n                    /* eslint-enable */\n                }\n                if (!isNOU(toolbarName[i + 1])) {\n                    addClass([toolbarName[i + 1]], 'e-selected');\n                }\n            }\n        }\n    };\n    EmojiPicker.prototype.contentscroll = function () {\n        if (isNOU(this.clickEvent) && this.popupObj) {\n            removeClass([this.divElement], 'e-active');\n            this.popupObj.hide();\n            return;\n        }\n    };\n    EmojiPicker.prototype.emojiToolbarClick = function (e) {\n        var args = {\n            // eslint-disable-next-line\n            text: e.item.htmlAttributes.title,\n        };\n        var currentEleName = args.text;\n        var emojiGroups = this.parent.element.querySelectorAll('.e-rte-emojipicker-group');\n        var emojiButtons = this.parent.element.querySelectorAll('.e-rte-emojipicker-btn button');\n        var toolbarName = this.parent.element.querySelectorAll('.e-rte-emojipicker-toolbar button');\n        for (var i = 0; i < toolbarName.length; i++) {\n            /* eslint-disable */\n            if (toolbarName[i].classList.contains('e-selected')) {\n                removeClass([toolbarName[i]], 'e-selected');\n            }\n            /* eslint-enable */\n        }\n        for (var i = 0; i < emojiButtons.length; i++) {\n            if (emojiButtons[i].classList.contains('e-focus')) {\n                removeClass([emojiButtons[i]], 'e-focus');\n            }\n        }\n        // Loop through the selected elements and perform the same operation on each element\n        var emojiGroupsheight = this.parent.element.querySelector('.e-rte-emojipicker-btn');\n        var emojiHeight = 0;\n        // eslint-disable-next-line\n        emojiGroups.forEach(function (group) {\n            var childNodes = group.childNodes[0];\n            var focusBtn = group.childNodes[1].childNodes[0];\n            var ariaLabel = childNodes.getAttribute('aria-label');\n            if (currentEleName === ariaLabel) {\n                if (childNodes) {\n                    emojiGroupsheight.scrollTop = emojiHeight + 10;\n                    addClass([focusBtn], 'e-focus');\n                    focusBtn.focus();\n                }\n            }\n            else {\n                emojiHeight += group.scrollHeight;\n                removeClass([focusBtn], 'e-focus');\n            }\n        });\n    };\n    EmojiPicker.prototype.onKeyDown = function (e) {\n        // Select all emoji buttons\n        var emojiButtons = this.parent.element.querySelectorAll('.e-rte-emojipicker-btn button');\n        var emojiGroups = this.parent.element.querySelectorAll('.e-rte-emojipickerbtn-group');\n        var searchKeyHandler = this.parent.element.querySelector('.e-rte-emojisearch-btn button');\n        if (e.keyCode === 27) {\n            if (this.popupObj) {\n                removeClass([this.divElement], 'e-active');\n                this.popupObj.hide();\n            }\n        }\n        if (e.keyCode === 13) {\n            var activeEle = document.activeElement;\n            if (activeEle.classList.contains('e-btn')) {\n                this.emojiBtnClick(e);\n                e.preventDefault();\n            }\n        }\n        var srcElement = e.srcElement;\n        if (!isNOU(srcElement)) {\n            if (srcElement.classList.contains('e-rte-emoji-search') && e.keyCode === 40) {\n                for (var i = 0; i < emojiButtons.length; i++) {\n                    if (emojiButtons[i].classList.contains('e-focus')) {\n                        removeClass([emojiButtons[i]], 'e-focus');\n                    }\n                }\n            }\n        }\n        if (!isNOU(searchKeyHandler)) {\n            this.filterKeyHandler(e);\n        }\n        else {\n            for (var i = 0; i < emojiButtons.length; i++) {\n                var focusIndex = i;\n                if (emojiButtons[i].classList.contains('e-focus')) {\n                    if (e.keyCode === 40) {\n                        // Move focus to next row if there is one\n                        if (emojiButtons.length - 4 > i) {\n                            var count = 0;\n                            for (var j = 0; j < emojiGroups.length; j++) {\n                                for (var k = 0; k < emojiGroups[j].childNodes.length; k++) {\n                                    // eslint-disable-next-line\n                                    var childNodes = emojiGroups[j].childNodes[k];\n                                    if (childNodes.classList.contains('e-focus') && count !== 1) {\n                                        var currentIndex = k;\n                                        var lastChild = emojiGroups[j].lastChild;\n                                        var lastRowIndex = Math.floor((k) % 6);\n                                        var lastEleLength = emojiGroups[j].childNodes.length - 1;\n                                        var lastEleIndex = Math.floor((lastEleLength) % 6);\n                                        if (currentIndex !== -1) {\n                                            var nextRowIndex = currentIndex + 6;\n                                            if (!isNOU(emojiGroups[j].childNodes[nextRowIndex])) {\n                                                // next row has six buttons\n                                                // handle focus change here\n                                                var firstFocusEle = emojiButtons[i];\n                                                removeClass([firstFocusEle], 'e-focus');\n                                                var focusEle = emojiButtons[focusIndex += 6];\n                                                addClass([focusEle], 'e-focus');\n                                                focusEle.focus();\n                                                break;\n                                            }\n                                            else if (isNOU(emojiGroups[j].childNodes[nextRowIndex]) && !lastChild.classList.contains('e-focus') && lastEleIndex < lastRowIndex) {\n                                                var firstFocusEle = emojiButtons[i];\n                                                removeClass([firstFocusEle], 'e-focus');\n                                                var focusEle = emojiGroups[j].lastChild;\n                                                addClass([focusEle], 'e-focus');\n                                                focusEle.focus();\n                                                count = 1;\n                                                break;\n                                            }\n                                            else {\n                                                var firstFocusEle = emojiButtons[i];\n                                                removeClass([firstFocusEle], 'e-focus');\n                                                var focusEle = emojiGroups[j + 1]\n                                                    .childNodes[lastRowIndex];\n                                                addClass([focusEle], 'e-focus');\n                                                focusEle.focus();\n                                                count = 1;\n                                                break;\n                                            }\n                                        }\n                                    }\n                                }\n                            }\n                            break;\n                        }\n                    }\n                    else if (e.keyCode === 38) {\n                        // Move focus to previous row if there is one\n                        if (i >= 6) {\n                            var count = 0;\n                            for (var j = 0; j < emojiGroups.length; j++) {\n                                for (var k = 0; k < emojiGroups[j].childNodes.length; k++) {\n                                    var childNodes = emojiGroups[j].childNodes[k];\n                                    if (childNodes.classList.contains('e-focus') && count !== 1) {\n                                        // eslint-disable-next-line\n                                        var currentIndex = k;\n                                        var previousRowLength = isNOU(emojiGroups[j - 1]) ? null :\n                                            emojiGroups[j - 1].childNodes.length % 6 || 6;\n                                        if (currentIndex !== -1) {\n                                            var previousRowIndex = currentIndex - 6;\n                                            if (!isNOU(emojiGroups[j].childNodes[previousRowIndex])) {\n                                                // previous row has six buttons\n                                                // handle focus change here\n                                                var firstFocusEle = emojiButtons[i];\n                                                removeClass([firstFocusEle], 'e-focus');\n                                                var focusEle = emojiButtons[focusIndex -= 6];\n                                                addClass([focusEle], 'e-focus');\n                                                focusEle.focus();\n                                                break;\n                                            }\n                                            else if (isNOU(emojiGroups[j - 1].childNodes[emojiGroups[j - 1]\n                                                .childNodes.length - (previousRowLength - k)])) {\n                                                var firstFocusEle = emojiButtons[i];\n                                                removeClass([firstFocusEle], 'e-focus');\n                                                var focusEle = emojiGroups[j - 1].lastChild;\n                                                addClass([focusEle], 'e-focus');\n                                                focusEle.focus();\n                                                count = 1;\n                                                break;\n                                            }\n                                            else {\n                                                // previous row has less than six buttons\n                                                // handle focus change here\n                                                var firstFocusEle = emojiButtons[i];\n                                                removeClass([firstFocusEle], 'e-focus');\n                                                var focusEle = emojiGroups[j - 1].childNodes[emojiGroups[j - 1].\n                                                    childNodes.length - (previousRowLength - k)];\n                                                addClass([focusEle], 'e-focus');\n                                                focusEle.focus();\n                                                count = 1;\n                                                break;\n                                            }\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                        else {\n                            var firstFocusEle = emojiButtons[i];\n                            removeClass([firstFocusEle], 'e-focus');\n                            var focusEle = emojiButtons[focusIndex -= 1];\n                            var inputELe = this.popupObj.element.querySelector('.e-rte-emoji-search');\n                            if (isNOU(focusEle) && !isNOU(inputELe)) {\n                                inputELe.focus();\n                                break;\n                            }\n                            addClass([focusEle], 'e-focus');\n                            focusEle.focus();\n                        }\n                        break;\n                    }\n                    else if (e.keyCode === 39) {\n                        // Move focus to next button in current row\n                        if (emojiButtons.length !== i + 1) {\n                            var firstFocusEle = emojiButtons[i];\n                            removeClass([firstFocusEle], 'e-focus');\n                            var focusEle = emojiButtons[focusIndex += 1];\n                            addClass([focusEle], 'e-focus');\n                            emojiButtons[focusIndex].focus();\n                        }\n                        break;\n                    }\n                    else if (e.keyCode === 37) {\n                        // Move focus to previous button in current row\n                        if (i > 0) {\n                            var firstFocusEle = emojiButtons[i];\n                            removeClass([firstFocusEle], 'e-focus');\n                            var focusEle = emojiButtons[focusIndex -= 1];\n                            addClass([focusEle], 'e-focus');\n                            emojiButtons[focusIndex].focus();\n                        }\n                        break;\n                    }\n                }\n            }\n        }\n        if (e.keyCode === 40) {\n            var firstFocusEle = this.parent.element.querySelector('.e-focus');\n            if (isNOU(firstFocusEle)) {\n                var focusEle = emojiButtons[0];\n                addClass([focusEle], 'e-focus');\n                emojiButtons[0].focus();\n            }\n        }\n    };\n    EmojiPicker.prototype.filterKeyHandler = function (e) {\n        var emojiButtons = this.parent.element.querySelectorAll('.e-rte-emojisearch-btn button');\n        var firstFocusEle = this.parent.element.querySelector('.e-focus');\n        if (isNOU(firstFocusEle) && e.keyCode === 40) {\n            var focusEle = emojiButtons[0];\n            addClass([focusEle], 'e-focus');\n            emojiButtons[0].focus();\n        }\n        else {\n            for (var i = 0; i < emojiButtons.length; i++) {\n                var focusIndex = i;\n                // eslint-disable-next-line\n                var childNodes = emojiButtons[i];\n                if (childNodes.classList.contains('e-focus')) {\n                    if (e.keyCode === 38) {\n                        if (i >= 6) {\n                            var firstFocusEle_1 = emojiButtons[i];\n                            removeClass([firstFocusEle_1], 'e-focus');\n                            var focusEle = emojiButtons[focusIndex -= 6];\n                            addClass([focusEle], 'e-focus');\n                            focusEle.focus();\n                            break;\n                        }\n                        else {\n                            var firstFocusEle_2 = emojiButtons[i];\n                            removeClass([firstFocusEle_2], 'e-focus');\n                            var focusEle = emojiButtons[focusIndex -= 1];\n                            var inputELe = this.popupObj.element.querySelector('.e-rte-emoji-search');\n                            if (isNOU(focusEle) && !isNOU(inputELe)) {\n                                inputELe.focus();\n                                break;\n                            }\n                            addClass([focusEle], 'e-focus');\n                            focusEle.focus();\n                        }\n                    }\n                    else if (e.keyCode === 40) {\n                        if (emojiButtons.length - 6 > i) {\n                            var firstFocusEle_3 = emojiButtons[i];\n                            removeClass([firstFocusEle_3], 'e-focus');\n                            var focusEle = emojiButtons[focusIndex += 6];\n                            addClass([focusEle], 'e-focus');\n                            focusEle.focus();\n                            break;\n                        }\n                    }\n                    else if (e.keyCode === 39) {\n                        if (emojiButtons.length !== i + 1) {\n                            var firstFocusEle_4 = emojiButtons[i];\n                            removeClass([firstFocusEle_4], 'e-focus');\n                            var focusEle = emojiButtons[focusIndex += 1];\n                            addClass([focusEle], 'e-focus');\n                            emojiButtons[focusIndex].focus();\n                        }\n                        break;\n                    }\n                    else if (e.keyCode === 37) {\n                        if (i > 0) {\n                            var firstFocusEle_5 = emojiButtons[i];\n                            removeClass([firstFocusEle_5], 'e-focus');\n                            var focusEle = emojiButtons[focusIndex -= 1];\n                            addClass([focusEle], 'e-focus');\n                            emojiButtons[focusIndex].focus();\n                            break;\n                        }\n                    }\n                }\n            }\n        }\n    };\n    EmojiPicker.prototype.searchFilter = function (e, value) {\n        var inputElement = this.parent.element.querySelector('.e-rte-emoji-search');\n        var contentELe = this.parent.element.querySelector('.e-content');\n        if (document.activeElement === inputElement || document.activeElement === contentELe) {\n            var trimmedStr = void 0;\n            if (value !== ':' && !isNOU(value)) {\n                trimmedStr = value.replace(/^:/, '');\n            }\n            else if (!isNOU(value)) {\n                trimmedStr = value;\n            }\n            var inputValue = isNOU(inputElement) ? trimmedStr : inputElement.value;\n            var emojiButtons = this.parent.element.querySelectorAll('.e-rte-emojipicker-btn button');\n            var emojipickerAll = this.parent.element.querySelector('.e-rte-emojipicker-btn');\n            var emojiGroups = this.parent.element.querySelectorAll('.e-rte-emojipicker-group');\n            var toolbarGroup = this.parent.element.querySelector('.e-rte-emojipicker-toolbar');\n            var excludedDiv_1 = this.parent.element.querySelector('.e-rte-emojisearch-btn');\n            var firstChild = this.popDiv.childNodes[0];\n            var getComputedStyle_2 = window.getComputedStyle(firstChild);\n            var inputHeight = firstChild.nodeName === 'SPAN' ? (firstChild.getBoundingClientRect().height + parseFloat(getComputedStyle_2.marginTop) +\n                parseFloat(getComputedStyle_2.marginBottom)) : 0;\n            var popupBorder = window.getComputedStyle(this.popDiv);\n            // eslint-disable-next-line @typescript-eslint/tslint/config\n            var filteredButtons = isNOU(excludedDiv_1) ? emojiButtons :\n                // eslint-disable-next-line @typescript-eslint/tslint/config\n                Array.from(emojiButtons).filter(function (button) { return !excludedDiv_1.contains(button); });\n            if (inputValue === '' || value === ':') {\n                toolbarGroup.style.display = '';\n                emojipickerAll.style.height = (this.popDiv.getBoundingClientRect().height - toolbarGroup.getBoundingClientRect().height - inputHeight - (2 * parseFloat(popupBorder.borderWidth))) + 'px';\n                // eslint-disable-next-line @typescript-eslint/tslint/config\n                emojiGroups.forEach(function (element) {\n                    element.style.display = '';\n                });\n            }\n            else {\n                // eslint-disable-next-line @typescript-eslint/tslint/config\n                emojiGroups.forEach(function (element) {\n                    element.style.display = 'none';\n                });\n                toolbarGroup.style.display = 'none';\n                emojipickerAll.style.height = (this.popDiv.getBoundingClientRect().height - inputHeight - (2 * parseFloat(popupBorder.borderWidth))) + 'px';\n            }\n            var emojiBtnDiv = this.parent.createElement('div', { className: 'e-rte-emojisearch-btn' });\n            var emojis = this.parent.element.querySelector('.e-rte-emojisearch-btn');\n            if (emojis) {\n                emojis.remove();\n            }\n            var noEmojiObj = this.parent.createElement('div', { className: 'e-rte-emojiSearch-noEmoji' });\n            var noEMoji = true;\n            for (var i = 0; i < filteredButtons.length; i++) {\n                if (!isNOU(filteredButtons[i].getAttribute('title'))) {\n                    var title = filteredButtons[i].getAttribute('title').toLowerCase();\n                    var titleLength = title.split(' ');\n                    for (var j = 0; j < titleLength.length; j++) {\n                        if (titleLength[j].startsWith(inputValue.toLowerCase()) && inputValue !== '') {\n                            var emoji = filteredButtons[i].cloneNode(true);\n                            emojiBtnDiv.appendChild(emoji);\n                            noEMoji = false;\n                            break;\n                        }\n                    }\n                }\n            }\n            if (noEMoji && !this.parent.element.querySelector('.e-rte-emojiSearch-noEmoji') && (inputValue !== '' && value !== ':')) {\n                noEmojiObj.innerHTML = '<span style=\"color: rgba(0, 0, 0, 0.75); font-weight: 500; font-size: 16px;\">' + this.i10n.getConstant('emojiPickerNoResultFound') + ' 😥 </span>' + '<br>' + '<span style=\"color: rgba(0, 0, 0, 0.75);\"> ' + this.i10n.getConstant('emojiPickerTrySomethingElse') + ' ? </span>';\n                noEmojiObj.style.margin = '55px';\n                emojipickerAll.appendChild(noEmojiObj);\n            }\n            else if (!noEMoji && this.parent.element.querySelector('.e-rte-emojiSearch-noEmoji') || (inputValue === '' && value === ':') || (inputValue === '' && this.parent.element.querySelector('.e-rte-emojiSearch-noEmoji'))) {\n                emojipickerAll.removeChild(this.parent.element.querySelector('.e-rte-emojiSearch-noEmoji'));\n            }\n            emojipickerAll.appendChild(emojiBtnDiv);\n        }\n        else {\n            return;\n        }\n    };\n    EmojiPicker.prototype.emojiBtnClick = function (e) {\n        var event = new MouseEvent('mouseleave', { bubbles: true, cancelable: true });\n        // Includes the emote button element tooltip and toolbar tooltip\n        var emotePickerTooltips = this.parent.element.querySelectorAll('.e-rte-emojipicker-popup [data-tooltip-id]');\n        for (var i = 0; i < emotePickerTooltips.length; i++) {\n            emotePickerTooltips[i].dispatchEvent(event);\n        }\n        var targetEle = e.target;\n        if (targetEle.tagName !== 'BUTTON') {\n            return;\n        }\n        targetEle.focus();\n        var startOffset = this.save.startOffset;\n        var textContent = this.save.range.startContainer.textContent;\n        var previousText = textContent.substring(startOffset, startOffset + 1);\n        // When toolbar action is clicked then only restore the range.\n        if (!isNOU(this.clickEvent) || previousText !== ':') {\n            this.save.restore();\n        }\n        if (this.popupObj) {\n            removeClass([this.divElement], 'e-active');\n            this.popupObj.hide();\n        }\n        var originalEvent = e;\n        this.parent.formatter.process(this.parent, {\n            item: {\n                'command': 'EmojiPicker',\n                'subCommand': 'EmojiPicker',\n                value: targetEle.innerHTML\n            }\n        }, e, originalEvent);\n    };\n    EmojiPicker.prototype.onkeyPress = function (e) {\n        var originalEvent = e.args;\n        var selection = (this.parent.iframeSettings.enable) ? this.parent.contentModule.getPanel().contentWindow.getSelection() :\n            this.parent.contentModule.getDocument().getSelection();\n        if (selection.rangeCount <= 0) {\n            return;\n        }\n        var range = selection.getRangeAt(0);\n        var cursorPos = range.startOffset;\n        var prevChar = selection.focusNode.textContent.substring(cursorPos - 1, cursorPos);\n        var isPrevSpace = /\\s/.test(prevChar);\n        var isPrevColon = selection.focusNode.textContent.substring(cursorPos - 1, cursorPos) === ':';\n        var colon = selection.focusNode.textContent.charAt(cursorPos - 1) === ':';\n        if (originalEvent.keyCode === 186 && originalEvent.shiftKey && (isPrevSpace || selection.focusOffset === 0)) {\n            var coordinates = this.getCoordinates();\n            this.parent.showEmojiPicker(coordinates.left, coordinates.top);\n        }\n        if (originalEvent.keyCode === 8 && colon && this.popupObj) {\n            removeClass([this.divElement], 'e-active');\n            this.popupObj.hide();\n        }\n        if (originalEvent.keyCode === 32 && isPrevColon && this.popupObj) {\n            removeClass([this.divElement], 'e-active');\n            var currentDocument = this.parent.iframeSettings.enable ? this.parent.contentModule.getPanel().ownerDocument : this.parent.contentModule.getDocument();\n            if (this.parent.showTooltip && !isNOU(currentDocument.querySelector('.e-tooltip-wrap'))) {\n                this.parent.notify(events.destroyTooltip, { args: event });\n            }\n            this.popupObj.hide();\n        }\n        if (this.popupObj && (originalEvent.keyCode === 37 || originalEvent.keyCode === 38 || originalEvent.keyCode === 39\n            || originalEvent.keyCode === 27 || originalEvent.keyCode === 40)) {\n            this.onKeyDown(originalEvent);\n            originalEvent.preventDefault();\n        }\n    };\n    EmojiPicker.prototype.onkeyUp = function (e) {\n        var originalEvent = e.args;\n        var selection = (this.parent.iframeSettings.enable) ? this.parent.contentModule.getPanel().contentWindow.getSelection() :\n            this.parent.contentModule.getDocument().getSelection();\n        if (selection.rangeCount <= 0) {\n            return;\n        }\n        var range = selection.getRangeAt(0);\n        var cursorPos = range.startOffset;\n        // eslint-disable-next-line\n        var selectedValue;\n        var count = 0;\n        for (var i = cursorPos - 1; i >= cursorPos - 15; i--) {\n            var prevChar = selection.focusNode.textContent.substring(i - 1, i);\n            var isPrevSpace = /:$/.test(prevChar);\n            if (isPrevSpace && !isNOU(this.popDiv) && count === 0) {\n                selectedValue = range.startContainer.textContent.substring(i - 1, cursorPos);\n                this.searchFilter(originalEvent, selectedValue);\n                count = 1;\n            }\n        }\n        var colon = selection.focusNode.textContent.substring(cursorPos - 1, cursorPos);\n        if (colon === ':' && !isNOU(this.popupObj)) {\n            selectedValue = colon;\n            this.searchFilter(originalEvent, selectedValue);\n        }\n    };\n    EmojiPicker.prototype.getCoordinates = function () {\n        var coordinates;\n        var selection = (this.parent.iframeSettings.enable) ? this.parent.contentModule.getPanel().contentWindow.getSelection() : window.getSelection();\n        var range = selection.getRangeAt(0);\n        var firstChild;\n        if (range.startContainer.nodeName === 'P' || range.startContainer.nodeName === 'DIV') {\n            if (range.startContainer.childNodes[0].nodeName !== '#text') {\n                firstChild = range.startContainer.childNodes[0];\n            }\n        }\n        // eslint-disable-next-line\n        var rect = isNOU(firstChild) ? range.getBoundingClientRect() : firstChild.getBoundingClientRect();\n        var rteContent = this.parent.element.querySelector('.e-rte-content');\n        var rteEle = this.parent.element;\n        var toolbarHeight = rteEle.offsetHeight - rteContent.offsetHeight;\n        var cursorTop = rect.top - this.parent.inputElement.getBoundingClientRect().top;\n        var cursorLeft = rect.left - this.parent.inputElement.getBoundingClientRect().left;\n        var screenHeight = window.innerHeight;\n        var popupHeight = 330;\n        var popupTop = cursorTop;\n        var popupLeft = cursorLeft + rect.width;\n        if (rteEle.getBoundingClientRect().top < 0) {\n            popupTop = popupTop + rteContent.getBoundingClientRect().top - toolbarHeight;\n        }\n        if (rect.top < popupHeight) {\n            // eslint-disable-next-line\n            popupTop = popupTop;\n        }\n        else if (rect.top + popupHeight > screenHeight) {\n            popupTop -= popupHeight + 20;\n        }\n        if (this.parent.inputElement) {\n            coordinates = {\n                top: popupTop + 60,\n                left: popupLeft + 8\n            };\n        }\n        return coordinates;\n    };\n    EmojiPicker.prototype.removeEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.off(events.emojiPicker, this.toolbarClick);\n        this.parent.off(events.docClick, this.docClick);\n        this.parent.off(events.keyDown, this.onkeyPress);\n        this.parent.off(events.keyUp, this.onkeyUp);\n        this.parent.off(events.contentscroll, this.contentscroll);\n        this.parent.off(events.scroll, this.contentscroll);\n    };\n    /**\n     * For internal use only - Get the module name.\n     *\n     * @returns {string} - returns the string value\n     */\n    EmojiPicker.prototype.getModuleName = function () {\n        return 'emojiPicker';\n    };\n    return EmojiPicker;\n}());\nexport { EmojiPicker };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}