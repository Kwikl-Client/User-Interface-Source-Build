{"ast":null,"code":"import { Draggable, Droppable, EventHandler } from '@syncfusion/ej2-base';\nimport { createElement, closest, remove, classList, addClass, removeClass } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined, extend } from '@syncfusion/ej2-base';\nimport { parentsUntil, isActionPrevent, isGroupAdaptive, updatecloneRow, getComplexFieldID, getParsedFieldID, isComplexField, findCellIndex, resetRowIndex } from '../base/util';\nimport { generateExpandPredicates, getPredicates, capitalizeFirstLetter } from '../base/util';\nimport * as events from '../base/constant';\nimport { AriaService } from '../services/aria-service';\nimport { GroupModelGenerator } from '../services/group-model-generator';\nimport { DataUtil } from '@syncfusion/ej2-data';\nimport * as literals from '../base/string-literals';\nimport { RowRenderer } from '../renderer/row-renderer';\n// eslint-disable-next-line valid-jsdoc\n/**\n *\n * The `Group` module is used to handle group action.\n */\nvar Group = /** @class */function () {\n  /**\n   * Constructor for Grid group module\n   *\n   * @param {IGrid} parent - specifies the IGrid\n   * @param {GroupSettingsModel} groupSettings - specifies the GroupSettingsModel\n   * @param {string[]} sortedColumns - specifies the sortedColumns\n   * @param {ServiceLocator} serviceLocator - specifies the serviceLocator\n   * @hidden\n   */\n  function Group(parent, groupSettings, sortedColumns, serviceLocator) {\n    var _this = this;\n    //Internal variables\n    this.sortRequired = true;\n    /** @hidden */\n    this.groupSortFocus = false;\n    /** @hidden */\n    this.groupTextFocus = false;\n    /** @hidden */\n    this.groupCancelFocus = false;\n    this.isAppliedGroup = false;\n    this.isAppliedUnGroup = false;\n    this.isAppliedCaptionRowBorder = false;\n    this.reorderingColumns = [];\n    this.visualElement = createElement('div', {\n      className: 'e-cloneproperties e-dragclone e-gdclone',\n      styles: 'line-height:23px',\n      attrs: {\n        action: 'grouping'\n      }\n    });\n    this.helper = function (e) {\n      var gObj = _this.parent;\n      var target = e.sender.target;\n      var element = target.classList.contains('e-groupheadercell') ? target : parentsUntil(target, 'e-groupheadercell');\n      if (!element || !target.classList.contains('e-drag') && _this.groupSettings.allowReordering) {\n        return false;\n      }\n      _this.column = gObj.getColumnByField(element.firstElementChild.getAttribute('ej-mappingname'));\n      _this.visualElement.textContent = element.textContent;\n      _this.visualElement.style.width = element.offsetWidth + 2 + 'px';\n      _this.visualElement.style.height = element.offsetHeight + 2 + 'px';\n      _this.visualElement.setAttribute('e-mappinguid', _this.column.uid);\n      gObj.element.appendChild(_this.visualElement);\n      return _this.visualElement;\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    this.dragStart = function (e) {\n      _this.parent.element.classList.add('e-ungroupdrag');\n    };\n    this.drag = function (e) {\n      if (_this.groupSettings.allowReordering) {\n        _this.animateDropper(e);\n      }\n      var target = e.target;\n      var cloneElement = _this.parent.element.querySelector('.e-cloneproperties');\n      _this.parent.trigger(events.columnDrag, {\n        target: target,\n        draggableType: 'headercell',\n        column: _this.column\n      });\n      if (!_this.groupSettings.allowReordering) {\n        classList(cloneElement, ['e-defaultcur'], ['e-notallowedcur']);\n        if (!(parentsUntil(target, literals.gridContent) || parentsUntil(target, 'e-headercell'))) {\n          classList(cloneElement, ['e-notallowedcur'], ['e-defaultcur']);\n        }\n      }\n    };\n    this.dragStop = function (e) {\n      _this.parent.element.classList.remove('e-ungroupdrag');\n      var preventDrop = !(parentsUntil(e.target, literals.gridContent) || parentsUntil(e.target, 'e-gridheader'));\n      if (_this.groupSettings.allowReordering && preventDrop) {\n        remove(e.helper);\n        if (parentsUntil(e.target, 'e-groupdroparea')) {\n          _this.rearrangeGroup();\n        } else if (!parentsUntil(e.target, 'e-grid')) {\n          var field = _this.parent.getColumnByUid(e.helper.getAttribute('e-mappinguid')).field;\n          if (_this.groupSettings.columns.indexOf(field) !== -1) {\n            _this.ungroupColumn(field);\n          }\n        }\n        return;\n      } else if (preventDrop) {\n        remove(e.helper);\n        return;\n      }\n    };\n    this.animateDropper = function (e) {\n      var uid = _this.parent.element.querySelector('.e-cloneproperties').getAttribute('e-mappinguid');\n      var dragField = _this.parent.getColumnByUid(uid).field;\n      var parent = parentsUntil(e.target, 'e-groupdroparea');\n      var dropTarget = parentsUntil(e.target, 'e-group-animator');\n      var grouped = [].slice.call(_this.element.getElementsByClassName('e-groupheadercell')).map(function (e) {\n        return e.querySelector('div').getAttribute('ej-mappingname');\n      });\n      var cols = JSON.parse(JSON.stringify(grouped));\n      if (dropTarget || parent) {\n        if (dropTarget) {\n          var dropField = dropTarget.querySelector('div[ej-mappingname]').getAttribute('ej-mappingname');\n          var dropIndex = +dropTarget.getAttribute('index');\n          if (dropField !== dragField) {\n            var dragIndex = cols.indexOf(dragField);\n            if (dragIndex !== -1) {\n              cols.splice(dragIndex, 1);\n            }\n            var flag = dropIndex !== -1 && dragIndex === dropIndex;\n            cols.splice(dropIndex + (flag ? 1 : 0), 0, dragField);\n          }\n        } else if (parent && cols.indexOf(dragField) === -1) {\n          cols.push(dragField);\n        }\n        _this.element.innerHTML = '';\n        if (cols.length && !_this.element.classList.contains('e-grouped')) {\n          _this.element.classList.add('e-grouped');\n        }\n        _this.reorderingColumns = cols;\n        for (var c = 0; c < cols.length; c++) {\n          _this.addColToGroupDrop(cols[parseInt(c.toString(), 10)]);\n        }\n      } else {\n        _this.addLabel();\n        _this.removeColFromGroupDrop(dragField);\n      }\n    };\n    this.drop = function (e) {\n      var gObj = _this.parent;\n      var column = gObj.getColumnByUid(e.droppedElement.getAttribute('e-mappinguid'));\n      _this.element.classList.remove('e-hover');\n      remove(e.droppedElement);\n      _this.aria.setDropTarget(_this.parent.element.querySelector('.e-groupdroparea'), false);\n      _this.aria.setGrabbed(_this.parent.getHeaderTable().querySelector('[aria-grabbed=true]'), false);\n      if (isNullOrUndefined(column) || column.allowGrouping === false || parentsUntil(gObj.getColumnHeaderByUid(column.uid), 'e-grid').getAttribute('id') !== gObj.element.getAttribute('id')) {\n        _this.parent.log('action_disabled_column', {\n          moduleName: _this.getModuleName(),\n          columnName: column ? column.headerText : undefined\n        });\n        return;\n      }\n      _this.groupColumn(column.field);\n    };\n    this.contentRefresh = true;\n    this.aria = new AriaService();\n    this.parent = parent;\n    this.groupSettings = groupSettings;\n    this.serviceLocator = serviceLocator;\n    this.sortedColumns = sortedColumns;\n    this.focus = serviceLocator.getService('focus');\n    this.addEventListener();\n    this.groupGenerator = new GroupModelGenerator(this.parent);\n  }\n  Group.prototype.addLabel = function () {\n    if (!this.element.getElementsByClassName('e-group-animator').length) {\n      var dragLabel = this.l10n.getConstant('GroupDropArea');\n      this.element.innerHTML = dragLabel;\n      this.element.classList.remove('e-grouped');\n    }\n  };\n  Group.prototype.rearrangeGroup = function () {\n    this.sortRequired = false;\n    this.updateModel();\n  };\n  Group.prototype.columnDrag = function (e) {\n    if (this.groupSettings.allowReordering && e.column.allowGrouping) {\n      this.animateDropper(e);\n    }\n    var cloneElement = this.parent.element.querySelector('.e-cloneproperties');\n    if (!this.parent.allowReordering) {\n      classList(cloneElement, ['e-defaultcur'], ['e-notallowedcur']);\n    }\n    if (!(e.column.allowGrouping && (parentsUntil(e.target, 'e-groupdroparea') || parentsUntil(e.target, 'e-headercell') && parentsUntil(e.target, 'e-headercell').isEqualNode(this.parent.getColumnHeaderByField(e.column.field)))) && !(this.parent.allowReordering && parentsUntil(e.target, 'e-headercell'))) {\n      classList(cloneElement, ['e-notallowedcur'], ['e-defaultcur']);\n    }\n    if (e.target.classList.contains('e-groupdroparea')) {\n      this.element.classList.add('e-hover');\n    } else {\n      this.element.classList.remove('e-hover');\n    }\n  };\n  Group.prototype.columnDragStart = function (e) {\n    if (e.target.classList.contains('e-stackedheadercell')) {\n      return;\n    }\n    var dropArea = this.parent.element.querySelector('.e-groupdroparea');\n    this.aria.setDropTarget(dropArea, e.column.allowGrouping);\n    var element = e.target.classList.contains('e-headercell') ? e.target : parentsUntil(e.target, 'e-headercell');\n    this.aria.setGrabbed(element, true, !e.column.allowGrouping);\n  };\n  Group.prototype.columnDrop = function (e) {\n    var gObj = this.parent;\n    if (e.droppedElement.getAttribute('action') === 'grouping') {\n      var column = gObj.getColumnByUid(e.droppedElement.getAttribute('e-mappinguid'));\n      if (isNullOrUndefined(column) || column.allowGrouping === false || parentsUntil(gObj.getColumnHeaderByUid(column.uid), 'e-grid').getAttribute('id') !== gObj.element.getAttribute('id')) {\n        return;\n      }\n      this.ungroupColumn(column.field);\n    }\n  };\n  /**\n   * @returns {void}\n   * @hidden\n   */\n  Group.prototype.addEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n    this.parent.on(events.uiUpdate, this.enableAfterRender, this);\n    this.parent.on(events.groupComplete, this.onActionComplete, this);\n    this.parent.on(events.ungroupComplete, this.onActionComplete, this);\n    this.parent.on(events.inBoundModelChanged, this.onPropertyChanged, this);\n    this.parent.on(events.click, this.clickHandler, this);\n    this.parent.on(events.columnDrag, this.columnDrag, this);\n    this.parent.on(events.columnDragStart, this.columnDragStart, this);\n    this.parent.on(events.headerDrop, this.columnDrop, this);\n    this.parent.on(events.columnDrop, this.columnDrop, this);\n    this.parent.on(events.headerRefreshed, this.refreshSortIcons, this);\n    this.parent.on(events.sortComplete, this.refreshSortIcons, this);\n    this.parent.on(events.keyPressed, this.keyPressHandler, this);\n    this.parent.on(events.contentReady, this.initialEnd, this);\n    this.parent.on(events.onEmpty, this.initialEnd, this);\n    this.parent.on(events.initialEnd, this.render, this);\n    this.parent.on(events.groupAggregates, this.onGroupAggregates, this);\n    this.parent.on(events.destroy, this.destroy, this);\n    this.parent.on('group-expand-collapse', this.updateExpand, this);\n    this.parent.on('persist-data-changed', this.initialEnd, this);\n  };\n  /**\n   * @returns {void}\n   * @hidden\n   */\n  Group.prototype.removeEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n    this.parent.off(events.initialEnd, this.render);\n    this.parent.off(events.uiUpdate, this.enableAfterRender);\n    this.parent.off(events.groupComplete, this.onActionComplete);\n    this.parent.off(events.ungroupComplete, this.onActionComplete);\n    this.parent.off(events.inBoundModelChanged, this.onPropertyChanged);\n    this.parent.off(events.click, this.clickHandler);\n    this.parent.off(events.columnDrag, this.columnDrag);\n    this.parent.off(events.columnDragStart, this.columnDragStart);\n    this.parent.off(events.columnDrop, this.columnDrop);\n    this.parent.off(events.headerDrop, this.columnDrop);\n    this.parent.off(events.headerRefreshed, this.refreshSortIcons);\n    this.parent.off(events.sortComplete, this.refreshSortIcons);\n    this.parent.off(events.keyPressed, this.keyPressHandler);\n    this.parent.off(events.groupAggregates, this.onGroupAggregates);\n    this.parent.off(events.destroy, this.destroy);\n    this.parent.off('group-expand-collapse', this.updateExpand);\n  };\n  Group.prototype.initialEnd = function () {\n    var gObj = this.parent;\n    this.parent.off(events.contentReady, this.initialEnd);\n    this.parent.off(events.onEmpty, this.initialEnd);\n    if (this.parent.getColumns().length && this.groupSettings.columns.length) {\n      this.contentRefresh = false;\n      for (var _i = 0, _a = gObj.groupSettings.columns; _i < _a.length; _i++) {\n        var col = _a[_i];\n        this.groupColumn(col);\n      }\n      this.contentRefresh = true;\n    }\n  };\n  Group.prototype.keyPressHandler = function (e) {\n    var gObj = this.parent;\n    if (e.target && parentsUntil(e.target, 'e-groupheadercell') && (e.action === 'tab' || e.action === 'shiftTab')) {\n      var focusableGroupedItems = this.getFocusableGroupedItems();\n      if (e.action === 'tab' && e.target === focusableGroupedItems[focusableGroupedItems.length - 1] || e.action === 'shiftTab' && e.target === focusableGroupedItems[0]) {\n        return;\n      }\n      for (var i = 0; i < focusableGroupedItems.length; i++) {\n        if (e.target === focusableGroupedItems[parseInt(i.toString(), 10)]) {\n          e.preventDefault();\n          var index = e.action === 'tab' ? i + 1 : i - 1;\n          focusableGroupedItems[parseInt(index.toString(), 10)].focus();\n          return;\n        }\n      }\n    }\n    var isMacLike = /(Mac)/i.test(navigator.platform);\n    if (isMacLike && e.metaKey) {\n      if (e.action === 'downArrow') {\n        e.action = 'ctrlDownArrow';\n      } else if (e.action === 'upArrow') {\n        e.action = 'ctrlUpArrow';\n      }\n    }\n    if (e.action !== 'ctrlSpace' && (!this.groupSettings.columns.length || ['altDownArrow', 'altUpArrow', 'ctrlDownArrow', 'ctrlUpArrow', 'enter'].indexOf(e.action) === -1)) {\n      return;\n    }\n    e.preventDefault();\n    switch (e.action) {\n      case 'altDownArrow':\n      case 'altUpArrow':\n        // eslint-disable-next-line no-case-declarations\n        var selected = gObj.allowSelection ? gObj.getSelectedRowIndexes() : [];\n        if (selected.length) {\n          var rows = gObj.getContentTable().querySelector(literals.tbody).children;\n          var dataRow = gObj.getDataRows()[selected[selected.length - 1]];\n          var grpRow = void 0;\n          for (var i = dataRow.rowIndex; i >= 0; i--) {\n            if (!rows[parseInt(i.toString(), 10)].classList.contains(literals.row) && !rows[parseInt(i.toString(), 10)].classList.contains('e-detailrow')) {\n              grpRow = rows[parseInt(i.toString(), 10)];\n              break;\n            }\n          }\n          this.expandCollapseRows(grpRow.querySelector(e.action === 'altUpArrow' ? '.e-recordplusexpand' : '.e-recordpluscollapse'));\n        }\n        break;\n      case 'ctrlDownArrow':\n        this.expandAll();\n        break;\n      case 'ctrlUpArrow':\n        this.collapseAll();\n        break;\n      case 'enter':\n        if (e.target.classList.contains('e-groupsort')) {\n          this.groupSortFocus = true;\n          this.applySortFromTarget(e.target);\n          break;\n        } else if (e.target.classList.contains('e-ungroupbutton')) {\n          this.groupCancelFocus = true;\n          this.unGroupFromTarget(e.target);\n          break;\n        }\n        if (this.parent.isEdit || closest(e.target, '#' + this.parent.element.id + '_searchbar') !== null || parentsUntil(e.target, 'e-pager') || parentsUntil(e.target, 'e-toolbar')) {\n          return;\n        }\n        // eslint-disable-next-line no-case-declarations\n        var element = this.focus.getFocusedElement();\n        if (element && (element.classList.contains('e-icon-grightarrow') || element.classList.contains('e-icon-gdownarrow'))) {\n          element = element.parentElement;\n        }\n        // eslint-disable-next-line no-case-declarations\n        var row = element ? element.parentElement.querySelector('[class^=\"e-record\"]') : null;\n        if (!row) {\n          break;\n        }\n        if (element.children.length && (element.children[0].classList.contains('e-icon-grightarrow') || element.children[0].classList.contains('e-icon-gdownarrow'))) {\n          this.expandCollapseRows(row);\n        }\n        break;\n      case 'ctrlSpace':\n        // eslint-disable-next-line no-case-declarations\n        var elem = gObj.focusModule.currentInfo.element;\n        if (elem && elem.classList.contains('e-headercell')) {\n          var column = gObj.getColumnByUid(elem.firstElementChild.getAttribute('e-mappinguid'));\n          if (column.field && gObj.groupSettings.columns.indexOf(column.field) < 0) {\n            this.groupColumn(column.field);\n          } else {\n            this.ungroupColumn(column.field);\n          }\n        }\n        break;\n    }\n  };\n  /**\n   * @returns {Element[]} - Return the focusable grouping items\n   * @hidden */\n  Group.prototype.getFocusableGroupedItems = function () {\n    var focusableGroupedItems = [];\n    if (this.groupSettings.columns.length) {\n      var focusableGroupedHeaderItems = this.element.querySelectorAll('.e-groupheadercell');\n      for (var i = 0; i < focusableGroupedHeaderItems.length; i++) {\n        focusableGroupedItems.push(focusableGroupedHeaderItems[parseInt(i.toString(), 10)].querySelector('.e-grouptext'));\n        focusableGroupedItems.push(focusableGroupedHeaderItems[parseInt(i.toString(), 10)].querySelector('.e-groupsort'));\n        focusableGroupedItems.push(focusableGroupedHeaderItems[parseInt(i.toString(), 10)].querySelector('.e-ungroupbutton'));\n      }\n    }\n    return focusableGroupedItems;\n  };\n  Group.prototype.wireEvent = function () {\n    EventHandler.add(this.element, 'focusin', this.onFocusIn, this);\n    EventHandler.add(this.element, 'focusout', this.onFocusOut, this);\n    EventHandler.add(this.parent.element, 'auxclick', this.auxilaryclickHandler, this);\n  };\n  Group.prototype.unWireEvent = function () {\n    EventHandler.remove(this.element, 'focusin', this.onFocusIn);\n    EventHandler.remove(this.element, 'focusout', this.onFocusOut);\n    EventHandler.remove(this.parent.element, 'auxclick', this.auxilaryclickHandler);\n  };\n  Group.prototype.onFocusIn = function (e) {\n    if (this.parent.focusModule.currentInfo && this.parent.focusModule.currentInfo.element) {\n      removeClass([this.parent.focusModule.currentInfo.element, this.parent.focusModule.currentInfo.elementToFocus], ['e-focused', 'e-focus']);\n      this.parent.focusModule.currentInfo.element.tabIndex = -1;\n    }\n    this.addOrRemoveFocus(e);\n  };\n  Group.prototype.onFocusOut = function (e) {\n    this.addOrRemoveFocus(e);\n  };\n  Group.prototype.addOrRemoveFocus = function (e) {\n    if (e.target.classList.contains('e-groupdroparea') || e.target.classList.contains('e-grouptext') || e.target.classList.contains('e-groupsort') || e.target.classList.contains('e-ungroupbutton')) {\n      var target = e.target.classList.contains('e-grouptext') ? e.target.parentElement.parentElement : e.target;\n      if (e.type === 'focusin') {\n        this.parent.focusModule.currentInfo.element = e.target;\n        this.parent.focusModule.currentInfo.elementToFocus = e.target;\n        addClass([target], ['e-focused', 'e-focus']);\n        e.target.tabIndex = 0;\n      } else {\n        removeClass([target], ['e-focused', 'e-focus']);\n        e.target.tabIndex = -1;\n      }\n    }\n  };\n  Group.prototype.clickHandler = function (e) {\n    if (e.target.classList.contains('e-grouptext')) {\n      this.groupTextFocus = true;\n    }\n    if (e.target.classList.contains('e-groupsort')) {\n      this.groupSortFocus = true;\n    }\n    if (e.target.classList.contains('e-ungroupbutton')) {\n      this.groupCancelFocus = true;\n    }\n    if (e.target.classList.contains('e-icon-grightarrow') || e.target.classList.contains('e-icon-gdownarrow')) {\n      e.preventDefault();\n    }\n    var trgtEle = parentsUntil(e.target, 'e-recordplusexpand') || parentsUntil(e.target, 'e-recordpluscollapse');\n    if (trgtEle && (trgtEle.children[0].classList.contains('e-icon-gdownarrow') || trgtEle.children[0].classList.contains('e-icon-grightarrow'))) {\n      this.expandCollapseRows(e.target);\n    }\n    this.applySortFromTarget(e.target);\n    this.unGroupFromTarget(e.target);\n    this.toogleGroupFromHeader(e.target);\n  };\n  Group.prototype.auxilaryclickHandler = function (e) {\n    if (e.target.classList.contains('e-icon-grightarrow') || e.target.classList.contains('e-icon-gdownarrow') && e.button === 1) {\n      e.preventDefault();\n    }\n  };\n  Group.prototype.unGroupFromTarget = function (target) {\n    if (target.classList.contains('e-ungroupbutton')) {\n      this.ungroupColumn(target.parentElement.getAttribute('ej-mappingname'));\n    }\n  };\n  Group.prototype.toogleGroupFromHeader = function (target) {\n    if (this.groupSettings.showToggleButton) {\n      if (target.classList.contains('e-grptogglebtn')) {\n        if (target.classList.contains('e-toggleungroup')) {\n          this.ungroupColumn(this.parent.getColumnByUid(target.parentElement.getAttribute('e-mappinguid')).field);\n        } else {\n          this.groupColumn(this.parent.getColumnByUid(target.parentElement.getAttribute('e-mappinguid')).field);\n        }\n      } else {\n        if (target.classList.contains('e-toggleungroup')) {\n          this.ungroupColumn(target.parentElement.getAttribute('ej-mappingname'));\n        }\n      }\n    }\n  };\n  Group.prototype.applySortFromTarget = function (target) {\n    var gObj = this.parent;\n    var gHeader = closest(target, '.e-groupheadercell');\n    if (gObj.allowSorting && gHeader && !target.classList.contains('e-ungroupbutton') && !target.classList.contains('e-toggleungroup')) {\n      var field = gHeader.firstElementChild.getAttribute('ej-mappingname');\n      if (gObj.getColumnHeaderByField(field).getElementsByClassName('e-ascending').length) {\n        gObj.sortColumn(field, 'Descending', true);\n      } else {\n        gObj.sortColumn(field, 'Ascending', true);\n      }\n    }\n  };\n  /**\n   * Expands or collapses grouped rows by target element.\n   *\n   * @param  {Element} target - Defines the target element of the grouped row.\n   * @returns {void}\n   */\n  Group.prototype.expandCollapseRows = function (target) {\n    var trgt = parentsUntil(target, 'e-recordplusexpand') || parentsUntil(target, 'e-recordpluscollapse');\n    if (trgt) {\n      var rowNodes = this.parent.getContentTable().querySelector(literals.tbody).children;\n      var isHide = void 0;\n      var dataManager = void 0;\n      var query = void 0;\n      var gObj = this.parent;\n      var indent = trgt.parentElement.getElementsByClassName('e-indentcell').length;\n      var uid = trgt.parentElement.getAttribute('data-uid');\n      var captionRow = gObj.getRowObjectFromUID(uid);\n      var expand = false;\n      if (trgt.classList.contains('e-recordpluscollapse')) {\n        addClass([trgt], 'e-recordplusexpand');\n        removeClass([trgt], 'e-recordpluscollapse');\n        trgt.firstElementChild.className = 'e-icons e-gdiagonaldown e-icon-gdownarrow';\n        trgt.firstElementChild.setAttribute('title', 'expanded');\n        expand = true;\n        captionRow.isExpand = true;\n        if (isGroupAdaptive(gObj)) {\n          this.updateVirtualRows(gObj, target, expand, query, dataManager);\n        }\n        if (this.parent.groupSettings.enableLazyLoading) {\n          if ((this.parent.filterSettings.columns.length || this.parent.sortSettings.columns.length || this.parent.searchSettings.key.length) && this.parent.getContent().firstElementChild.scrollTop === 0) {\n            this.parent.contentModule.isTop = true;\n          }\n          (this.parent.enableVirtualization ? this.parent.lazyLoadRender : this.parent.contentModule).captionExpand(trgt.parentElement);\n        }\n      } else {\n        isHide = true;\n        captionRow.isExpand = false;\n        removeClass([trgt], 'e-recordplusexpand');\n        addClass([trgt], 'e-recordpluscollapse');\n        trgt.firstElementChild.className = 'e-icons e-gnextforward e-icon-grightarrow';\n        trgt.firstElementChild.setAttribute('title', 'collapsed');\n        if (isGroupAdaptive(gObj)) {\n          this.updateVirtualRows(gObj, target, !isHide, query, dataManager);\n        }\n        if (this.parent.groupSettings.enableLazyLoading) {\n          (this.parent.enableVirtualization ? this.parent.lazyLoadRender : this.parent.contentModule).captionCollapse(trgt.parentElement);\n        }\n      }\n      this.aria.setExpand(trgt, expand);\n      if (!isGroupAdaptive(gObj) && !this.parent.groupSettings.enableLazyLoading) {\n        var rowObjs = gObj.getRowsObject();\n        var startIdx = rowObjs.indexOf(captionRow);\n        var rowsState = {};\n        var cacheStartIdx = gObj.enableInfiniteScrolling && gObj.infiniteScrollSettings && gObj.infiniteScrollSettings.enableCache && rowObjs.length !== rowNodes.length ? Array.from(rowNodes).indexOf(trgt.parentElement) : undefined;\n        for (var i = startIdx; i < rowObjs.length; i++) {\n          if (i > startIdx && rowObjs[parseInt(i.toString(), 10)].indent === indent) {\n            break;\n          }\n          if (rowObjs[parseInt(i.toString(), 10)].isDetailRow) {\n            var visible = rowObjs[i - 1].isExpand && rowObjs[i - 1].visible;\n            if (cacheStartIdx && cacheStartIdx > 0 && cacheStartIdx < rowNodes.length) {\n              rowNodes[parseInt(cacheStartIdx.toString(), 10)].style.display = visible ? '' : 'none';\n            } else if (isNullOrUndefined(cacheStartIdx)) {\n              rowNodes[parseInt(i.toString(), 10)].style.display = visible ? '' : 'none';\n            }\n          } else if (rowsState[rowObjs[parseInt(i.toString(), 10)].parentUid] === false) {\n            rowObjs[parseInt(i.toString(), 10)].visible = false;\n            if (cacheStartIdx && cacheStartIdx > 0 && cacheStartIdx < rowNodes.length) {\n              rowNodes[parseInt(cacheStartIdx.toString(), 10)].style.display = 'none';\n            } else if (isNullOrUndefined(cacheStartIdx)) {\n              rowNodes[parseInt(i.toString(), 10)].style.display = 'none';\n            }\n          } else {\n            if (!(rowObjs[parseInt(i.toString(), 10)].isDataRow || rowObjs[parseInt(i.toString(), 10)].isCaptionRow || rowObjs[parseInt(i.toString(), 10)].isDetailRow || rowObjs[parseInt(i.toString(), 10)].isAggregateRow)) {\n              var visible = rowObjs[parseInt(i.toString(), 10)].cells.some(function (cell) {\n                return cell.isDataCell && cell.visible;\n              });\n              if (visible === rowObjs[parseInt(i.toString(), 10)].visible) {\n                continue;\n              }\n            }\n            rowObjs[parseInt(i.toString(), 10)].visible = true;\n            if (cacheStartIdx && cacheStartIdx > 0 && cacheStartIdx < rowNodes.length) {\n              rowNodes[parseInt(cacheStartIdx.toString(), 10)].style.display = '';\n              rowNodes[parseInt(cacheStartIdx.toString(), 10)].classList.remove('e-hide');\n            } else if (isNullOrUndefined(cacheStartIdx)) {\n              rowNodes[parseInt(i.toString(), 10)].style.display = '';\n              rowNodes[parseInt(i.toString(), 10)].classList.remove('e-hide');\n            }\n          }\n          if (rowObjs[parseInt(i.toString(), 10)].isCaptionRow) {\n            rowsState[rowObjs[parseInt(i.toString(), 10)].uid] = rowObjs[parseInt(i.toString(), 10)].isExpand && rowObjs[parseInt(i.toString(), 10)].visible;\n          }\n          if (!isNullOrUndefined(cacheStartIdx)) {\n            cacheStartIdx++;\n          }\n        }\n        this.lastCaptionRowBorder();\n        this.parent.notify(events.refreshExpandandCollapse, {\n          rows: this.parent.getRowsObject()\n        });\n      }\n      if (!this.parent.enableInfiniteScrolling || !this.parent.groupSettings.enableLazyLoading) {\n        this.parent.notify(events.captionActionComplete, {\n          isCollapse: isHide,\n          parentUid: uid\n        });\n      }\n    }\n  };\n  /**\n   * The function is used to set border in last row\n   *\n   * @returns { void }\n   * @hidden\n   */\n  Group.prototype.lastCaptionRowBorder = function () {\n    var table = this.parent.getContentTable();\n    var clientHeight = this.parent.getContent().clientHeight;\n    if (!this.parent.enableVirtualization && !this.parent.enableInfiniteScrolling || this.parent.groupSettings.enableLazyLoading) {\n      if (table.scrollHeight < clientHeight || this.isAppliedCaptionRowBorder) {\n        if (this.isAppliedCaptionRowBorder || table.querySelector('.e-lastrowcell')) {\n          var borderCells = table.querySelectorAll('.e-lastrowcell');\n          for (var i = 0, len = borderCells.length; i < len; i++) {\n            removeClass([borderCells[parseInt(i.toString(), 10)]], 'e-lastrowcell');\n          }\n          this.isAppliedCaptionRowBorder = false;\n        }\n        var rowNodes = this.parent.getContentTable().querySelector(literals.tbody).children;\n        var lastRow = rowNodes[rowNodes.length - 1];\n        if (lastRow.style.display !== 'none' && !lastRow.classList.contains('e-groupcaptionrow')) {\n          if (table.scrollHeight < clientHeight) {\n            addClass(table.querySelectorAll('tr:last-child td'), 'e-lastrowcell');\n            this.isAppliedCaptionRowBorder = true;\n          }\n        } else {\n          for (var i = rowNodes.length - 1, len = 0; i > len; i--) {\n            if (rowNodes[parseInt(i.toString(), 10)].style.display !== 'none' && rowNodes[parseInt(i.toString(), 10)].classList.contains('e-groupcaptionrow')) {\n              if (rowNodes[parseInt(i.toString(), 10)].querySelector('.e-recordpluscollapse')) {\n                addClass(rowNodes[parseInt(i.toString(), 10)].childNodes, 'e-lastrowcell');\n                this.isAppliedCaptionRowBorder = true;\n                break;\n              }\n            }\n          }\n        }\n      }\n    }\n  };\n  Group.prototype.updateVirtualRows = function (gObj, target, isExpand, query, dataManager) {\n    var rObj = gObj.getRowObjectFromUID(target.closest('tr').getAttribute('data-uid'));\n    rObj.isExpand = isExpand;\n    updatecloneRow(gObj);\n    this.parent.notify(events.refreshVirtualMaxPage, {});\n    query = gObj.getDataModule().generateQuery(false);\n    query.queries = gObj.getDataModule().aggregateQuery(gObj.getQuery().clone()).queries;\n    var args = {\n      requestType: 'virtualscroll',\n      rowObject: rObj\n    };\n    if (gObj.contentModule) {\n      args.virtualInfo = gObj.contentModule.prevInfo;\n    }\n    dataManager = gObj.getDataModule().getData(args, query.requiresCount());\n    dataManager.then(function (e) {\n      return gObj.renderModule.dataManagerSuccess(e, args);\n    });\n  };\n  Group.prototype.expandCollapse = function (isExpand) {\n    if (!this.parent.groupSettings.columns.length) {\n      return;\n    }\n    if (!isExpand) {\n      this.parent.notify(events.initialCollapse, isExpand);\n    }\n    var rowNodes = this.parent.getContentTable().querySelector(literals.tbody).children;\n    var rowObjs = this.parent.getRowsObject();\n    var row;\n    for (var i = 0, len = rowNodes.length; i < len; i++) {\n      if (rowNodes[parseInt(i.toString(), 10)].querySelectorAll('.e-recordplusexpand, .e-recordpluscollapse').length) {\n        row = rowNodes[parseInt(i.toString(), 10)].querySelector(isExpand ? '.e-recordpluscollapse' : '.e-recordplusexpand');\n        if (row) {\n          if (isExpand) {\n            row.className = 'e-recordplusexpand';\n            row.firstElementChild.className = 'e-icons e-gdiagonaldown e-icon-gdownarrow';\n            row.setAttribute('aria-expanded', 'true');\n            row.firstElementChild.setAttribute('title', 'expanded');\n          } else {\n            row.className = 'e-recordpluscollapse';\n            row.firstElementChild.className = 'e-icons e-gnextforward e-icon-grightarrow';\n            row.setAttribute('aria-expanded', 'false');\n            row.firstElementChild.setAttribute('title', 'collapsed');\n          }\n        }\n        if (!(rowNodes[parseInt(i.toString(), 10)].firstElementChild.classList.contains('e-recordplusexpand') || rowNodes[parseInt(i.toString(), 10)].firstElementChild.classList.contains('e-recordpluscollapse'))) {\n          rowNodes[parseInt(i.toString(), 10)].style.display = isExpand ? '' : 'none';\n        }\n      } else {\n        rowNodes[parseInt(i.toString(), 10)].style.display = isExpand ? '' : 'none';\n      }\n      if (rowObjs[parseInt(i.toString(), 10)].isCaptionRow) {\n        rowObjs[parseInt(i.toString(), 10)].isExpand = isExpand ? true : false;\n      }\n    }\n    this.parent.updateVisibleExpandCollapseRows();\n    this.lastCaptionRowBorder();\n    this.parent.notify(events.refreshExpandandCollapse, {\n      rows: this.parent.getRowsObject()\n    });\n  };\n  /**\n   * Expands all the grouped rows of the Grid.\n   *\n   * @returns {void}\n   */\n  Group.prototype.expandAll = function () {\n    this.expandCollapse(true);\n  };\n  /**\n   * Collapses all the grouped rows of the Grid.\n   *\n   * @returns {void}\n   */\n  Group.prototype.collapseAll = function () {\n    this.expandCollapse(false);\n  };\n  /**\n   * The function is used to render grouping\n   *\n   * @returns {void}\n   * @hidden\n   */\n  Group.prototype.render = function () {\n    this.l10n = this.serviceLocator.getService('localization');\n    this.renderGroupDropArea();\n    this.initDragAndDrop();\n    this.refreshToggleBtn();\n    this.wireEvent();\n  };\n  Group.prototype.renderGroupDropArea = function () {\n    var groupElem = this.parent.element.querySelector('.e-groupdroparea');\n    if (groupElem) {\n      remove(groupElem);\n    }\n    this.element = this.parent.createElement('div', {\n      className: 'e-groupdroparea',\n      attrs: {\n        'tabindex': '-1'\n      }\n    });\n    if (this.groupSettings.allowReordering) {\n      this.element.classList.add('e-group-animate');\n    }\n    this.updateGroupDropArea();\n    this.parent.element.insertBefore(this.element, this.parent.element.firstChild);\n    if (!this.groupSettings.showDropArea || this.parent.rowRenderingMode === 'Vertical') {\n      this.element.style.display = 'none';\n    }\n  };\n  Group.prototype.updateGroupDropArea = function (clear) {\n    if (this.groupSettings.showDropArea && !this.groupSettings.columns.length) {\n      var dragLabel = this.l10n.getConstant('GroupDropArea');\n      this.element.innerHTML = dragLabel;\n      this.element.classList.remove('e-grouped');\n    } else {\n      if (this.element.innerHTML === this.l10n.getConstant('GroupDropArea') && (this.groupSettings.columns.length === 1 || !this.isAppliedGroup && !this.isAppliedUnGroup) || clear) {\n        this.element.innerHTML = '';\n      }\n      this.element.classList.add('e-grouped');\n    }\n  };\n  Group.prototype.initDragAndDrop = function () {\n    this.initializeGHeaderDrop();\n    this.initializeGHeaderDrag();\n  };\n  Group.prototype.initializeGHeaderDrag = function () {\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    var drag = new Draggable(this.element, {\n      dragTarget: this.groupSettings.allowReordering ? '.e-drag' : '.e-groupheadercell',\n      distance: this.groupSettings.allowReordering ? -10 : 5,\n      helper: this.helper,\n      dragStart: this.dragStart,\n      drag: this.drag,\n      dragStop: this.dragStop\n    });\n  };\n  Group.prototype.initializeGHeaderDrop = function () {\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    var drop = new Droppable(this.element, {\n      accept: '.e-dragclone',\n      drop: this.drop\n    });\n  };\n  /**\n   * Groups a column by column name.\n   *\n   * @param  {string} columnName - Defines the column name to group.\n   * @returns {void}\n   */\n  Group.prototype.groupColumn = function (columnName) {\n    var gObj = this.parent;\n    var column = gObj.getColumnByField(columnName);\n    if (isNullOrUndefined(column) || column.allowGrouping === false || this.contentRefresh && this.groupSettings.columns.indexOf(columnName) > -1) {\n      this.parent.log('action_disabled_column', {\n        moduleName: this.getModuleName(),\n        columnName: column.headerText\n      });\n      return;\n    }\n    if (isActionPrevent(gObj)) {\n      gObj.notify(events.preventBatch, {\n        instance: this,\n        handler: this.groupColumn,\n        arg1: columnName\n      });\n      return;\n    }\n    column.visible = gObj.groupSettings.showGroupedColumn;\n    this.colName = columnName;\n    this.isAppliedGroup = true;\n    if (this.contentRefresh) {\n      this.updateModel();\n    } else {\n      this.addColToGroupDrop(columnName);\n    }\n    this.updateGroupDropArea();\n    this.isAppliedGroup = false;\n  };\n  /**\n   * Ungroups a column by column name.\n   *\n   * @param  {string} columnName - Defines the column name to ungroup.\n   * @returns {void}\n   */\n  Group.prototype.ungroupColumn = function (columnName) {\n    var gObj = this.parent;\n    var column = this.parent.enableColumnVirtualization ? this.parent.columns.filter(function (c) {\n      return c.field === columnName;\n    })[0] : gObj.getColumnByField(columnName);\n    if (isNullOrUndefined(column) || column.allowGrouping === false || this.groupSettings.columns.indexOf(columnName) < 0) {\n      return;\n    }\n    if (isActionPrevent(gObj)) {\n      gObj.notify(events.preventBatch, {\n        instance: this,\n        handler: this.ungroupColumn,\n        arg1: columnName\n      });\n      return;\n    }\n    column.visible = true;\n    this.colName = column.field;\n    var columns = JSON.parse(JSON.stringify(this.groupSettings.columns));\n    columns.splice(columns.indexOf(this.colName), 1);\n    if (this.sortedColumns.indexOf(columnName) < 0) {\n      for (var i = 0, len = gObj.sortSettings.columns.length; i < len; i++) {\n        if (columnName === gObj.sortSettings.columns[parseInt(i.toString(), 10)].field) {\n          gObj.sortSettings.columns.splice(i, 1);\n          break;\n        }\n      }\n    }\n    if (this.groupSettings.allowReordering) {\n      this.reorderingColumns = columns;\n    }\n    this.groupSettings.columns = columns;\n    if (gObj.allowGrouping) {\n      this.isAppliedUnGroup = true;\n      this.parent.dataBind();\n    }\n  };\n  /**\n   * The function used to update groupSettings\n   *\n   * @returns {void}\n   * @hidden\n   */\n  Group.prototype.updateModel = function () {\n    var columns = JSON.parse(JSON.stringify(this.groupSettings.columns));\n    columns = this.reorderingColumns.length ? JSON.parse(JSON.stringify(this.reorderingColumns)) : columns;\n    if (this.sortRequired) {\n      if (columns.indexOf(this.colName) === -1) {\n        columns.push(this.colName);\n      }\n      this.groupAddSortingQuery(this.colName);\n    }\n    this.sortRequired = true;\n    this.parent.groupSettings.columns = columns;\n    this.parent.dataBind();\n  };\n  /**\n   * The function used to trigger onActionComplete\n   *\n   * @param {NotifyArgs} e - specifies the NotifyArgs\n   * @returns {void}\n   * @hidden\n   */\n  Group.prototype.onActionComplete = function (e) {\n    if (e.requestType === 'grouping') {\n      this.addColToGroupDrop(this.colName);\n    } else {\n      this.removeColFromGroupDrop(this.colName);\n    }\n    var args = this.groupSettings.columns.indexOf(this.colName) > -1 ? {\n      columnName: this.colName,\n      requestType: 'grouping',\n      type: events.actionComplete\n    } : {\n      requestType: 'ungrouping',\n      type: events.actionComplete\n    };\n    this.parent.trigger(events.actionComplete, extend(e, args));\n    this.colName = null;\n  };\n  Group.prototype.groupAddSortingQuery = function (colName) {\n    var i = 0;\n    while (i < this.parent.sortSettings.columns.length) {\n      if (this.parent.sortSettings.columns[parseInt(i.toString(), 10)].field === colName) {\n        break;\n      }\n      i++;\n    }\n    if (this.parent.sortSettings.columns.length === i) {\n      this.parent.sortSettings.columns.push({\n        field: colName,\n        direction: 'Ascending',\n        isFromGroup: true\n      });\n    } else if (!this.parent.allowSorting) {\n      this.parent.sortSettings.columns[parseInt(i.toString(), 10)].direction = 'Ascending';\n    }\n  };\n  Group.prototype.createElement = function (field) {\n    var gObj = this.parent;\n    var direction = 'Ascending';\n    var animator = this.parent.createElement('div', {\n      className: 'e-grid-icon e-group-animator'\n    });\n    var groupedColumn = this.parent.createElement('div', {\n      className: 'e-grid-icon e-groupheadercell'\n    });\n    var childDiv = this.parent.createElement('div', {\n      attrs: {\n        'ej-mappingname': field\n      }\n    });\n    if (isComplexField(field)) {\n      childDiv.setAttribute('ej-complexname', getComplexFieldID(field));\n    }\n    var column = this.parent.getColumnByField(field);\n    //Todo headerTemplateID for grouped column, disableHtmlEncode\n    var headerCell = gObj.getColumnHeaderByUid(column.uid);\n    // if (!isNullOrUndefined(column.headerTemplate)) {\n    //     if (column.headerTemplate.indexOf('#') !== -1) {\n    //         childDiv.innerHTML = document.querySelector(column.headerTemplate).innerHTML.trim();\n    //     } else {\n    //         childDiv.innerHTML = column.headerTemplate;\n    //     }\n    //     childDiv.firstElementChild.classList.add('e-grouptext');\n    // } else {\n    if (this.groupSettings.allowReordering) {\n      childDiv.appendChild(this.parent.createElement('span', {\n        className: 'e-drag e-icons e-icon-drag',\n        innerHTML: '&nbsp;',\n        attrs: {\n          title: 'Drag',\n          tabindex: '-1',\n          'aria-label': this.l10n.getConstant('GroupedDrag')\n        }\n      }));\n    }\n    childDiv.appendChild(this.parent.createElement('span', {\n      className: 'e-grouptext',\n      innerHTML: column.headerText,\n      attrs: {\n        tabindex: '-1'\n      }\n    }));\n    // }\n    if (this.groupSettings.showToggleButton) {\n      childDiv.appendChild(this.parent.createElement('span', {\n        className: 'e-togglegroupbutton e-icons e-icon-ungroup e-toggleungroup',\n        innerHTML: '&nbsp;',\n        attrs: {\n          tabindex: '-1',\n          'aria-label': this.l10n.getConstant('UnGroupAria')\n        }\n      }));\n    }\n    if (headerCell.querySelectorAll('.e-ascending,.e-descending').length) {\n      direction = headerCell.querySelector('.e-ascending') ? 'Ascending' : 'Descending';\n    }\n    childDiv.appendChild(this.parent.createElement('span', {\n      className: 'e-groupsort e-icons ' + ('e-' + direction.toLowerCase() + ' e-icon-' + direction.toLowerCase()),\n      innerHTML: '&nbsp;',\n      attrs: {\n        tabindex: '-1',\n        'aria-label': this.l10n.getConstant('GroupedSortIcon') + column.headerText,\n        role: 'button'\n      }\n    }));\n    childDiv.appendChild(this.parent.createElement('span', {\n      className: 'e-ungroupbutton e-icons e-icon-hide',\n      innerHTML: '&nbsp;',\n      attrs: {\n        title: this.l10n.getConstant('UnGroup'),\n        tabindex: '-1',\n        'aria-label': this.l10n.getConstant('UnGroupIcon') + column.headerText,\n        role: 'button'\n      },\n      styles: this.groupSettings.showUngroupButton ? '' : 'display:none'\n    }));\n    groupedColumn.appendChild(childDiv);\n    if (this.groupSettings.allowReordering) {\n      animator.appendChild(groupedColumn);\n      animator.appendChild(this.createSeparator());\n      groupedColumn = animator;\n    }\n    return groupedColumn;\n  };\n  Group.prototype.addColToGroupDrop = function (field) {\n    var groupElem = isComplexField(field) ? this.parent.element.querySelector('.e-groupdroparea div[ej-complexname=' + getParsedFieldID(getComplexFieldID(field)) + ']') : this.parent.element.querySelector('.e-groupdroparea div[ej-mappingname=' + getParsedFieldID(field) + ']');\n    if (this.groupSettings.allowReordering && groupElem) {\n      return;\n    }\n    var column = this.parent.getColumnByField(field);\n    if (isNullOrUndefined(column)) {\n      return;\n    }\n    var groupedColumn = this.createElement(field);\n    if (this.groupSettings.allowReordering) {\n      var index = this.element.getElementsByClassName('e-group-animator').length;\n      groupedColumn.setAttribute('index', index.toString());\n    }\n    this.element.appendChild(groupedColumn);\n    var focusModule = this.parent.focusModule;\n    focusModule.setActive(true);\n    var firstContentCellIndex = [0, 0];\n    if (focusModule.active.matrix.matrix[firstContentCellIndex[0]][firstContentCellIndex[1]] === 0) {\n      firstContentCellIndex = findCellIndex(focusModule.active.matrix.matrix, firstContentCellIndex, true);\n    }\n    focusModule.active.matrix.current = firstContentCellIndex;\n    focusModule.active.getTable().rows[focusModule.active.matrix.current[0]].cells[focusModule.active.matrix.current[1]].focus();\n    //Todo:  rtl\n  };\n  Group.prototype.createSeparator = function () {\n    return this.parent.createElement('span', {\n      className: 'e-nextgroup e-icons e-icon-next',\n      innerHTML: '&nbsp;',\n      attrs: {\n        tabindex: '-1',\n        'aria-label': this.l10n.getConstant('GroupSeperator')\n      },\n      styles: this.groupSettings.showUngroupButton ? '' : 'display:none'\n    });\n  };\n  Group.prototype.refreshToggleBtn = function (isRemove) {\n    if (this.groupSettings.showToggleButton) {\n      var headers = [].slice.call(this.parent.getHeaderTable().getElementsByClassName('e-headercelldiv'));\n      for (var i = 0, len = headers.length; i < len; i++) {\n        if (!(headers[parseInt(i.toString(), 10)].classList.contains('e-emptycell') || headers[parseInt(i.toString(), 10)].classList.contains('e-headerchkcelldiv'))) {\n          var column = this.parent.getColumnByUid(headers[parseInt(i.toString(), 10)].getAttribute('e-mappinguid'));\n          if (!this.parent.showColumnMenu || this.parent.showColumnMenu && !column.showColumnMenu) {\n            if (headers[parseInt(i.toString(), 10)].getElementsByClassName('e-grptogglebtn').length) {\n              remove(headers[parseInt(i.toString(), 10)].querySelectorAll('.e-grptogglebtn')[0]);\n            }\n            if (!isRemove) {\n              headers[parseInt(i.toString(), 10)].appendChild(this.parent.createElement('span', {\n                className: 'e-grptogglebtn e-icons ' + (this.groupSettings.columns.indexOf(column.field) > -1 ? 'e-toggleungroup e-icon-ungroup' : 'e-togglegroup e-icon-group'),\n                attrs: {\n                  tabindex: '-1',\n                  'aria-label': isNullOrUndefined(this.l10n) ? this.parent.localeObj.getConstant('GroupButton') : this.l10n.getConstant('GroupButton')\n                }\n              }));\n            }\n          }\n        }\n      }\n    }\n  };\n  Group.prototype.removeColFromGroupDrop = function (field) {\n    if (!isNullOrUndefined(this.getGHeaderCell(field))) {\n      var elem = this.getGHeaderCell(field);\n      if (this.groupSettings.allowReordering) {\n        var parent_1 = parentsUntil(elem, 'e-group-animator');\n        remove(parent_1);\n      } else {\n        remove(elem);\n      }\n      this.updateGroupDropArea();\n    }\n    this.isAppliedUnGroup = false;\n  };\n  Group.prototype.onPropertyChanged = function (e) {\n    if (e.module !== this.getModuleName()) {\n      return;\n    }\n    for (var _i = 0, _a = Object.keys(e.properties); _i < _a.length; _i++) {\n      var prop = _a[_i];\n      switch (prop) {\n        case 'columns':\n          // eslint-disable-next-line no-case-declarations\n          var args = void 0;\n          if (this.contentRefresh) {\n            if (!this.isAppliedUnGroup) {\n              if (!this.isAppliedGroup) {\n                this.updateGroupDropArea(true);\n                for (var j = 0; j < this.parent.sortSettings.columns.length; j++) {\n                  if (this.parent.sortSettings.columns[parseInt(j.toString(), 10)].isFromGroup) {\n                    this.parent.sortSettings.columns.splice(j, 1);\n                    j--;\n                  }\n                }\n                for (var i = 0; i < this.groupSettings.columns.length; i++) {\n                  this.colName = this.groupSettings.columns[parseInt(i.toString(), 10)];\n                  var col = this.parent.getColumnByField(this.colName);\n                  col.visible = this.parent.groupSettings.showGroupedColumn;\n                  this.groupAddSortingQuery(this.colName);\n                  if (i < this.groupSettings.columns.length - 1) {\n                    this.addColToGroupDrop(this.groupSettings.columns[parseInt(i.toString(), 10)]);\n                  }\n                }\n              }\n              args = {\n                columnName: this.colName,\n                requestType: e.properties[\"\" + prop].length ? 'grouping' : 'ungrouping',\n                type: events.actionBegin\n              };\n            } else {\n              args = {\n                columnName: this.colName,\n                requestType: 'ungrouping',\n                type: events.actionBegin\n              };\n            }\n            if (!this.groupSettings.showGroupedColumn) {\n              var columns = e.oldProperties[\"\" + prop];\n              for (var i = 0; i < columns.length; i++) {\n                if (e.properties[\"\" + prop].indexOf(columns[parseInt(i.toString(), 10)]) === -1) {\n                  this.parent.getColumnByField(columns[parseInt(i.toString(), 10)]).visible = true;\n                }\n              }\n            }\n            this.parent.notify(events.modelChanged, args);\n          }\n          break;\n        case 'showDropArea':\n          this.updateGroupDropArea();\n          if (this.groupSettings.showDropArea) {\n            this.element.style.display = '';\n            this.parent.headerModule.refreshUI();\n          } else {\n            this.element.style.display = 'none';\n          }\n          if (this.parent.height === '100%') {\n            this.parent.scrollModule.refresh();\n          }\n          break;\n        case 'showGroupedColumn':\n          this.updateGroupedColumn(this.groupSettings.showGroupedColumn);\n          this.parent.notify(events.modelChanged, {\n            requestType: 'refresh'\n          });\n          break;\n        case 'showUngroupButton':\n          this.updateButtonVisibility(this.groupSettings.showUngroupButton, 'e-ungroupbutton');\n          break;\n        case 'showToggleButton':\n          this.updateButtonVisibility(this.groupSettings.showToggleButton, 'e-togglegroupbutton ');\n          this.parent.refreshHeader();\n          break;\n        case 'enableLazyLoading':\n          this.parent.freezeRefresh();\n          break;\n      }\n    }\n  };\n  Group.prototype.updateGroupedColumn = function (isVisible) {\n    for (var i = 0; i < this.groupSettings.columns.length; i++) {\n      this.parent.getColumnByField(this.groupSettings.columns[parseInt(i.toString(), 10)]).visible = isVisible;\n    }\n  };\n  Group.prototype.updateButtonVisibility = function (isVisible, className) {\n    var gHeader = [].slice.call(this.element.getElementsByClassName(className));\n    for (var i = 0; i < gHeader.length; i++) {\n      gHeader[parseInt(i.toString(), 10)].style.display = isVisible ? '' : 'none';\n    }\n  };\n  Group.prototype.enableAfterRender = function (e) {\n    if (e.module === this.getModuleName() && e.enable) {\n      this.render();\n    }\n  };\n  /**\n   * To destroy the reorder\n   *\n   * @returns {void}\n   * @hidden\n   */\n  Group.prototype.destroy = function () {\n    var gridElement = this.parent.element;\n    if (!gridElement || !gridElement.querySelector('.' + literals.gridHeader) && !gridElement.querySelector('.' + literals.gridContent)) {\n      return;\n    }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    if ((this.parent.isDestroyed || !this.parent.allowGrouping) && !this.parent.refreshing) {\n      this.clearGrouping();\n    }\n    this.unWireEvent();\n    this.removeEventListener();\n    this.refreshToggleBtn(true);\n    if (this.element.parentNode) {\n      remove(this.element);\n    }\n    //call ejdrag and drop destroy\n  };\n  /**\n   * Clears all the grouped columns of the Grid.\n   *\n   * @returns {void}\n   */\n  Group.prototype.clearGrouping = function () {\n    var cols = JSON.parse(JSON.stringify(this.groupSettings.columns));\n    this.contentRefresh = false;\n    for (var i = 0, len = cols.length; i < len; i++) {\n      if (i === len - 1) {\n        this.contentRefresh = true;\n      }\n      this.ungroupColumn(cols[parseInt(i.toString(), 10)]);\n    }\n    this.contentRefresh = true;\n  };\n  /**\n   * For internal use only - Get the module name.\n   *\n   * @returns {string} returns the module name\n   * @private\n   */\n  Group.prototype.getModuleName = function () {\n    return 'group';\n  };\n  Group.prototype.refreshSortIcons = function () {\n    var gObj = this.parent;\n    var header;\n    var cols = gObj.sortSettings.columns;\n    var gCols = gObj.groupSettings.columns;\n    var fieldNames = this.parent.getColumns().map(function (c) {\n      return c.field;\n    });\n    this.refreshToggleBtn();\n    for (var i = 0, len = cols.length; i < len; i++) {\n      if (fieldNames.indexOf(cols[parseInt(i.toString(), 10)].field) === -1) {\n        continue;\n      }\n      header = gObj.getColumnHeaderByField(cols[parseInt(i.toString(), 10)].field);\n      if (!gObj.allowSorting && (this.sortedColumns.indexOf(cols[parseInt(i.toString(), 10)].field) > -1 || this.groupSettings.columns.indexOf(cols[parseInt(i.toString(), 10)].field) > -1)) {\n        classList(header.querySelector('.e-sortfilterdiv'), ['e-ascending', 'e-icon-ascending'], []);\n        if (cols.length > 1) {\n          header.querySelector('.e-headercelldiv').appendChild(this.parent.createElement('span', {\n            className: 'e-sortnumber',\n            innerHTML: (i + 1).toString()\n          }));\n        }\n      } else if (this.getGHeaderCell(cols[parseInt(i.toString(), 10)].field) && this.getGHeaderCell(cols[parseInt(i.toString(), 10)].field).getElementsByClassName('e-groupsort').length) {\n        if (cols[parseInt(i.toString(), 10)].direction === 'Ascending') {\n          classList(this.getGHeaderCell(cols[parseInt(i.toString(), 10)].field).querySelector('.e-groupsort'), ['e-ascending', 'e-icon-ascending'], ['e-descending', 'e-icon-descending']);\n        } else {\n          classList(this.getGHeaderCell(cols[parseInt(i.toString(), 10)].field).querySelector('.e-groupsort'), ['e-descending', 'e-icon-descending'], ['e-ascending', 'e-icon-ascending']);\n        }\n      }\n    }\n    for (var i = 0, len = gCols.length; i < len; i++) {\n      if (fieldNames.indexOf(gCols[parseInt(i.toString(), 10)]) === -1) {\n        continue;\n      }\n      gObj.getColumnHeaderByField(gCols[parseInt(i.toString(), 10)]).setAttribute('aria-grouped', 'true');\n    }\n  };\n  Group.prototype.getGHeaderCell = function (field) {\n    if (this.element && this.element.querySelector('[ej-mappingname=\"' + field + '\"]')) {\n      return this.element.querySelector('[ej-mappingname=\"' + field + '\"]').parentElement;\n    }\n    return null;\n  };\n  Group.prototype.onGroupAggregates = function (editedData) {\n    if (this.parent.groupSettings.enableLazyLoading) {\n      if (this.parent.editSettings.mode !== 'Batch') {\n        this.updateLazyLoadGroupAggregates(editedData);\n      }\n      return;\n    }\n    var aggregates = this.iterateGroupAggregates(editedData);\n    var rowData = this.groupGenerator.generateRows(aggregates, {});\n    var summaryRows = this.parent.getRowsObject().filter(function (row) {\n      return !row.isDataRow;\n    });\n    var updateSummaryRows = rowData.filter(function (data) {\n      return !data.isDataRow;\n    });\n    if (this.parent.isReact || this.parent.isVue) {\n      this.parent.destroyTemplate(['groupFooterTemplate', 'groupCaptionTemplate', 'footerTemplate']);\n    }\n    for (var i = 0; i < updateSummaryRows.length; i++) {\n      var row = updateSummaryRows[parseInt(i.toString(), 10)];\n      var cells = row.cells.filter(function (cell) {\n        return cell.isDataCell;\n      });\n      var args = {\n        cells: cells,\n        data: row.data,\n        dataUid: summaryRows[parseInt(i.toString(), 10)] ? summaryRows[parseInt(i.toString(), 10)].uid : ''\n      };\n      this.parent.notify(events.refreshAggregateCell, args);\n    }\n  };\n  Group.prototype.updateLazyLoadGroupAggregates = function (data, remoteResult) {\n    var _this = this;\n    var groupCaptionTemplates = this.getGroupAggregateTemplates(true);\n    var groupFooterTemplates = this.getGroupAggregateTemplates(false);\n    if (!groupCaptionTemplates.length && !groupFooterTemplates.length) {\n      return;\n    }\n    var gObj = this.parent;\n    var isRemote = gObj.getDataModule().isRemote();\n    var updatedData = data[0];\n    var editedRow = data.row;\n    var groupedCols = gObj.groupSettings.columns;\n    var groupLazyLoadRenderer = gObj.contentModule;\n    var groupCache = groupLazyLoadRenderer.getGroupCache();\n    var currentPageGroupCache = groupCache[gObj.pageSettings.currentPage];\n    var result = remoteResult ? remoteResult : [];\n    var _loop_1 = function (i) {\n      var groupField = groupedCols[parseInt(i.toString(), 10)];\n      var groupKey = updatedData[\"\" + groupField];\n      var groupCaptionRowObject = this_1.getGroupCaptionRowObject(editedRow, groupedCols.length - i);\n      if (isRemote && result.length) {\n        if (i !== 0) {\n          var prevGroupField = groupedCols[i - 1];\n          var prevGroupKey_1 = updatedData[\"\" + prevGroupField];\n          result = result.find(function (data) {\n            return data.key === prevGroupKey_1;\n          }).items;\n        }\n        this_1.updateLazyLoadGroupAggregatesRow(result, groupKey, groupCaptionRowObject, currentPageGroupCache, groupCaptionTemplates, groupFooterTemplates);\n      } else {\n        var query = gObj.renderModule.data.generateQuery();\n        if (i !== 0) {\n          var currentLevelCaptionRowObjects = currentPageGroupCache.filter(function (data) {\n            return data.isCaptionRow && data.parentUid === groupCaptionRowObject.parentUid;\n          });\n          var index = currentLevelCaptionRowObjects.indexOf(groupCaptionRowObject);\n          var fields = gObj.groupSettings.columns.slice(0, i).reverse();\n          var keys = fields.map(function (data) {\n            return updatedData[\"\" + data];\n          });\n          var pred = generateExpandPredicates(fields, keys, groupLazyLoadRenderer);\n          var predicateList = getPredicates(pred);\n          var lazyLoad = {\n            level: i,\n            skip: index,\n            take: 1,\n            where: predicateList\n          };\n          query.lazyLoad.push({\n            key: 'onDemandGroupInfo',\n            value: lazyLoad\n          });\n        }\n        gObj.renderModule.data.getData({}, query).then(function (e) {\n          if (isRemote) {\n            _this.updateLazyLoadGroupAggregates(data, e.result);\n          } else {\n            _this.updateLazyLoadGroupAggregatesRow(e.result, groupKey, groupCaptionRowObject, currentPageGroupCache, groupCaptionTemplates, groupFooterTemplates);\n          }\n          if (i === groupedCols.length - 1 || isRemote) {\n            _this.destroyRefreshGroupCaptionFooterTemplate();\n          }\n        }).catch(function (e) {\n          return gObj.renderModule.dataManagerFailure(e, {\n            requestType: 'grouping'\n          });\n        });\n        if (isRemote) {\n          return \"break\";\n        }\n      }\n    };\n    var this_1 = this;\n    for (var i = 0; i < groupedCols.length; i++) {\n      var state_1 = _loop_1(i);\n      if (state_1 === \"break\") break;\n    }\n  };\n  Group.prototype.destroyRefreshGroupCaptionFooterTemplate = function () {\n    var gObj = this.parent;\n    if (gObj.isAngular || gObj.isReact || gObj.isVue) {\n      gObj.destroyTemplate(['groupCaptionTemplate', 'groupFooterTemplate']);\n    }\n    gObj.refreshGroupCaptionFooterTemplate();\n    gObj.removeMaskRow();\n    gObj.hideSpinner();\n  };\n  Group.prototype.updateLazyLoadGroupAggregatesRow = function (result, groupKey, groupCaptionRowObject, currentPageGroupCache, groupCaptionTemplates, groupFooterTemplates) {\n    var updatedGroupCaptionData = result.find(function (data) {\n      return data.key === groupKey;\n    });\n    if (groupCaptionTemplates.length) {\n      this.updateLazyLoadGroupAggregatesCell(updatedGroupCaptionData, groupCaptionRowObject, groupCaptionTemplates);\n    }\n    if (groupFooterTemplates.length) {\n      var groupFooterRowObject = currentPageGroupCache.find(function (data) {\n        return data.isAggregateRow && data.parentUid === groupCaptionRowObject.uid;\n      });\n      this.updateLazyLoadGroupAggregatesCell(updatedGroupCaptionData, groupFooterRowObject, groupFooterTemplates);\n    }\n  };\n  Group.prototype.updateLazyLoadGroupAggregatesCell = function (updatedGroupCaptionData, captionFooterRowObject, captionFooterTemplates) {\n    var prevCaptionFooterData = captionFooterRowObject.data;\n    var updatedGroupCaptionDataAggregates = updatedGroupCaptionData.aggregates;\n    if (captionFooterRowObject.isCaptionRow) {\n      prevCaptionFooterData.aggregates = updatedGroupCaptionDataAggregates;\n    }\n    for (var i = 0; i < captionFooterTemplates.length; i++) {\n      var template = captionFooterTemplates[parseInt(i.toString(), 10)];\n      var key = template.field + ' - ' + template.type;\n      var fieldData = prevCaptionFooterData[template.field];\n      fieldData[\"\" + key] = updatedGroupCaptionDataAggregates[\"\" + key];\n      fieldData[capitalizeFirstLetter(template.type)] = updatedGroupCaptionDataAggregates[\"\" + key];\n      if (fieldData[template.type]) {\n        fieldData[template.type] = updatedGroupCaptionDataAggregates[\"\" + key];\n      }\n    }\n  };\n  Group.prototype.getGroupCaptionRowObject = function (element, groupCaptionIndex) {\n    var gObj = this.parent;\n    var uid = element.getAttribute('data-uid');\n    var parentCaptionRowObject = gObj.getRowObjectFromUID(uid);\n    for (var i = 0; i < groupCaptionIndex; i++) {\n      parentCaptionRowObject = gObj.getRowObjectFromUID(parentCaptionRowObject.parentUid);\n    }\n    return parentCaptionRowObject;\n  };\n  /**\n   * @param { boolean } groupCaptionTemplate - Defines template either group caption or footer\n   * @returns { Object[] } - Returns template array\n   * @hidden\n   */\n  Group.prototype.getGroupAggregateTemplates = function (groupCaptionTemplate) {\n    var aggregates = [];\n    var aggregateRows = this.parent.aggregates;\n    for (var j = 0; j < aggregateRows.length; j++) {\n      var row = aggregateRows[parseInt(j.toString(), 10)];\n      for (var k = 0; k < row.columns.length; k++) {\n        if (groupCaptionTemplate && row.columns[parseInt(k.toString(), 10)].groupCaptionTemplate || !groupCaptionTemplate && row.columns[parseInt(k.toString(), 10)].groupFooterTemplate) {\n          var aggr = {};\n          var type = row.columns[parseInt(k.toString(), 10)].type.toString();\n          aggr = {\n            type: type.toLowerCase(),\n            field: row.columns[parseInt(k.toString(), 10)].field\n          };\n          aggregates.push(aggr);\n        }\n      }\n    }\n    return aggregates;\n  };\n  /**\n   * @param { Row<Column> } fromRowObj - Defines group key changed Data row object.\n   * @param { Row<Column> } toRowObj - Defines group key setting reference Data row object.\n   * @returns { void }\n   * @hidden\n   */\n  Group.prototype.groupedRowReorder = function (fromRowObj, toRowObj) {\n    var dragRow = this.parent.getRowElementByUID(fromRowObj.uid);\n    var dropRow = this.parent.getRowElementByUID(toRowObj.uid);\n    var dropArgs = {\n      rows: [dragRow],\n      target: dropRow,\n      fromIndex: fromRowObj.index,\n      dropIndex: toRowObj.index\n    };\n    if (!isNullOrUndefined(fromRowObj) && !isNullOrUndefined(toRowObj) && fromRowObj.parentUid !== toRowObj.parentUid) {\n      if (dropRow) {\n        if (dropRow['style'].display === 'none') {\n          dragRow['style'].display = 'none';\n        }\n        if (dropArgs.fromIndex > dropArgs.dropIndex) {\n          this.parent.getContentTable().querySelector(literals.tbody).insertBefore(dragRow, dropRow);\n        } else {\n          this.parent.getContentTable().querySelector(literals.tbody).insertBefore(dragRow, dropRow.nextSibling);\n        }\n      } else {\n        remove(dragRow);\n      }\n      this.groupReorderHandler(fromRowObj, toRowObj);\n      var tr = [].slice.call(this.parent.getContentTable().getElementsByClassName(literals.row));\n      this.groupReorderRowObject(dropArgs, tr, toRowObj);\n      if (this.parent.enableVirtualization) {\n        this.vGroupResetRowIndex();\n      } else {\n        resetRowIndex(this.parent, this.parent.getRowsObject().filter(function (data) {\n          return data.isDataRow;\n        }), tr);\n      }\n      this.parent.notify(events.refreshExpandandCollapse, {\n        rows: this.parent.getRowsObject()\n      });\n    }\n  };\n  Group.prototype.vGroupResetRowIndex = function () {\n    var gObj = this.parent;\n    var rowObjects = gObj.vRows;\n    var rowElements = this.parent.getRows();\n    for (var i = 0, startIdx = 0, k = 0; i < rowObjects.length; i++) {\n      if (rowObjects[parseInt(i.toString(), 10)].isDataRow) {\n        rowObjects[parseInt(i.toString(), 10)].index = startIdx;\n        rowObjects[parseInt(i.toString(), 10)].isAltRow = gObj.enableAltRow ? startIdx % 2 !== 0 : false;\n        var rowElement = gObj.getRowElementByUID(rowObjects[parseInt(i.toString(), 10)].uid);\n        if (!isNullOrUndefined(rowElement)) {\n          rowElements[parseInt(k.toString(), 10)] = rowElement;\n          rowElement.setAttribute(literals.dataRowIndex, startIdx.toString());\n          rowElement.setAttribute(literals.ariaRowIndex, (startIdx + 1).toString());\n          if (rowObjects[parseInt(i.toString(), 10)].isAltRow) {\n            rowElement.classList.add('e-altrow');\n          } else {\n            rowElement.classList.remove('e-altrow');\n          }\n          for (var j = 0; j < rowElement.cells.length; j++) {\n            rowElement.cells[parseInt(j.toString(), 10)].setAttribute('index', startIdx.toString());\n          }\n          k++;\n        }\n        startIdx++;\n      }\n    }\n  };\n  Group.prototype.groupReorderHandler = function (dragRowObject, dropRowObject) {\n    var gObj = this.parent;\n    var dragRowObjectData = dragRowObject.data;\n    var dropRowObjectData = dropRowObject.data;\n    var groupAggregateTemplate = gObj['groupModule'].getGroupAggregateTemplates(false);\n    var dropParentRowObject = gObj.getRowObjectFromUID(dropRowObject.parentUid);\n    var dragParentRowObject = gObj.getRowObjectFromUID(dragRowObject.parentUid);\n    var dropRootParentRowObjects = [dropParentRowObject];\n    var dragRootParentRowObjects = [dragParentRowObject];\n    var groupColumns = gObj.groupSettings.columns;\n    for (var j = 0; j < groupColumns.length; j++) {\n      dragRowObjectData[groupColumns[parseInt(j.toString(), 10)]] = dropRowObjectData[groupColumns[parseInt(j.toString(), 10)]];\n      if (j > 0) {\n        dropRootParentRowObjects.push(gObj.getRowObjectFromUID(dropRootParentRowObjects[j - 1].parentUid));\n        dragRootParentRowObjects.push(gObj.getRowObjectFromUID(dragRootParentRowObjects[j - 1].parentUid));\n      }\n    }\n    dragRowObject.parentUid = dropRowObject.parentUid;\n    dragRowObject.visible = dropRowObject.visible;\n    dragRowObject['parentGid'] = dropRowObject['parentGid'];\n    if (dragRowObject.changes !== dragRowObjectData) {\n      dragRowObject.changes = dragRowObjectData;\n    }\n    var updatedCurrentViewData = this.iterateGroupAggregates([{\n      dragRowObjects: dragRootParentRowObjects,\n      dropRowObjects: dropRootParentRowObjects\n    }]);\n    var updatedDragCurrentViewData = updatedCurrentViewData.filter(function (object) {\n      return object['key'] === dragRootParentRowObjects[dragRootParentRowObjects.length - 1].data['key'] || object['key'] instanceof Date && object['key'].toString() === dragRootParentRowObjects[dragRootParentRowObjects.length - 1].data['key'].toString();\n    });\n    var updatedDropCurrentViewData = updatedCurrentViewData.filter(function (object) {\n      return object['key'] === dropRootParentRowObjects[dropRootParentRowObjects.length - 1].data['key'] || object['key'] instanceof Date && object['key'].toString() === dropRootParentRowObjects[dropRootParentRowObjects.length - 1].data['key'].toString();\n    });\n    updatedCurrentViewData = [];\n    if (!isNullOrUndefined(updatedDragCurrentViewData[0])) {\n      updatedCurrentViewData.push(updatedDragCurrentViewData[0]);\n    }\n    if (!isNullOrUndefined(updatedDropCurrentViewData[0])) {\n      updatedCurrentViewData.push(updatedDropCurrentViewData[0]);\n    }\n    var currentViewData = gObj.currentViewData;\n    for (var i = 0; i < currentViewData.length; i++) {\n      if (isNullOrUndefined(updatedDragCurrentViewData[0]) && currentViewData[parseInt(i.toString(), 10)]['key'] === dragRootParentRowObjects[dragRootParentRowObjects.length - 1].data['key']) {\n        currentViewData.splice(i, 1);\n        i--;\n      } else if (isNullOrUndefined(updatedDropCurrentViewData[0]) && currentViewData[parseInt(i.toString(), 10)]['key'] === dropRootParentRowObjects[dropRootParentRowObjects.length - 1].data['key']) {\n        currentViewData.splice(i, 1);\n        i--;\n      } else if (!isNullOrUndefined(updatedDragCurrentViewData[0]) && currentViewData[parseInt(i.toString(), 10)]['key'] === updatedDragCurrentViewData[0]['key']) {\n        currentViewData[parseInt(i.toString(), 10)] = updatedDragCurrentViewData[0];\n      } else if (!isNullOrUndefined(updatedDropCurrentViewData[0]) && currentViewData[parseInt(i.toString(), 10)]['key'] === updatedDropCurrentViewData[0]['key']) {\n        currentViewData[parseInt(i.toString(), 10)] = updatedDropCurrentViewData[0];\n      }\n    }\n    var updatedRowObject = this.groupGenerator.generateRows(updatedCurrentViewData, {});\n    var dragRootParentAggregateRowObject = [];\n    var dropRootParentAggregateRowObject = [];\n    for (var i = 0; i < dragRootParentRowObjects.length; i++) {\n      dragRootParentAggregateRowObject.push.apply(dragRootParentAggregateRowObject, this.getGroupParentFooterAggregateRowObject(dragRootParentRowObjects[parseInt(i.toString(), 10)].uid));\n    }\n    for (var i = 0; i < dropRootParentRowObjects.length; i++) {\n      dropRootParentAggregateRowObject.push.apply(dropRootParentAggregateRowObject, this.getGroupParentFooterAggregateRowObject(dropRootParentRowObjects[parseInt(i.toString(), 10)].uid));\n    }\n    dragRootParentRowObjects.push.apply(dragRootParentRowObjects, dragRootParentAggregateRowObject);\n    dropRootParentRowObjects.push.apply(dropRootParentRowObjects, dropRootParentAggregateRowObject);\n    this.updatedRowObjChange(dragRootParentRowObjects, updatedRowObject, groupAggregateTemplate);\n    this.updatedRowObjChange(dropRootParentRowObjects, updatedRowObject, groupAggregateTemplate);\n    this.groupReorderRefreshHandler(dragRowObject, dragParentRowObject, dropParentRowObject, groupAggregateTemplate);\n  };\n  Group.prototype.updatedRowObjChange = function (rootParentRowObjects, updatedRowObj, groupAggregateTemplate) {\n    var gObj = this.parent;\n    var rowObjects = gObj.getRowsObject();\n    var cache = {};\n    var virtualCacheRowObjects = [];\n    if (gObj.enableVirtualization) {\n      cache = gObj.contentModule['vgenerator'].cache;\n      virtualCacheRowObjects = gObj.vcRows;\n    }\n    for (var i = 0; i < rootParentRowObjects.length; i++) {\n      var keyPresent = false;\n      for (var j = 0; j < updatedRowObj.length; j++) {\n        if (!isNullOrUndefined(updatedRowObj[parseInt(j.toString(), 10)]) && !isNullOrUndefined(rootParentRowObjects[parseInt(i.toString(), 10)].data['key']) && !isNullOrUndefined(updatedRowObj[parseInt(j.toString(), 10)].data['key']) && (rootParentRowObjects[parseInt(i.toString(), 10)].data['key'] === updatedRowObj[parseInt(j.toString(), 10)].data['key'] || rootParentRowObjects[parseInt(i.toString(), 10)].data['key'] instanceof Date && rootParentRowObjects[parseInt(i.toString(), 10)].data['key'].toString() === updatedRowObj[parseInt(j.toString(), 10)].data['key'].toString())) {\n          var index = rowObjects.indexOf(rootParentRowObjects[parseInt(i.toString(), 10)]);\n          if (index !== -1) {\n            rowObjects[parseInt(index.toString(), 10)].data = updatedRowObj[parseInt(j.toString(), 10)].data;\n            rowObjects[parseInt(index.toString(), 10)]['gSummary'] = updatedRowObj[parseInt(j.toString(), 10)]['gSummary'];\n          }\n          if (gObj.enableVirtualization) {\n            var vIndex = virtualCacheRowObjects.indexOf(rootParentRowObjects[parseInt(i.toString(), 10)]);\n            if (vIndex !== -1) {\n              virtualCacheRowObjects[parseInt(vIndex.toString(), 10)].data = updatedRowObj[parseInt(j.toString(), 10)].data;\n              virtualCacheRowObjects[parseInt(vIndex.toString(), 10)]['gSummary'] = updatedRowObj[parseInt(j.toString(), 10)]['gSummary'];\n            }\n          }\n          rootParentRowObjects[parseInt(i.toString(), 10)].data = updatedRowObj[parseInt(j.toString(), 10)].data;\n          rootParentRowObjects[parseInt(i.toString(), 10)]['gSummary'] = updatedRowObj[parseInt(j.toString(), 10)]['gSummary'];\n          updatedRowObj.splice(j, 1);\n          j--;\n          keyPresent = true;\n          break;\n        } else if (rootParentRowObjects[parseInt(i.toString(), 10)].isAggregateRow && updatedRowObj[parseInt(j.toString(), 10)].isAggregateRow) {\n          for (var l = 0; l < groupAggregateTemplate.length; l++) {\n            if (this.evaluateGroupAggregateValueChange(rootParentRowObjects[parseInt(i.toString(), 10)], updatedRowObj[parseInt(j.toString(), 10)], groupAggregateTemplate[parseInt(l.toString(), 10)])) {\n              var index = rowObjects.indexOf(rootParentRowObjects[parseInt(i.toString(), 10)]);\n              if (index !== -1) {\n                rowObjects[parseInt(index.toString(), 10)].data = updatedRowObj[parseInt(j.toString(), 10)].data;\n                rowObjects[parseInt(index.toString(), 10)]['gSummary'] = updatedRowObj[parseInt(j.toString(), 10)]['gSummary'];\n              }\n              if (gObj.enableVirtualization) {\n                var vIndex = virtualCacheRowObjects.indexOf(rootParentRowObjects[parseInt(i.toString(), 10)]);\n                if (vIndex !== -1) {\n                  virtualCacheRowObjects[parseInt(vIndex.toString(), 10)].data = updatedRowObj[parseInt(j.toString(), 10)].data;\n                  virtualCacheRowObjects[parseInt(vIndex.toString(), 10)]['gSummary'] = updatedRowObj[parseInt(j.toString(), 10)]['gSummary'];\n                }\n              }\n              rootParentRowObjects[parseInt(i.toString(), 10)].data = updatedRowObj[parseInt(j.toString(), 10)].data;\n              rootParentRowObjects[parseInt(i.toString(), 10)]['gSummary'] = updatedRowObj[parseInt(j.toString(), 10)]['gSummary'];\n              keyPresent = true;\n              break;\n            }\n          }\n          if (keyPresent) {\n            break;\n          }\n        }\n      }\n      if (!keyPresent) {\n        var removeElem = gObj.getRowElementByUID(rootParentRowObjects[parseInt(i.toString(), 10)].uid);\n        if (!isNullOrUndefined(removeElem)) {\n          remove(removeElem);\n        }\n        rowObjects.splice(rowObjects.indexOf(rootParentRowObjects[parseInt(i.toString(), 10)]), 1);\n        if (gObj.enableVirtualization) {\n          virtualCacheRowObjects.splice(virtualCacheRowObjects.indexOf(rootParentRowObjects[parseInt(i.toString(), 10)]), 1);\n          for (var k = 1; k <= Object.keys(cache).length; k++) {\n            var vcIndex = cache[parseInt(k.toString(), 10)].indexOf(rootParentRowObjects[parseInt(i.toString(), 10)]);\n            if (vcIndex !== -1) {\n              cache[parseInt(k.toString(), 10)].splice([parseInt(vcIndex.toString(), 10)], 1);\n            }\n          }\n        }\n      }\n    }\n  };\n  Group.prototype.groupReorderRefreshHandler = function (dragRowObject, dragParentRowObject, dropParentRowObject, groupAggregateTemplate) {\n    var gObj = this.parent;\n    var row = new RowRenderer(gObj['serviceLocator'], null, gObj);\n    if (!isNullOrUndefined(dragRowObject) && !isNullOrUndefined(gObj.getRowElementByUID(dragRowObject.uid))) {\n      row.refresh(dragRowObject, gObj.getColumns(), false);\n    }\n    for (var j = 0; j < gObj.groupSettings.columns.length; j++) {\n      if (!isNullOrUndefined(dragParentRowObject) && !isNullOrUndefined(gObj.getRowElementByUID(dragParentRowObject.uid))) {\n        row.refresh(dragParentRowObject, gObj.getColumns(), false);\n      }\n      if (!isNullOrUndefined(dropParentRowObject) && !isNullOrUndefined(gObj.getRowElementByUID(dropParentRowObject.uid))) {\n        row.refresh(dropParentRowObject, gObj.getColumns(), false);\n      }\n      if (groupAggregateTemplate.length) {\n        var dragParentFooterAggregateRowObjects = !isNullOrUndefined(dragParentRowObject) ? this.getGroupParentFooterAggregateRowObject(dragParentRowObject.uid) : [];\n        var dropParentFooterAggregateRowObjects = !isNullOrUndefined(dropParentRowObject) ? this.getGroupParentFooterAggregateRowObject(dropParentRowObject.uid) : [];\n        for (var k = 0; k < dropParentFooterAggregateRowObjects.length; k++) {\n          if (!isNullOrUndefined(dropParentFooterAggregateRowObjects[parseInt(k.toString(), 10)]) && !isNullOrUndefined(gObj.getRowElementByUID(dropParentFooterAggregateRowObjects[parseInt(k.toString(), 10)].uid))) {\n            row.refresh(dropParentFooterAggregateRowObjects[parseInt(k.toString(), 10)], gObj.getColumns(), false);\n          }\n        }\n        for (var k = 0; k < dragParentFooterAggregateRowObjects.length; k++) {\n          if (!isNullOrUndefined(dragParentFooterAggregateRowObjects[parseInt(k.toString(), 10)]) && !isNullOrUndefined(gObj.getRowElementByUID(dragParentFooterAggregateRowObjects[parseInt(k.toString(), 10)].uid))) {\n            row.refresh(dragParentFooterAggregateRowObjects[parseInt(k.toString(), 10)], gObj.getColumns(), false);\n          }\n        }\n      }\n      if (!isNullOrUndefined(dragParentRowObject)) {\n        dragParentRowObject = gObj.getRowObjectFromUID(dragParentRowObject.parentUid);\n      }\n      if (!isNullOrUndefined(dropParentRowObject)) {\n        dropParentRowObject = gObj.getRowObjectFromUID(dropParentRowObject.parentUid);\n      }\n    }\n  };\n  Group.prototype.getGroupParentFooterAggregateRowObject = function (parentUid) {\n    var rowObjects = this.parent.getRowsObject();\n    var parentFooterAggregates = [];\n    for (var i = 0; i < rowObjects.length; i++) {\n      if (rowObjects[parseInt(i.toString(), 10)].parentUid === parentUid && rowObjects[parseInt(i.toString(), 10)].isAggregateRow) {\n        parentFooterAggregates.push(rowObjects[parseInt(i.toString(), 10)]);\n      }\n    }\n    return parentFooterAggregates;\n  };\n  Group.prototype.evaluateGroupAggregateValueChange = function (rowObjects, updatedRowObject, groupAggregateTemplate) {\n    var change = false;\n    if (rowObjects.data[groupAggregateTemplate['field']]['field'] === updatedRowObject.data[groupAggregateTemplate['field']]['field'] && rowObjects.data[groupAggregateTemplate['field']]['key'] === updatedRowObject.data[groupAggregateTemplate['field']]['key'] && rowObjects.data[groupAggregateTemplate['field']]\n    // eslint-disable-next-line no-prototype-builtins\n    .hasOwnProperty(groupAggregateTemplate['field'] + ' - ' + groupAggregateTemplate['type']) && updatedRowObject.data[groupAggregateTemplate['field']]\n    // eslint-disable-next-line no-prototype-builtins\n    .hasOwnProperty(groupAggregateTemplate['field'] + ' - ' + groupAggregateTemplate['type'])) {\n      change = true;\n    }\n    return change;\n  };\n  Group.prototype.groupReorderRowObject = function (args, tr, dropRObj) {\n    var gObj = this.parent;\n    var rowObjects = gObj.enableVirtualization ? gObj.vRows : gObj.getRowsObject();\n    var orderChangeRowObjects = [];\n    var dropRowObject = dropRObj ? dropRObj : gObj.getRowObjectFromUID(args.target.closest('tr').getAttribute('data-uid'));\n    var rowObjDropindex;\n    for (var i = 0; i < args.rows.length; i++) {\n      var orderChangeRowObject = gObj.getRowObjectFromUID(args.rows[parseInt(i.toString(), 10)].getAttribute('data-uid'));\n      if (dropRowObject === orderChangeRowObject) {\n        rowObjDropindex = rowObjects.indexOf(dropRowObject);\n      }\n      orderChangeRowObjects.push(rowObjects.splice(rowObjects.indexOf(orderChangeRowObject), 1)[0]);\n    }\n    if (isNullOrUndefined(rowObjDropindex)) {\n      rowObjDropindex = rowObjects.indexOf(dropRowObject);\n      if (args.fromIndex > args.dropIndex) {\n        rowObjects.splice.apply(rowObjects, [rowObjDropindex, 0].concat(orderChangeRowObjects));\n      } else {\n        rowObjects.splice.apply(rowObjects, [rowObjDropindex + 1, 0].concat(orderChangeRowObjects));\n      }\n    } else {\n      rowObjects.splice.apply(rowObjects, [rowObjDropindex, 0].concat(orderChangeRowObjects));\n    }\n    if (!gObj.enableVirtualization) {\n      var recordobj = {};\n      var currentViewData = this.parent.getCurrentViewRecords();\n      for (var i = 0, len = tr.length; i < len; i++) {\n        var index = parseInt(tr[parseInt(i.toString(), 10)].getAttribute(literals.dataRowIndex), 10);\n        recordobj[parseInt(i.toString(), 10)] = currentViewData[parseInt(index.toString(), 10)];\n      }\n      var rows = this.parent.getRows();\n      for (var i = 0, len = tr.length; i < len; i++) {\n        rows[parseInt(i.toString(), 10)] = tr[parseInt(i.toString(), 10)];\n        currentViewData[parseInt(i.toString(), 10)] = recordobj[parseInt(i.toString(), 10)];\n      }\n    }\n  };\n  Group.prototype.gettingVirtualData = function (parentRowObjs, curViewRec, pK) {\n    var datas = [];\n    var _loop_2 = function (i) {\n      if (curViewRec.indexOf(parentRowObjs[parseInt(i.toString(), 10)].data) === -1) {\n        datas.push(parentRowObjs[parseInt(i.toString(), 10)].data);\n      }\n      if (parentRowObjs[parseInt(i.toString(), 10)].data['field'] === this_2.parent.groupSettings.columns[0]) {\n        var draggedData_1 = parentRowObjs[parseInt(i.toString(), 10)].data['items'];\n        if (!isNullOrUndefined(draggedData_1['records'])) {\n          draggedData_1 = draggedData_1['records'];\n        }\n        var _loop_3 = function (j) {\n          if (pK && curViewRec.findIndex(function (data) {\n            return data[pK.toString()] === draggedData_1[parseInt(j.toString(), 10)][pK.toString()];\n          }) === -1) {\n            datas.push(draggedData_1[parseInt(j.toString(), 10)]);\n          }\n        };\n        for (var j = 0; j < draggedData_1.length; j++) {\n          _loop_3(j);\n        }\n      }\n    };\n    var this_2 = this;\n    for (var i = 0; i < parentRowObjs.length; i++) {\n      _loop_2(i);\n    }\n    return datas;\n  };\n  Group.prototype.iterateGroupAggregates = function (editedData) {\n    var updatedData = editedData instanceof Array ? editedData : [];\n    var rows = this.parent.getRowsObject();\n    var initData = this.parent.getCurrentViewRecords();\n    var field = this.parent.getPrimaryKeyFieldNames()[0];\n    if (this.parent.enableVirtualization && this.parent.allowGrouping && this.parent.groupSettings.columns.length && (!isNullOrUndefined(editedData[0]['dragRowObjects']) || !isNullOrUndefined(editedData[0]['dropRowObjects']))) {\n      var dragParentRowObjects = editedData[0]['dragRowObjects'];\n      var dropParentRowObjects = editedData[0]['dropRowObjects'];\n      if (dragParentRowObjects) {\n        initData.push.apply(initData, this.gettingVirtualData(dragParentRowObjects, initData, field));\n      }\n      if (dropParentRowObjects) {\n        initData.push.apply(initData, this.gettingVirtualData(dropParentRowObjects, initData, field));\n      }\n    }\n    var deletedCols = [];\n    var changeds = rows.map(function (row) {\n      if (row.edit === 'delete') {\n        deletedCols.push(row.data);\n      }\n      return row.changes instanceof Object ? row.changes : row.data;\n    });\n    changeds = updatedData.length === 0 ? changeds : updatedData;\n    var mergeData = initData.map(function (item) {\n      var pKeyVal = DataUtil.getObject(field, item);\n      var value;\n      var hasVal = changeds.some(function (cItem) {\n        value = cItem;\n        return pKeyVal === DataUtil.getObject(field, cItem);\n      });\n      return hasVal ? value : item;\n    });\n    var eData = editedData;\n    if (!(eData.type && eData.type === 'cancel') && deletedCols.length > 0) {\n      for (var i = 0; i < deletedCols.length; i++) {\n        var index = mergeData.indexOf(deletedCols[parseInt(i.toString(), 10)]);\n        mergeData.splice(index, 1);\n      }\n    }\n    var aggregates = [];\n    var aggregateRows = this.parent.aggregates;\n    for (var j = 0; j < aggregateRows.length; j++) {\n      var row = aggregateRows[parseInt(j.toString(), 10)];\n      for (var k = 0; k < row.columns.length; k++) {\n        var aggr = {};\n        var type = row.columns[parseInt(k.toString(), 10)].type.toString();\n        aggr = {\n          type: type.toLowerCase(),\n          field: row.columns[parseInt(k.toString(), 10)].field\n        };\n        aggregates.push(aggr);\n      }\n    }\n    var result;\n    var aggrds;\n    var groupedCols = this.parent.groupSettings.columns;\n    for (var l = 0; l < groupedCols.length; l++) {\n      aggrds = result ? result : mergeData;\n      result = DataUtil.group(aggrds, groupedCols[parseInt(l.toString(), 10)], aggregates, null, null);\n    }\n    return result;\n  };\n  Group.prototype.updateExpand = function (args) {\n    var uid = args.uid;\n    var isExpand = args.isExpand;\n    var rows = this.parent.getRowsObject();\n    for (var i = 0; i < rows.length; i++) {\n      var row = rows[parseInt(i.toString(), 10)];\n      if (row.uid === uid || isNullOrUndefined(uid)) {\n        row.isExpand = isExpand;\n        var _loop_4 = function (j) {\n          var childRow = rows[parseInt(j.toString(), 10)];\n          var closestParent = void 0;\n          if (childRow.parentUid !== row.uid) {\n            closestParent = rows.filter(function (x) {\n              return x.uid === childRow.parentUid;\n            })[0];\n          }\n          if (childRow.parentUid === row.uid) {\n            childRow.visible = row.isExpand;\n          } else if (!isNullOrUndefined(closestParent) && childRow.parentUid === closestParent.uid) {\n            if (closestParent.isExpand && closestParent.visible === true) {\n              childRow.visible = true;\n            } else if (closestParent.isExpand && closestParent.visible === false) {\n              childRow.visible = false;\n            }\n          }\n          if (isNullOrUndefined(uid)) {\n            return \"break\";\n          }\n        };\n        for (var j = i + 1; j < rows.length; j++) {\n          var state_2 = _loop_4(j);\n          if (state_2 === \"break\") break;\n        }\n      }\n    }\n    this.parent.notify(events.contentReady, {\n      rows: rows,\n      args: {\n        isFrozen: false,\n        rows: rows\n      }\n    });\n  };\n  return Group;\n}();\nexport { Group };","map":{"version":3,"names":["Draggable","Droppable","EventHandler","createElement","closest","remove","classList","addClass","removeClass","isNullOrUndefined","extend","parentsUntil","isActionPrevent","isGroupAdaptive","updatecloneRow","getComplexFieldID","getParsedFieldID","isComplexField","findCellIndex","resetRowIndex","generateExpandPredicates","getPredicates","capitalizeFirstLetter","events","AriaService","GroupModelGenerator","DataUtil","literals","RowRenderer","Group","parent","groupSettings","sortedColumns","serviceLocator","_this","sortRequired","groupSortFocus","groupTextFocus","groupCancelFocus","isAppliedGroup","isAppliedUnGroup","isAppliedCaptionRowBorder","reorderingColumns","visualElement","className","styles","attrs","action","helper","e","gObj","target","sender","element","contains","allowReordering","column","getColumnByField","firstElementChild","getAttribute","textContent","style","width","offsetWidth","height","offsetHeight","setAttribute","uid","appendChild","dragStart","add","drag","animateDropper","cloneElement","querySelector","trigger","columnDrag","draggableType","gridContent","dragStop","preventDrop","rearrangeGroup","field","getColumnByUid","columns","indexOf","ungroupColumn","dragField","dropTarget","grouped","slice","call","getElementsByClassName","map","cols","JSON","parse","stringify","dropField","dropIndex","dragIndex","splice","flag","push","innerHTML","length","c","addColToGroupDrop","parseInt","toString","addLabel","removeColFromGroupDrop","drop","droppedElement","aria","setDropTarget","setGrabbed","getHeaderTable","allowGrouping","getColumnHeaderByUid","log","moduleName","getModuleName","columnName","headerText","undefined","groupColumn","contentRefresh","focus","getService","addEventListener","groupGenerator","prototype","dragLabel","l10n","getConstant","updateModel","isEqualNode","getColumnHeaderByField","columnDragStart","dropArea","columnDrop","isDestroyed","on","uiUpdate","enableAfterRender","groupComplete","onActionComplete","ungroupComplete","inBoundModelChanged","onPropertyChanged","click","clickHandler","headerDrop","headerRefreshed","refreshSortIcons","sortComplete","keyPressed","keyPressHandler","contentReady","initialEnd","onEmpty","render","groupAggregates","onGroupAggregates","destroy","updateExpand","removeEventListener","off","getColumns","_i","_a","col","focusableGroupedItems","getFocusableGroupedItems","i","preventDefault","index","isMacLike","test","navigator","platform","metaKey","selected","allowSelection","getSelectedRowIndexes","rows","getContentTable","tbody","children","dataRow","getDataRows","grpRow","rowIndex","row","expandCollapseRows","expandAll","collapseAll","applySortFromTarget","unGroupFromTarget","isEdit","id","getFocusedElement","parentElement","elem","focusModule","currentInfo","focusableGroupedHeaderItems","querySelectorAll","wireEvent","onFocusIn","onFocusOut","auxilaryclickHandler","unWireEvent","elementToFocus","tabIndex","addOrRemoveFocus","type","trgtEle","toogleGroupFromHeader","button","showToggleButton","gHeader","allowSorting","sortColumn","trgt","rowNodes","isHide","dataManager","query","indent","captionRow","getRowObjectFromUID","expand","isExpand","updateVirtualRows","enableLazyLoading","filterSettings","sortSettings","searchSettings","key","getContent","scrollTop","contentModule","isTop","enableVirtualization","lazyLoadRender","captionExpand","captionCollapse","setExpand","rowObjs","getRowsObject","startIdx","rowsState","cacheStartIdx","enableInfiniteScrolling","infiniteScrollSettings","enableCache","Array","from","isDetailRow","visible","display","parentUid","isDataRow","isCaptionRow","isAggregateRow","cells","some","cell","isDataCell","lastCaptionRowBorder","notify","refreshExpandandCollapse","captionActionComplete","isCollapse","table","clientHeight","scrollHeight","borderCells","len","lastRow","childNodes","rObj","refreshVirtualMaxPage","getDataModule","generateQuery","queries","aggregateQuery","getQuery","clone","args","requestType","rowObject","virtualInfo","prevInfo","getData","requiresCount","then","renderModule","dataManagerSuccess","expandCollapse","initialCollapse","updateVisibleExpandCollapseRows","renderGroupDropArea","initDragAndDrop","refreshToggleBtn","groupElem","updateGroupDropArea","insertBefore","firstChild","showDropArea","rowRenderingMode","clear","initializeGHeaderDrop","initializeGHeaderDrag","dragTarget","distance","accept","preventBatch","instance","handler","arg1","showGroupedColumn","colName","enableColumnVirtualization","filter","dataBind","groupAddSortingQuery","actionComplete","direction","isFromGroup","animator","groupedColumn","childDiv","headerCell","title","tabindex","toLowerCase","role","showUngroupButton","createSeparator","setActive","firstContentCellIndex","active","matrix","current","getTable","isRemove","headers","showColumnMenu","localeObj","getGHeaderCell","parent_1","module","Object","keys","properties","prop","j","actionBegin","oldProperties","modelChanged","headerModule","refreshUI","scrollModule","refresh","updateGroupedColumn","updateButtonVisibility","refreshHeader","freezeRefresh","isVisible","enable","gridElement","gridHeader","refreshing","clearGrouping","parentNode","header","gCols","fieldNames","editedData","editSettings","mode","updateLazyLoadGroupAggregates","aggregates","iterateGroupAggregates","rowData","generateRows","summaryRows","updateSummaryRows","data","isReact","isVue","destroyTemplate","dataUid","refreshAggregateCell","remoteResult","groupCaptionTemplates","getGroupAggregateTemplates","groupFooterTemplates","isRemote","updatedData","editedRow","groupedCols","groupLazyLoadRenderer","groupCache","getGroupCache","currentPageGroupCache","pageSettings","currentPage","result","_loop_1","groupField","groupKey","groupCaptionRowObject","this_1","getGroupCaptionRowObject","prevGroupField","prevGroupKey_1","find","items","updateLazyLoadGroupAggregatesRow","currentLevelCaptionRowObjects","fields","reverse","pred","predicateList","lazyLoad","level","skip","take","where","value","destroyRefreshGroupCaptionFooterTemplate","catch","dataManagerFailure","state_1","isAngular","refreshGroupCaptionFooterTemplate","removeMaskRow","hideSpinner","updatedGroupCaptionData","updateLazyLoadGroupAggregatesCell","groupFooterRowObject","captionFooterRowObject","captionFooterTemplates","prevCaptionFooterData","updatedGroupCaptionDataAggregates","template","fieldData","groupCaptionIndex","parentCaptionRowObject","groupCaptionTemplate","aggregateRows","k","groupFooterTemplate","aggr","groupedRowReorder","fromRowObj","toRowObj","dragRow","getRowElementByUID","dropRow","dropArgs","fromIndex","nextSibling","groupReorderHandler","tr","groupReorderRowObject","vGroupResetRowIndex","rowObjects","vRows","rowElements","getRows","isAltRow","enableAltRow","rowElement","dataRowIndex","ariaRowIndex","dragRowObject","dropRowObject","dragRowObjectData","dropRowObjectData","groupAggregateTemplate","dropParentRowObject","dragParentRowObject","dropRootParentRowObjects","dragRootParentRowObjects","groupColumns","changes","updatedCurrentViewData","dragRowObjects","dropRowObjects","updatedDragCurrentViewData","object","Date","updatedDropCurrentViewData","currentViewData","updatedRowObject","dragRootParentAggregateRowObject","dropRootParentAggregateRowObject","apply","getGroupParentFooterAggregateRowObject","updatedRowObjChange","groupReorderRefreshHandler","rootParentRowObjects","updatedRowObj","cache","virtualCacheRowObjects","vcRows","keyPresent","vIndex","l","evaluateGroupAggregateValueChange","removeElem","vcIndex","dragParentFooterAggregateRowObjects","dropParentFooterAggregateRowObjects","parentFooterAggregates","change","hasOwnProperty","dropRObj","orderChangeRowObjects","rowObjDropindex","orderChangeRowObject","concat","recordobj","getCurrentViewRecords","gettingVirtualData","parentRowObjs","curViewRec","pK","datas","_loop_2","this_2","draggedData_1","_loop_3","findIndex","initData","getPrimaryKeyFieldNames","dragParentRowObjects","dropParentRowObjects","deletedCols","changeds","edit","mergeData","item","pKeyVal","getObject","hasVal","cItem","eData","aggrds","group","_loop_4","childRow","closestParent","x","state_2","isFrozen"],"sources":["/Users/saleem/Desktop/KClient/Web App/Ver_3.6/User Interface/website_Source files/node_modules/@syncfusion/ej2-grids/src/grid/actions/group.js"],"sourcesContent":["import { Draggable, Droppable, EventHandler } from '@syncfusion/ej2-base';\nimport { createElement, closest, remove, classList, addClass, removeClass } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined, extend } from '@syncfusion/ej2-base';\nimport { parentsUntil, isActionPrevent, isGroupAdaptive, updatecloneRow, getComplexFieldID, getParsedFieldID, isComplexField, findCellIndex, resetRowIndex } from '../base/util';\nimport { generateExpandPredicates, getPredicates, capitalizeFirstLetter } from '../base/util';\nimport * as events from '../base/constant';\nimport { AriaService } from '../services/aria-service';\nimport { GroupModelGenerator } from '../services/group-model-generator';\nimport { DataUtil } from '@syncfusion/ej2-data';\nimport * as literals from '../base/string-literals';\nimport { RowRenderer } from '../renderer/row-renderer';\n// eslint-disable-next-line valid-jsdoc\n/**\n *\n * The `Group` module is used to handle group action.\n */\nvar Group = /** @class */ (function () {\n    /**\n     * Constructor for Grid group module\n     *\n     * @param {IGrid} parent - specifies the IGrid\n     * @param {GroupSettingsModel} groupSettings - specifies the GroupSettingsModel\n     * @param {string[]} sortedColumns - specifies the sortedColumns\n     * @param {ServiceLocator} serviceLocator - specifies the serviceLocator\n     * @hidden\n     */\n    function Group(parent, groupSettings, sortedColumns, serviceLocator) {\n        var _this = this;\n        //Internal variables\n        this.sortRequired = true;\n        /** @hidden */\n        this.groupSortFocus = false;\n        /** @hidden */\n        this.groupTextFocus = false;\n        /** @hidden */\n        this.groupCancelFocus = false;\n        this.isAppliedGroup = false;\n        this.isAppliedUnGroup = false;\n        this.isAppliedCaptionRowBorder = false;\n        this.reorderingColumns = [];\n        this.visualElement = createElement('div', {\n            className: 'e-cloneproperties e-dragclone e-gdclone',\n            styles: 'line-height:23px', attrs: { action: 'grouping' }\n        });\n        this.helper = function (e) {\n            var gObj = _this.parent;\n            var target = e.sender.target;\n            var element = target.classList.contains('e-groupheadercell') ? target :\n                parentsUntil(target, 'e-groupheadercell');\n            if (!element || (!target.classList.contains('e-drag') && _this.groupSettings.allowReordering)) {\n                return false;\n            }\n            _this.column = gObj.getColumnByField(element.firstElementChild.getAttribute('ej-mappingname'));\n            _this.visualElement.textContent = element.textContent;\n            _this.visualElement.style.width = element.offsetWidth + 2 + 'px';\n            _this.visualElement.style.height = element.offsetHeight + 2 + 'px';\n            _this.visualElement.setAttribute('e-mappinguid', _this.column.uid);\n            gObj.element.appendChild(_this.visualElement);\n            return _this.visualElement;\n        };\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        this.dragStart = function (e) {\n            _this.parent.element.classList.add('e-ungroupdrag');\n        };\n        this.drag = function (e) {\n            if (_this.groupSettings.allowReordering) {\n                _this.animateDropper(e);\n            }\n            var target = e.target;\n            var cloneElement = _this.parent.element.querySelector('.e-cloneproperties');\n            _this.parent.trigger(events.columnDrag, { target: target, draggableType: 'headercell', column: _this.column });\n            if (!_this.groupSettings.allowReordering) {\n                classList(cloneElement, ['e-defaultcur'], ['e-notallowedcur']);\n                if (!(parentsUntil(target, literals.gridContent) || parentsUntil(target, 'e-headercell'))) {\n                    classList(cloneElement, ['e-notallowedcur'], ['e-defaultcur']);\n                }\n            }\n        };\n        this.dragStop = function (e) {\n            _this.parent.element.classList.remove('e-ungroupdrag');\n            var preventDrop = !(parentsUntil(e.target, literals.gridContent) || parentsUntil(e.target, 'e-gridheader'));\n            if (_this.groupSettings.allowReordering && preventDrop) {\n                remove(e.helper);\n                if (parentsUntil(e.target, 'e-groupdroparea')) {\n                    _this.rearrangeGroup();\n                }\n                else if (!(parentsUntil(e.target, 'e-grid'))) {\n                    var field = _this.parent.getColumnByUid(e.helper.getAttribute('e-mappinguid')).field;\n                    if (_this.groupSettings.columns.indexOf(field) !== -1) {\n                        _this.ungroupColumn(field);\n                    }\n                }\n                return;\n            }\n            else if (preventDrop) {\n                remove(e.helper);\n                return;\n            }\n        };\n        this.animateDropper = function (e) {\n            var uid = _this.parent.element.querySelector('.e-cloneproperties').getAttribute('e-mappinguid');\n            var dragField = _this.parent.getColumnByUid(uid).field;\n            var parent = parentsUntil(e.target, 'e-groupdroparea');\n            var dropTarget = parentsUntil(e.target, 'e-group-animator');\n            var grouped = [].slice.call(_this.element.getElementsByClassName('e-groupheadercell'))\n                .map(function (e) { return e.querySelector('div').getAttribute('ej-mappingname'); });\n            var cols = JSON.parse(JSON.stringify(grouped));\n            if (dropTarget || parent) {\n                if (dropTarget) {\n                    var dropField = dropTarget.querySelector('div[ej-mappingname]').getAttribute('ej-mappingname');\n                    var dropIndex = +(dropTarget.getAttribute('index'));\n                    if (dropField !== dragField) {\n                        var dragIndex = cols.indexOf(dragField);\n                        if (dragIndex !== -1) {\n                            cols.splice(dragIndex, 1);\n                        }\n                        var flag = dropIndex !== -1 && dragIndex === dropIndex;\n                        cols.splice(dropIndex + (flag ? 1 : 0), 0, dragField);\n                    }\n                }\n                else if (parent && cols.indexOf(dragField) === -1) {\n                    cols.push(dragField);\n                }\n                _this.element.innerHTML = '';\n                if (cols.length && !_this.element.classList.contains('e-grouped')) {\n                    _this.element.classList.add('e-grouped');\n                }\n                _this.reorderingColumns = cols;\n                for (var c = 0; c < cols.length; c++) {\n                    _this.addColToGroupDrop(cols[parseInt(c.toString(), 10)]);\n                }\n            }\n            else {\n                _this.addLabel();\n                _this.removeColFromGroupDrop(dragField);\n            }\n        };\n        this.drop = function (e) {\n            var gObj = _this.parent;\n            var column = gObj.getColumnByUid(e.droppedElement.getAttribute('e-mappinguid'));\n            _this.element.classList.remove('e-hover');\n            remove(e.droppedElement);\n            _this.aria.setDropTarget(_this.parent.element.querySelector('.e-groupdroparea'), false);\n            _this.aria.setGrabbed(_this.parent.getHeaderTable().querySelector('[aria-grabbed=true]'), false);\n            if (isNullOrUndefined(column) || column.allowGrouping === false ||\n                parentsUntil(gObj.getColumnHeaderByUid(column.uid), 'e-grid').getAttribute('id') !==\n                    gObj.element.getAttribute('id')) {\n                _this.parent.log('action_disabled_column', { moduleName: _this.getModuleName(), columnName: column ? column.headerText : undefined });\n                return;\n            }\n            _this.groupColumn(column.field);\n        };\n        this.contentRefresh = true;\n        this.aria = new AriaService();\n        this.parent = parent;\n        this.groupSettings = groupSettings;\n        this.serviceLocator = serviceLocator;\n        this.sortedColumns = sortedColumns;\n        this.focus = serviceLocator.getService('focus');\n        this.addEventListener();\n        this.groupGenerator = new GroupModelGenerator(this.parent);\n    }\n    Group.prototype.addLabel = function () {\n        if (!this.element.getElementsByClassName('e-group-animator').length) {\n            var dragLabel = this.l10n.getConstant('GroupDropArea');\n            this.element.innerHTML = dragLabel;\n            this.element.classList.remove('e-grouped');\n        }\n    };\n    Group.prototype.rearrangeGroup = function () {\n        this.sortRequired = false;\n        this.updateModel();\n    };\n    Group.prototype.columnDrag = function (e) {\n        if (this.groupSettings.allowReordering && e.column.allowGrouping) {\n            this.animateDropper(e);\n        }\n        var cloneElement = this.parent.element.querySelector('.e-cloneproperties');\n        if (!this.parent.allowReordering) {\n            classList(cloneElement, ['e-defaultcur'], ['e-notallowedcur']);\n        }\n        if (!(e.column.allowGrouping && (parentsUntil(e.target, 'e-groupdroparea') ||\n            (parentsUntil(e.target, 'e-headercell') &&\n                parentsUntil(e.target, 'e-headercell').isEqualNode(this.parent.getColumnHeaderByField(e.column.field))))) &&\n            !(this.parent.allowReordering && parentsUntil(e.target, 'e-headercell'))) {\n            classList(cloneElement, ['e-notallowedcur'], ['e-defaultcur']);\n        }\n        if (e.target.classList.contains('e-groupdroparea')) {\n            this.element.classList.add('e-hover');\n        }\n        else {\n            this.element.classList.remove('e-hover');\n        }\n    };\n    Group.prototype.columnDragStart = function (e) {\n        if (e.target.classList.contains('e-stackedheadercell')) {\n            return;\n        }\n        var dropArea = this.parent.element.querySelector('.e-groupdroparea');\n        this.aria.setDropTarget(dropArea, e.column.allowGrouping);\n        var element = e.target.classList.contains('e-headercell') ? e.target : parentsUntil(e.target, 'e-headercell');\n        this.aria.setGrabbed(element, true, !e.column.allowGrouping);\n    };\n    Group.prototype.columnDrop = function (e) {\n        var gObj = this.parent;\n        if (e.droppedElement.getAttribute('action') === 'grouping') {\n            var column = gObj.getColumnByUid(e.droppedElement.getAttribute('e-mappinguid'));\n            if (isNullOrUndefined(column) || column.allowGrouping === false ||\n                parentsUntil(gObj.getColumnHeaderByUid(column.uid), 'e-grid').getAttribute('id') !==\n                    gObj.element.getAttribute('id')) {\n                return;\n            }\n            this.ungroupColumn(column.field);\n        }\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    Group.prototype.addEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.on(events.uiUpdate, this.enableAfterRender, this);\n        this.parent.on(events.groupComplete, this.onActionComplete, this);\n        this.parent.on(events.ungroupComplete, this.onActionComplete, this);\n        this.parent.on(events.inBoundModelChanged, this.onPropertyChanged, this);\n        this.parent.on(events.click, this.clickHandler, this);\n        this.parent.on(events.columnDrag, this.columnDrag, this);\n        this.parent.on(events.columnDragStart, this.columnDragStart, this);\n        this.parent.on(events.headerDrop, this.columnDrop, this);\n        this.parent.on(events.columnDrop, this.columnDrop, this);\n        this.parent.on(events.headerRefreshed, this.refreshSortIcons, this);\n        this.parent.on(events.sortComplete, this.refreshSortIcons, this);\n        this.parent.on(events.keyPressed, this.keyPressHandler, this);\n        this.parent.on(events.contentReady, this.initialEnd, this);\n        this.parent.on(events.onEmpty, this.initialEnd, this);\n        this.parent.on(events.initialEnd, this.render, this);\n        this.parent.on(events.groupAggregates, this.onGroupAggregates, this);\n        this.parent.on(events.destroy, this.destroy, this);\n        this.parent.on('group-expand-collapse', this.updateExpand, this);\n        this.parent.on('persist-data-changed', this.initialEnd, this);\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    Group.prototype.removeEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.off(events.initialEnd, this.render);\n        this.parent.off(events.uiUpdate, this.enableAfterRender);\n        this.parent.off(events.groupComplete, this.onActionComplete);\n        this.parent.off(events.ungroupComplete, this.onActionComplete);\n        this.parent.off(events.inBoundModelChanged, this.onPropertyChanged);\n        this.parent.off(events.click, this.clickHandler);\n        this.parent.off(events.columnDrag, this.columnDrag);\n        this.parent.off(events.columnDragStart, this.columnDragStart);\n        this.parent.off(events.columnDrop, this.columnDrop);\n        this.parent.off(events.headerDrop, this.columnDrop);\n        this.parent.off(events.headerRefreshed, this.refreshSortIcons);\n        this.parent.off(events.sortComplete, this.refreshSortIcons);\n        this.parent.off(events.keyPressed, this.keyPressHandler);\n        this.parent.off(events.groupAggregates, this.onGroupAggregates);\n        this.parent.off(events.destroy, this.destroy);\n        this.parent.off('group-expand-collapse', this.updateExpand);\n    };\n    Group.prototype.initialEnd = function () {\n        var gObj = this.parent;\n        this.parent.off(events.contentReady, this.initialEnd);\n        this.parent.off(events.onEmpty, this.initialEnd);\n        if (this.parent.getColumns().length && this.groupSettings.columns.length) {\n            this.contentRefresh = false;\n            for (var _i = 0, _a = gObj.groupSettings.columns; _i < _a.length; _i++) {\n                var col = _a[_i];\n                this.groupColumn(col);\n            }\n            this.contentRefresh = true;\n        }\n    };\n    Group.prototype.keyPressHandler = function (e) {\n        var gObj = this.parent;\n        if (e.target && parentsUntil(e.target, 'e-groupheadercell') && (e.action === 'tab' || e.action === 'shiftTab')) {\n            var focusableGroupedItems = this.getFocusableGroupedItems();\n            if ((e.action === 'tab' && e.target === focusableGroupedItems[focusableGroupedItems.length - 1])\n                || (e.action === 'shiftTab' && e.target === focusableGroupedItems[0])) {\n                return;\n            }\n            for (var i = 0; i < focusableGroupedItems.length; i++) {\n                if (e.target === focusableGroupedItems[parseInt(i.toString(), 10)]) {\n                    e.preventDefault();\n                    var index = e.action === 'tab' ? i + 1 : i - 1;\n                    focusableGroupedItems[parseInt(index.toString(), 10)].focus();\n                    return;\n                }\n            }\n        }\n        var isMacLike = /(Mac)/i.test(navigator.platform);\n        if (isMacLike && e.metaKey) {\n            if (e.action === 'downArrow') {\n                e.action = 'ctrlDownArrow';\n            }\n            else if (e.action === 'upArrow') {\n                e.action = 'ctrlUpArrow';\n            }\n        }\n        if (e.action !== 'ctrlSpace' && (!this.groupSettings.columns.length ||\n            ['altDownArrow', 'altUpArrow', 'ctrlDownArrow', 'ctrlUpArrow', 'enter'].indexOf(e.action) === -1)) {\n            return;\n        }\n        e.preventDefault();\n        switch (e.action) {\n            case 'altDownArrow':\n            case 'altUpArrow':\n                // eslint-disable-next-line no-case-declarations\n                var selected = gObj.allowSelection ? gObj.getSelectedRowIndexes() : [];\n                if (selected.length) {\n                    var rows = gObj.getContentTable().querySelector(literals.tbody).children;\n                    var dataRow = gObj.getDataRows()[selected[selected.length - 1]];\n                    var grpRow = void 0;\n                    for (var i = dataRow.rowIndex; i >= 0; i--) {\n                        if (!rows[parseInt(i.toString(), 10)].classList.contains(literals.row) && !rows[parseInt(i.toString(), 10)].classList.contains('e-detailrow')) {\n                            grpRow = rows[parseInt(i.toString(), 10)];\n                            break;\n                        }\n                    }\n                    this.expandCollapseRows(grpRow.querySelector(e.action === 'altUpArrow' ?\n                        '.e-recordplusexpand' : '.e-recordpluscollapse'));\n                }\n                break;\n            case 'ctrlDownArrow':\n                this.expandAll();\n                break;\n            case 'ctrlUpArrow':\n                this.collapseAll();\n                break;\n            case 'enter':\n                if (e.target.classList.contains('e-groupsort')) {\n                    this.groupSortFocus = true;\n                    this.applySortFromTarget(e.target);\n                    break;\n                }\n                else if (e.target.classList.contains('e-ungroupbutton')) {\n                    this.groupCancelFocus = true;\n                    this.unGroupFromTarget(e.target);\n                    break;\n                }\n                if (this.parent.isEdit || (closest(e.target, '#' + this.parent.element.id + '_searchbar') !== null) ||\n                    parentsUntil(e.target, 'e-pager') || parentsUntil(e.target, 'e-toolbar')) {\n                    return;\n                }\n                // eslint-disable-next-line no-case-declarations\n                var element = this.focus.getFocusedElement();\n                if (element && (element.classList.contains('e-icon-grightarrow') || element.classList.contains('e-icon-gdownarrow'))) {\n                    element = element.parentElement;\n                }\n                // eslint-disable-next-line no-case-declarations\n                var row = element ? element.parentElement.querySelector('[class^=\"e-record\"]') : null;\n                if (!row) {\n                    break;\n                }\n                if (element.children.length && (element.children[0].classList.contains('e-icon-grightarrow') ||\n                    element.children[0].classList.contains('e-icon-gdownarrow'))) {\n                    this.expandCollapseRows(row);\n                }\n                break;\n            case 'ctrlSpace':\n                // eslint-disable-next-line no-case-declarations\n                var elem = gObj.focusModule.currentInfo.element;\n                if (elem && elem.classList.contains('e-headercell')) {\n                    var column = gObj.getColumnByUid(elem.firstElementChild.getAttribute('e-mappinguid'));\n                    if (column.field && gObj.groupSettings.columns.indexOf(column.field) < 0) {\n                        this.groupColumn(column.field);\n                    }\n                    else {\n                        this.ungroupColumn(column.field);\n                    }\n                }\n                break;\n        }\n    };\n    /**\n     * @returns {Element[]} - Return the focusable grouping items\n     * @hidden */\n    Group.prototype.getFocusableGroupedItems = function () {\n        var focusableGroupedItems = [];\n        if (this.groupSettings.columns.length) {\n            var focusableGroupedHeaderItems = this.element.querySelectorAll('.e-groupheadercell');\n            for (var i = 0; i < focusableGroupedHeaderItems.length; i++) {\n                focusableGroupedItems.push(focusableGroupedHeaderItems[parseInt(i.toString(), 10)].querySelector('.e-grouptext'));\n                focusableGroupedItems.push(focusableGroupedHeaderItems[parseInt(i.toString(), 10)].querySelector('.e-groupsort'));\n                focusableGroupedItems.push(focusableGroupedHeaderItems[parseInt(i.toString(), 10)].querySelector('.e-ungroupbutton'));\n            }\n        }\n        return focusableGroupedItems;\n    };\n    Group.prototype.wireEvent = function () {\n        EventHandler.add(this.element, 'focusin', this.onFocusIn, this);\n        EventHandler.add(this.element, 'focusout', this.onFocusOut, this);\n        EventHandler.add(this.parent.element, 'auxclick', this.auxilaryclickHandler, this);\n    };\n    Group.prototype.unWireEvent = function () {\n        EventHandler.remove(this.element, 'focusin', this.onFocusIn);\n        EventHandler.remove(this.element, 'focusout', this.onFocusOut);\n        EventHandler.remove(this.parent.element, 'auxclick', this.auxilaryclickHandler);\n    };\n    Group.prototype.onFocusIn = function (e) {\n        if (this.parent.focusModule.currentInfo && this.parent.focusModule.currentInfo.element) {\n            removeClass([this.parent.focusModule.currentInfo.element, this.parent.focusModule.currentInfo.elementToFocus], ['e-focused', 'e-focus']);\n            this.parent.focusModule.currentInfo.element.tabIndex = -1;\n        }\n        this.addOrRemoveFocus(e);\n    };\n    Group.prototype.onFocusOut = function (e) {\n        this.addOrRemoveFocus(e);\n    };\n    Group.prototype.addOrRemoveFocus = function (e) {\n        if (e.target.classList.contains('e-groupdroparea') || e.target.classList.contains('e-grouptext')\n            || e.target.classList.contains('e-groupsort')\n            || e.target.classList.contains('e-ungroupbutton')) {\n            var target = e.target.classList.contains('e-grouptext') ?\n                e.target.parentElement.parentElement : e.target;\n            if (e.type === 'focusin') {\n                this.parent.focusModule.currentInfo.element = e.target;\n                this.parent.focusModule.currentInfo.elementToFocus = e.target;\n                addClass([target], ['e-focused', 'e-focus']);\n                e.target.tabIndex = 0;\n            }\n            else {\n                removeClass([target], ['e-focused', 'e-focus']);\n                e.target.tabIndex = -1;\n            }\n        }\n    };\n    Group.prototype.clickHandler = function (e) {\n        if (e.target.classList.contains('e-grouptext')) {\n            this.groupTextFocus = true;\n        }\n        if (e.target.classList.contains('e-groupsort')) {\n            this.groupSortFocus = true;\n        }\n        if (e.target.classList.contains('e-ungroupbutton')) {\n            this.groupCancelFocus = true;\n        }\n        if (e.target.classList.contains('e-icon-grightarrow') || e.target.classList.contains('e-icon-gdownarrow')) {\n            e.preventDefault();\n        }\n        var trgtEle = parentsUntil(e.target, 'e-recordplusexpand') ||\n            parentsUntil(e.target, 'e-recordpluscollapse');\n        if (trgtEle && (trgtEle.children[0].classList.contains('e-icon-gdownarrow') || trgtEle.children[0].classList.contains('e-icon-grightarrow'))) {\n            this.expandCollapseRows(e.target);\n        }\n        this.applySortFromTarget(e.target);\n        this.unGroupFromTarget(e.target);\n        this.toogleGroupFromHeader(e.target);\n    };\n    Group.prototype.auxilaryclickHandler = function (e) {\n        if (e.target.classList.contains('e-icon-grightarrow') || e.target.classList.contains('e-icon-gdownarrow')\n            && (e.button === 1)) {\n            e.preventDefault();\n        }\n    };\n    Group.prototype.unGroupFromTarget = function (target) {\n        if (target.classList.contains('e-ungroupbutton')) {\n            this.ungroupColumn(target.parentElement.getAttribute('ej-mappingname'));\n        }\n    };\n    Group.prototype.toogleGroupFromHeader = function (target) {\n        if (this.groupSettings.showToggleButton) {\n            if (target.classList.contains('e-grptogglebtn')) {\n                if (target.classList.contains('e-toggleungroup')) {\n                    this.ungroupColumn(this.parent.getColumnByUid(target.parentElement.getAttribute('e-mappinguid')).field);\n                }\n                else {\n                    this.groupColumn(this.parent.getColumnByUid(target.parentElement.getAttribute('e-mappinguid')).field);\n                }\n            }\n            else {\n                if (target.classList.contains('e-toggleungroup')) {\n                    this.ungroupColumn(target.parentElement.getAttribute('ej-mappingname'));\n                }\n            }\n        }\n    };\n    Group.prototype.applySortFromTarget = function (target) {\n        var gObj = this.parent;\n        var gHeader = closest(target, '.e-groupheadercell');\n        if (gObj.allowSorting && gHeader && !target.classList.contains('e-ungroupbutton') &&\n            !target.classList.contains('e-toggleungroup')) {\n            var field = gHeader.firstElementChild.getAttribute('ej-mappingname');\n            if (gObj.getColumnHeaderByField(field).getElementsByClassName('e-ascending').length) {\n                gObj.sortColumn(field, 'Descending', true);\n            }\n            else {\n                gObj.sortColumn(field, 'Ascending', true);\n            }\n        }\n    };\n    /**\n     * Expands or collapses grouped rows by target element.\n     *\n     * @param  {Element} target - Defines the target element of the grouped row.\n     * @returns {void}\n     */\n    Group.prototype.expandCollapseRows = function (target) {\n        var trgt = parentsUntil(target, 'e-recordplusexpand') ||\n            parentsUntil(target, 'e-recordpluscollapse');\n        if (trgt) {\n            var rowNodes = this.parent.getContentTable().querySelector(literals.tbody).children;\n            var isHide = void 0;\n            var dataManager = void 0;\n            var query = void 0;\n            var gObj = this.parent;\n            var indent = trgt.parentElement.getElementsByClassName('e-indentcell').length;\n            var uid = trgt.parentElement.getAttribute('data-uid');\n            var captionRow = gObj.getRowObjectFromUID(uid);\n            var expand = false;\n            if (trgt.classList.contains('e-recordpluscollapse')) {\n                addClass([trgt], 'e-recordplusexpand');\n                removeClass([trgt], 'e-recordpluscollapse');\n                trgt.firstElementChild.className = 'e-icons e-gdiagonaldown e-icon-gdownarrow';\n                trgt.firstElementChild.setAttribute('title', 'expanded');\n                expand = true;\n                captionRow.isExpand = true;\n                if (isGroupAdaptive(gObj)) {\n                    this.updateVirtualRows(gObj, target, expand, query, dataManager);\n                }\n                if (this.parent.groupSettings.enableLazyLoading) {\n                    if ((this.parent.filterSettings.columns.length || this.parent.sortSettings.columns.length ||\n                        this.parent.searchSettings.key.length) && this.parent.getContent().firstElementChild.scrollTop === 0) {\n                        this.parent.contentModule.isTop = true;\n                    }\n                    (this.parent.enableVirtualization ? this.parent.lazyLoadRender :\n                        this.parent.contentModule).captionExpand(trgt.parentElement);\n                }\n            }\n            else {\n                isHide = true;\n                captionRow.isExpand = false;\n                removeClass([trgt], 'e-recordplusexpand');\n                addClass([trgt], 'e-recordpluscollapse');\n                trgt.firstElementChild.className = 'e-icons e-gnextforward e-icon-grightarrow';\n                trgt.firstElementChild.setAttribute('title', 'collapsed');\n                if (isGroupAdaptive(gObj)) {\n                    this.updateVirtualRows(gObj, target, !isHide, query, dataManager);\n                }\n                if (this.parent.groupSettings.enableLazyLoading) {\n                    (this.parent.enableVirtualization ? this.parent.lazyLoadRender :\n                        this.parent.contentModule).captionCollapse(trgt.parentElement);\n                }\n            }\n            this.aria.setExpand(trgt, expand);\n            if (!isGroupAdaptive(gObj) && !this.parent.groupSettings.enableLazyLoading) {\n                var rowObjs = gObj.getRowsObject();\n                var startIdx = rowObjs.indexOf(captionRow);\n                var rowsState = {};\n                var cacheStartIdx = gObj.enableInfiniteScrolling && gObj.infiniteScrollSettings &&\n                    gObj.infiniteScrollSettings.enableCache && rowObjs.length !== rowNodes.length ?\n                    Array.from(rowNodes).indexOf(trgt.parentElement) : undefined;\n                for (var i = startIdx; i < rowObjs.length; i++) {\n                    if (i > startIdx && rowObjs[parseInt(i.toString(), 10)].indent === indent) {\n                        break;\n                    }\n                    if (rowObjs[parseInt(i.toString(), 10)].isDetailRow) {\n                        var visible = rowObjs[i - 1].isExpand && rowObjs[i - 1].visible;\n                        if (cacheStartIdx && cacheStartIdx > 0 && cacheStartIdx < rowNodes.length) {\n                            rowNodes[parseInt(cacheStartIdx.toString(), 10)].style.display = visible ? '' : 'none';\n                        }\n                        else if (isNullOrUndefined(cacheStartIdx)) {\n                            rowNodes[parseInt(i.toString(), 10)].style.display = visible ? '' : 'none';\n                        }\n                    }\n                    else if (rowsState[rowObjs[parseInt(i.toString(), 10)].parentUid] === false) {\n                        rowObjs[parseInt(i.toString(), 10)].visible = false;\n                        if (cacheStartIdx && cacheStartIdx > 0 && cacheStartIdx < rowNodes.length) {\n                            rowNodes[parseInt(cacheStartIdx.toString(), 10)].style.display = 'none';\n                        }\n                        else if (isNullOrUndefined(cacheStartIdx)) {\n                            rowNodes[parseInt(i.toString(), 10)].style.display = 'none';\n                        }\n                    }\n                    else {\n                        if (!(rowObjs[parseInt(i.toString(), 10)].isDataRow || rowObjs[parseInt(i.toString(), 10)].isCaptionRow\n                            || rowObjs[parseInt(i.toString(), 10)].isDetailRow || rowObjs[parseInt(i.toString(), 10)].isAggregateRow)) {\n                            var visible = rowObjs[parseInt(i.toString(), 10)].cells\n                                .some(function (cell) { return cell.isDataCell && cell.visible; });\n                            if (visible === rowObjs[parseInt(i.toString(), 10)].visible) {\n                                continue;\n                            }\n                        }\n                        rowObjs[parseInt(i.toString(), 10)].visible = true;\n                        if (cacheStartIdx && cacheStartIdx > 0 && cacheStartIdx < rowNodes.length) {\n                            rowNodes[parseInt(cacheStartIdx.toString(), 10)].style.display = '';\n                            rowNodes[parseInt(cacheStartIdx.toString(), 10)].classList.remove('e-hide');\n                        }\n                        else if (isNullOrUndefined(cacheStartIdx)) {\n                            rowNodes[parseInt(i.toString(), 10)].style.display = '';\n                            rowNodes[parseInt(i.toString(), 10)].classList.remove('e-hide');\n                        }\n                    }\n                    if (rowObjs[parseInt(i.toString(), 10)].isCaptionRow) {\n                        rowsState[rowObjs[parseInt(i.toString(), 10)].uid] = rowObjs[parseInt(i.toString(), 10)].isExpand\n                            && rowObjs[parseInt(i.toString(), 10)].visible;\n                    }\n                    if (!isNullOrUndefined(cacheStartIdx)) {\n                        cacheStartIdx++;\n                    }\n                }\n                this.lastCaptionRowBorder();\n                this.parent.notify(events.refreshExpandandCollapse, { rows: this.parent.getRowsObject() });\n            }\n            if (!this.parent.enableInfiniteScrolling || !this.parent.groupSettings.enableLazyLoading) {\n                this.parent.notify(events.captionActionComplete, { isCollapse: isHide, parentUid: uid });\n            }\n        }\n    };\n    /**\n     * The function is used to set border in last row\n     *\n     * @returns { void }\n     * @hidden\n     */\n    Group.prototype.lastCaptionRowBorder = function () {\n        var table = this.parent.getContentTable();\n        var clientHeight = this.parent.getContent().clientHeight;\n        if ((!this.parent.enableVirtualization && !this.parent.enableInfiniteScrolling) ||\n            this.parent.groupSettings.enableLazyLoading) {\n            if (table.scrollHeight < clientHeight || this.isAppliedCaptionRowBorder) {\n                if (this.isAppliedCaptionRowBorder || table.querySelector('.e-lastrowcell')) {\n                    var borderCells = table.querySelectorAll('.e-lastrowcell');\n                    for (var i = 0, len = borderCells.length; i < len; i++) {\n                        removeClass([borderCells[parseInt(i.toString(), 10)]], 'e-lastrowcell');\n                    }\n                    this.isAppliedCaptionRowBorder = false;\n                }\n                var rowNodes = this.parent.getContentTable().querySelector(literals.tbody).children;\n                var lastRow = rowNodes[rowNodes.length - 1];\n                if (lastRow.style.display !== 'none' && !lastRow.classList.contains('e-groupcaptionrow')) {\n                    if (table.scrollHeight < clientHeight) {\n                        addClass(table.querySelectorAll('tr:last-child td'), 'e-lastrowcell');\n                        this.isAppliedCaptionRowBorder = true;\n                    }\n                }\n                else {\n                    for (var i = rowNodes.length - 1, len = 0; i > len; i--) {\n                        if (rowNodes[parseInt(i.toString(), 10)].style.display !== 'none'\n                            && rowNodes[parseInt(i.toString(), 10)].classList.contains('e-groupcaptionrow')) {\n                            if (rowNodes[parseInt(i.toString(), 10)].querySelector('.e-recordpluscollapse')) {\n                                addClass(rowNodes[parseInt(i.toString(), 10)].childNodes, 'e-lastrowcell');\n                                this.isAppliedCaptionRowBorder = true;\n                                break;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    };\n    Group.prototype.updateVirtualRows = function (gObj, target, isExpand, query, dataManager) {\n        var rObj = gObj.getRowObjectFromUID(target.closest('tr').getAttribute('data-uid'));\n        rObj.isExpand = isExpand;\n        updatecloneRow(gObj);\n        this.parent.notify(events.refreshVirtualMaxPage, {});\n        query = gObj.getDataModule().generateQuery(false);\n        query.queries = gObj.getDataModule().aggregateQuery(gObj.getQuery().clone()).queries;\n        var args = { requestType: 'virtualscroll', rowObject: rObj };\n        if (gObj.contentModule) {\n            args.virtualInfo = gObj.contentModule.prevInfo;\n        }\n        dataManager = gObj.getDataModule().getData(args, query.requiresCount());\n        dataManager.then(function (e) { return gObj.renderModule.dataManagerSuccess(e, args); });\n    };\n    Group.prototype.expandCollapse = function (isExpand) {\n        if (!this.parent.groupSettings.columns.length) {\n            return;\n        }\n        if (!isExpand) {\n            this.parent.notify(events.initialCollapse, isExpand);\n        }\n        var rowNodes = this.parent.getContentTable().querySelector(literals.tbody).children;\n        var rowObjs = this.parent.getRowsObject();\n        var row;\n        for (var i = 0, len = rowNodes.length; i < len; i++) {\n            if (rowNodes[parseInt(i.toString(), 10)].querySelectorAll('.e-recordplusexpand, .e-recordpluscollapse').length) {\n                row = rowNodes[parseInt(i.toString(), 10)].querySelector(isExpand ? '.e-recordpluscollapse' : '.e-recordplusexpand');\n                if (row) {\n                    if (isExpand) {\n                        row.className = 'e-recordplusexpand';\n                        row.firstElementChild.className = 'e-icons e-gdiagonaldown e-icon-gdownarrow';\n                        row.setAttribute('aria-expanded', 'true');\n                        row.firstElementChild.setAttribute('title', 'expanded');\n                    }\n                    else {\n                        row.className = 'e-recordpluscollapse';\n                        row.firstElementChild.className = 'e-icons e-gnextforward e-icon-grightarrow';\n                        row.setAttribute('aria-expanded', 'false');\n                        row.firstElementChild.setAttribute('title', 'collapsed');\n                    }\n                }\n                if (!(rowNodes[parseInt(i.toString(), 10)].firstElementChild.classList.contains('e-recordplusexpand') ||\n                    rowNodes[parseInt(i.toString(), 10)].firstElementChild.classList.contains('e-recordpluscollapse'))) {\n                    rowNodes[parseInt(i.toString(), 10)].style.display = isExpand ? '' : 'none';\n                }\n            }\n            else {\n                rowNodes[parseInt(i.toString(), 10)].style.display = isExpand ? '' : 'none';\n            }\n            if (rowObjs[parseInt(i.toString(), 10)].isCaptionRow) {\n                rowObjs[parseInt(i.toString(), 10)].isExpand = isExpand ? true : false;\n            }\n        }\n        this.parent.updateVisibleExpandCollapseRows();\n        this.lastCaptionRowBorder();\n        this.parent.notify(events.refreshExpandandCollapse, { rows: this.parent.getRowsObject() });\n    };\n    /**\n     * Expands all the grouped rows of the Grid.\n     *\n     * @returns {void}\n     */\n    Group.prototype.expandAll = function () {\n        this.expandCollapse(true);\n    };\n    /**\n     * Collapses all the grouped rows of the Grid.\n     *\n     * @returns {void}\n     */\n    Group.prototype.collapseAll = function () {\n        this.expandCollapse(false);\n    };\n    /**\n     * The function is used to render grouping\n     *\n     * @returns {void}\n     * @hidden\n     */\n    Group.prototype.render = function () {\n        this.l10n = this.serviceLocator.getService('localization');\n        this.renderGroupDropArea();\n        this.initDragAndDrop();\n        this.refreshToggleBtn();\n        this.wireEvent();\n    };\n    Group.prototype.renderGroupDropArea = function () {\n        var groupElem = this.parent.element.querySelector('.e-groupdroparea');\n        if (groupElem) {\n            remove(groupElem);\n        }\n        this.element = this.parent.createElement('div', { className: 'e-groupdroparea', attrs: { 'tabindex': '-1' } });\n        if (this.groupSettings.allowReordering) {\n            this.element.classList.add('e-group-animate');\n        }\n        this.updateGroupDropArea();\n        this.parent.element.insertBefore(this.element, this.parent.element.firstChild);\n        if (!this.groupSettings.showDropArea || this.parent.rowRenderingMode === 'Vertical') {\n            this.element.style.display = 'none';\n        }\n    };\n    Group.prototype.updateGroupDropArea = function (clear) {\n        if (this.groupSettings.showDropArea && !this.groupSettings.columns.length) {\n            var dragLabel = this.l10n.getConstant('GroupDropArea');\n            this.element.innerHTML = dragLabel;\n            this.element.classList.remove('e-grouped');\n        }\n        else {\n            if ((this.element.innerHTML === this.l10n.getConstant('GroupDropArea') && (this.groupSettings.columns.length === 1\n                || !this.isAppliedGroup && !this.isAppliedUnGroup)) || clear) {\n                this.element.innerHTML = '';\n            }\n            this.element.classList.add('e-grouped');\n        }\n    };\n    Group.prototype.initDragAndDrop = function () {\n        this.initializeGHeaderDrop();\n        this.initializeGHeaderDrag();\n    };\n    Group.prototype.initializeGHeaderDrag = function () {\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        var drag = new Draggable(this.element, {\n            dragTarget: this.groupSettings.allowReordering ? '.e-drag' : '.e-groupheadercell',\n            distance: this.groupSettings.allowReordering ? -10 : 5,\n            helper: this.helper,\n            dragStart: this.dragStart,\n            drag: this.drag,\n            dragStop: this.dragStop\n        });\n    };\n    Group.prototype.initializeGHeaderDrop = function () {\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        var drop = new Droppable(this.element, {\n            accept: '.e-dragclone',\n            drop: this.drop\n        });\n    };\n    /**\n     * Groups a column by column name.\n     *\n     * @param  {string} columnName - Defines the column name to group.\n     * @returns {void}\n     */\n    Group.prototype.groupColumn = function (columnName) {\n        var gObj = this.parent;\n        var column = gObj.getColumnByField(columnName);\n        if (isNullOrUndefined(column) || column.allowGrouping === false ||\n            (this.contentRefresh && this.groupSettings.columns.indexOf(columnName) > -1)) {\n            this.parent.log('action_disabled_column', { moduleName: this.getModuleName(), columnName: column.headerText });\n            return;\n        }\n        if (isActionPrevent(gObj)) {\n            gObj.notify(events.preventBatch, { instance: this, handler: this.groupColumn, arg1: columnName });\n            return;\n        }\n        column.visible = gObj.groupSettings.showGroupedColumn;\n        this.colName = columnName;\n        this.isAppliedGroup = true;\n        if (this.contentRefresh) {\n            this.updateModel();\n        }\n        else {\n            this.addColToGroupDrop(columnName);\n        }\n        this.updateGroupDropArea();\n        this.isAppliedGroup = false;\n    };\n    /**\n     * Ungroups a column by column name.\n     *\n     * @param  {string} columnName - Defines the column name to ungroup.\n     * @returns {void}\n     */\n    Group.prototype.ungroupColumn = function (columnName) {\n        var gObj = this.parent;\n        var column = this.parent.enableColumnVirtualization ?\n            this.parent.columns.filter(function (c) { return c.field === columnName; })[0] : gObj.getColumnByField(columnName);\n        if (isNullOrUndefined(column) || column.allowGrouping === false || this.groupSettings.columns.indexOf(columnName) < 0) {\n            return;\n        }\n        if (isActionPrevent(gObj)) {\n            gObj.notify(events.preventBatch, { instance: this, handler: this.ungroupColumn, arg1: columnName });\n            return;\n        }\n        column.visible = true;\n        this.colName = column.field;\n        var columns = JSON.parse(JSON.stringify(this.groupSettings.columns));\n        columns.splice(columns.indexOf(this.colName), 1);\n        if (this.sortedColumns.indexOf(columnName) < 0) {\n            for (var i = 0, len = gObj.sortSettings.columns.length; i < len; i++) {\n                if (columnName === gObj.sortSettings.columns[parseInt(i.toString(), 10)].field) {\n                    gObj.sortSettings.columns.splice(i, 1);\n                    break;\n                }\n            }\n        }\n        if (this.groupSettings.allowReordering) {\n            this.reorderingColumns = columns;\n        }\n        this.groupSettings.columns = columns;\n        if (gObj.allowGrouping) {\n            this.isAppliedUnGroup = true;\n            this.parent.dataBind();\n        }\n    };\n    /**\n     * The function used to update groupSettings\n     *\n     * @returns {void}\n     * @hidden\n     */\n    Group.prototype.updateModel = function () {\n        var columns = JSON.parse(JSON.stringify(this.groupSettings.columns));\n        columns = this.reorderingColumns.length ? JSON.parse(JSON.stringify(this.reorderingColumns)) : columns;\n        if (this.sortRequired) {\n            if (columns.indexOf(this.colName) === -1) {\n                columns.push(this.colName);\n            }\n            this.groupAddSortingQuery(this.colName);\n        }\n        this.sortRequired = true;\n        this.parent.groupSettings.columns = columns;\n        this.parent.dataBind();\n    };\n    /**\n     * The function used to trigger onActionComplete\n     *\n     * @param {NotifyArgs} e - specifies the NotifyArgs\n     * @returns {void}\n     * @hidden\n     */\n    Group.prototype.onActionComplete = function (e) {\n        if (e.requestType === 'grouping') {\n            this.addColToGroupDrop(this.colName);\n        }\n        else {\n            this.removeColFromGroupDrop(this.colName);\n        }\n        var args = this.groupSettings.columns.indexOf(this.colName) > -1 ? {\n            columnName: this.colName, requestType: 'grouping', type: events.actionComplete\n        } : { requestType: 'ungrouping', type: events.actionComplete };\n        this.parent.trigger(events.actionComplete, extend(e, args));\n        this.colName = null;\n    };\n    Group.prototype.groupAddSortingQuery = function (colName) {\n        var i = 0;\n        while (i < this.parent.sortSettings.columns.length) {\n            if (this.parent.sortSettings.columns[parseInt(i.toString(), 10)].field === colName) {\n                break;\n            }\n            i++;\n        }\n        if (this.parent.sortSettings.columns.length === i) {\n            this.parent.sortSettings.columns.push({ field: colName, direction: 'Ascending', isFromGroup: true });\n        }\n        else if (!this.parent.allowSorting) {\n            this.parent.sortSettings.columns[parseInt(i.toString(), 10)].direction = 'Ascending';\n        }\n    };\n    Group.prototype.createElement = function (field) {\n        var gObj = this.parent;\n        var direction = 'Ascending';\n        var animator = this.parent.createElement('div', { className: 'e-grid-icon e-group-animator' });\n        var groupedColumn = this.parent.createElement('div', { className: 'e-grid-icon e-groupheadercell' });\n        var childDiv = this.parent.createElement('div', { attrs: { 'ej-mappingname': field } });\n        if (isComplexField(field)) {\n            childDiv.setAttribute('ej-complexname', getComplexFieldID(field));\n        }\n        var column = this.parent.getColumnByField(field);\n        //Todo headerTemplateID for grouped column, disableHtmlEncode\n        var headerCell = gObj.getColumnHeaderByUid(column.uid);\n        // if (!isNullOrUndefined(column.headerTemplate)) {\n        //     if (column.headerTemplate.indexOf('#') !== -1) {\n        //         childDiv.innerHTML = document.querySelector(column.headerTemplate).innerHTML.trim();\n        //     } else {\n        //         childDiv.innerHTML = column.headerTemplate;\n        //     }\n        //     childDiv.firstElementChild.classList.add('e-grouptext');\n        // } else {\n        if (this.groupSettings.allowReordering) {\n            childDiv.appendChild(this.parent.createElement('span', {\n                className: 'e-drag e-icons e-icon-drag', innerHTML: '&nbsp;',\n                attrs: { title: 'Drag', tabindex: '-1', 'aria-label': this.l10n.getConstant('GroupedDrag') }\n            }));\n        }\n        childDiv.appendChild(this.parent.createElement('span', {\n            className: 'e-grouptext', innerHTML: column.headerText,\n            attrs: { tabindex: '-1' }\n        }));\n        // }\n        if (this.groupSettings.showToggleButton) {\n            childDiv.appendChild(this.parent.createElement('span', {\n                className: 'e-togglegroupbutton e-icons e-icon-ungroup e-toggleungroup', innerHTML: '&nbsp;',\n                attrs: { tabindex: '-1', 'aria-label': this.l10n.getConstant('UnGroupAria') }\n            }));\n        }\n        if (headerCell.querySelectorAll('.e-ascending,.e-descending').length) {\n            direction = headerCell.querySelector('.e-ascending') ? 'Ascending' : 'Descending';\n        }\n        childDiv.appendChild(this.parent.createElement('span', {\n            className: 'e-groupsort e-icons ' +\n                ('e-' + direction.toLowerCase() + ' e-icon-' + direction.toLowerCase()), innerHTML: '&nbsp;',\n            attrs: { tabindex: '-1', 'aria-label': this.l10n.getConstant('GroupedSortIcon') + column.headerText, role: 'button' }\n        }));\n        childDiv.appendChild(this.parent.createElement('span', {\n            className: 'e-ungroupbutton e-icons e-icon-hide', innerHTML: '&nbsp;',\n            attrs: { title: this.l10n.getConstant('UnGroup'),\n                tabindex: '-1', 'aria-label': this.l10n.getConstant('UnGroupIcon') + column.headerText, role: 'button' },\n            styles: this.groupSettings.showUngroupButton ? '' : 'display:none'\n        }));\n        groupedColumn.appendChild(childDiv);\n        if (this.groupSettings.allowReordering) {\n            animator.appendChild(groupedColumn);\n            animator.appendChild(this.createSeparator());\n            groupedColumn = animator;\n        }\n        return groupedColumn;\n    };\n    Group.prototype.addColToGroupDrop = function (field) {\n        var groupElem = isComplexField(field) ? this.parent.element.querySelector('.e-groupdroparea div[ej-complexname=' +\n            getParsedFieldID(getComplexFieldID(field)) + ']') : this.parent.element.querySelector('.e-groupdroparea div[ej-mappingname=' + getParsedFieldID(field) + ']');\n        if (this.groupSettings.allowReordering && groupElem) {\n            return;\n        }\n        var column = this.parent.getColumnByField(field);\n        if (isNullOrUndefined(column)) {\n            return;\n        }\n        var groupedColumn = this.createElement(field);\n        if (this.groupSettings.allowReordering) {\n            var index = this.element.getElementsByClassName('e-group-animator').length;\n            groupedColumn.setAttribute('index', index.toString());\n        }\n        this.element.appendChild(groupedColumn);\n        var focusModule = this.parent.focusModule;\n        focusModule.setActive(true);\n        var firstContentCellIndex = [0, 0];\n        if (focusModule.active.matrix.matrix[firstContentCellIndex[0]][firstContentCellIndex[1]] === 0) {\n            firstContentCellIndex = findCellIndex(focusModule.active.matrix.matrix, firstContentCellIndex, true);\n        }\n        focusModule.active.matrix.current = firstContentCellIndex;\n        focusModule.active.getTable().rows[focusModule.active.matrix.current[0]].cells[focusModule.active.matrix.current[1]].focus();\n        //Todo:  rtl\n    };\n    Group.prototype.createSeparator = function () {\n        return this.parent.createElement('span', {\n            className: 'e-nextgroup e-icons e-icon-next', innerHTML: '&nbsp;',\n            attrs: { tabindex: '-1', 'aria-label': this.l10n.getConstant('GroupSeperator') },\n            styles: this.groupSettings.showUngroupButton ? '' : 'display:none'\n        });\n    };\n    Group.prototype.refreshToggleBtn = function (isRemove) {\n        if (this.groupSettings.showToggleButton) {\n            var headers = [].slice.call(this.parent.getHeaderTable().getElementsByClassName('e-headercelldiv'));\n            for (var i = 0, len = headers.length; i < len; i++) {\n                if (!((headers[parseInt(i.toString(), 10)].classList.contains('e-emptycell')) || (headers[parseInt(i.toString(), 10)].classList.contains('e-headerchkcelldiv')))) {\n                    var column = this.parent.getColumnByUid(headers[parseInt(i.toString(), 10)].getAttribute('e-mappinguid'));\n                    if (!this.parent.showColumnMenu || (this.parent.showColumnMenu && !column.showColumnMenu)) {\n                        if (headers[parseInt(i.toString(), 10)].getElementsByClassName('e-grptogglebtn').length) {\n                            remove(headers[parseInt(i.toString(), 10)].querySelectorAll('.e-grptogglebtn')[0]);\n                        }\n                        if (!isRemove) {\n                            headers[parseInt(i.toString(), 10)].appendChild(this.parent.createElement('span', {\n                                className: 'e-grptogglebtn e-icons ' + (this.groupSettings.columns.indexOf(column.field) > -1 ?\n                                    'e-toggleungroup e-icon-ungroup' : 'e-togglegroup e-icon-group'), attrs: { tabindex: '-1',\n                                    'aria-label': isNullOrUndefined(this.l10n) ? this.parent.localeObj.getConstant('GroupButton')\n                                        : this.l10n.getConstant('GroupButton') }\n                            }));\n                        }\n                    }\n                }\n            }\n        }\n    };\n    Group.prototype.removeColFromGroupDrop = function (field) {\n        if (!isNullOrUndefined(this.getGHeaderCell(field))) {\n            var elem = this.getGHeaderCell(field);\n            if (this.groupSettings.allowReordering) {\n                var parent_1 = parentsUntil(elem, 'e-group-animator');\n                remove(parent_1);\n            }\n            else {\n                remove(elem);\n            }\n            this.updateGroupDropArea();\n        }\n        this.isAppliedUnGroup = false;\n    };\n    Group.prototype.onPropertyChanged = function (e) {\n        if (e.module !== this.getModuleName()) {\n            return;\n        }\n        for (var _i = 0, _a = Object.keys(e.properties); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'columns':\n                    // eslint-disable-next-line no-case-declarations\n                    var args = void 0;\n                    if (this.contentRefresh) {\n                        if (!this.isAppliedUnGroup) {\n                            if (!this.isAppliedGroup) {\n                                this.updateGroupDropArea(true);\n                                for (var j = 0; j < this.parent.sortSettings.columns.length; j++) {\n                                    if (this.parent.sortSettings.columns[parseInt(j.toString(), 10)].isFromGroup) {\n                                        this.parent.sortSettings.columns.splice(j, 1);\n                                        j--;\n                                    }\n                                }\n                                for (var i = 0; i < this.groupSettings.columns.length; i++) {\n                                    this.colName = this.groupSettings.columns[parseInt(i.toString(), 10)];\n                                    var col = this.parent.getColumnByField(this.colName);\n                                    col.visible = this.parent.groupSettings.showGroupedColumn;\n                                    this.groupAddSortingQuery(this.colName);\n                                    if (i < this.groupSettings.columns.length - 1) {\n                                        this.addColToGroupDrop(this.groupSettings.columns[parseInt(i.toString(), 10)]);\n                                    }\n                                }\n                            }\n                            args = {\n                                columnName: this.colName, requestType: e.properties[\"\" + prop].length ? 'grouping' : 'ungrouping',\n                                type: events.actionBegin\n                            };\n                        }\n                        else {\n                            args = { columnName: this.colName, requestType: 'ungrouping', type: events.actionBegin };\n                        }\n                        if (!this.groupSettings.showGroupedColumn) {\n                            var columns = e.oldProperties[\"\" + prop];\n                            for (var i = 0; i < columns.length; i++) {\n                                if (e.properties[\"\" + prop].indexOf(columns[parseInt(i.toString(), 10)]) === -1) {\n                                    this.parent.getColumnByField(columns[parseInt(i.toString(), 10)]).visible = true;\n                                }\n                            }\n                        }\n                        this.parent.notify(events.modelChanged, args);\n                    }\n                    break;\n                case 'showDropArea':\n                    this.updateGroupDropArea();\n                    if (this.groupSettings.showDropArea) {\n                        this.element.style.display = '';\n                        this.parent.headerModule.refreshUI();\n                    }\n                    else {\n                        this.element.style.display = 'none';\n                    }\n                    if (this.parent.height === '100%') {\n                        this.parent.scrollModule.refresh();\n                    }\n                    break;\n                case 'showGroupedColumn':\n                    this.updateGroupedColumn(this.groupSettings.showGroupedColumn);\n                    this.parent.notify(events.modelChanged, { requestType: 'refresh' });\n                    break;\n                case 'showUngroupButton':\n                    this.updateButtonVisibility(this.groupSettings.showUngroupButton, 'e-ungroupbutton');\n                    break;\n                case 'showToggleButton':\n                    this.updateButtonVisibility(this.groupSettings.showToggleButton, 'e-togglegroupbutton ');\n                    this.parent.refreshHeader();\n                    break;\n                case 'enableLazyLoading':\n                    this.parent.freezeRefresh();\n                    break;\n            }\n        }\n    };\n    Group.prototype.updateGroupedColumn = function (isVisible) {\n        for (var i = 0; i < this.groupSettings.columns.length; i++) {\n            this.parent.getColumnByField(this.groupSettings.columns[parseInt(i.toString(), 10)]).visible = isVisible;\n        }\n    };\n    Group.prototype.updateButtonVisibility = function (isVisible, className) {\n        var gHeader = [].slice.call(this.element.getElementsByClassName(className));\n        for (var i = 0; i < gHeader.length; i++) {\n            gHeader[parseInt(i.toString(), 10)].style.display = isVisible ? '' : 'none';\n        }\n    };\n    Group.prototype.enableAfterRender = function (e) {\n        if (e.module === this.getModuleName() && e.enable) {\n            this.render();\n        }\n    };\n    /**\n     * To destroy the reorder\n     *\n     * @returns {void}\n     * @hidden\n     */\n    Group.prototype.destroy = function () {\n        var gridElement = this.parent.element;\n        if (!gridElement || (!gridElement.querySelector('.' + literals.gridHeader) && !gridElement.querySelector('.' + literals.gridContent))) {\n            return;\n        }\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        if ((this.parent.isDestroyed || !this.parent.allowGrouping) && !this.parent.refreshing) {\n            this.clearGrouping();\n        }\n        this.unWireEvent();\n        this.removeEventListener();\n        this.refreshToggleBtn(true);\n        if (this.element.parentNode) {\n            remove(this.element);\n        }\n        //call ejdrag and drop destroy\n    };\n    /**\n     * Clears all the grouped columns of the Grid.\n     *\n     * @returns {void}\n     */\n    Group.prototype.clearGrouping = function () {\n        var cols = JSON.parse(JSON.stringify(this.groupSettings.columns));\n        this.contentRefresh = false;\n        for (var i = 0, len = cols.length; i < len; i++) {\n            if (i === (len - 1)) {\n                this.contentRefresh = true;\n            }\n            this.ungroupColumn(cols[parseInt(i.toString(), 10)]);\n        }\n        this.contentRefresh = true;\n    };\n    /**\n     * For internal use only - Get the module name.\n     *\n     * @returns {string} returns the module name\n     * @private\n     */\n    Group.prototype.getModuleName = function () {\n        return 'group';\n    };\n    Group.prototype.refreshSortIcons = function () {\n        var gObj = this.parent;\n        var header;\n        var cols = gObj.sortSettings.columns;\n        var gCols = gObj.groupSettings.columns;\n        var fieldNames = this.parent.getColumns().map(function (c) { return c.field; });\n        this.refreshToggleBtn();\n        for (var i = 0, len = cols.length; i < len; i++) {\n            if (fieldNames.indexOf(cols[parseInt(i.toString(), 10)].field) === -1) {\n                continue;\n            }\n            header = gObj.getColumnHeaderByField(cols[parseInt(i.toString(), 10)].field);\n            if (!gObj.allowSorting && (this.sortedColumns.indexOf(cols[parseInt(i.toString(), 10)].field) > -1 ||\n                this.groupSettings.columns.indexOf(cols[parseInt(i.toString(), 10)].field) > -1)) {\n                classList(header.querySelector('.e-sortfilterdiv'), ['e-ascending', 'e-icon-ascending'], []);\n                if (cols.length > 1) {\n                    header.querySelector('.e-headercelldiv').appendChild(this.parent.createElement('span', { className: 'e-sortnumber', innerHTML: (i + 1).toString() }));\n                }\n            }\n            else if (this.getGHeaderCell(cols[parseInt(i.toString(), 10)].field) && this.getGHeaderCell(cols[parseInt(i.toString(), 10)].field).getElementsByClassName('e-groupsort').length) {\n                if (cols[parseInt(i.toString(), 10)].direction === 'Ascending') {\n                    classList(this.getGHeaderCell(cols[parseInt(i.toString(), 10)].field).querySelector('.e-groupsort'), ['e-ascending', 'e-icon-ascending'], ['e-descending', 'e-icon-descending']);\n                }\n                else {\n                    classList(this.getGHeaderCell(cols[parseInt(i.toString(), 10)].field).querySelector('.e-groupsort'), ['e-descending', 'e-icon-descending'], ['e-ascending', 'e-icon-ascending']);\n                }\n            }\n        }\n        for (var i = 0, len = gCols.length; i < len; i++) {\n            if (fieldNames.indexOf(gCols[parseInt(i.toString(), 10)]) === -1) {\n                continue;\n            }\n            gObj.getColumnHeaderByField(gCols[parseInt(i.toString(), 10)]).setAttribute('aria-grouped', 'true');\n        }\n    };\n    Group.prototype.getGHeaderCell = function (field) {\n        if (this.element && this.element.querySelector('[ej-mappingname=\"' + field + '\"]')) {\n            return this.element.querySelector('[ej-mappingname=\"' + field + '\"]').parentElement;\n        }\n        return null;\n    };\n    Group.prototype.onGroupAggregates = function (editedData) {\n        if (this.parent.groupSettings.enableLazyLoading) {\n            if (this.parent.editSettings.mode !== 'Batch') {\n                this.updateLazyLoadGroupAggregates(editedData);\n            }\n            return;\n        }\n        var aggregates = this.iterateGroupAggregates(editedData);\n        var rowData = this.groupGenerator.generateRows(aggregates, {});\n        var summaryRows = this.parent.getRowsObject().filter(function (row) { return !row.isDataRow; });\n        var updateSummaryRows = rowData.filter(function (data) { return !data.isDataRow; });\n        if (this.parent.isReact || this.parent.isVue) {\n            this.parent.destroyTemplate(['groupFooterTemplate', 'groupCaptionTemplate', 'footerTemplate']);\n        }\n        for (var i = 0; i < updateSummaryRows.length; i++) {\n            var row = updateSummaryRows[parseInt(i.toString(), 10)];\n            var cells = row.cells.filter(function (cell) { return cell.isDataCell; });\n            var args = { cells: cells, data: row.data, dataUid: summaryRows[parseInt(i.toString(), 10)] ? summaryRows[parseInt(i.toString(), 10)].uid : '' };\n            this.parent.notify(events.refreshAggregateCell, args);\n        }\n    };\n    Group.prototype.updateLazyLoadGroupAggregates = function (data, remoteResult) {\n        var _this = this;\n        var groupCaptionTemplates = this.getGroupAggregateTemplates(true);\n        var groupFooterTemplates = this.getGroupAggregateTemplates(false);\n        if (!groupCaptionTemplates.length && !groupFooterTemplates.length) {\n            return;\n        }\n        var gObj = this.parent;\n        var isRemote = gObj.getDataModule().isRemote();\n        var updatedData = data[0];\n        var editedRow = data.row;\n        var groupedCols = gObj.groupSettings.columns;\n        var groupLazyLoadRenderer = gObj.contentModule;\n        var groupCache = groupLazyLoadRenderer.getGroupCache();\n        var currentPageGroupCache = groupCache[gObj.pageSettings.currentPage];\n        var result = remoteResult ? remoteResult : [];\n        var _loop_1 = function (i) {\n            var groupField = groupedCols[parseInt(i.toString(), 10)];\n            var groupKey = updatedData[\"\" + groupField];\n            var groupCaptionRowObject = this_1.getGroupCaptionRowObject(editedRow, groupedCols.length - i);\n            if (isRemote && result.length) {\n                if (i !== 0) {\n                    var prevGroupField = groupedCols[i - 1];\n                    var prevGroupKey_1 = updatedData[\"\" + prevGroupField];\n                    result = result.find(function (data) {\n                        return data.key === prevGroupKey_1;\n                    }).items;\n                }\n                this_1.updateLazyLoadGroupAggregatesRow(result, groupKey, groupCaptionRowObject, currentPageGroupCache, groupCaptionTemplates, groupFooterTemplates);\n            }\n            else {\n                var query = gObj.renderModule.data.generateQuery();\n                if (i !== 0) {\n                    var currentLevelCaptionRowObjects = currentPageGroupCache.filter(function (data) {\n                        return data.isCaptionRow && data.parentUid === groupCaptionRowObject.parentUid;\n                    });\n                    var index = currentLevelCaptionRowObjects.indexOf(groupCaptionRowObject);\n                    var fields = gObj.groupSettings.columns.slice(0, i).reverse();\n                    var keys = fields.map(function (data) {\n                        return updatedData[\"\" + data];\n                    });\n                    var pred = generateExpandPredicates(fields, keys, groupLazyLoadRenderer);\n                    var predicateList = getPredicates(pred);\n                    var lazyLoad = { level: i, skip: index, take: 1, where: predicateList };\n                    query.lazyLoad.push({ key: 'onDemandGroupInfo', value: lazyLoad });\n                }\n                gObj.renderModule.data.getData({}, query).then(function (e) {\n                    if (isRemote) {\n                        _this.updateLazyLoadGroupAggregates(data, e.result);\n                    }\n                    else {\n                        _this.updateLazyLoadGroupAggregatesRow(e.result, groupKey, groupCaptionRowObject, currentPageGroupCache, groupCaptionTemplates, groupFooterTemplates);\n                    }\n                    if (i === groupedCols.length - 1 || isRemote) {\n                        _this.destroyRefreshGroupCaptionFooterTemplate();\n                    }\n                }).catch(function (e) { return gObj.renderModule.dataManagerFailure(e, { requestType: 'grouping' }); });\n                if (isRemote) {\n                    return \"break\";\n                }\n            }\n        };\n        var this_1 = this;\n        for (var i = 0; i < groupedCols.length; i++) {\n            var state_1 = _loop_1(i);\n            if (state_1 === \"break\")\n                break;\n        }\n    };\n    Group.prototype.destroyRefreshGroupCaptionFooterTemplate = function () {\n        var gObj = this.parent;\n        if (gObj.isAngular || gObj.isReact || gObj.isVue) {\n            gObj.destroyTemplate(['groupCaptionTemplate', 'groupFooterTemplate']);\n        }\n        gObj.refreshGroupCaptionFooterTemplate();\n        gObj.removeMaskRow();\n        gObj.hideSpinner();\n    };\n    Group.prototype.updateLazyLoadGroupAggregatesRow = function (result, groupKey, groupCaptionRowObject, currentPageGroupCache, groupCaptionTemplates, groupFooterTemplates) {\n        var updatedGroupCaptionData = result.find(function (data) {\n            return data.key === groupKey;\n        });\n        if (groupCaptionTemplates.length) {\n            this.updateLazyLoadGroupAggregatesCell(updatedGroupCaptionData, groupCaptionRowObject, groupCaptionTemplates);\n        }\n        if (groupFooterTemplates.length) {\n            var groupFooterRowObject = currentPageGroupCache.find(function (data) {\n                return data.isAggregateRow && data.parentUid === groupCaptionRowObject.uid;\n            });\n            this.updateLazyLoadGroupAggregatesCell(updatedGroupCaptionData, groupFooterRowObject, groupFooterTemplates);\n        }\n    };\n    Group.prototype.updateLazyLoadGroupAggregatesCell = function (updatedGroupCaptionData, captionFooterRowObject, captionFooterTemplates) {\n        var prevCaptionFooterData = captionFooterRowObject.data;\n        var updatedGroupCaptionDataAggregates = updatedGroupCaptionData.aggregates;\n        if (captionFooterRowObject.isCaptionRow) {\n            prevCaptionFooterData.aggregates = updatedGroupCaptionDataAggregates;\n        }\n        for (var i = 0; i < captionFooterTemplates.length; i++) {\n            var template = captionFooterTemplates[parseInt(i.toString(), 10)];\n            var key = template.field + ' - ' + template.type;\n            var fieldData = prevCaptionFooterData[template.field];\n            fieldData[\"\" + key] = updatedGroupCaptionDataAggregates[\"\" + key];\n            fieldData[capitalizeFirstLetter(template.type)] = updatedGroupCaptionDataAggregates[\"\" + key];\n            if (fieldData[template.type]) {\n                fieldData[template.type] = updatedGroupCaptionDataAggregates[\"\" + key];\n            }\n        }\n    };\n    Group.prototype.getGroupCaptionRowObject = function (element, groupCaptionIndex) {\n        var gObj = this.parent;\n        var uid = element.getAttribute('data-uid');\n        var parentCaptionRowObject = gObj.getRowObjectFromUID(uid);\n        for (var i = 0; i < groupCaptionIndex; i++) {\n            parentCaptionRowObject = gObj.getRowObjectFromUID(parentCaptionRowObject.parentUid);\n        }\n        return parentCaptionRowObject;\n    };\n    /**\n     * @param { boolean } groupCaptionTemplate - Defines template either group caption or footer\n     * @returns { Object[] } - Returns template array\n     * @hidden\n     */\n    Group.prototype.getGroupAggregateTemplates = function (groupCaptionTemplate) {\n        var aggregates = [];\n        var aggregateRows = this.parent.aggregates;\n        for (var j = 0; j < aggregateRows.length; j++) {\n            var row = aggregateRows[parseInt(j.toString(), 10)];\n            for (var k = 0; k < row.columns.length; k++) {\n                if ((groupCaptionTemplate && row.columns[parseInt(k.toString(), 10)].groupCaptionTemplate)\n                    || (!groupCaptionTemplate && row.columns[parseInt(k.toString(), 10)].groupFooterTemplate)) {\n                    var aggr = {};\n                    var type = row.columns[parseInt(k.toString(), 10)].type.toString();\n                    aggr = { type: type.toLowerCase(), field: row.columns[parseInt(k.toString(), 10)].field };\n                    aggregates.push(aggr);\n                }\n            }\n        }\n        return aggregates;\n    };\n    /**\n     * @param { Row<Column> } fromRowObj - Defines group key changed Data row object.\n     * @param { Row<Column> } toRowObj - Defines group key setting reference Data row object.\n     * @returns { void }\n     * @hidden\n     */\n    Group.prototype.groupedRowReorder = function (fromRowObj, toRowObj) {\n        var dragRow = this.parent.getRowElementByUID(fromRowObj.uid);\n        var dropRow = this.parent.getRowElementByUID(toRowObj.uid);\n        var dropArgs = {\n            rows: [dragRow], target: dropRow, fromIndex: fromRowObj.index, dropIndex: toRowObj.index\n        };\n        if (!isNullOrUndefined(fromRowObj) && !isNullOrUndefined(toRowObj) &&\n            fromRowObj.parentUid !== toRowObj.parentUid) {\n            if (dropRow) {\n                if (dropRow['style'].display === 'none') {\n                    dragRow['style'].display = 'none';\n                }\n                if (dropArgs.fromIndex > dropArgs.dropIndex) {\n                    this.parent.getContentTable().querySelector(literals.tbody).insertBefore(dragRow, dropRow);\n                }\n                else {\n                    this.parent.getContentTable().querySelector(literals.tbody).insertBefore(dragRow, dropRow.nextSibling);\n                }\n            }\n            else {\n                remove(dragRow);\n            }\n            this.groupReorderHandler(fromRowObj, toRowObj);\n            var tr = [].slice.call(this.parent.getContentTable().getElementsByClassName(literals.row));\n            this.groupReorderRowObject(dropArgs, tr, toRowObj);\n            if (this.parent.enableVirtualization) {\n                this.vGroupResetRowIndex();\n            }\n            else {\n                resetRowIndex(this.parent, this.parent.getRowsObject().filter(function (data) { return data.isDataRow; }), tr);\n            }\n            this.parent.notify(events.refreshExpandandCollapse, { rows: this.parent.getRowsObject() });\n        }\n    };\n    Group.prototype.vGroupResetRowIndex = function () {\n        var gObj = this.parent;\n        var rowObjects = gObj.vRows;\n        var rowElements = this.parent.getRows();\n        for (var i = 0, startIdx = 0, k = 0; i < rowObjects.length; i++) {\n            if (rowObjects[parseInt(i.toString(), 10)].isDataRow) {\n                rowObjects[parseInt(i.toString(), 10)].index = startIdx;\n                rowObjects[parseInt(i.toString(), 10)].isAltRow = gObj.enableAltRow ? startIdx % 2 !== 0 : false;\n                var rowElement = gObj.getRowElementByUID(rowObjects[parseInt(i.toString(), 10)].uid);\n                if (!isNullOrUndefined(rowElement)) {\n                    rowElements[parseInt(k.toString(), 10)] = rowElement;\n                    rowElement.setAttribute(literals.dataRowIndex, startIdx.toString());\n                    rowElement.setAttribute(literals.ariaRowIndex, (startIdx + 1).toString());\n                    if (rowObjects[parseInt(i.toString(), 10)].isAltRow) {\n                        rowElement.classList.add('e-altrow');\n                    }\n                    else {\n                        rowElement.classList.remove('e-altrow');\n                    }\n                    for (var j = 0; j < rowElement.cells.length; j++) {\n                        rowElement.cells[parseInt(j.toString(), 10)].setAttribute('index', startIdx.toString());\n                    }\n                    k++;\n                }\n                startIdx++;\n            }\n        }\n    };\n    Group.prototype.groupReorderHandler = function (dragRowObject, dropRowObject) {\n        var gObj = this.parent;\n        var dragRowObjectData = dragRowObject.data;\n        var dropRowObjectData = dropRowObject.data;\n        var groupAggregateTemplate = gObj['groupModule'].getGroupAggregateTemplates(false);\n        var dropParentRowObject = gObj.getRowObjectFromUID(dropRowObject.parentUid);\n        var dragParentRowObject = gObj.getRowObjectFromUID(dragRowObject.parentUid);\n        var dropRootParentRowObjects = [dropParentRowObject];\n        var dragRootParentRowObjects = [dragParentRowObject];\n        var groupColumns = gObj.groupSettings.columns;\n        for (var j = 0; j < groupColumns.length; j++) {\n            dragRowObjectData[groupColumns[parseInt(j.toString(), 10)]] = dropRowObjectData[groupColumns[parseInt(j.toString(), 10)]];\n            if (j > 0) {\n                dropRootParentRowObjects.push(gObj.getRowObjectFromUID(dropRootParentRowObjects[j - 1].parentUid));\n                dragRootParentRowObjects.push(gObj.getRowObjectFromUID(dragRootParentRowObjects[j - 1].parentUid));\n            }\n        }\n        dragRowObject.parentUid = dropRowObject.parentUid;\n        dragRowObject.visible = dropRowObject.visible;\n        dragRowObject['parentGid'] = dropRowObject['parentGid'];\n        if (dragRowObject.changes !== dragRowObjectData) {\n            dragRowObject.changes = dragRowObjectData;\n        }\n        var updatedCurrentViewData = this.iterateGroupAggregates([{ dragRowObjects: dragRootParentRowObjects,\n                dropRowObjects: dropRootParentRowObjects }]);\n        var updatedDragCurrentViewData = updatedCurrentViewData.filter(function (object) {\n            return (object['key'] === dragRootParentRowObjects[dragRootParentRowObjects.length - 1].data['key'] ||\n                (object['key'] instanceof Date && object['key'].toString() ===\n                    dragRootParentRowObjects[dragRootParentRowObjects.length - 1].data['key'].toString()));\n        });\n        var updatedDropCurrentViewData = updatedCurrentViewData.filter(function (object) {\n            return (object['key'] === dropRootParentRowObjects[dropRootParentRowObjects.length - 1].data['key'] ||\n                (object['key'] instanceof Date && object['key'].toString() ===\n                    dropRootParentRowObjects[dropRootParentRowObjects.length - 1].data['key'].toString()));\n        });\n        updatedCurrentViewData = [];\n        if (!isNullOrUndefined(updatedDragCurrentViewData[0])) {\n            updatedCurrentViewData.push(updatedDragCurrentViewData[0]);\n        }\n        if (!isNullOrUndefined(updatedDropCurrentViewData[0])) {\n            updatedCurrentViewData.push(updatedDropCurrentViewData[0]);\n        }\n        var currentViewData = gObj.currentViewData;\n        for (var i = 0; i < currentViewData.length; i++) {\n            if (isNullOrUndefined(updatedDragCurrentViewData[0]) &&\n                currentViewData[parseInt(i.toString(), 10)]['key'] ===\n                    dragRootParentRowObjects[dragRootParentRowObjects.length - 1].data['key']) {\n                currentViewData.splice(i, 1);\n                i--;\n            }\n            else if (isNullOrUndefined(updatedDropCurrentViewData[0]) &&\n                currentViewData[parseInt(i.toString(), 10)]['key'] ===\n                    dropRootParentRowObjects[dropRootParentRowObjects.length - 1].data['key']) {\n                currentViewData.splice(i, 1);\n                i--;\n            }\n            else if (!isNullOrUndefined(updatedDragCurrentViewData[0]) &&\n                currentViewData[parseInt(i.toString(), 10)]['key'] === updatedDragCurrentViewData[0]['key']) {\n                currentViewData[parseInt(i.toString(), 10)] = updatedDragCurrentViewData[0];\n            }\n            else if (!isNullOrUndefined(updatedDropCurrentViewData[0]) &&\n                currentViewData[parseInt(i.toString(), 10)]['key'] === updatedDropCurrentViewData[0]['key']) {\n                currentViewData[parseInt(i.toString(), 10)] = updatedDropCurrentViewData[0];\n            }\n        }\n        var updatedRowObject = this.groupGenerator.generateRows(updatedCurrentViewData, {});\n        var dragRootParentAggregateRowObject = [];\n        var dropRootParentAggregateRowObject = [];\n        for (var i = 0; i < dragRootParentRowObjects.length; i++) {\n            dragRootParentAggregateRowObject\n                .push.apply(dragRootParentAggregateRowObject, this.getGroupParentFooterAggregateRowObject(dragRootParentRowObjects[parseInt(i.toString(), 10)].uid));\n        }\n        for (var i = 0; i < dropRootParentRowObjects.length; i++) {\n            dropRootParentAggregateRowObject\n                .push.apply(dropRootParentAggregateRowObject, this.getGroupParentFooterAggregateRowObject(dropRootParentRowObjects[parseInt(i.toString(), 10)].uid));\n        }\n        dragRootParentRowObjects.push.apply(dragRootParentRowObjects, dragRootParentAggregateRowObject);\n        dropRootParentRowObjects.push.apply(dropRootParentRowObjects, dropRootParentAggregateRowObject);\n        this.updatedRowObjChange(dragRootParentRowObjects, updatedRowObject, groupAggregateTemplate);\n        this.updatedRowObjChange(dropRootParentRowObjects, updatedRowObject, groupAggregateTemplate);\n        this.groupReorderRefreshHandler(dragRowObject, dragParentRowObject, dropParentRowObject, groupAggregateTemplate);\n    };\n    Group.prototype.updatedRowObjChange = function (rootParentRowObjects, updatedRowObj, groupAggregateTemplate) {\n        var gObj = this.parent;\n        var rowObjects = gObj.getRowsObject();\n        var cache = {};\n        var virtualCacheRowObjects = [];\n        if (gObj.enableVirtualization) {\n            cache = gObj.contentModule['vgenerator'].cache;\n            virtualCacheRowObjects = gObj.vcRows;\n        }\n        for (var i = 0; i < rootParentRowObjects.length; i++) {\n            var keyPresent = false;\n            for (var j = 0; j < updatedRowObj.length; j++) {\n                if (!isNullOrUndefined(updatedRowObj[parseInt(j.toString(), 10)]) &&\n                    !isNullOrUndefined(rootParentRowObjects[parseInt(i.toString(), 10)].data['key']) &&\n                    !isNullOrUndefined(updatedRowObj[parseInt(j.toString(), 10)].data['key']) &&\n                    ((rootParentRowObjects[parseInt(i.toString(), 10)].data['key'] ===\n                        updatedRowObj[parseInt(j.toString(), 10)].data['key'] ||\n                        (rootParentRowObjects[parseInt(i.toString(), 10)].data['key'] instanceof Date &&\n                            rootParentRowObjects[parseInt(i.toString(), 10)].data['key'].toString() ===\n                                updatedRowObj[parseInt(j.toString(), 10)].data['key'].toString())))) {\n                    var index = rowObjects.indexOf(rootParentRowObjects[parseInt(i.toString(), 10)]);\n                    if (index !== -1) {\n                        rowObjects[parseInt(index.toString(), 10)].data = updatedRowObj[parseInt(j.toString(), 10)].data;\n                        rowObjects[parseInt(index.toString(), 10)]['gSummary'] = updatedRowObj[parseInt(j.toString(), 10)]['gSummary'];\n                    }\n                    if (gObj.enableVirtualization) {\n                        var vIndex = virtualCacheRowObjects.indexOf(rootParentRowObjects[parseInt(i.toString(), 10)]);\n                        if (vIndex !== -1) {\n                            virtualCacheRowObjects[parseInt(vIndex.toString(), 10)].data =\n                                updatedRowObj[parseInt(j.toString(), 10)].data;\n                            virtualCacheRowObjects[parseInt(vIndex.toString(), 10)]['gSummary'] =\n                                updatedRowObj[parseInt(j.toString(), 10)]['gSummary'];\n                        }\n                    }\n                    rootParentRowObjects[parseInt(i.toString(), 10)].data = updatedRowObj[parseInt(j.toString(), 10)].data;\n                    rootParentRowObjects[parseInt(i.toString(), 10)]['gSummary'] =\n                        updatedRowObj[parseInt(j.toString(), 10)]['gSummary'];\n                    updatedRowObj.splice(j, 1);\n                    j--;\n                    keyPresent = true;\n                    break;\n                }\n                else if (rootParentRowObjects[parseInt(i.toString(), 10)].isAggregateRow &&\n                    updatedRowObj[parseInt(j.toString(), 10)].isAggregateRow) {\n                    for (var l = 0; l < groupAggregateTemplate.length; l++) {\n                        if (this.evaluateGroupAggregateValueChange(rootParentRowObjects[parseInt(i.toString(), 10)], updatedRowObj[parseInt(j.toString(), 10)], groupAggregateTemplate[parseInt(l.toString(), 10)])) {\n                            var index = rowObjects.indexOf(rootParentRowObjects[parseInt(i.toString(), 10)]);\n                            if (index !== -1) {\n                                rowObjects[parseInt(index.toString(), 10)].data = updatedRowObj[parseInt(j.toString(), 10)].data;\n                                rowObjects[parseInt(index.toString(), 10)]['gSummary'] =\n                                    updatedRowObj[parseInt(j.toString(), 10)]['gSummary'];\n                            }\n                            if (gObj.enableVirtualization) {\n                                var vIndex = virtualCacheRowObjects.indexOf(rootParentRowObjects[parseInt(i.toString(), 10)]);\n                                if (vIndex !== -1) {\n                                    virtualCacheRowObjects[parseInt(vIndex.toString(), 10)].data =\n                                        updatedRowObj[parseInt(j.toString(), 10)].data;\n                                    virtualCacheRowObjects[parseInt(vIndex.toString(), 10)]['gSummary'] =\n                                        updatedRowObj[parseInt(j.toString(), 10)]['gSummary'];\n                                }\n                            }\n                            rootParentRowObjects[parseInt(i.toString(), 10)].data = updatedRowObj[parseInt(j.toString(), 10)].data;\n                            rootParentRowObjects[parseInt(i.toString(), 10)]['gSummary'] =\n                                updatedRowObj[parseInt(j.toString(), 10)]['gSummary'];\n                            keyPresent = true;\n                            break;\n                        }\n                    }\n                    if (keyPresent) {\n                        break;\n                    }\n                }\n            }\n            if (!keyPresent) {\n                var removeElem = gObj.getRowElementByUID(rootParentRowObjects[parseInt(i.toString(), 10)].uid);\n                if (!isNullOrUndefined(removeElem)) {\n                    remove(removeElem);\n                }\n                rowObjects.splice(rowObjects.indexOf(rootParentRowObjects[parseInt(i.toString(), 10)]), 1);\n                if (gObj.enableVirtualization) {\n                    virtualCacheRowObjects.splice(virtualCacheRowObjects.indexOf(rootParentRowObjects[parseInt(i.toString(), 10)]), 1);\n                    for (var k = 1; k <= Object.keys(cache).length; k++) {\n                        var vcIndex = cache[parseInt(k.toString(), 10)].indexOf(rootParentRowObjects[parseInt(i.toString(), 10)]);\n                        if (vcIndex !== -1) {\n                            cache[parseInt(k.toString(), 10)].splice([parseInt(vcIndex.toString(), 10)], 1);\n                        }\n                    }\n                }\n            }\n        }\n    };\n    Group.prototype.groupReorderRefreshHandler = function (dragRowObject, dragParentRowObject, dropParentRowObject, groupAggregateTemplate) {\n        var gObj = this.parent;\n        var row = new RowRenderer(gObj['serviceLocator'], null, gObj);\n        if (!isNullOrUndefined(dragRowObject) && !isNullOrUndefined(gObj.getRowElementByUID(dragRowObject.uid))) {\n            row.refresh(dragRowObject, gObj.getColumns(), false);\n        }\n        for (var j = 0; j < gObj.groupSettings.columns.length; j++) {\n            if (!isNullOrUndefined(dragParentRowObject) &&\n                !isNullOrUndefined(gObj.getRowElementByUID(dragParentRowObject.uid))) {\n                row.refresh(dragParentRowObject, gObj.getColumns(), false);\n            }\n            if (!isNullOrUndefined(dropParentRowObject) &&\n                !isNullOrUndefined(gObj.getRowElementByUID(dropParentRowObject.uid))) {\n                row.refresh(dropParentRowObject, gObj.getColumns(), false);\n            }\n            if (groupAggregateTemplate.length) {\n                var dragParentFooterAggregateRowObjects = !isNullOrUndefined(dragParentRowObject) ?\n                    this.getGroupParentFooterAggregateRowObject(dragParentRowObject.uid) : [];\n                var dropParentFooterAggregateRowObjects = !isNullOrUndefined(dropParentRowObject) ?\n                    this.getGroupParentFooterAggregateRowObject(dropParentRowObject.uid) : [];\n                for (var k = 0; k < dropParentFooterAggregateRowObjects.length; k++) {\n                    if (!isNullOrUndefined(dropParentFooterAggregateRowObjects[parseInt(k.toString(), 10)]) && !isNullOrUndefined(gObj\n                        .getRowElementByUID(dropParentFooterAggregateRowObjects[parseInt(k.toString(), 10)].uid))) {\n                        row.refresh(dropParentFooterAggregateRowObjects[parseInt(k.toString(), 10)], gObj.getColumns(), false);\n                    }\n                }\n                for (var k = 0; k < dragParentFooterAggregateRowObjects.length; k++) {\n                    if (!isNullOrUndefined(dragParentFooterAggregateRowObjects[parseInt(k.toString(), 10)]) && !isNullOrUndefined(gObj\n                        .getRowElementByUID(dragParentFooterAggregateRowObjects[parseInt(k.toString(), 10)].uid))) {\n                        row.refresh(dragParentFooterAggregateRowObjects[parseInt(k.toString(), 10)], gObj.getColumns(), false);\n                    }\n                }\n            }\n            if (!isNullOrUndefined(dragParentRowObject)) {\n                dragParentRowObject = gObj.getRowObjectFromUID(dragParentRowObject.parentUid);\n            }\n            if (!isNullOrUndefined(dropParentRowObject)) {\n                dropParentRowObject = gObj.getRowObjectFromUID(dropParentRowObject.parentUid);\n            }\n        }\n    };\n    Group.prototype.getGroupParentFooterAggregateRowObject = function (parentUid) {\n        var rowObjects = this.parent.getRowsObject();\n        var parentFooterAggregates = [];\n        for (var i = 0; i < rowObjects.length; i++) {\n            if (rowObjects[parseInt(i.toString(), 10)].parentUid === parentUid && rowObjects[parseInt(i.toString(), 10)].isAggregateRow) {\n                parentFooterAggregates.push(rowObjects[parseInt(i.toString(), 10)]);\n            }\n        }\n        return parentFooterAggregates;\n    };\n    Group.prototype.evaluateGroupAggregateValueChange = function (rowObjects, updatedRowObject, groupAggregateTemplate) {\n        var change = false;\n        if (rowObjects.data[groupAggregateTemplate['field']]['field'] === updatedRowObject.data[groupAggregateTemplate['field']]['field']\n            && rowObjects.data[groupAggregateTemplate['field']]['key'] === updatedRowObject.data[groupAggregateTemplate['field']]['key'] &&\n            rowObjects.data[groupAggregateTemplate['field']]\n                // eslint-disable-next-line no-prototype-builtins\n                .hasOwnProperty(groupAggregateTemplate['field'] + ' - ' + groupAggregateTemplate['type']) &&\n            updatedRowObject.data[groupAggregateTemplate['field']]\n                // eslint-disable-next-line no-prototype-builtins\n                .hasOwnProperty(groupAggregateTemplate['field'] + ' - ' + groupAggregateTemplate['type'])) {\n            change = true;\n        }\n        return change;\n    };\n    Group.prototype.groupReorderRowObject = function (args, tr, dropRObj) {\n        var gObj = this.parent;\n        var rowObjects = gObj.enableVirtualization ? gObj.vRows : gObj.getRowsObject();\n        var orderChangeRowObjects = [];\n        var dropRowObject = dropRObj ? dropRObj :\n            gObj.getRowObjectFromUID(args.target.closest('tr').getAttribute('data-uid'));\n        var rowObjDropindex;\n        for (var i = 0; i < args.rows.length; i++) {\n            var orderChangeRowObject = gObj.getRowObjectFromUID(args.rows[parseInt(i.toString(), 10)].getAttribute('data-uid'));\n            if (dropRowObject === orderChangeRowObject) {\n                rowObjDropindex = rowObjects.indexOf(dropRowObject);\n            }\n            orderChangeRowObjects.push(rowObjects.splice(rowObjects.indexOf(orderChangeRowObject), 1)[0]);\n        }\n        if (isNullOrUndefined(rowObjDropindex)) {\n            rowObjDropindex = rowObjects.indexOf(dropRowObject);\n            if (args.fromIndex > args.dropIndex) {\n                rowObjects.splice.apply(rowObjects, [rowObjDropindex, 0].concat(orderChangeRowObjects));\n            }\n            else {\n                rowObjects.splice.apply(rowObjects, [rowObjDropindex + 1, 0].concat(orderChangeRowObjects));\n            }\n        }\n        else {\n            rowObjects.splice.apply(rowObjects, [rowObjDropindex, 0].concat(orderChangeRowObjects));\n        }\n        if (!gObj.enableVirtualization) {\n            var recordobj = {};\n            var currentViewData = this.parent.getCurrentViewRecords();\n            for (var i = 0, len = tr.length; i < len; i++) {\n                var index = parseInt(tr[parseInt(i.toString(), 10)].getAttribute(literals.dataRowIndex), 10);\n                recordobj[parseInt(i.toString(), 10)] = currentViewData[parseInt(index.toString(), 10)];\n            }\n            var rows = this.parent.getRows();\n            for (var i = 0, len = tr.length; i < len; i++) {\n                rows[parseInt(i.toString(), 10)] = tr[parseInt(i.toString(), 10)];\n                currentViewData[parseInt(i.toString(), 10)] = recordobj[parseInt(i.toString(), 10)];\n            }\n        }\n    };\n    Group.prototype.gettingVirtualData = function (parentRowObjs, curViewRec, pK) {\n        var datas = [];\n        var _loop_2 = function (i) {\n            if (curViewRec.indexOf(parentRowObjs[parseInt(i.toString(), 10)].data) === -1) {\n                datas.push(parentRowObjs[parseInt(i.toString(), 10)].data);\n            }\n            if (parentRowObjs[parseInt(i.toString(), 10)].data['field'] === this_2.parent.groupSettings.columns[0]) {\n                var draggedData_1 = parentRowObjs[parseInt(i.toString(), 10)].data['items'];\n                if (!isNullOrUndefined(draggedData_1['records'])) {\n                    draggedData_1 = draggedData_1['records'];\n                }\n                var _loop_3 = function (j) {\n                    if (pK && curViewRec.findIndex(function (data) { return data[pK.toString()] ===\n                        draggedData_1[parseInt(j.toString(), 10)][pK.toString()]; }) === -1) {\n                        datas.push(draggedData_1[parseInt(j.toString(), 10)]);\n                    }\n                };\n                for (var j = 0; j < draggedData_1.length; j++) {\n                    _loop_3(j);\n                }\n            }\n        };\n        var this_2 = this;\n        for (var i = 0; i < parentRowObjs.length; i++) {\n            _loop_2(i);\n        }\n        return datas;\n    };\n    Group.prototype.iterateGroupAggregates = function (editedData) {\n        var updatedData = editedData instanceof Array ? editedData : [];\n        var rows = this.parent.getRowsObject();\n        var initData = this.parent.getCurrentViewRecords();\n        var field = this.parent.getPrimaryKeyFieldNames()[0];\n        if (this.parent.enableVirtualization && this.parent.allowGrouping && this.parent.groupSettings.columns.length &&\n            (!isNullOrUndefined(editedData[0]['dragRowObjects']) || !isNullOrUndefined(editedData[0]['dropRowObjects']))) {\n            var dragParentRowObjects = editedData[0]['dragRowObjects'];\n            var dropParentRowObjects = editedData[0]['dropRowObjects'];\n            if (dragParentRowObjects) {\n                initData.push.apply(initData, this.gettingVirtualData(dragParentRowObjects, initData, field));\n            }\n            if (dropParentRowObjects) {\n                initData.push.apply(initData, this.gettingVirtualData(dropParentRowObjects, initData, field));\n            }\n        }\n        var deletedCols = [];\n        var changeds = rows.map(function (row) {\n            if (row.edit === 'delete') {\n                deletedCols.push(row.data);\n            }\n            return row.changes instanceof Object ? row.changes : row.data;\n        });\n        changeds = updatedData.length === 0 ? changeds : updatedData;\n        var mergeData = initData.map(function (item) {\n            var pKeyVal = DataUtil.getObject(field, item);\n            var value;\n            var hasVal = changeds.some(function (cItem) {\n                value = cItem;\n                return pKeyVal === DataUtil.getObject(field, cItem);\n            });\n            return hasVal ? value : item;\n        });\n        var eData = editedData;\n        if (!(eData.type && eData.type === 'cancel') && deletedCols.length > 0) {\n            for (var i = 0; i < deletedCols.length; i++) {\n                var index = mergeData.indexOf(deletedCols[parseInt(i.toString(), 10)]);\n                mergeData.splice(index, 1);\n            }\n        }\n        var aggregates = [];\n        var aggregateRows = this.parent.aggregates;\n        for (var j = 0; j < aggregateRows.length; j++) {\n            var row = aggregateRows[parseInt(j.toString(), 10)];\n            for (var k = 0; k < row.columns.length; k++) {\n                var aggr = {};\n                var type = row.columns[parseInt(k.toString(), 10)].type.toString();\n                aggr = { type: type.toLowerCase(), field: row.columns[parseInt(k.toString(), 10)].field };\n                aggregates.push(aggr);\n            }\n        }\n        var result;\n        var aggrds;\n        var groupedCols = this.parent.groupSettings.columns;\n        for (var l = 0; l < groupedCols.length; l++) {\n            aggrds = result ? result : mergeData;\n            result = DataUtil.group(aggrds, groupedCols[parseInt(l.toString(), 10)], aggregates, null, null);\n        }\n        return result;\n    };\n    Group.prototype.updateExpand = function (args) {\n        var uid = args.uid;\n        var isExpand = args.isExpand;\n        var rows = this.parent.getRowsObject();\n        for (var i = 0; i < rows.length; i++) {\n            var row = rows[parseInt(i.toString(), 10)];\n            if (row.uid === uid || isNullOrUndefined(uid)) {\n                row.isExpand = isExpand;\n                var _loop_4 = function (j) {\n                    var childRow = rows[parseInt(j.toString(), 10)];\n                    var closestParent = void 0;\n                    if (childRow.parentUid !== row.uid) {\n                        closestParent = rows.filter(function (x) { return x.uid === childRow.parentUid; })[0];\n                    }\n                    if (childRow.parentUid === row.uid) {\n                        childRow.visible = row.isExpand;\n                    }\n                    else if (!isNullOrUndefined(closestParent) && childRow.parentUid === closestParent.uid) {\n                        if (closestParent.isExpand && closestParent.visible === true) {\n                            childRow.visible = true;\n                        }\n                        else if (closestParent.isExpand && closestParent.visible === false) {\n                            childRow.visible = false;\n                        }\n                    }\n                    if (isNullOrUndefined(uid)) {\n                        return \"break\";\n                    }\n                };\n                for (var j = i + 1; j < rows.length; j++) {\n                    var state_2 = _loop_4(j);\n                    if (state_2 === \"break\")\n                        break;\n                }\n            }\n        }\n        this.parent.notify(events.contentReady, { rows: rows, args: { isFrozen: false, rows: rows } });\n    };\n    return Group;\n}());\nexport { Group };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}