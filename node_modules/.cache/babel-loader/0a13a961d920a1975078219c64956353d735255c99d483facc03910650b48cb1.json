{"ast":null,"code":"import { addClass, detach, EventHandler, isNullOrUndefined, Ajax, formatUnit } from '@syncfusion/ej2-base';\nimport { Browser, closest, removeClass, isNullOrUndefined as isNOU } from '@syncfusion/ej2-base';\nimport * as events from '../base/constant';\nimport * as classes from '../base/classes';\nimport { Uploader, TextBox } from '@syncfusion/ej2-inputs';\nimport { Button, RadioButton } from '@syncfusion/ej2-buttons';\nimport { RenderType } from '../base/enum';\nimport { dispatchEvent, parseHtml, hasClass, convertToBlob } from '../base/util';\nimport { isIDevice } from '../../common/util';\nvar Video = /** @class */function () {\n  function Video(parent, serviceLocator) {\n    this.isVideoUploaded = false;\n    this.isAllowedTypes = true;\n    this.pageX = null;\n    this.pageY = null;\n    this.deletedVid = [];\n    this.parent = parent;\n    this.rteID = parent.element.id;\n    this.i10n = serviceLocator.getService('rteLocale');\n    this.rendererFactory = serviceLocator.getService('rendererFactory');\n    this.dialogRenderObj = serviceLocator.getService('dialogRenderObject');\n    this.addEventListener();\n  }\n  Video.prototype.addEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n    this.parent.on(events.keyDown, this.onKeyDown, this);\n    this.parent.on(events.keyUp, this.onKeyUp, this);\n    this.parent.on(events.insertVideo, this.insertingVideo, this);\n    this.parent.on(events.initialEnd, this.afterRender, this);\n    this.parent.on(events.dynamicModule, this.afterRender, this);\n    this.parent.on(events.windowResize, this.onWindowResize, this);\n    this.parent.on(events.showVideoDialog, this.showDialog, this);\n    this.parent.on(events.closeVideoDialog, this.closeDialog, this);\n    this.parent.on(events.dropDownSelect, this.alignmentSelect, this);\n    this.parent.on(events.videoDelete, this.deleteVideo, this);\n    this.parent.on(events.videoToolbarAction, this.onToolbarAction, this);\n    this.parent.on(events.editAreaClick, this.editAreaClickHandler, this);\n    this.parent.on(events.iframeMouseDown, this.onIframeMouseDown, this);\n    this.parent.on(events.videoSize, this.videoSize, this);\n    this.parent.on(events.insertCompleted, this.showVideoQuickToolbar, this);\n    this.parent.on(events.clearDialogObj, this.clearDialogObj, this);\n    this.parent.on(events.destroy, this.removeEventListener, this);\n  };\n  Video.prototype.removeEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n    this.parent.off(events.keyDown, this.onKeyDown);\n    this.parent.off(events.keyUp, this.onKeyUp);\n    this.parent.off(events.insertVideo, this.insertingVideo);\n    this.parent.off(events.windowResize, this.onWindowResize);\n    this.parent.off(events.initialEnd, this.afterRender);\n    this.parent.off(events.dynamicModule, this.afterRender);\n    this.parent.off(events.showVideoDialog, this.showDialog);\n    this.parent.off(events.closeVideoDialog, this.closeDialog);\n    this.parent.off(events.dropDownSelect, this.alignmentSelect);\n    this.parent.off(events.videoDelete, this.deleteVideo);\n    this.parent.off(events.videoToolbarAction, this.onToolbarAction);\n    this.parent.off(events.editAreaClick, this.editAreaClickHandler);\n    this.parent.off(events.iframeMouseDown, this.onIframeMouseDown);\n    this.parent.off(events.videoSize, this.videoSize);\n    this.parent.off(events.insertCompleted, this.showVideoQuickToolbar);\n    this.parent.off(events.clearDialogObj, this.clearDialogObj);\n    this.parent.off(events.destroy, this.removeEventListener);\n    if (!isNullOrUndefined(this.contentModule)) {\n      EventHandler.remove(this.contentModule.getEditPanel(), Browser.touchEndEvent, this.videoClick);\n      this.parent.formatter.editorManager.observer.off(events.checkUndo, this.undoStack);\n      if (this.parent.insertVideoSettings.resize) {\n        EventHandler.remove(this.parent.contentModule.getEditPanel(), Browser.touchStartEvent, this.resizeStart);\n        EventHandler.remove(this.parent.element.ownerDocument, 'mousedown', this.onDocumentClick);\n        EventHandler.remove(this.contentModule.getEditPanel(), 'cut', this.onCutHandler);\n        EventHandler.remove(this.contentModule.getDocument(), Browser.touchMoveEvent, this.resizing);\n      }\n    }\n  };\n  Video.prototype.afterRender = function () {\n    this.contentModule = this.rendererFactory.getRenderer(RenderType.Content);\n    EventHandler.add(this.contentModule.getEditPanel(), Browser.touchEndEvent, this.videoClick, this);\n    if (this.parent.insertVideoSettings.resize) {\n      EventHandler.add(this.parent.contentModule.getEditPanel(), Browser.touchStartEvent, this.resizeStart, this);\n      EventHandler.add(this.parent.element.ownerDocument, 'mousedown', this.onDocumentClick, this);\n      EventHandler.add(this.contentModule.getEditPanel(), 'cut', this.onCutHandler, this);\n    }\n  };\n  Video.prototype.clearDialogObj = function () {\n    if (this.dialogObj) {\n      this.dialogObj.destroy();\n      detach(this.dialogObj.element);\n      this.dialogObj = null;\n    }\n  };\n  // eslint-disable-next-line\n  Video.prototype.onKeyUp = function (event) {\n    if (!isNOU(this.deletedVid) && this.deletedVid.length > 0) {\n      for (var i = 0; i < this.deletedVid.length; i++) {\n        var args = {\n          element: this.deletedVid[i],\n          src: this.deletedVid[i].tagName !== 'IFRAME' ? this.deletedVid[i].querySelector('source').getAttribute('src') : this.deletedVid[i].src\n        };\n        this.parent.trigger(events.afterMediaDelete, args);\n      }\n    }\n  };\n  Video.prototype.undoStack = function (args) {\n    if (args.subCommand.toLowerCase() === 'undo' || args.subCommand.toLowerCase() === 'redo') {\n      for (var i = 0; i < this.parent.formatter.getUndoRedoStack().length; i++) {\n        var temp = this.parent.createElement('div');\n        var contentElem = this.parent.formatter.getUndoRedoStack()[i].text;\n        temp.appendChild(contentElem.cloneNode(true));\n        var vid = temp.querySelectorAll('video');\n        if (temp.querySelector('.e-vid-resize') && vid.length > 0) {\n          for (var j = 0; j < vid.length; j++) {\n            vid[j].style.outline = '';\n          }\n          detach(temp.querySelector('.e-vid-resize'));\n          var clonedElement = temp.cloneNode(true);\n          var fragment = document.createDocumentFragment();\n          while (clonedElement.firstChild) {\n            fragment.appendChild(clonedElement.firstChild);\n          }\n          this.parent.formatter.getUndoRedoStack()[i].text = fragment;\n        }\n      }\n    }\n  };\n  Video.prototype.onIframeMouseDown = function () {\n    if (this.dialogObj) {\n      this.dialogObj.hide({\n        returnValue: true\n      });\n    }\n  };\n  Video.prototype.videoSize = function (e) {\n    var _this = this;\n    if (e.selectNode[0].nodeName !== 'VIDEO' && !this.isEmbedVidElem(e.selectNode[0])) {\n      return;\n    }\n    this.insertVideo(e);\n    if (!isNullOrUndefined(this.dialogObj)) {\n      var vidSizeHeader = this.i10n.getConstant('videoSizeHeader');\n      var linkUpdate = this.i10n.getConstant('dialogUpdate');\n      var dialogContent = this.vidsizeInput(e);\n      var selectObj_1 = {\n        args: e.args,\n        selfVideo: this,\n        selection: e.selection,\n        selectNode: e.selectNode\n      };\n      this.dialogObj.setProperties({\n        height: 'inherit',\n        width: '290px',\n        header: vidSizeHeader,\n        content: dialogContent,\n        buttons: [{\n          // eslint-disable-next-line\n          click: function (e) {\n            _this.insertSize(selectObj_1);\n          },\n          buttonModel: {\n            content: linkUpdate,\n            cssClass: 'e-flat e-update-size',\n            isPrimary: true\n          }\n        }]\n      });\n      this.dialogObj.element.style.maxHeight = 'inherit';\n      this.dialogObj.content.querySelector('input').focus();\n    }\n  };\n  Video.prototype.vidsizeInput = function (e) {\n    var _this = this;\n    var selectNode = e.selectNode[0];\n    var vidHeight = this.i10n.getConstant('videoHeight');\n    var vidWidth = this.i10n.getConstant('videoWidth');\n    var vidSizeWrap = this.parent.createElement('div', {\n      className: 'e-video-sizewrap'\n    });\n    var widthVal = isNullOrUndefined(this.changedWidthValue) && (selectNode.style.width.toString() === 'auto' || selectNode.style.width !== '') ? selectNode.style.width : !isNullOrUndefined(this.changedWidthValue) ? this.changedWidthValue : parseInt(selectNode.getClientRects()[0].width.toString(), 10).toString();\n    var heightVal = isNullOrUndefined(this.changedHeightValue) && (selectNode.style.height.toString() === 'auto' || selectNode.style.height !== '') ? selectNode.style.height : !isNullOrUndefined(this.changedHeightValue) ? this.changedHeightValue : parseInt(selectNode.getClientRects()[0].height.toString(), 10).toString();\n    this.changedWidthValue = null;\n    this.changedHeightValue = null;\n    var content = '<div class=\"e-rte-label\"><label>' + vidWidth + '</label></div><div class=\"e-rte-field\"><input type=\"text\" id=\"vidwidth\" class=\"e-vid-width\" value=' + widthVal + ' /></div>' + '<div class=\"e-rte-label\">' + '<label>' + vidHeight + '</label></div><div class=\"e-rte-field\"> ' + '<input type=\"text\" id=\"vidheight\" class=\"e-vid-height\" value=' + heightVal + ' /></div>';\n    var contentElem = parseHtml(content);\n    vidSizeWrap.appendChild(contentElem);\n    var widthNum = new TextBox({\n      value: formatUnit(widthVal),\n      enableRtl: this.parent.enableRtl,\n      input: function (e) {\n        _this.inputWidthValue = formatUnit(e.value);\n      }\n    });\n    widthNum.createElement = this.parent.createElement;\n    widthNum.appendTo(vidSizeWrap.querySelector('#vidwidth'));\n    var heightNum = new TextBox({\n      value: formatUnit(heightVal),\n      enableRtl: this.parent.enableRtl,\n      input: function (e) {\n        _this.inputHeightValue = formatUnit(e.value);\n      }\n    });\n    heightNum.createElement = this.parent.createElement;\n    heightNum.appendTo(vidSizeWrap.querySelector('#vidheight'));\n    return vidSizeWrap;\n  };\n  Video.prototype.insertSize = function (e) {\n    e.selection.restore();\n    var proxy = e.selfVideo;\n    if (proxy.parent.formatter.getUndoRedoStack().length === 0) {\n      proxy.parent.formatter.saveData();\n    }\n    var dialogEle = proxy.dialogObj.element;\n    this.changedWidthValue = this.inputWidthValue;\n    this.changedHeightValue = this.inputHeightValue;\n    var width = dialogEle.querySelector('.e-vid-width').value;\n    var height = dialogEle.parentElement.querySelector('.e-vid-height').value;\n    proxy.parent.formatter.process(this.parent, e.args, e.args, {\n      width: width,\n      height: height,\n      selectNode: e.selectNode,\n      subCommand: e.args.item.subCommand\n    });\n    if (this.vidResizeDiv) {\n      e.selectNode[0] = e.selectNode[0].tagName === 'VIDEO' || e.selectNode[0].tagName === 'IFRAME' ? e.selectNode[0] : e.selectNode[0].querySelector('iframe');\n      proxy.vidResizePos(e.selectNode[0], this.vidResizeDiv);\n    }\n    proxy.dialogObj.hide({\n      returnValue: true\n    });\n  };\n  Video.prototype.resizeEnd = function (e) {\n    this.resizeBtnInit();\n    this.videoEle.parentElement.style.cursor = 'auto';\n    if (Browser.isDevice) {\n      removeClass([e.target.parentElement], 'e-mob-span');\n    }\n    var args = {\n      event: e,\n      requestType: 'videos'\n    };\n    this.parent.trigger(events.resizeStop, args);\n    /* eslint-disable */\n    var pageX = this.getPointX(e);\n    var pageY = this.parent.iframeSettings.enable ? window.pageYOffset + this.parent.element.getBoundingClientRect().top + e.clientY : e.pageY;\n    /* eslint-enable */\n    this.parent.formatter.editorManager.observer.on(events.checkUndo, this.undoStack, this);\n    this.parent.formatter.saveData();\n  };\n  Video.prototype.resizeStart = function (e, ele) {\n    var _this = this;\n    if (this.parent.readonly) {\n      return;\n    }\n    var target = ele ? ele : !this.isEmbedVidElem(e.target) ? e.target : e.target.querySelector('iframe');\n    this.prevSelectedVidEle = this.videoEle;\n    if (target.tagName === 'VIDEO' || target.tagName === 'IFRAME') {\n      this.parent.preventDefaultResize(e);\n      var videoElem = target;\n      if (this.vidResizeDiv && this.contentModule.getEditPanel().contains(this.vidResizeDiv)) {\n        detach(this.vidResizeDiv);\n      }\n      this.videoResize(videoElem);\n    }\n    if (target.classList.contains('e-rte-videoboxmark')) {\n      if (this.parent.formatter.getUndoRedoStack().length === 0) {\n        this.parent.formatter.saveData();\n      }\n      this.pageX = this.getPointX(e);\n      this.pageY = this.getPointY(e);\n      e.preventDefault();\n      e.stopImmediatePropagation();\n      this.resizeBtnInit();\n      if (this.quickToolObj) {\n        this.quickToolObj.videoQTBar.hidePopup();\n      }\n      if (target.classList.contains('e-rte-topLeft')) {\n        this.resizeBtnStat.topLeft = true;\n      }\n      if (target.classList.contains('e-rte-topRight')) {\n        this.resizeBtnStat.topRight = true;\n      }\n      if (target.classList.contains('e-rte-botLeft')) {\n        this.resizeBtnStat.botLeft = true;\n      }\n      if (target.classList.contains('e-rte-botRight')) {\n        this.resizeBtnStat.botRight = true;\n      }\n      if (Browser.isDevice && this.contentModule.getEditPanel().contains(this.vidResizeDiv) && !this.vidResizeDiv.classList.contains('e-mob-span')) {\n        addClass([this.vidResizeDiv], 'e-mob-span');\n      } else {\n        var args = {\n          event: e,\n          requestType: 'videos'\n        };\n        this.parent.trigger(events.resizeStart, args, function (resizeStartArgs) {\n          if (resizeStartArgs.cancel) {\n            _this.cancelResizeAction();\n          }\n        });\n      }\n      EventHandler.add(this.contentModule.getDocument(), Browser.touchEndEvent, this.resizeEnd, this);\n    }\n  };\n  Video.prototype.videoClick = function (e) {\n    if (Browser.isDevice) {\n      if (e.target.tagName === 'VIDEO' || this.isEmbedVidElem(e.target)) {\n        this.contentModule.getEditPanel().setAttribute('contenteditable', 'false');\n        e.target.focus();\n      } else {\n        if (!this.parent.readonly) {\n          this.contentModule.getEditPanel().setAttribute('contenteditable', 'true');\n        }\n      }\n    }\n    if (e.target.tagName === 'VIDEO' || this.isEmbedVidElem(e.target)) {\n      e.preventDefault();\n    }\n  };\n  Video.prototype.onCutHandler = function () {\n    if (this.vidResizeDiv && this.contentModule.getEditPanel().contains(this.vidResizeDiv)) {\n      this.cancelResizeAction();\n    }\n  };\n  Video.prototype.videoResize = function (e) {\n    this.resizeBtnInit();\n    this.videoEle = e;\n    addClass([this.videoEle], 'e-resize');\n    this.vidResizeDiv = this.parent.createElement('span', {\n      className: 'e-vid-resize',\n      id: this.rteID + '_vidResize'\n    });\n    this.vidResizeDiv.appendChild(this.parent.createElement('span', {\n      className: 'e-rte-videoboxmark e-rte-topLeft',\n      styles: 'cursor: nwse-resize'\n    }));\n    this.vidResizeDiv.appendChild(this.parent.createElement('span', {\n      className: 'e-rte-videoboxmark e-rte-topRight',\n      styles: 'cursor: nesw-resize'\n    }));\n    this.vidResizeDiv.appendChild(this.parent.createElement('span', {\n      className: 'e-rte-videoboxmark e-rte-botLeft',\n      styles: 'cursor: nesw-resize'\n    }));\n    this.vidResizeDiv.appendChild(this.parent.createElement('span', {\n      className: 'e-rte-videoboxmark e-rte-botRight',\n      styles: 'cursor: nwse-resize'\n    }));\n    if (Browser.isDevice) {\n      addClass([this.vidResizeDiv], 'e-mob-rte');\n    }\n    e.style.outline = '2px solid #4a90e2';\n    this.vidResizePos(e, this.vidResizeDiv);\n    this.resizeVidDupPos(e);\n    this.contentModule.getEditPanel().appendChild(this.vidResizeDiv);\n    EventHandler.add(this.contentModule.getDocument(), Browser.touchMoveEvent, this.resizing, this);\n  };\n  Video.prototype.getPointX = function (e) {\n    if (e.touches && e.touches.length) {\n      return e.touches[0].pageX;\n    } else {\n      return e.pageX;\n    }\n  };\n  Video.prototype.getPointY = function (e) {\n    if (e.touches && e.touches.length) {\n      return e.touches[0].pageY;\n    } else {\n      return e.pageY;\n    }\n  };\n  Video.prototype.vidResizePos = function (e, vidResizeDiv) {\n    if (isNullOrUndefined(vidResizeDiv)) {\n      return;\n    }\n    var pos = this.calcPos(e);\n    var top = pos.top;\n    var left = pos.left;\n    var vidWid = e.width !== 0 && e.width !== 'auto' && e.width !== 'NaN' ? e.width : e.getBoundingClientRect().width;\n    var vidHgt = e.height !== 0 && e.height !== 'auto' && e.height !== 'NaN' ? e.height : e.getBoundingClientRect().height;\n    var borWid = Browser.isDevice ? 4 * parseInt(e.style.outline.slice(-3), 10) + 2 : 2 * parseInt(e.style.outline.slice(-3), 10) + 2; //span border width + video outline width\n    var devWid = Browser.isDevice ? 0 : 2; // span border width\n    vidResizeDiv.querySelector('.e-rte-botLeft').style.left = left - borWid + 'px';\n    vidResizeDiv.querySelector('.e-rte-botLeft').style.top = parseInt(vidHgt.toString(), 10) - borWid + top + 'px';\n    vidResizeDiv.querySelector('.e-rte-botRight').style.left = parseInt(vidWid.toString(), 10) - (borWid - devWid) + left + 'px';\n    vidResizeDiv.querySelector('.e-rte-botRight').style.top = parseInt(vidHgt.toString(), 10) - borWid + top + 'px';\n    vidResizeDiv.querySelector('.e-rte-topRight').style.left = parseInt(vidWid.toString(), 10) - (borWid - devWid) + left + 'px';\n    vidResizeDiv.querySelector('.e-rte-topRight').style.top = top - borWid + 'px';\n    vidResizeDiv.querySelector('.e-rte-topLeft').style.left = left - borWid + 'px';\n    vidResizeDiv.querySelector('.e-rte-topLeft').style.top = top - borWid + 'px';\n  };\n  Video.prototype.calcPos = function (elem) {\n    var ignoreOffset = ['TD', 'TH', 'TABLE', 'A'];\n    var parentOffset = {\n      top: 0,\n      left: 0\n    };\n    var elementOffset;\n    var doc = elem.ownerDocument;\n    var offsetParent = (elem.offsetParent && (elem.offsetParent.classList.contains('e-video-clickelem') || ignoreOffset.indexOf(elem.offsetParent.tagName) > -1) ? closest(elem, '#' + this.parent.getID() + '_rte-edit-view') : elem.offsetParent) || doc.documentElement;\n    while (offsetParent && (offsetParent === doc.body || offsetParent === doc.documentElement) && offsetParent.style.position === 'static') {\n      offsetParent = offsetParent.parentNode;\n    }\n    if (offsetParent && offsetParent !== elem && offsetParent.nodeType === 1) {\n      parentOffset = offsetParent.getBoundingClientRect();\n    }\n    if (elem && elem.nodeType === 1 && elem.tagName === 'IFRAME') {\n      elementOffset = elem.getBoundingClientRect();\n      return {\n        top: elementOffset.top - parentOffset.top,\n        left: elementOffset.left - parentOffset.left\n      };\n    } else {\n      return {\n        top: elem.offsetTop,\n        left: elem.offsetLeft\n      };\n    }\n  };\n  Video.prototype.setAspectRatio = function (vid, expectedX, expectedY, e) {\n    var vidEleStyle = getComputedStyle(vid);\n    if (isNullOrUndefined(vidEleStyle)) {\n      return;\n    }\n    // eslint-disable-next-line\n    var width = vidEleStyle.width !== '' ? vidEleStyle.width.match(/^\\d+(\\.\\d*)?%$/g) ? parseFloat(vidEleStyle.width) : parseInt(vidEleStyle.width, 10) : vid.style.width !== '' ? vid.style.width : vid.width;\n    var height = vidEleStyle.height !== '' ? parseInt(vidEleStyle.height, 10) : vid.style.height !== '' ? vid.style.height : vid.height;\n    if (width > height) {\n      vid.style.minWidth = this.parent.insertVideoSettings.minWidth === 0 ? '200px' : formatUnit(this.parent.insertVideoSettings.minWidth);\n      vid.style.minHeight = this.parent.insertVideoSettings.minHeight === 0 ? '90px' : formatUnit(this.parent.insertVideoSettings.minHeight);\n      if (this.parent.insertVideoSettings.resizeByPercent) {\n        if (parseInt('' + vid.getBoundingClientRect().width + '', 10) !== 0 && parseInt('' + width + '', 10) !== 0) {\n          var percentageValue = this.pixToPerc(parseInt(width.toString(), 10) / parseInt(height.toString(), 10) * expectedY, vid.previousElementSibling || vid.parentElement);\n          vid.style.width = Math.min(Math.round(percentageValue / vid.getBoundingClientRect().width * expectedX * 100) / 100, 100) + '%';\n        } else {\n          vid.style.width = this.pixToPerc(parseInt(width.toString(), 10) / parseInt(height.toString(), 10) * expectedY, vid.previousElementSibling || vid.parentElement) + '%';\n        }\n        vid.style.height = null;\n        vid.removeAttribute('height');\n      } else if (vid.style.width === '' && vid.style.height !== '' || vidEleStyle.width === '' && vidEleStyle.height !== '') {\n        vid.style.height = expectedY + 'px';\n      } else if (vid.style.width !== '' && vid.style.height === '' || vidEleStyle.width !== '' && vidEleStyle.height === '') {\n        var currentWidth = parseInt(width.toString(), 10) / parseInt(height.toString(), 10) * expectedY + parseInt(width.toString(), 10) / parseInt(height.toString(), 10) < this.parent.inputElement.getBoundingClientRect().right - 32 ? parseInt(width.toString(), 10) / parseInt(height.toString(), 10) * expectedY + parseInt(width.toString(), 10) / parseInt(height.toString(), 10) : this.parent.inputElement.getBoundingClientRect().right - 32;\n        vid.style.width = currentWidth.toString() + 'px';\n      } else if (vid.style.width !== '' || vidEleStyle.width !== '') {\n        var currentWidth = parseInt(width.toString(), 10) / parseInt(height.toString(), 10) * expectedY < this.parent.inputElement.getBoundingClientRect().right - 32 ? parseInt(width.toString(), 10) / parseInt(height.toString(), 10) * expectedY : this.parent.inputElement.getBoundingClientRect().right - 32;\n        vid.style.width = currentWidth + 'px';\n        vid.style.height = expectedY + 'px';\n      } else {\n        vid.setAttribute('width', parseInt((parseInt(width.toString(), 10) / parseInt(height.toString(), 10) * expectedY + parseInt(width.toString(), 10) / parseInt(height.toString(), 10)).toString(), 10).toString());\n      }\n    } else if (height > width) {\n      if (this.parent.insertVideoSettings.resizeByPercent) {\n        if (parseInt('' + vid.getBoundingClientRect().width + '', 10) !== 0 && parseInt('' + width + '', 10) !== 0) {\n          vid.style.width = Math.min(Math.round(parseInt(width.toString(), 10) / vid.getBoundingClientRect().width * expectedX * 100) / 100, 100) + '%';\n        } else {\n          vid.style.width = this.pixToPerc(expectedX / parseInt(height.toString(), 10) * expectedY, vid.previousElementSibling || vid.parentElement) + '%';\n        }\n        vid.style.height = null;\n        vid.removeAttribute('height');\n      } else if (vid.style.width !== '' || vidEleStyle.width !== '') {\n        vid.style.width = expectedX + 'px';\n        vid.style.height = parseInt(height.toString(), 10) / parseInt(width.toString(), 10) * expectedX + 'px';\n      } else {\n        vid.setAttribute('width', this.resizeBtnStat.botRight ? (this.getPointX(e.event) - vid.getBoundingClientRect().left).toString() : expectedX.toString());\n      }\n    } else {\n      if (this.parent.insertVideoSettings.resizeByPercent) {\n        vid.style.width = this.pixToPerc(expectedX, vid.previousElementSibling || vid.parentElement) + '%';\n        vid.style.height = null;\n        vid.removeAttribute('height');\n      } else {\n        vid.style.width = expectedX + 'px';\n        vid.style.height = expectedX + 'px';\n      }\n    }\n  };\n  Video.prototype.pixToPerc = function (expected, parentEle) {\n    return expected / parseFloat(getComputedStyle(parentEle).width) * 100;\n  };\n  Video.prototype.vidDupMouseMove = function (width, height, e) {\n    var _this = this;\n    var args = {\n      event: e,\n      requestType: 'videos'\n    };\n    this.parent.trigger(events.onResize, args, function (resizingArgs) {\n      if (resizingArgs.cancel) {\n        _this.cancelResizeAction();\n      } else {\n        if (parseInt(_this.parent.insertVideoSettings.minWidth, 10) >= parseInt(width, 10) || parseInt(_this.parent.getInsertVidMaxWidth(), 10) <= parseInt(width, 10) && isNOU(_this.videoEle.style.width)) {\n          return;\n        }\n        if (!_this.parent.insertVideoSettings.resizeByPercent && (parseInt(_this.parent.insertVideoSettings.minHeight, 10) >= parseInt(height, 10) || parseInt(_this.parent.insertVideoSettings.maxHeight, 10) <= parseInt(height, 10))) {\n          return;\n        }\n        _this.videoEle.parentElement.style.cursor = 'pointer';\n        _this.setAspectRatio(_this.videoEle, parseInt(width, 10), parseInt(height, 10), args);\n        _this.resizeVidDupPos(_this.videoEle);\n        _this.vidResizePos(_this.videoEle, _this.vidResizeDiv);\n        _this.parent.setContentHeight('', false);\n      }\n    });\n  };\n  Video.prototype.resizing = function (e) {\n    if (this.videoEle.offsetWidth >= this.parent.getInsertVidMaxWidth()) {\n      this.videoEle.style.maxHeight = this.videoEle.offsetHeight + 'px';\n    }\n    var pageX = this.getPointX(e);\n    var pageY = this.getPointY(e);\n    var mouseX = this.resizeBtnStat.botLeft || this.resizeBtnStat.topLeft ? -(pageX - this.pageX) : pageX - this.pageX;\n    var mouseY = this.resizeBtnStat.topLeft || this.resizeBtnStat.topRight ? -(pageY - this.pageY) : pageY - this.pageY;\n    var width = parseInt(this.vidDupPos.width, 10) + mouseX;\n    var height = parseInt(this.vidDupPos.height, 10) + mouseY;\n    this.pageX = pageX;\n    this.pageY = pageY;\n    if (this.resizeBtnStat.botRight) {\n      this.vidDupMouseMove(width + 'px', height + 'px', e);\n    } else if (this.resizeBtnStat.botLeft) {\n      this.vidDupMouseMove(width + 'px', height + 'px', e);\n    } else if (this.resizeBtnStat.topRight) {\n      this.vidDupMouseMove(width + 'px', height + 'px', e);\n    } else if (this.resizeBtnStat.topLeft) {\n      this.vidDupMouseMove(width + 'px', height + 'px', e);\n    }\n  };\n  Video.prototype.cancelResizeAction = function () {\n    EventHandler.remove(this.contentModule.getDocument(), Browser.touchMoveEvent, this.resizing);\n    EventHandler.remove(this.contentModule.getDocument(), Browser.touchEndEvent, this.resizeEnd);\n    if (this.videoEle && this.vidResizeDiv && this.contentModule.getEditPanel().contains(this.vidResizeDiv)) {\n      detach(this.vidResizeDiv);\n      this.videoEle.style.outline = '';\n      this.vidResizeDiv = null;\n      this.pageX = null;\n      this.pageY = null;\n    }\n  };\n  Video.prototype.resizeVidDupPos = function (e) {\n    this.vidDupPos = {\n      width: e.style.width !== '' && this.parent.insertVideoSettings && !this.parent.insertVideoSettings.resizeByPercent ? this.videoEle.style.width : e.width !== 'auto' && e.width !== 0 && e.width !== 'NaN' ? e.width + 'px' : parseInt(getComputedStyle(e).width, 10) + 'px',\n      height: e.style.height !== '' ? this.videoEle.style.height : e.height !== 'auto' && e.height !== 0 && e.height !== 'NaN' ? e.height + 'px' : parseInt(getComputedStyle(e).height, 10) + 'px'\n    };\n  };\n  Video.prototype.resizeBtnInit = function () {\n    return this.resizeBtnStat = {\n      botLeft: false,\n      botRight: false,\n      topRight: false,\n      topLeft: false\n    };\n  };\n  Video.prototype.onToolbarAction = function (args) {\n    if (isIDevice()) {\n      this.parent.notify(events.selectionRestore, {});\n    }\n    var item = args.args.item;\n    switch (item.subCommand) {\n      case 'VideoReplace':\n        this.parent.notify(events.insertVideo, args);\n        break;\n      case 'VideoRemove':\n        this.parent.notify(events.videoDelete, args);\n        break;\n      case 'VideoDimension':\n        this.parent.notify(events.videoSize, args);\n    }\n  };\n  Video.prototype.onKeyDown = function (event) {\n    var originalEvent = event.args;\n    var range;\n    var save;\n    var selectNodeEle;\n    var selectParentEle;\n    this.deletedVid = [];\n    var isCursor;\n    var keyCodeValues = [27, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 44, 45, 9, 16, 17, 18, 19, 20, 33, 34, 35, 36, 37, 38, 39, 40, 91, 92, 93, 144, 145, 182, 183];\n    if (this.parent.editorMode === 'HTML') {\n      range = this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());\n      isCursor = range.startContainer === range.endContainer && range.startOffset === range.endOffset;\n    }\n    if (!isCursor && this.parent.editorMode === 'HTML' && keyCodeValues.indexOf(originalEvent.which) < 0) {\n      var nodes = this.parent.formatter.editorManager.nodeSelection.getNodeCollection(range);\n      for (var i = 0; i < nodes.length; i++) {\n        if (nodes[i].nodeName === 'VIDEO' || nodes[i].nodeName === 'IFRAME') {\n          this.deletedVid.push(nodes[i]);\n        }\n      }\n    }\n    if (this.parent.editorMode === 'HTML' && (originalEvent.which === 8 && originalEvent.code === 'Backspace' || originalEvent.which === 46 && originalEvent.code === 'Delete')) {\n      var isCursor_1 = range.startContainer === range.endContainer && range.startOffset === range.endOffset;\n      if (originalEvent.which === 8 && originalEvent.code === 'Backspace' && isCursor_1) {\n        this.checkVideoBack(range);\n      } else if (originalEvent.which === 46 && originalEvent.code === 'Delete' && isCursor_1) {\n        this.checkVideoDel(range);\n      }\n    }\n    if (!isNullOrUndefined(this.parent.formatter.editorManager.nodeSelection) && originalEvent.code !== 'KeyK') {\n      range = this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());\n      selectNodeEle = this.parent.formatter.editorManager.nodeSelection.getNodeCollection(range);\n      selectParentEle = this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(range);\n      if (!originalEvent.ctrlKey && originalEvent.key && (originalEvent.key.length === 1 || originalEvent.action === 'enter') && (!isNOU(selectParentEle[0]) && selectParentEle[0].tagName === 'VIDEO' || this.isEmbedVidElem(selectParentEle[0])) && selectParentEle[0].parentElement) {\n        var prev = selectParentEle[0].parentElement.childNodes[0];\n        if (this.contentModule.getEditPanel().querySelector('.e-vid-resize')) {\n          this.removeResizeEle();\n        }\n        this.parent.formatter.editorManager.nodeSelection.setSelectionText(this.contentModule.getDocument(), prev, prev, prev.textContent.length, prev.textContent.length);\n        removeClass([selectParentEle[0]], classes.CLS_VID_FOCUS);\n        this.quickToolObj.videoQTBar.hidePopup();\n      }\n    }\n    if (originalEvent.ctrlKey && (originalEvent.keyCode === 89 || originalEvent.keyCode === 90)) {\n      this.undoStack({\n        subCommand: originalEvent.keyCode === 90 ? 'undo' : 'redo'\n      });\n    }\n    if (originalEvent.keyCode === 8 || originalEvent.keyCode === 46) {\n      if (selectNodeEle && (selectNodeEle[0].nodeName === 'VIDEO' || this.isEmbedVidElem(selectNodeEle[0])) && selectNodeEle.length < 1) {\n        if (!isNullOrUndefined(this.parent.formatter.editorManager.nodeSelection)) {\n          save = this.parent.formatter.editorManager.nodeSelection.save(range, this.parent.contentModule.getDocument());\n        }\n        originalEvent.preventDefault();\n        var event_1 = {\n          selectNode: selectNodeEle,\n          selection: save,\n          selectParent: selectParentEle,\n          args: {\n            item: {\n              command: 'Videos',\n              subCommand: 'VideoRemove'\n            },\n            originalEvent: originalEvent\n          }\n        };\n        this.deleteVideo(event_1, originalEvent.keyCode);\n      }\n      if (this.parent.contentModule.getEditPanel().querySelector('.e-vid-resize')) {\n        this.removeResizeEle();\n      }\n    }\n    if (originalEvent.code === 'Backspace') {\n      originalEvent.action = 'backspace';\n    }\n    switch (originalEvent.action) {\n      case 'escape':\n        if (!isNullOrUndefined(this.dialogObj)) {\n          this.dialogObj.close();\n        }\n        break;\n      case 'backspace':\n      case 'delete':\n        for (var i = 0; i < this.deletedVid.length; i++) {\n          var src = this.deletedVid[i].src;\n          this.videoRemovePost(src);\n        }\n        if (this.parent.editorMode !== 'Markdown') {\n          if (range.startContainer.nodeType === 3) {\n            if (originalEvent.code === 'Backspace') {\n              if (range.startContainer.previousElementSibling && range.startOffset === 0 && range.startContainer.previousElementSibling.classList.contains(classes.CLS_VIDEOWRAP)) {\n                detach(range.startContainer.previousElementSibling);\n              }\n            } else {\n              if (range.startContainer.nextElementSibling && range.endContainer.textContent.length === range.endOffset && range.startContainer.nextElementSibling.classList.contains(classes.CLS_VIDEOWRAP)) {\n                detach(range.startContainer.nextElementSibling);\n              }\n            }\n          } else if (range.startContainer.nodeType === 1 && range.startContainer.classList && range.startContainer.classList.contains(classes.CLS_VIDEOWRAP)) {\n            detach(range.startContainer);\n          }\n        }\n        break;\n      case 'insert-video':\n        if (!isNullOrUndefined(this.parent.formatter.editorManager.nodeSelection)) {\n          save = this.parent.formatter.editorManager.nodeSelection.save(range, this.parent.contentModule.getDocument());\n        }\n        this.openDialog(true, originalEvent, save, selectNodeEle, selectParentEle);\n        originalEvent.preventDefault();\n        break;\n    }\n    if (originalEvent.ctrlKey && originalEvent.key === 'a') {\n      this.handleSelectAll();\n    }\n  };\n  Video.prototype.handleSelectAll = function () {\n    this.cancelResizeAction();\n    var videoFocusNodes = this.parent.inputElement.querySelectorAll('.' + classes.CLS_VID_FOCUS);\n    removeClass(videoFocusNodes, classes.CLS_VID_FOCUS);\n  };\n  Video.prototype.openDialog = function (isInternal, event, selection, ele, parentEle) {\n    var range;\n    var save;\n    var selectNodeEle;\n    var selectParentEle;\n    if (!isInternal && !isNOU(this.parent.formatter.editorManager.nodeSelection)) {\n      range = this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());\n      save = this.parent.formatter.editorManager.nodeSelection.save(range, this.parent.contentModule.getDocument());\n      selectNodeEle = this.parent.formatter.editorManager.nodeSelection.getNodeCollection(range);\n      selectParentEle = this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(range);\n    } else {\n      save = selection;\n      selectNodeEle = ele;\n      selectParentEle = parentEle;\n    }\n    if (this.parent.editorMode === 'HTML') {\n      this.insertVideo({\n        args: {\n          item: {\n            command: 'Videos',\n            subCommand: 'Video'\n          },\n          originalEvent: event,\n          name: !isInternal ? 'showDialog' : null\n        },\n        selectNode: selectNodeEle,\n        selection: save,\n        selectParent: selectParentEle\n      });\n    }\n  };\n  Video.prototype.showDialog = function () {\n    this.openDialog(false);\n  };\n  Video.prototype.closeDialog = function () {\n    if (this.dialogObj) {\n      this.dialogObj.hide({\n        returnValue: true\n      });\n    }\n  };\n  Video.prototype.checkVideoBack = function (range) {\n    if (range.startContainer.nodeName === '#text' && range.startOffset === 0 && !isNOU(range.startContainer.previousSibling) && (range.startContainer.previousSibling.nodeName === 'VIDEO' || this.isEmbedVidElem(range.startContainer.previousSibling))) {\n      this.deletedVid.push(range.startContainer.previousSibling);\n    } else if (range.startContainer.nodeName !== '#text' && !isNOU(range.startContainer.childNodes[range.startOffset - 1]) && (range.startContainer.childNodes[range.startOffset - 1].nodeName === 'VIDEO' || this.isEmbedVidElem(range.startContainer.childNodes[range.startOffset - 1]))) {\n      this.deletedVid.push(range.startContainer.childNodes[range.startOffset - 1]);\n    }\n  };\n  Video.prototype.checkVideoDel = function (range) {\n    if (range.startContainer.nodeName === '#text' && range.startOffset === range.startContainer.textContent.length && !isNOU(range.startContainer.nextSibling) && (range.startContainer.nextSibling.nodeName === 'VIDEO' || this.isEmbedVidElem(range.startContainer.nextSibling))) {\n      this.deletedVid.push(range.startContainer.nextSibling);\n    } else if (range.startContainer.nodeName !== '#text' && !isNOU(range.startContainer.childNodes[range.startOffset]) && (range.startContainer.childNodes[range.startOffset].nodeName === 'VIDEO' || this.isEmbedVidElem(range.startContainer.childNodes[range.startOffset]))) {\n      this.deletedVid.push(range.startContainer.childNodes[range.startOffset]);\n    }\n  };\n  Video.prototype.alignmentSelect = function (e) {\n    var item = e.item;\n    if (!document.body.contains(document.body.querySelector('.e-rte-quick-toolbar')) || item.command !== 'Videos') {\n      return;\n    }\n    var range = this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());\n    var selectNodeEle = this.parent.formatter.editorManager.nodeSelection.getNodeCollection(range);\n    selectNodeEle = selectNodeEle[0].nodeName === 'VIDEO' ? selectNodeEle : [this.videoEle];\n    var args = {\n      args: e,\n      selectNode: selectNodeEle\n    };\n    if (this.parent.formatter.getUndoRedoStack().length === 0) {\n      this.parent.formatter.saveData();\n    }\n    switch (item.subCommand) {\n      case 'JustifyLeft':\n      case 'JustifyCenter':\n      case 'JustifyRight':\n        this.alignVideo(args, item.subCommand);\n        break;\n      case 'Inline':\n        this.inline(args);\n        break;\n      case 'Break':\n        this.break(args);\n        break;\n    }\n    if (this.quickToolObj && document.body.contains(this.quickToolObj.videoQTBar.element)) {\n      this.quickToolObj.videoQTBar.hidePopup();\n      removeClass([selectNodeEle[0]], classes.CLS_VID_FOCUS);\n    }\n    this.cancelResizeAction();\n  };\n  Video.prototype.deleteVideo = function (e, keyCode) {\n    if (e.selectNode[0].nodeName !== 'VIDEO' && !this.isEmbedVidElem(e.selectNode[0])) {\n      return;\n    }\n    if (this.isEmbedVidElem(e.selectNode[0])) {\n      e.selectNode[0] = e.selectNode[0].classList.contains(classes.CLS_VID_CLICK_ELEM) ? e.selectNode[0] : e.selectNode[0].parentElement;\n    }\n    var args = {\n      element: !this.isEmbedVidElem(e.selectNode[0]) ? e.selectNode[0].querySelector('iframe') : e.selectNode[0],\n      src: !this.isEmbedVidElem(e.selectNode[0]) ? e.selectNode[0].querySelector('source').getAttribute('src') : e.selectNode[0].querySelector('iframe').getAttribute('src')\n    };\n    if (this.parent.formatter.getUndoRedoStack().length === 0) {\n      this.parent.formatter.saveData();\n    }\n    e.selection.restore();\n    this.parent.formatter.process(this.parent, e.args, e.args, {\n      selectNode: e.selectNode,\n      subCommand: e.args.item.subCommand\n    });\n    this.videoRemovePost(args.src);\n    if (this.quickToolObj && document.body.contains(this.quickToolObj.videoQTBar.element)) {\n      this.quickToolObj.videoQTBar.hidePopup();\n    }\n    this.cancelResizeAction();\n    if (isNullOrUndefined(keyCode)) {\n      this.parent.trigger(events.afterMediaDelete, args);\n    }\n  };\n  Video.prototype.videoRemovePost = function (src) {\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    var proxy = this;\n    var absoluteUrl = '';\n    if (isNOU(this.parent.insertVideoSettings.removeUrl) || this.parent.insertVideoSettings.removeUrl === '') {\n      return;\n    }\n    if (src.indexOf('http://') > -1 || src.indexOf('https://') > -1) {\n      absoluteUrl = src;\n    } else {\n      absoluteUrl = new URL(src, document.baseURI).href;\n    }\n    // eslint-disable-next-line no-useless-escape\n    this.removingVideoName = absoluteUrl.replace(/^.*[\\\\\\/]/, '');\n    var xhr = new XMLHttpRequest();\n    // eslint-disable-next-line @typescript-eslint/tslint/config\n    xhr.addEventListener('readystatechange', function () {\n      if (this.readyState === 4 && this.status === 200) {\n        proxy.triggerPost(this.response);\n      }\n    });\n    xhr.open('GET', absoluteUrl);\n    xhr.responseType = 'blob';\n    xhr.send();\n  };\n  Video.prototype.triggerPost = function (response) {\n    var removeUrl = this.parent.insertVideoSettings.removeUrl;\n    if (isNOU(removeUrl) || removeUrl === '') {\n      return;\n    }\n    var file = new File([response], this.removingVideoName);\n    var ajax = new Ajax(removeUrl, 'POST', true, null);\n    var formData = new FormData();\n    formData.append('UploadFiles', file);\n    ajax.send(formData);\n  };\n  Video.prototype.onDocumentClick = function (e) {\n    var target = e.target;\n    if (target.nodeName === 'VIDEO' || this.isEmbedVidElem(target)) {\n      this.videoEle = !this.isEmbedVidElem(target) ? target : target.querySelector('iframe');\n    }\n    if (!isNullOrUndefined(this.dialogObj) && (\n    // eslint-disable-next-line\n    !closest(target, '[id=' + \"'\" + this.dialogObj.element.id + \"'\" + ']') && this.parent.toolbarSettings.enable && this.parent.getToolbarElement() && !this.parent.getToolbarElement().contains(e.target) || this.parent.getToolbarElement() && this.parent.getToolbarElement().contains(e.target) && !closest(target, '#' + this.parent.getID() + '_toolbar_Video') && !target.querySelector('#' + this.parent.getID() + '_toolbar_Video'))) {\n      /* eslint-disable */\n      if (e.offsetX > e.target.clientWidth || e.offsetY > e.target.clientHeight) {} else {\n        this.parent.notify(events.documentClickClosedBy, {\n          closedBy: \"outside click\"\n        });\n        this.dialogObj.hide({\n          returnValue: true\n        });\n        this.parent.isBlur = true;\n        dispatchEvent(this.parent.element, 'focusout');\n      }\n      /* eslint-enable */\n    }\n    // if (((e.target as HTMLElement).tagName !== 'VIDEO' || !this.isEmbedVidElem(e.target as HTMLElement)) && this.vidResizeDiv && !(this.quickToolObj &&\n    //     this.quickToolObj.videoQTBar && this.quickToolObj.videoQTBar.element.contains(e.target as HTMLElement)) &&\n    //     this.contentModule.getEditPanel().contains(this.vidResizeDiv)) {\n    //     this.cancelResizeAction();\n    // }\n    if (this.contentModule.getEditPanel().querySelector('.e-vid-resize')) {\n      if (target.tagName !== 'VIDEO' && !this.isEmbedVidElem(target)) {\n        this.removeResizeEle();\n      }\n      if (target.tagName !== 'VIDEO' && !this.isEmbedVidElem(target) && !isNOU(this.videoEle)) {\n        this.videoEle.style.outline = '';\n      } else if (!isNOU(this.prevSelectedVidEle) && this.prevSelectedVidEle !== (target.tagName === 'IFRAME' || target.tagName === 'VIDEO' ? target : target.querySelector('iframe'))) {\n        this.prevSelectedVidEle.style.outline = '';\n      }\n    }\n  };\n  Video.prototype.removeResizeEle = function () {\n    EventHandler.remove(this.contentModule.getDocument(), Browser.touchMoveEvent, this.resizing);\n    EventHandler.remove(this.contentModule.getDocument(), Browser.touchEndEvent, this.resizeEnd);\n    detach(this.contentModule.getEditPanel().querySelector('.e-vid-resize'));\n  };\n  Video.prototype.onWindowResize = function () {\n    if (!isNOU(this.contentModule) && !isNOU(this.contentModule.getEditPanel().querySelector('.e-vid-resize'))) {\n      this.cancelResizeAction();\n    }\n  };\n  Video.prototype.break = function (e) {\n    if (e.selectNode[0].nodeName !== 'VIDEO' && !this.isEmbedVidElem(e.selectNode[0])) {\n      return;\n    }\n    var subCommand = e.args.item ? e.args.item.subCommand : 'Break';\n    this.parent.formatter.process(this.parent, e.args, e.args, {\n      selectNode: e.selectNode,\n      subCommand: subCommand\n    });\n  };\n  Video.prototype.inline = function (e) {\n    if (e.selectNode[0].nodeName !== 'VIDEO' && !this.isEmbedVidElem(e.selectNode[0])) {\n      return;\n    }\n    var subCommand = e.args.item ? e.args.item.subCommand : 'Inline';\n    this.parent.formatter.process(this.parent, e.args, e.args, {\n      selectNode: e.selectNode,\n      subCommand: subCommand\n    });\n  };\n  Video.prototype.alignVideo = function (e, type) {\n    var subCommand = e.args.item ? e.args.item.subCommand : type;\n    this.parent.formatter.process(this.parent, e.args, e.args, {\n      selectNode: e.selectNode,\n      subCommand: subCommand\n    });\n  };\n  Video.prototype.editAreaClickHandler = function (e) {\n    if (this.parent.readonly) {\n      this.hideVideoQuickToolbar();\n      return;\n    }\n    var args = e.args;\n    var showOnRightClick = this.parent.quickToolbarSettings.showOnRightClick;\n    if (args.which === 2 || showOnRightClick && args.which === 1 || !showOnRightClick && args.which === 3) {\n      if (showOnRightClick && args.which === 1 && !isNullOrUndefined(args.target) && (args.target.tagName === 'VIDEO' || this.isEmbedVidElem(args.target))) {\n        this.parent.formatter.editorManager.nodeSelection.Clear(this.contentModule.getDocument());\n        this.parent.formatter.editorManager.nodeSelection.setSelectionContents(this.contentModule.getDocument(), args.target);\n      }\n      return;\n    }\n    if (this.parent.editorMode === 'HTML' && this.parent.quickToolbarModule && this.parent.quickToolbarModule.videoQTBar) {\n      this.quickToolObj = this.parent.quickToolbarModule;\n      var target = args.target;\n      this.contentModule = this.rendererFactory.getRenderer(RenderType.Content);\n      var isPopupOpen = this.quickToolObj.videoQTBar.element.classList.contains('e-rte-pop');\n      if ((target.nodeName === 'VIDEO' || this.isEmbedVidElem(target)) && this.parent.quickToolbarModule) {\n        if (isPopupOpen) {\n          return;\n        }\n        this.parent.formatter.editorManager.nodeSelection.Clear(this.contentModule.getDocument());\n        this.parent.formatter.editorManager.nodeSelection.setSelectionContents(this.contentModule.getDocument(), target);\n        if (isIDevice()) {\n          this.parent.notify(events.selectionSave, e);\n        }\n        addClass([!this.isEmbedVidElem(target) ? target : target.querySelector('iframe')], classes.CLS_VID_FOCUS);\n        this.showVideoQuickToolbar({\n          args: args,\n          type: 'Videos',\n          elements: [args.target]\n        });\n      } else {\n        this.hideVideoQuickToolbar();\n      }\n    }\n  };\n  Video.prototype.showVideoQuickToolbar = function (e) {\n    var _this = this;\n    if (e.type !== 'Videos' || !isNullOrUndefined(e.args) && e.args.detail === 2 || isNullOrUndefined(this.parent.quickToolbarModule) || isNullOrUndefined(this.parent.quickToolbarModule.videoQTBar) || isNullOrUndefined(e.args)) {\n      return;\n    }\n    this.quickToolObj = this.parent.quickToolbarModule;\n    var args = e.args;\n    var target = e.elements;\n    [].forEach.call(e.elements, function (element, index) {\n      if (index === 0) {\n        target = element;\n      }\n    });\n    if (target.tagName === 'VIDEO' || this.isEmbedVidElem(target)) {\n      addClass([!this.isEmbedVidElem(target) || target.tagName === 'IFRAME' ? target : target.querySelector('iframe')], [classes.CLS_VID_FOCUS]);\n    }\n    var pageY = this.parent.iframeSettings.enable ? window.pageYOffset + this.parent.element.getBoundingClientRect().top + args.clientY : args.pageY;\n    if (this.parent.quickToolbarModule.videoQTBar) {\n      if (e.isNotify) {\n        setTimeout(function () {\n          _this.parent.formatter.editorManager.nodeSelection.Clear(_this.contentModule.getDocument());\n          _this.parent.formatter.editorManager.nodeSelection.setSelectionContents(_this.contentModule.getDocument(), target);\n          _this.quickToolObj.videoQTBar.showPopup(args.pageX - 50, pageY + target.getBoundingClientRect().height / 2 - target.offsetTop, target);\n        }, 400);\n      } else {\n        this.quickToolObj.videoQTBar.showPopup(args.pageX - 50, pageY + target.getBoundingClientRect().height / 2 - target.offsetTop, target);\n      }\n    }\n  };\n  Video.prototype.hideVideoQuickToolbar = function () {\n    if (!isNullOrUndefined(this.contentModule.getEditPanel().querySelector('.' + classes.CLS_VID_FOCUS))) {\n      removeClass([this.contentModule.getEditPanel().querySelector('.' + classes.CLS_VID_FOCUS)], classes.CLS_VID_FOCUS);\n      if (!isNOU(this.videoEle)) {\n        this.videoEle.style.outline = '';\n      }\n      if (!isNOU(this.contentModule.getEditPanel().querySelector('.e-vid-resize'))) {\n        detach(this.contentModule.getEditPanel().querySelector('.e-vid-resize'));\n      }\n      if (this.quickToolObj && this.quickToolObj.videoQTBar && document.body.contains(this.quickToolObj.videoQTBar.element)) {\n        this.quickToolObj.videoQTBar.hidePopup();\n      }\n    }\n  };\n  Video.prototype.isEmbedVidElem = function (target) {\n    if (target && target.nodeType !== 3 && target.nodeName !== 'BR' && target.classList && target.classList.contains(classes.CLS_VID_CLICK_ELEM) || target && target.nodeName === 'IFRAME') {\n      return true;\n    } else {\n      return false;\n    }\n  };\n  Video.prototype.insertingVideo = function (e) {\n    this.insertVideo(e);\n    if (!isNullOrUndefined(this.dialogObj)) {\n      this.dialogObj.element.style.maxHeight = 'inherit';\n      var dialogContent = this.dialogObj.element.querySelector('.e-video-content');\n      if (!isNullOrUndefined(this.parent.insertVideoSettings.path) || this.parent.editorMode === 'HTML') {\n        document.getElementById(this.rteID + '_insertVideo').focus();\n      } else {\n        dialogContent.querySelector('.e-video-url').focus();\n      }\n    }\n  };\n  Video.prototype.insertVideo = function (e) {\n    var _this = this;\n    if (this.dialogObj) {\n      this.dialogObj.hide({\n        returnValue: true\n      });\n      return;\n    }\n    var videoDialog = this.parent.createElement('div', {\n      className: 'e-rte-video-dialog',\n      id: this.rteID + '_video'\n    });\n    this.parent.element.appendChild(videoDialog);\n    var videoInsert = this.i10n.getConstant('dialogInsert');\n    var videolinkCancel = this.i10n.getConstant('dialogCancel');\n    var videoHeader = this.i10n.getConstant('videoHeader');\n    var selection = e.selection;\n    var selectObj = {\n      selfVideo: this,\n      selection: e.selection,\n      args: e.args,\n      selectParent: e.selectParent\n    };\n    var dialogModel = {\n      header: videoHeader,\n      cssClass: classes.CLS_RTE_ELEMENTS,\n      enableRtl: this.parent.enableRtl,\n      locale: this.parent.locale,\n      showCloseIcon: true,\n      closeOnEscape: true,\n      width: Browser.isDevice ? '290px' : '340px',\n      isModal: Browser.isDevice,\n      buttons: [{\n        click: this.insertVideoUrl.bind(selectObj),\n        buttonModel: {\n          content: videoInsert,\n          cssClass: 'e-flat e-insertVideo',\n          isPrimary: true,\n          disabled: true\n        }\n      }, {\n        click: function (e) {\n          _this.cancelDialog(e);\n        },\n        buttonModel: {\n          cssClass: 'e-flat e-cancel',\n          content: videolinkCancel\n        }\n      }],\n      target: Browser.isDevice ? document.body : this.parent.element,\n      animationSettings: {\n        effect: 'None'\n      },\n      close: function (event) {\n        if (_this.isVideoUploaded) {\n          _this.uploadObj.removing();\n        }\n        _this.parent.isBlur = false;\n        if (event && event.event.returnValue) {\n          if (_this.parent.editorMode === 'HTML') {\n            selection.restore();\n          }\n        }\n        _this.dialogObj.destroy();\n        detach(_this.dialogObj.element);\n        _this.dialogRenderObj.close(event);\n        _this.dialogObj = null;\n      }\n    };\n    var dialogContent = this.parent.createElement('div', {\n      className: 'e-video-content'\n    });\n    if (!isNullOrUndefined(this.parent.insertVideoSettings.path) || this.parent.editorMode === 'HTML') {\n      dialogContent.appendChild(this.videoUpload(e));\n    }\n    var linkHeader = this.parent.createElement('div', {\n      className: 'e-videoheader'\n    });\n    var embedLinkHeader = this.parent.createElement('div', {\n      className: 'e-embed-videoheader'\n    });\n    var linkHeaderText = this.i10n.getConstant('videoLinkHeader');\n    var embedLinkHeaderText = this.i10n.getConstant('embedVideoLinkHeader');\n    if (this.parent.editorMode === 'HTML') {\n      linkHeader.innerHTML = linkHeaderText;\n      embedLinkHeader.innerHTML = embedLinkHeaderText;\n    }\n    dialogContent.appendChild(this.urlPopup(e));\n    if (e.selectNode && e.selectNode[0].nodeType === 1 && (e.selectNode[0].tagName === 'VIDEO' || this.isEmbedVidElem(e.selectNode[0]))) {\n      dialogModel.header = this.parent.localeObj.getConstant('editVideoHeader');\n      dialogModel.content = dialogContent;\n    } else {\n      dialogModel.content = dialogContent;\n    }\n    this.dialogObj = this.dialogRenderObj.render(dialogModel);\n    this.dialogObj.createElement = this.parent.createElement;\n    this.dialogObj.appendTo(videoDialog);\n    if (e.selectNode && e.selectNode[0].nodeType === 1 && (e.selectNode[0].tagName === 'VIDEO' || this.isEmbedVidElem(e.selectNode[0])) && e.name === 'insertVideo') {\n      this.dialogObj.element.querySelector('.e-insertVideo').textContent = this.parent.localeObj.getConstant('dialogUpdate');\n    }\n    videoDialog.style.maxHeight = 'inherit';\n    if (this.quickToolObj) {\n      if (this.quickToolObj.videoQTBar && document.body.contains(this.quickToolObj.videoQTBar.element)) {\n        this.quickToolObj.videoQTBar.hidePopup();\n        if (!isNullOrUndefined(e.selectParent)) {\n          removeClass([e.selectParent[0]], classes.CLS_VID_FOCUS);\n        }\n      }\n      if (this.quickToolObj.inlineQTBar && document.body.contains(this.quickToolObj.inlineQTBar.element)) {\n        this.quickToolObj.inlineQTBar.hidePopup();\n      }\n      if (this.quickToolObj.textQTBar && this.parent.element.ownerDocument.body.contains(this.quickToolObj.textQTBar.element)) {\n        this.quickToolObj.textQTBar.hidePopup();\n      }\n    }\n  };\n  // eslint-disable-next-line\n  Video.prototype.urlPopup = function (e) {\n    var _this = this;\n    var videoUrl = this.parent.createElement('div', {\n      className: 'e-video-url-wrap'\n    });\n    var urlContent = this.parent.createElement('div', {\n      id: 'urlcontent'\n    });\n    var placeUrl = this.i10n.getConstant('videoUrl');\n    var content = '<input id=\"embedURL\" type=\"radio\">' + '<input id=\"webURL\" type=\"radio\" >';\n    var contentElem = parseHtml(content);\n    videoUrl.appendChild(contentElem);\n    videoUrl.appendChild(urlContent);\n    this.embedInputUrl = this.parent.createElement('textarea', {\n      className: 'e-input e-embed-video-url',\n      attrs: {\n        placeholder: this.i10n.getConstant('pasteEmbeddedCodeHere'),\n        type: 'text',\n        tabindex: '-1',\n        'aria-label': this.i10n.getConstant('embedVideoLinkHeader')\n      }\n    });\n    this.embedInputUrl.addEventListener('keyup', function () {\n      if (!isNOU(_this.embedInputUrl)) {\n        if (_this.embedInputUrl.value.length === 0) {\n          _this.dialogObj.getButtons(0).element.disabled = true;\n        } else {\n          _this.dialogObj.getButtons(0).element.removeAttribute('disabled');\n        }\n      }\n    });\n    this.inputUrl = this.parent.createElement('input', {\n      className: 'e-input e-video-url',\n      attrs: {\n        placeholder: placeUrl,\n        spellcheck: 'false'\n      }\n    });\n    this.inputUrl.addEventListener('input', function () {\n      if (!isNOU(_this.inputUrl)) {\n        if (_this.inputUrl.value.length === 0) {\n          _this.dialogObj.getButtons(0).element.disabled = true;\n        } else {\n          _this.dialogObj.getButtons(0).element.removeAttribute('disabled');\n        }\n      }\n    });\n    if (e.selectNode && (e.selectNode[0] && e.selectNode[0].nodeType !== 3 && e.selectNode[0].nodeName !== 'BR' && e.selectNode[0].classList && e.selectNode[0].classList.contains(classes.CLS_VID_CLICK_ELEM) || e.selectNode[0].nodeName === 'IFRAME' || e.selectNode[0].nodeName === 'VIDEO')) {\n      var regex = new RegExp(/([^\\S]|^)(((https?\\:\\/\\/)|(www\\.))(\\S+))/gi);\n      var sourceElement = e.selectNode[0].querySelector('source');\n      this.inputUrl.value = sourceElement.src.match(regex) ? sourceElement.src : '';\n    }\n    var embedUrlBtn = new RadioButton({\n      label: this.i10n.getConstant('embeddedCode'),\n      checked: true,\n      name: 'URL',\n      created: function () {\n        urlContent.appendChild(_this.embedInputUrl);\n      },\n      change: function () {\n        urlContent.innerHTML = '';\n        urlContent.appendChild(_this.embedInputUrl);\n      }\n    });\n    embedUrlBtn.appendTo(videoUrl.querySelector('#embedURL'));\n    var webUrlBtn = new RadioButton({\n      label: this.i10n.getConstant('webUrl'),\n      name: 'URL',\n      change: function () {\n        urlContent.innerHTML = '';\n        urlContent.appendChild(_this.inputUrl);\n      }\n    });\n    webUrlBtn.appendTo(videoUrl.querySelector('#webURL'));\n    return videoUrl;\n  };\n  Video.prototype.videoUpload = function (e) {\n    var _this = this;\n    var save;\n    var selectParent;\n    // eslint-disable-next-line\n    var proxy = this;\n    var iframe = proxy.parent.iframeSettings.enable;\n    if (proxy.parent.editorMode === 'HTML' && (!iframe && isNullOrUndefined(closest(e.selection.range.startContainer.parentNode, '[id='\n    // eslint-disable-next-line\n    + \"'\" + this.parent.contentModule.getPanel().id + \"'\" + ']')) || iframe && !hasClass(e.selection.range.startContainer.parentNode.ownerDocument.querySelector('body'), 'e-lib'))) {\n      this.contentModule.getEditPanel().focus();\n      var range = this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());\n      save = this.parent.formatter.editorManager.nodeSelection.save(range, this.parent.contentModule.getDocument());\n      selectParent = this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(range);\n    } else {\n      save = e.selection;\n      selectParent = e.selectParent;\n    }\n    var uploadParentEle = this.parent.createElement('div', {\n      className: 'e-vid-uploadwrap e-droparea'\n    });\n    var deviceVideoUpMsg = this.i10n.getConstant('videoDeviceUploadMessage');\n    var videoUpMsg = this.i10n.getConstant('videoUploadMessage');\n    var span = this.parent.createElement('span', {\n      className: 'e-droptext'\n    });\n    var spanMsg = this.parent.createElement('span', {\n      className: 'e-rte-upload-text',\n      innerHTML: Browser.isDevice ? deviceVideoUpMsg : videoUpMsg\n    });\n    span.appendChild(spanMsg);\n    var btnEle = this.parent.createElement('button', {\n      className: 'e-browsebtn',\n      id: this.rteID + '_insertVideo',\n      attrs: {\n        autofocus: 'true',\n        type: 'button'\n      }\n    });\n    span.appendChild(btnEle);\n    uploadParentEle.appendChild(span);\n    var browserMsg = this.i10n.getConstant('browse');\n    var button = new Button({\n      content: browserMsg,\n      enableRtl: this.parent.enableRtl\n    });\n    button.isStringTemplate = true;\n    button.createElement = this.parent.createElement;\n    button.appendTo(btnEle);\n    var btnClick = Browser.isDevice ? span : btnEle;\n    EventHandler.add(btnClick, 'click', this.fileSelect, this);\n    var uploadEle = this.parent.createElement('input', {\n      id: this.rteID + '_upload',\n      attrs: {\n        type: 'File',\n        name: 'UploadFiles'\n      }\n    });\n    uploadParentEle.appendChild(uploadEle);\n    var fileName;\n    var selectArgs;\n    var filesData;\n    this.uploadObj = new Uploader({\n      asyncSettings: {\n        saveUrl: this.parent.insertVideoSettings.saveUrl,\n        removeUrl: this.parent.insertVideoSettings.removeUrl\n      },\n      dropArea: span,\n      multiple: false,\n      enableRtl: this.parent.enableRtl,\n      allowedExtensions: this.parent.insertVideoSettings.allowedTypes.toString(),\n      selected: function (e) {\n        proxy.isVideoUploaded = true;\n        selectArgs = e;\n        // eslint-disable-next-line\n        filesData = e.filesData;\n        _this.parent.trigger(events.fileSelected, selectArgs, function (selectArgs) {\n          if (!selectArgs.cancel) {\n            _this.checkExtension(selectArgs.filesData[0]);\n            fileName = selectArgs.filesData[0].name;\n            if (_this.parent.editorMode === 'HTML' && isNullOrUndefined(_this.parent.insertVideoSettings.path)) {\n              var reader_1 = new FileReader();\n              // eslint-disable-next-line\n              reader_1.addEventListener('load', function (e) {\n                var url = _this.parent.insertVideoSettings.saveFormat === 'Base64' ? reader_1.result : URL.createObjectURL(convertToBlob(reader_1.result));\n                proxy.uploadUrl = {\n                  url: url,\n                  selection: save,\n                  fileName: fileName,\n                  selectParent: selectParent\n                };\n                proxy.inputUrl.setAttribute('disabled', 'true');\n                proxy.embedInputUrl.setAttribute('disabled', 'true');\n                if (isNullOrUndefined(proxy.parent.insertVideoSettings.saveUrl) && _this.isAllowedTypes && !isNullOrUndefined(_this.dialogObj)) {\n                  _this.dialogObj.getButtons(0).element.removeAttribute('disabled');\n                }\n              });\n              reader_1.readAsDataURL(selectArgs.filesData[0].rawFile);\n            }\n          }\n        });\n      },\n      beforeUpload: function (args) {\n        _this.parent.trigger(events.beforeFileUpload, args);\n      },\n      uploading: function (e) {\n        if (!_this.parent.isServerRendered) {\n          _this.parent.trigger(events.fileUploading, e);\n        }\n      },\n      success: function (e) {\n        _this.parent.trigger(events.fileUploadSuccess, e, function (e) {\n          if (!isNullOrUndefined(_this.parent.insertVideoSettings.path)) {\n            var url = _this.parent.insertVideoSettings.path + e.file.name;\n            // eslint-disable-next-line\n            var value = {\n              url: url,\n              selection: save\n            };\n            proxy.uploadUrl = {\n              url: url,\n              selection: save,\n              fileName: fileName,\n              selectParent: selectParent,\n              width: {\n                width: proxy.parent.insertVideoSettings.width,\n                minWidth: proxy.parent.insertVideoSettings.minWidth,\n                maxWidth: proxy.parent.getInsertImgMaxWidth()\n              },\n              height: {\n                height: proxy.parent.insertVideoSettings.height,\n                minHeight: proxy.parent.insertVideoSettings.minHeight,\n                maxHeight: proxy.parent.insertVideoSettings.maxHeight\n              }\n            };\n            //proxy.inputUrl.setAttribute('disabled', 'true');\n            proxy.embedInputUrl.setAttribute('disabled', 'true');\n          }\n          if (e.operation === 'upload' && !isNullOrUndefined(_this.dialogObj)) {\n            _this.dialogObj.getButtons(0).element.removeAttribute('disabled');\n          }\n        });\n      },\n      failure: function (e) {\n        _this.parent.trigger(events.fileUploadFailed, e);\n      },\n      removing: function () {\n        // eslint-disable-next-line\n        _this.parent.trigger(events.fileRemoving, e, function (e) {\n          proxy.isVideoUploaded = false;\n          _this.dialogObj.getButtons(0).element.disabled = true;\n          //proxy.inputUrl.removeAttribute('disabled');\n          proxy.embedInputUrl.removeAttribute('disabled');\n          if (proxy.uploadUrl) {\n            proxy.uploadUrl.url = '';\n          }\n        });\n      }\n    });\n    this.uploadObj.isStringTemplate = true;\n    this.uploadObj.createElement = this.parent.createElement;\n    this.uploadObj.appendTo(uploadEle);\n    return uploadParentEle;\n  };\n  Video.prototype.checkExtension = function (e) {\n    if (this.uploadObj.allowedExtensions) {\n      if (this.uploadObj.allowedExtensions.toLocaleLowerCase().indexOf(('.' + e.type).toLocaleLowerCase()) === -1) {\n        this.dialogObj.getButtons(0).element.setAttribute('disabled', 'disabled');\n        this.isAllowedTypes = false;\n      } else {\n        this.isAllowedTypes = true;\n      }\n    }\n  };\n  Video.prototype.fileSelect = function () {\n    this.dialogObj.element.getElementsByClassName('e-file-select-wrap')[0].querySelector('button').click();\n    return false;\n  };\n  // eslint-disable-next-line\n  Video.prototype.cancelDialog = function (e) {\n    this.parent.isBlur = false;\n    this.dialogObj.hide({\n      returnValue: true\n    });\n    if (this.isVideoUploaded) {\n      this.uploadObj.removing();\n    }\n  };\n  // eslint-disable-next-line\n  Video.prototype.insertVideoUrl = function (e) {\n    var proxy = this.selfVideo;\n    //let audioSelectParent: Node = proxy.uploadUrl.selectParent[0];\n    proxy.isVideoUploaded = false;\n    var url = proxy.inputUrl.value;\n    var embedUrl = proxy.embedInputUrl.value;\n    if (proxy.parent.formatter.getUndoRedoStack().length === 0) {\n      proxy.parent.formatter.saveData();\n    }\n    if (!isNullOrUndefined(proxy.uploadUrl) && proxy.uploadUrl.url !== '') {\n      proxy.uploadUrl.cssClass = proxy.parent.insertVideoSettings.layoutOption === 'Inline' ? classes.CLS_VIDEOINLINE : classes.CLS_VIDEOBREAK;\n      proxy.dialogObj.hide({\n        returnValue: false\n      });\n      proxy.parent.formatter.process(proxy.parent, this.args, this.args.originalEvent, proxy.uploadUrl);\n      proxy.uploadUrl.url = '';\n    } else if (proxy.parent.editorMode === 'HTML' && (url !== '' || embedUrl !== '')) {\n      if (proxy.parent.editorMode === 'HTML' && isNullOrUndefined(closest(\n      // eslint-disable-next-line\n      this.selection.range.startContainer.parentNode, '[id=' + \"'\" + proxy.contentModule.getPanel().id + \"'\" + ']'))) {\n        proxy.contentModule.getEditPanel().focus();\n        var range = proxy.parent.formatter.editorManager.nodeSelection.getRange(proxy.contentModule.getDocument());\n        this.selection = proxy.parent.formatter.editorManager.nodeSelection.save(range, proxy.contentModule.getDocument());\n        this.selectParent = proxy.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(range);\n      }\n      var webUrlBtn = document.getElementById('webURL');\n      var name_1 = webUrlBtn.checked ? url.split('/')[url.split('/').length - 1] : embedUrl;\n      var value = {\n        cssClass: proxy.parent.insertVideoSettings.layoutOption === 'Inline' ? classes.CLS_VIDEOINLINE : classes.CLS_VIDEOBREAK,\n        url: url,\n        selection: this.selection,\n        fileName: name_1,\n        isEmbedUrl: !webUrlBtn.checked,\n        selectParent: this.selectParent,\n        width: {\n          width: proxy.parent.insertVideoSettings.width,\n          minWidth: proxy.parent.insertVideoSettings.minWidth,\n          maxWidth: proxy.parent.getInsertImgMaxWidth()\n        },\n        height: {\n          height: proxy.parent.insertVideoSettings.height,\n          minHeight: proxy.parent.insertVideoSettings.minHeight,\n          maxHeight: proxy.parent.insertVideoSettings.maxHeight\n        }\n      };\n      proxy.parent.formatter.process(proxy.parent, this.args, this.args.originalEvent, value);\n      proxy.dialogObj.hide({\n        returnValue: false\n      });\n    }\n  };\n  /* eslint-disable */\n  /**\n   * Destroys the ToolBar.\n   *\n   * @method destroy\n   * @returns {void}\n   * @hidden\n    */\n  /* eslint-enable */\n  Video.prototype.destroy = function () {\n    this.prevSelectedVidEle = undefined;\n    this.removeEventListener();\n  };\n  /**\n   * For internal use only - Get the module name.\n   *\n   * @returns {void}\n   * @hidden\n   */\n  Video.prototype.getModuleName = function () {\n    return 'video';\n  };\n  return Video;\n}();\nexport { Video };","map":{"version":3,"names":["addClass","detach","EventHandler","isNullOrUndefined","Ajax","formatUnit","Browser","closest","removeClass","isNOU","events","classes","Uploader","TextBox","Button","RadioButton","RenderType","dispatchEvent","parseHtml","hasClass","convertToBlob","isIDevice","Video","parent","serviceLocator","isVideoUploaded","isAllowedTypes","pageX","pageY","deletedVid","rteID","element","id","i10n","getService","rendererFactory","dialogRenderObj","addEventListener","prototype","isDestroyed","on","keyDown","onKeyDown","keyUp","onKeyUp","insertVideo","insertingVideo","initialEnd","afterRender","dynamicModule","windowResize","onWindowResize","showVideoDialog","showDialog","closeVideoDialog","closeDialog","dropDownSelect","alignmentSelect","videoDelete","deleteVideo","videoToolbarAction","onToolbarAction","editAreaClick","editAreaClickHandler","iframeMouseDown","onIframeMouseDown","videoSize","insertCompleted","showVideoQuickToolbar","clearDialogObj","destroy","removeEventListener","off","contentModule","remove","getEditPanel","touchEndEvent","videoClick","formatter","editorManager","observer","checkUndo","undoStack","insertVideoSettings","resize","touchStartEvent","resizeStart","ownerDocument","onDocumentClick","onCutHandler","getDocument","touchMoveEvent","resizing","getRenderer","Content","add","dialogObj","event","length","i","args","src","tagName","querySelector","getAttribute","trigger","afterMediaDelete","subCommand","toLowerCase","getUndoRedoStack","temp","createElement","contentElem","text","appendChild","cloneNode","vid","querySelectorAll","j","style","outline","clonedElement","fragment","document","createDocumentFragment","firstChild","hide","returnValue","e","_this","selectNode","nodeName","isEmbedVidElem","vidSizeHeader","getConstant","linkUpdate","dialogContent","vidsizeInput","selectObj_1","selfVideo","selection","setProperties","height","width","header","content","buttons","click","insertSize","buttonModel","cssClass","isPrimary","maxHeight","focus","vidHeight","vidWidth","vidSizeWrap","className","widthVal","changedWidthValue","toString","parseInt","getClientRects","heightVal","changedHeightValue","widthNum","value","enableRtl","input","inputWidthValue","appendTo","heightNum","inputHeightValue","restore","proxy","saveData","dialogEle","parentElement","process","item","vidResizeDiv","vidResizePos","resizeEnd","resizeBtnInit","videoEle","cursor","isDevice","target","requestType","resizeStop","getPointX","iframeSettings","enable","window","pageYOffset","getBoundingClientRect","top","clientY","ele","readonly","prevSelectedVidEle","preventDefaultResize","videoElem","contains","videoResize","classList","getPointY","preventDefault","stopImmediatePropagation","quickToolObj","videoQTBar","hidePopup","resizeBtnStat","topLeft","topRight","botLeft","botRight","resizeStartArgs","cancel","cancelResizeAction","setAttribute","styles","resizeVidDupPos","touches","pos","calcPos","left","vidWid","vidHgt","borWid","slice","devWid","elem","ignoreOffset","parentOffset","elementOffset","doc","offsetParent","indexOf","getID","documentElement","body","position","parentNode","nodeType","offsetTop","offsetLeft","setAspectRatio","expectedX","expectedY","vidEleStyle","getComputedStyle","match","parseFloat","minWidth","minHeight","resizeByPercent","percentageValue","pixToPerc","previousElementSibling","Math","min","round","removeAttribute","currentWidth","inputElement","right","expected","parentEle","vidDupMouseMove","onResize","resizingArgs","getInsertVidMaxWidth","setContentHeight","offsetWidth","offsetHeight","mouseX","mouseY","vidDupPos","notify","selectionRestore","originalEvent","range","save","selectNodeEle","selectParentEle","isCursor","keyCodeValues","editorMode","nodeSelection","getRange","startContainer","endContainer","startOffset","endOffset","which","nodes","getNodeCollection","push","code","isCursor_1","checkVideoBack","checkVideoDel","getParentNodeCollection","ctrlKey","key","action","prev","childNodes","removeResizeEle","setSelectionText","textContent","CLS_VID_FOCUS","keyCode","event_1","selectParent","command","close","videoRemovePost","CLS_VIDEOWRAP","nextElementSibling","openDialog","handleSelectAll","videoFocusNodes","isInternal","name","previousSibling","nextSibling","alignVideo","inline","break","CLS_VID_CLICK_ELEM","absoluteUrl","removeUrl","URL","baseURI","href","removingVideoName","replace","xhr","XMLHttpRequest","readyState","status","triggerPost","response","open","responseType","send","file","File","ajax","formData","FormData","append","toolbarSettings","getToolbarElement","offsetX","clientWidth","offsetY","clientHeight","documentClickClosedBy","closedBy","isBlur","type","hideVideoQuickToolbar","showOnRightClick","quickToolbarSettings","Clear","setSelectionContents","quickToolbarModule","isPopupOpen","selectionSave","elements","detail","forEach","call","index","isNotify","setTimeout","showPopup","path","getElementById","videoDialog","videoInsert","videolinkCancel","videoHeader","selectObj","dialogModel","CLS_RTE_ELEMENTS","locale","showCloseIcon","closeOnEscape","isModal","insertVideoUrl","bind","disabled","cancelDialog","animationSettings","effect","uploadObj","removing","videoUpload","linkHeader","embedLinkHeader","linkHeaderText","embedLinkHeaderText","innerHTML","urlPopup","localeObj","render","inlineQTBar","textQTBar","videoUrl","urlContent","placeUrl","embedInputUrl","attrs","placeholder","tabindex","getButtons","inputUrl","spellcheck","regex","RegExp","sourceElement","embedUrlBtn","label","checked","created","change","webUrlBtn","iframe","getPanel","uploadParentEle","deviceVideoUpMsg","videoUpMsg","span","spanMsg","btnEle","autofocus","browserMsg","button","isStringTemplate","btnClick","fileSelect","uploadEle","fileName","selectArgs","filesData","asyncSettings","saveUrl","dropArea","multiple","allowedExtensions","allowedTypes","selected","fileSelected","checkExtension","reader_1","FileReader","url","saveFormat","result","createObjectURL","uploadUrl","readAsDataURL","rawFile","beforeUpload","beforeFileUpload","uploading","isServerRendered","fileUploading","success","fileUploadSuccess","maxWidth","getInsertImgMaxWidth","operation","failure","fileUploadFailed","fileRemoving","toLocaleLowerCase","getElementsByClassName","embedUrl","layoutOption","CLS_VIDEOINLINE","CLS_VIDEOBREAK","name_1","split","isEmbedUrl","undefined","getModuleName"],"sources":["/Users/saleem/Desktop/KClient/Web App/Ver_3.6/User Interface/website_Source files/node_modules/@syncfusion/ej2-richtexteditor/src/rich-text-editor/renderer/video-module.js"],"sourcesContent":["import { addClass, detach, EventHandler, isNullOrUndefined, Ajax, formatUnit } from '@syncfusion/ej2-base';\nimport { Browser, closest, removeClass, isNullOrUndefined as isNOU } from '@syncfusion/ej2-base';\nimport * as events from '../base/constant';\nimport * as classes from '../base/classes';\nimport { Uploader, TextBox } from '@syncfusion/ej2-inputs';\nimport { Button, RadioButton } from '@syncfusion/ej2-buttons';\nimport { RenderType } from '../base/enum';\nimport { dispatchEvent, parseHtml, hasClass, convertToBlob } from '../base/util';\nimport { isIDevice } from '../../common/util';\nvar Video = /** @class */ (function () {\n    function Video(parent, serviceLocator) {\n        this.isVideoUploaded = false;\n        this.isAllowedTypes = true;\n        this.pageX = null;\n        this.pageY = null;\n        this.deletedVid = [];\n        this.parent = parent;\n        this.rteID = parent.element.id;\n        this.i10n = serviceLocator.getService('rteLocale');\n        this.rendererFactory = serviceLocator.getService('rendererFactory');\n        this.dialogRenderObj = serviceLocator.getService('dialogRenderObject');\n        this.addEventListener();\n    }\n    Video.prototype.addEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.on(events.keyDown, this.onKeyDown, this);\n        this.parent.on(events.keyUp, this.onKeyUp, this);\n        this.parent.on(events.insertVideo, this.insertingVideo, this);\n        this.parent.on(events.initialEnd, this.afterRender, this);\n        this.parent.on(events.dynamicModule, this.afterRender, this);\n        this.parent.on(events.windowResize, this.onWindowResize, this);\n        this.parent.on(events.showVideoDialog, this.showDialog, this);\n        this.parent.on(events.closeVideoDialog, this.closeDialog, this);\n        this.parent.on(events.dropDownSelect, this.alignmentSelect, this);\n        this.parent.on(events.videoDelete, this.deleteVideo, this);\n        this.parent.on(events.videoToolbarAction, this.onToolbarAction, this);\n        this.parent.on(events.editAreaClick, this.editAreaClickHandler, this);\n        this.parent.on(events.iframeMouseDown, this.onIframeMouseDown, this);\n        this.parent.on(events.videoSize, this.videoSize, this);\n        this.parent.on(events.insertCompleted, this.showVideoQuickToolbar, this);\n        this.parent.on(events.clearDialogObj, this.clearDialogObj, this);\n        this.parent.on(events.destroy, this.removeEventListener, this);\n    };\n    Video.prototype.removeEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.off(events.keyDown, this.onKeyDown);\n        this.parent.off(events.keyUp, this.onKeyUp);\n        this.parent.off(events.insertVideo, this.insertingVideo);\n        this.parent.off(events.windowResize, this.onWindowResize);\n        this.parent.off(events.initialEnd, this.afterRender);\n        this.parent.off(events.dynamicModule, this.afterRender);\n        this.parent.off(events.showVideoDialog, this.showDialog);\n        this.parent.off(events.closeVideoDialog, this.closeDialog);\n        this.parent.off(events.dropDownSelect, this.alignmentSelect);\n        this.parent.off(events.videoDelete, this.deleteVideo);\n        this.parent.off(events.videoToolbarAction, this.onToolbarAction);\n        this.parent.off(events.editAreaClick, this.editAreaClickHandler);\n        this.parent.off(events.iframeMouseDown, this.onIframeMouseDown);\n        this.parent.off(events.videoSize, this.videoSize);\n        this.parent.off(events.insertCompleted, this.showVideoQuickToolbar);\n        this.parent.off(events.clearDialogObj, this.clearDialogObj);\n        this.parent.off(events.destroy, this.removeEventListener);\n        if (!isNullOrUndefined(this.contentModule)) {\n            EventHandler.remove(this.contentModule.getEditPanel(), Browser.touchEndEvent, this.videoClick);\n            this.parent.formatter.editorManager.observer.off(events.checkUndo, this.undoStack);\n            if (this.parent.insertVideoSettings.resize) {\n                EventHandler.remove(this.parent.contentModule.getEditPanel(), Browser.touchStartEvent, this.resizeStart);\n                EventHandler.remove(this.parent.element.ownerDocument, 'mousedown', this.onDocumentClick);\n                EventHandler.remove(this.contentModule.getEditPanel(), 'cut', this.onCutHandler);\n                EventHandler.remove(this.contentModule.getDocument(), Browser.touchMoveEvent, this.resizing);\n            }\n        }\n    };\n    Video.prototype.afterRender = function () {\n        this.contentModule = this.rendererFactory.getRenderer(RenderType.Content);\n        EventHandler.add(this.contentModule.getEditPanel(), Browser.touchEndEvent, this.videoClick, this);\n        if (this.parent.insertVideoSettings.resize) {\n            EventHandler.add(this.parent.contentModule.getEditPanel(), Browser.touchStartEvent, this.resizeStart, this);\n            EventHandler.add(this.parent.element.ownerDocument, 'mousedown', this.onDocumentClick, this);\n            EventHandler.add(this.contentModule.getEditPanel(), 'cut', this.onCutHandler, this);\n        }\n    };\n    Video.prototype.clearDialogObj = function () {\n        if (this.dialogObj) {\n            this.dialogObj.destroy();\n            detach(this.dialogObj.element);\n            this.dialogObj = null;\n        }\n    };\n    // eslint-disable-next-line\n    Video.prototype.onKeyUp = function (event) {\n        if (!isNOU(this.deletedVid) && this.deletedVid.length > 0) {\n            for (var i = 0; i < this.deletedVid.length; i++) {\n                var args = {\n                    element: this.deletedVid[i],\n                    src: this.deletedVid[i].tagName !== 'IFRAME' ? this.deletedVid[i].querySelector('source').getAttribute('src') :\n                        this.deletedVid[i].src\n                };\n                this.parent.trigger(events.afterMediaDelete, args);\n            }\n        }\n    };\n    Video.prototype.undoStack = function (args) {\n        if (args.subCommand.toLowerCase() === 'undo' || args.subCommand.toLowerCase() === 'redo') {\n            for (var i = 0; i < this.parent.formatter.getUndoRedoStack().length; i++) {\n                var temp = this.parent.createElement('div');\n                var contentElem = this.parent.formatter.getUndoRedoStack()[i].text;\n                temp.appendChild(contentElem.cloneNode(true));\n                var vid = temp.querySelectorAll('video');\n                if (temp.querySelector('.e-vid-resize') && vid.length > 0) {\n                    for (var j = 0; j < vid.length; j++) {\n                        vid[j].style.outline = '';\n                    }\n                    detach(temp.querySelector('.e-vid-resize'));\n                    var clonedElement = temp.cloneNode(true);\n                    var fragment = document.createDocumentFragment();\n                    while (clonedElement.firstChild) {\n                        fragment.appendChild(clonedElement.firstChild);\n                    }\n                    this.parent.formatter.getUndoRedoStack()[i].text = fragment;\n                }\n            }\n        }\n    };\n    Video.prototype.onIframeMouseDown = function () {\n        if (this.dialogObj) {\n            this.dialogObj.hide({ returnValue: true });\n        }\n    };\n    Video.prototype.videoSize = function (e) {\n        var _this = this;\n        if (e.selectNode[0].nodeName !== 'VIDEO' && !this.isEmbedVidElem(e.selectNode[0])) {\n            return;\n        }\n        this.insertVideo(e);\n        if (!isNullOrUndefined(this.dialogObj)) {\n            var vidSizeHeader = this.i10n.getConstant('videoSizeHeader');\n            var linkUpdate = this.i10n.getConstant('dialogUpdate');\n            var dialogContent = this.vidsizeInput(e);\n            var selectObj_1 = { args: e.args, selfVideo: this, selection: e.selection, selectNode: e.selectNode };\n            this.dialogObj.setProperties({\n                height: 'inherit', width: '290px', header: vidSizeHeader, content: dialogContent,\n                buttons: [{\n                        // eslint-disable-next-line\n                        click: function (e) {\n                            _this.insertSize(selectObj_1);\n                        },\n                        buttonModel: {\n                            content: linkUpdate, cssClass: 'e-flat e-update-size', isPrimary: true\n                        }\n                    }]\n            });\n            this.dialogObj.element.style.maxHeight = 'inherit';\n            this.dialogObj.content.querySelector('input').focus();\n        }\n    };\n    Video.prototype.vidsizeInput = function (e) {\n        var _this = this;\n        var selectNode = e.selectNode[0];\n        var vidHeight = this.i10n.getConstant('videoHeight');\n        var vidWidth = this.i10n.getConstant('videoWidth');\n        var vidSizeWrap = this.parent.createElement('div', { className: 'e-video-sizewrap' });\n        var widthVal = isNullOrUndefined(this.changedWidthValue) && (selectNode.style.width.toString() === 'auto' ||\n            selectNode.style.width !== '') ? selectNode.style.width : !isNullOrUndefined(this.changedWidthValue) ?\n            this.changedWidthValue : (parseInt(selectNode.getClientRects()[0].width.toString(), 10)).toString();\n        var heightVal = isNullOrUndefined(this.changedHeightValue) && (selectNode.style.height.toString() === 'auto' ||\n            selectNode.style.height !== '') ? selectNode.style.height : !isNullOrUndefined(this.changedHeightValue) ?\n            this.changedHeightValue : (parseInt(selectNode.getClientRects()[0].height.toString(), 10)).toString();\n        this.changedWidthValue = null;\n        this.changedHeightValue = null;\n        var content = '<div class=\"e-rte-label\"><label>' + vidWidth +\n            '</label></div><div class=\"e-rte-field\"><input type=\"text\" id=\"vidwidth\" class=\"e-vid-width\" value=' +\n            widthVal\n            + ' /></div>' +\n            '<div class=\"e-rte-label\">' + '<label>' + vidHeight + '</label></div><div class=\"e-rte-field\"> ' +\n            '<input type=\"text\" id=\"vidheight\" class=\"e-vid-height\" value=' +\n            heightVal\n            + ' /></div>';\n        var contentElem = parseHtml(content);\n        vidSizeWrap.appendChild(contentElem);\n        var widthNum = new TextBox({\n            value: formatUnit(widthVal),\n            enableRtl: this.parent.enableRtl,\n            input: function (e) {\n                _this.inputWidthValue = formatUnit((e.value));\n            }\n        });\n        widthNum.createElement = this.parent.createElement;\n        widthNum.appendTo(vidSizeWrap.querySelector('#vidwidth'));\n        var heightNum = new TextBox({\n            value: formatUnit(heightVal),\n            enableRtl: this.parent.enableRtl,\n            input: function (e) {\n                _this.inputHeightValue = formatUnit((e.value));\n            }\n        });\n        heightNum.createElement = this.parent.createElement;\n        heightNum.appendTo(vidSizeWrap.querySelector('#vidheight'));\n        return vidSizeWrap;\n    };\n    Video.prototype.insertSize = function (e) {\n        e.selection.restore();\n        var proxy = e.selfVideo;\n        if (proxy.parent.formatter.getUndoRedoStack().length === 0) {\n            proxy.parent.formatter.saveData();\n        }\n        var dialogEle = proxy.dialogObj.element;\n        this.changedWidthValue = this.inputWidthValue;\n        this.changedHeightValue = this.inputHeightValue;\n        var width = dialogEle.querySelector('.e-vid-width').value;\n        var height = dialogEle.parentElement.querySelector('.e-vid-height').value;\n        proxy.parent.formatter.process(this.parent, e.args, e.args, {\n            width: width, height: height, selectNode: e.selectNode,\n            subCommand: e.args.item.subCommand\n        });\n        if (this.vidResizeDiv) {\n            e.selectNode[0] = (e.selectNode[0].tagName === 'VIDEO' || e.selectNode[0].tagName === 'IFRAME') ?\n                e.selectNode[0] : e.selectNode[0].querySelector('iframe');\n            proxy.vidResizePos(e.selectNode[0], this.vidResizeDiv);\n        }\n        proxy.dialogObj.hide({ returnValue: true });\n    };\n    Video.prototype.resizeEnd = function (e) {\n        this.resizeBtnInit();\n        this.videoEle.parentElement.style.cursor = 'auto';\n        if (Browser.isDevice) {\n            removeClass([e.target.parentElement], 'e-mob-span');\n        }\n        var args = { event: e, requestType: 'videos' };\n        this.parent.trigger(events.resizeStop, args);\n        /* eslint-disable */\n        var pageX = this.getPointX(e);\n        var pageY = (this.parent.iframeSettings.enable) ? window.pageYOffset +\n            this.parent.element.getBoundingClientRect().top + e.clientY : e.pageY;\n        /* eslint-enable */\n        this.parent.formatter.editorManager.observer.on(events.checkUndo, this.undoStack, this);\n        this.parent.formatter.saveData();\n    };\n    Video.prototype.resizeStart = function (e, ele) {\n        var _this = this;\n        if (this.parent.readonly) {\n            return;\n        }\n        var target = ele ? ele : !this.isEmbedVidElem(e.target) ? e.target : e.target.querySelector('iframe');\n        this.prevSelectedVidEle = this.videoEle;\n        if (target.tagName === 'VIDEO' || target.tagName === 'IFRAME') {\n            this.parent.preventDefaultResize(e);\n            var videoElem = target;\n            if (this.vidResizeDiv && this.contentModule.getEditPanel().contains(this.vidResizeDiv)) {\n                detach(this.vidResizeDiv);\n            }\n            this.videoResize(videoElem);\n        }\n        if (target.classList.contains('e-rte-videoboxmark')) {\n            if (this.parent.formatter.getUndoRedoStack().length === 0) {\n                this.parent.formatter.saveData();\n            }\n            this.pageX = this.getPointX(e);\n            this.pageY = this.getPointY(e);\n            e.preventDefault();\n            e.stopImmediatePropagation();\n            this.resizeBtnInit();\n            if (this.quickToolObj) {\n                this.quickToolObj.videoQTBar.hidePopup();\n            }\n            if (target.classList.contains('e-rte-topLeft')) {\n                this.resizeBtnStat.topLeft = true;\n            }\n            if (target.classList.contains('e-rte-topRight')) {\n                this.resizeBtnStat.topRight = true;\n            }\n            if (target.classList.contains('e-rte-botLeft')) {\n                this.resizeBtnStat.botLeft = true;\n            }\n            if (target.classList.contains('e-rte-botRight')) {\n                this.resizeBtnStat.botRight = true;\n            }\n            if (Browser.isDevice && this.contentModule.getEditPanel().contains(this.vidResizeDiv) &&\n                !this.vidResizeDiv.classList.contains('e-mob-span')) {\n                addClass([this.vidResizeDiv], 'e-mob-span');\n            }\n            else {\n                var args = { event: e, requestType: 'videos' };\n                this.parent.trigger(events.resizeStart, args, function (resizeStartArgs) {\n                    if (resizeStartArgs.cancel) {\n                        _this.cancelResizeAction();\n                    }\n                });\n            }\n            EventHandler.add(this.contentModule.getDocument(), Browser.touchEndEvent, this.resizeEnd, this);\n        }\n    };\n    Video.prototype.videoClick = function (e) {\n        if (Browser.isDevice) {\n            if ((e.target.tagName === 'VIDEO' || this.isEmbedVidElem(e.target))) {\n                this.contentModule.getEditPanel().setAttribute('contenteditable', 'false');\n                e.target.focus();\n            }\n            else {\n                if (!this.parent.readonly) {\n                    this.contentModule.getEditPanel().setAttribute('contenteditable', 'true');\n                }\n            }\n        }\n        if (e.target.tagName === 'VIDEO' || this.isEmbedVidElem(e.target)) {\n            e.preventDefault();\n        }\n    };\n    Video.prototype.onCutHandler = function () {\n        if (this.vidResizeDiv && this.contentModule.getEditPanel().contains(this.vidResizeDiv)) {\n            this.cancelResizeAction();\n        }\n    };\n    Video.prototype.videoResize = function (e) {\n        this.resizeBtnInit();\n        this.videoEle = e;\n        addClass([this.videoEle], 'e-resize');\n        this.vidResizeDiv = this.parent.createElement('span', { className: 'e-vid-resize', id: this.rteID + '_vidResize' });\n        this.vidResizeDiv.appendChild(this.parent.createElement('span', {\n            className: 'e-rte-videoboxmark e-rte-topLeft', styles: 'cursor: nwse-resize'\n        }));\n        this.vidResizeDiv.appendChild(this.parent.createElement('span', {\n            className: 'e-rte-videoboxmark e-rte-topRight', styles: 'cursor: nesw-resize'\n        }));\n        this.vidResizeDiv.appendChild(this.parent.createElement('span', {\n            className: 'e-rte-videoboxmark e-rte-botLeft', styles: 'cursor: nesw-resize'\n        }));\n        this.vidResizeDiv.appendChild(this.parent.createElement('span', {\n            className: 'e-rte-videoboxmark e-rte-botRight', styles: 'cursor: nwse-resize'\n        }));\n        if (Browser.isDevice) {\n            addClass([this.vidResizeDiv], 'e-mob-rte');\n        }\n        e.style.outline = '2px solid #4a90e2';\n        this.vidResizePos(e, this.vidResizeDiv);\n        this.resizeVidDupPos(e);\n        this.contentModule.getEditPanel().appendChild(this.vidResizeDiv);\n        EventHandler.add(this.contentModule.getDocument(), Browser.touchMoveEvent, this.resizing, this);\n    };\n    Video.prototype.getPointX = function (e) {\n        if (e.touches && e.touches.length) {\n            return e.touches[0].pageX;\n        }\n        else {\n            return e.pageX;\n        }\n    };\n    Video.prototype.getPointY = function (e) {\n        if (e.touches && e.touches.length) {\n            return e.touches[0].pageY;\n        }\n        else {\n            return e.pageY;\n        }\n    };\n    Video.prototype.vidResizePos = function (e, vidResizeDiv) {\n        if (isNullOrUndefined(vidResizeDiv)) {\n            return;\n        }\n        var pos = this.calcPos(e);\n        var top = pos.top;\n        var left = pos.left;\n        var vidWid = e.width !== 0 && e.width !== 'auto' && e.width !== 'NaN' ? e.width : e.getBoundingClientRect().width;\n        var vidHgt = e.height !== 0 && e.height !== 'auto' && e.height !== 'NaN' ? e.height : e.getBoundingClientRect().height;\n        var borWid = (Browser.isDevice) ? (4 * parseInt((e.style.outline.slice(-3)), 10)) + 2 :\n            (2 * parseInt((e.style.outline.slice(-3)), 10)) + 2; //span border width + video outline width\n        var devWid = ((Browser.isDevice) ? 0 : 2); // span border width\n        vidResizeDiv.querySelector('.e-rte-botLeft').style.left = (left - borWid) + 'px';\n        vidResizeDiv.querySelector('.e-rte-botLeft').style.top = ((parseInt(vidHgt.toString(), 10) - borWid) + top) + 'px';\n        vidResizeDiv.querySelector('.e-rte-botRight').style.left = ((parseInt(vidWid.toString(), 10) - (borWid - devWid)) + left) + 'px';\n        vidResizeDiv.querySelector('.e-rte-botRight').style.top = ((parseInt(vidHgt.toString(), 10) - borWid) + top) + 'px';\n        vidResizeDiv.querySelector('.e-rte-topRight').style.left = ((parseInt(vidWid.toString(), 10) - (borWid - devWid)) + left) + 'px';\n        vidResizeDiv.querySelector('.e-rte-topRight').style.top = (top - (borWid)) + 'px';\n        vidResizeDiv.querySelector('.e-rte-topLeft').style.left = (left - borWid) + 'px';\n        vidResizeDiv.querySelector('.e-rte-topLeft').style.top = (top - borWid) + 'px';\n    };\n    Video.prototype.calcPos = function (elem) {\n        var ignoreOffset = ['TD', 'TH', 'TABLE', 'A'];\n        var parentOffset = { top: 0, left: 0 };\n        var elementOffset;\n        var doc = elem.ownerDocument;\n        var offsetParent = ((elem.offsetParent && (elem.offsetParent.classList.contains('e-video-clickelem') ||\n            ignoreOffset.indexOf(elem.offsetParent.tagName) > -1)) ? closest(elem, '#' + this.parent.getID() + '_rte-edit-view') : elem.offsetParent) || doc.documentElement;\n        while (offsetParent &&\n            (offsetParent === doc.body || offsetParent === doc.documentElement) &&\n            offsetParent.style.position === 'static') {\n            offsetParent = offsetParent.parentNode;\n        }\n        if (offsetParent && offsetParent !== elem && offsetParent.nodeType === 1) {\n            parentOffset = offsetParent.getBoundingClientRect();\n        }\n        if (elem && elem.nodeType === 1 && elem.tagName === 'IFRAME') {\n            elementOffset = elem.getBoundingClientRect();\n            return {\n                top: elementOffset.top - parentOffset.top,\n                left: elementOffset.left - parentOffset.left\n            };\n        }\n        else {\n            return {\n                top: elem.offsetTop,\n                left: elem.offsetLeft\n            };\n        }\n    };\n    Video.prototype.setAspectRatio = function (vid, expectedX, expectedY, e) {\n        var vidEleStyle = getComputedStyle(vid);\n        if (isNullOrUndefined(vidEleStyle)) {\n            return;\n        }\n        // eslint-disable-next-line\n        var width = vidEleStyle.width !== '' ? vidEleStyle.width.match(/^\\d+(\\.\\d*)?%$/g) ? parseFloat(vidEleStyle.width) :\n            parseInt(vidEleStyle.width, 10) : vid.style.width !== '' ? vid.style.width : vid.width;\n        var height = vidEleStyle.height !== '' ? parseInt(vidEleStyle.height, 10) : vid.style.height !== '' ? vid.style.height : vid.height;\n        if (width > height) {\n            vid.style.minWidth = this.parent.insertVideoSettings.minWidth === 0 ? '200px' : formatUnit(this.parent.insertVideoSettings.minWidth);\n            vid.style.minHeight = this.parent.insertVideoSettings.minHeight === 0 ? '90px' : formatUnit(this.parent.insertVideoSettings.minHeight);\n            if (this.parent.insertVideoSettings.resizeByPercent) {\n                if (parseInt('' + vid.getBoundingClientRect().width + '', 10) !== 0 && parseInt('' + width + '', 10) !== 0) {\n                    var percentageValue = this.pixToPerc((parseInt(width.toString(), 10) / parseInt(height.toString(), 10) * expectedY), (vid.previousElementSibling || vid.parentElement));\n                    vid.style.width = Math.min(Math.round((percentageValue / vid.getBoundingClientRect().width) * expectedX * 100) / 100, 100) + '%';\n                }\n                else {\n                    vid.style.width = this.pixToPerc(parseInt(width.toString(), 10) / parseInt(height.toString(), 10) * expectedY, (vid.previousElementSibling || vid.parentElement)) + '%';\n                }\n                vid.style.height = null;\n                vid.removeAttribute('height');\n            }\n            else if ((vid.style.width === '' && vid.style.height !== '') || (vidEleStyle.width === '' && vidEleStyle.height !== '')) {\n                vid.style.height = expectedY + 'px';\n            }\n            else if ((vid.style.width !== '' && vid.style.height === '') || (vidEleStyle.width !== '' && vidEleStyle.height === '')) {\n                var currentWidth = ((parseInt(width.toString(), 10) / parseInt(height.toString(), 10) * expectedY) +\n                    parseInt(width.toString(), 10) / parseInt(height.toString(), 10)) <\n                    (this.parent.inputElement.getBoundingClientRect().right - 32) ?\n                    ((parseInt(width.toString(), 10) / parseInt(height.toString(), 10) * expectedY) +\n                        parseInt(width.toString(), 10) / parseInt(height.toString(), 10)) :\n                    (this.parent.inputElement.getBoundingClientRect().right - 32);\n                vid.style.width = currentWidth.toString() + 'px';\n            }\n            else if (vid.style.width !== '' || vidEleStyle.width !== '') {\n                var currentWidth = (parseInt(width.toString(), 10) / parseInt(height.toString(), 10) * expectedY) <\n                    (this.parent.inputElement.getBoundingClientRect().right - 32) ?\n                    (parseInt(width.toString(), 10) / parseInt(height.toString(), 10) * expectedY) :\n                    (this.parent.inputElement.getBoundingClientRect().right - 32);\n                vid.style.width = currentWidth + 'px';\n                vid.style.height = expectedY + 'px';\n            }\n            else {\n                vid.setAttribute('width', (parseInt(((parseInt(width.toString(), 10) / parseInt(height.toString(), 10) * expectedY) + parseInt(width.toString(), 10) / parseInt(height.toString(), 10)).toString(), 10)).toString());\n            }\n        }\n        else if (height > width) {\n            if (this.parent.insertVideoSettings.resizeByPercent) {\n                if (parseInt('' + vid.getBoundingClientRect().width + '', 10) !== 0 && parseInt('' + width + '', 10) !== 0) {\n                    vid.style.width = Math.min(Math.round((parseInt(width.toString(), 10) / vid.getBoundingClientRect().width) * expectedX * 100) / 100, 100) + '%';\n                }\n                else {\n                    vid.style.width = this.pixToPerc((expectedX / parseInt(height.toString(), 10) * expectedY), (vid.previousElementSibling || vid.parentElement)) + '%';\n                }\n                vid.style.height = null;\n                vid.removeAttribute('height');\n            }\n            else if (vid.style.width !== '' || vidEleStyle.width !== '') {\n                vid.style.width = expectedX + 'px';\n                vid.style.height = (parseInt(height.toString(), 10) / parseInt(width.toString(), 10) * expectedX) + 'px';\n            }\n            else {\n                vid.setAttribute('width', this.resizeBtnStat.botRight ? (this.getPointX(e.event) - vid.getBoundingClientRect().left).toString() : expectedX.toString());\n            }\n        }\n        else {\n            if (this.parent.insertVideoSettings.resizeByPercent) {\n                vid.style.width = this.pixToPerc(expectedX, (vid.previousElementSibling || vid.parentElement)) + '%';\n                vid.style.height = null;\n                vid.removeAttribute('height');\n            }\n            else {\n                vid.style.width = expectedX + 'px';\n                vid.style.height = expectedX + 'px';\n            }\n        }\n    };\n    Video.prototype.pixToPerc = function (expected, parentEle) {\n        return expected / parseFloat(getComputedStyle(parentEle).width) * 100;\n    };\n    Video.prototype.vidDupMouseMove = function (width, height, e) {\n        var _this = this;\n        var args = { event: e, requestType: 'videos' };\n        this.parent.trigger(events.onResize, args, function (resizingArgs) {\n            if (resizingArgs.cancel) {\n                _this.cancelResizeAction();\n            }\n            else {\n                if ((parseInt(_this.parent.insertVideoSettings.minWidth, 10) >= parseInt(width, 10) ||\n                    (parseInt(_this.parent.getInsertVidMaxWidth(), 10) <= parseInt(width, 10) &&\n                        isNOU(_this.videoEle.style.width)))) {\n                    return;\n                }\n                if (!_this.parent.insertVideoSettings.resizeByPercent &&\n                    (parseInt(_this.parent.insertVideoSettings.minHeight, 10) >= parseInt(height, 10) ||\n                        parseInt(_this.parent.insertVideoSettings.maxHeight, 10) <= parseInt(height, 10))) {\n                    return;\n                }\n                _this.videoEle.parentElement.style.cursor = 'pointer';\n                _this.setAspectRatio(_this.videoEle, parseInt(width, 10), parseInt(height, 10), args);\n                _this.resizeVidDupPos(_this.videoEle);\n                _this.vidResizePos(_this.videoEle, _this.vidResizeDiv);\n                _this.parent.setContentHeight('', false);\n            }\n        });\n    };\n    Video.prototype.resizing = function (e) {\n        if (this.videoEle.offsetWidth >= this.parent.getInsertVidMaxWidth()) {\n            this.videoEle.style.maxHeight = this.videoEle.offsetHeight + 'px';\n        }\n        var pageX = this.getPointX(e);\n        var pageY = this.getPointY(e);\n        var mouseX = (this.resizeBtnStat.botLeft || this.resizeBtnStat.topLeft) ? -(pageX - this.pageX) : (pageX - this.pageX);\n        var mouseY = (this.resizeBtnStat.topLeft || this.resizeBtnStat.topRight) ? -(pageY - this.pageY) : (pageY - this.pageY);\n        var width = parseInt(this.vidDupPos.width, 10) + mouseX;\n        var height = parseInt(this.vidDupPos.height, 10) + mouseY;\n        this.pageX = pageX;\n        this.pageY = pageY;\n        if (this.resizeBtnStat.botRight) {\n            this.vidDupMouseMove(width + 'px', height + 'px', e);\n        }\n        else if (this.resizeBtnStat.botLeft) {\n            this.vidDupMouseMove(width + 'px', height + 'px', e);\n        }\n        else if (this.resizeBtnStat.topRight) {\n            this.vidDupMouseMove(width + 'px', height + 'px', e);\n        }\n        else if (this.resizeBtnStat.topLeft) {\n            this.vidDupMouseMove(width + 'px', height + 'px', e);\n        }\n    };\n    Video.prototype.cancelResizeAction = function () {\n        EventHandler.remove(this.contentModule.getDocument(), Browser.touchMoveEvent, this.resizing);\n        EventHandler.remove(this.contentModule.getDocument(), Browser.touchEndEvent, this.resizeEnd);\n        if (this.videoEle && this.vidResizeDiv && this.contentModule.getEditPanel().contains(this.vidResizeDiv)) {\n            detach(this.vidResizeDiv);\n            this.videoEle.style.outline = '';\n            this.vidResizeDiv = null;\n            this.pageX = null;\n            this.pageY = null;\n        }\n    };\n    Video.prototype.resizeVidDupPos = function (e) {\n        this.vidDupPos = {\n            width: (e.style.width !== '' && (this.parent.insertVideoSettings &&\n                !this.parent.insertVideoSettings.resizeByPercent)) ? this.videoEle.style.width : e.width !== 'auto' && e.width !== 0 && e.width !== 'NaN' ? e.width + 'px' : parseInt(getComputedStyle(e).width, 10) + 'px',\n            height: (e.style.height !== '') ? this.videoEle.style.height : e.height !== 'auto' && e.height !== 0 && e.height !== 'NaN' ? e.height + 'px' : parseInt(getComputedStyle(e).height, 10) + 'px'\n        };\n    };\n    Video.prototype.resizeBtnInit = function () {\n        return this.resizeBtnStat = { botLeft: false, botRight: false, topRight: false, topLeft: false };\n    };\n    Video.prototype.onToolbarAction = function (args) {\n        if (isIDevice()) {\n            this.parent.notify(events.selectionRestore, {});\n        }\n        var item = args.args.item;\n        switch (item.subCommand) {\n            case 'VideoReplace':\n                this.parent.notify(events.insertVideo, args);\n                break;\n            case 'VideoRemove':\n                this.parent.notify(events.videoDelete, args);\n                break;\n            case 'VideoDimension':\n                this.parent.notify(events.videoSize, args);\n        }\n    };\n    Video.prototype.onKeyDown = function (event) {\n        var originalEvent = event.args;\n        var range;\n        var save;\n        var selectNodeEle;\n        var selectParentEle;\n        this.deletedVid = [];\n        var isCursor;\n        var keyCodeValues = [27, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123,\n            44, 45, 9, 16, 17, 18, 19, 20, 33, 34, 35, 36, 37, 38, 39, 40, 91, 92, 93, 144, 145, 182, 183];\n        if (this.parent.editorMode === 'HTML') {\n            range = this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());\n            isCursor = range.startContainer === range.endContainer && range.startOffset === range.endOffset;\n        }\n        if (!isCursor && this.parent.editorMode === 'HTML' && keyCodeValues.indexOf(originalEvent.which) < 0) {\n            var nodes = this.parent.formatter.editorManager.nodeSelection.getNodeCollection(range);\n            for (var i = 0; i < nodes.length; i++) {\n                if (nodes[i].nodeName === 'VIDEO' || nodes[i].nodeName === 'IFRAME') {\n                    this.deletedVid.push(nodes[i]);\n                }\n            }\n        }\n        if (this.parent.editorMode === 'HTML' && ((originalEvent.which === 8 && originalEvent.code === 'Backspace') ||\n            (originalEvent.which === 46 && originalEvent.code === 'Delete'))) {\n            var isCursor_1 = range.startContainer === range.endContainer && range.startOffset === range.endOffset;\n            if ((originalEvent.which === 8 && originalEvent.code === 'Backspace' && isCursor_1)) {\n                this.checkVideoBack(range);\n            }\n            else if ((originalEvent.which === 46 && originalEvent.code === 'Delete' && isCursor_1)) {\n                this.checkVideoDel(range);\n            }\n        }\n        if (!isNullOrUndefined(this.parent.formatter.editorManager.nodeSelection) &&\n            originalEvent.code !== 'KeyK') {\n            range = this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());\n            selectNodeEle = this.parent.formatter.editorManager.nodeSelection.getNodeCollection(range);\n            selectParentEle = this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(range);\n            if (!originalEvent.ctrlKey && originalEvent.key && (originalEvent.key.length === 1 || originalEvent.action === 'enter') &&\n                ((!isNOU(selectParentEle[0]) && selectParentEle[0].tagName === 'VIDEO' || this.isEmbedVidElem(selectParentEle[0]))) &&\n                selectParentEle[0].parentElement) {\n                var prev = selectParentEle[0].parentElement.childNodes[0];\n                if (this.contentModule.getEditPanel().querySelector('.e-vid-resize')) {\n                    this.removeResizeEle();\n                }\n                this.parent.formatter.editorManager.nodeSelection.setSelectionText(this.contentModule.getDocument(), prev, prev, prev.textContent.length, prev.textContent.length);\n                removeClass([selectParentEle[0]], classes.CLS_VID_FOCUS);\n                this.quickToolObj.videoQTBar.hidePopup();\n            }\n        }\n        if (originalEvent.ctrlKey && (originalEvent.keyCode === 89 || originalEvent.keyCode === 90)) {\n            this.undoStack({ subCommand: (originalEvent.keyCode === 90 ? 'undo' : 'redo') });\n        }\n        if (originalEvent.keyCode === 8 || originalEvent.keyCode === 46) {\n            if (selectNodeEle && (selectNodeEle[0].nodeName === 'VIDEO' || this.isEmbedVidElem(selectNodeEle[0])) && selectNodeEle.length < 1) {\n                if (!isNullOrUndefined(this.parent.formatter.editorManager.nodeSelection)) {\n                    save = this.parent.formatter.editorManager.nodeSelection.save(range, this.parent.contentModule.getDocument());\n                }\n                originalEvent.preventDefault();\n                var event_1 = {\n                    selectNode: selectNodeEle, selection: save, selectParent: selectParentEle,\n                    args: {\n                        item: { command: 'Videos', subCommand: 'VideoRemove' },\n                        originalEvent: originalEvent\n                    }\n                };\n                this.deleteVideo(event_1, originalEvent.keyCode);\n            }\n            if (this.parent.contentModule.getEditPanel().querySelector('.e-vid-resize')) {\n                this.removeResizeEle();\n            }\n        }\n        if (originalEvent.code === 'Backspace') {\n            originalEvent.action = 'backspace';\n        }\n        switch (originalEvent.action) {\n            case 'escape':\n                if (!isNullOrUndefined(this.dialogObj)) {\n                    this.dialogObj.close();\n                }\n                break;\n            case 'backspace':\n            case 'delete':\n                for (var i = 0; i < this.deletedVid.length; i++) {\n                    var src = this.deletedVid[i].src;\n                    this.videoRemovePost(src);\n                }\n                if (this.parent.editorMode !== 'Markdown') {\n                    if (range.startContainer.nodeType === 3) {\n                        if (originalEvent.code === 'Backspace') {\n                            if (range.startContainer.previousElementSibling && range.startOffset === 0 &&\n                                range.startContainer.previousElementSibling.classList.contains(classes.CLS_VIDEOWRAP)) {\n                                detach(range.startContainer.previousElementSibling);\n                            }\n                        }\n                        else {\n                            if (range.startContainer.nextElementSibling &&\n                                range.endContainer.textContent.length === range.endOffset &&\n                                range.startContainer.nextElementSibling.classList.contains(classes.CLS_VIDEOWRAP)) {\n                                detach(range.startContainer.nextElementSibling);\n                            }\n                        }\n                    }\n                    else if (range.startContainer.nodeType === 1 && (range.startContainer.classList &&\n                        range.startContainer.classList.contains(classes.CLS_VIDEOWRAP))) {\n                        detach(range.startContainer);\n                    }\n                }\n                break;\n            case 'insert-video':\n                if (!isNullOrUndefined(this.parent.formatter.editorManager.nodeSelection)) {\n                    save = this.parent.formatter.editorManager.nodeSelection.save(range, this.parent.contentModule.getDocument());\n                }\n                this.openDialog(true, originalEvent, save, selectNodeEle, selectParentEle);\n                originalEvent.preventDefault();\n                break;\n        }\n        if (originalEvent.ctrlKey && originalEvent.key === 'a') {\n            this.handleSelectAll();\n        }\n    };\n    Video.prototype.handleSelectAll = function () {\n        this.cancelResizeAction();\n        var videoFocusNodes = this.parent.inputElement.querySelectorAll('.' + classes.CLS_VID_FOCUS);\n        removeClass(videoFocusNodes, classes.CLS_VID_FOCUS);\n    };\n    Video.prototype.openDialog = function (isInternal, event, selection, ele, parentEle) {\n        var range;\n        var save;\n        var selectNodeEle;\n        var selectParentEle;\n        if (!isInternal && !isNOU(this.parent.formatter.editorManager.nodeSelection)) {\n            range = this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());\n            save = this.parent.formatter.editorManager.nodeSelection.save(range, this.parent.contentModule.getDocument());\n            selectNodeEle = this.parent.formatter.editorManager.nodeSelection.getNodeCollection(range);\n            selectParentEle = this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(range);\n        }\n        else {\n            save = selection;\n            selectNodeEle = ele;\n            selectParentEle = parentEle;\n        }\n        if (this.parent.editorMode === 'HTML') {\n            this.insertVideo({\n                args: {\n                    item: { command: 'Videos', subCommand: 'Video' },\n                    originalEvent: event,\n                    name: !isInternal ? 'showDialog' : null\n                },\n                selectNode: selectNodeEle,\n                selection: save,\n                selectParent: selectParentEle\n            });\n        }\n    };\n    Video.prototype.showDialog = function () {\n        this.openDialog(false);\n    };\n    Video.prototype.closeDialog = function () {\n        if (this.dialogObj) {\n            this.dialogObj.hide({ returnValue: true });\n        }\n    };\n    Video.prototype.checkVideoBack = function (range) {\n        if (range.startContainer.nodeName === '#text' && range.startOffset === 0 &&\n            !isNOU(range.startContainer.previousSibling) && (range.startContainer.previousSibling.nodeName === 'VIDEO' ||\n            this.isEmbedVidElem(range.startContainer.previousSibling))) {\n            this.deletedVid.push(range.startContainer.previousSibling);\n        }\n        else if (range.startContainer.nodeName !== '#text' && !isNOU(range.startContainer.childNodes[range.startOffset - 1]) &&\n            (range.startContainer.childNodes[range.startOffset - 1].nodeName === 'VIDEO' ||\n                this.isEmbedVidElem(range.startContainer.childNodes[range.startOffset - 1]))) {\n            this.deletedVid.push(range.startContainer.childNodes[range.startOffset - 1]);\n        }\n    };\n    Video.prototype.checkVideoDel = function (range) {\n        if (range.startContainer.nodeName === '#text' && range.startOffset === range.startContainer.textContent.length &&\n            !isNOU(range.startContainer.nextSibling) && (range.startContainer.nextSibling.nodeName === 'VIDEO' ||\n            this.isEmbedVidElem(range.startContainer.nextSibling))) {\n            this.deletedVid.push(range.startContainer.nextSibling);\n        }\n        else if (range.startContainer.nodeName !== '#text' && !isNOU(range.startContainer.childNodes[range.startOffset]) &&\n            (range.startContainer.childNodes[range.startOffset].nodeName === 'VIDEO' ||\n                this.isEmbedVidElem(range.startContainer.childNodes[range.startOffset]))) {\n            this.deletedVid.push(range.startContainer.childNodes[range.startOffset]);\n        }\n    };\n    Video.prototype.alignmentSelect = function (e) {\n        var item = e.item;\n        if (!document.body.contains(document.body.querySelector('.e-rte-quick-toolbar')) || item.command !== 'Videos') {\n            return;\n        }\n        var range = this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());\n        var selectNodeEle = this.parent.formatter.editorManager.nodeSelection.getNodeCollection(range);\n        selectNodeEle = (selectNodeEle[0].nodeName === 'VIDEO') ? selectNodeEle : [this.videoEle];\n        var args = { args: e, selectNode: selectNodeEle };\n        if (this.parent.formatter.getUndoRedoStack().length === 0) {\n            this.parent.formatter.saveData();\n        }\n        switch (item.subCommand) {\n            case 'JustifyLeft':\n            case 'JustifyCenter':\n            case 'JustifyRight':\n                this.alignVideo(args, item.subCommand);\n                break;\n            case 'Inline':\n                this.inline(args);\n                break;\n            case 'Break':\n                this.break(args);\n                break;\n        }\n        if (this.quickToolObj && document.body.contains(this.quickToolObj.videoQTBar.element)) {\n            this.quickToolObj.videoQTBar.hidePopup();\n            removeClass([selectNodeEle[0]], classes.CLS_VID_FOCUS);\n        }\n        this.cancelResizeAction();\n    };\n    Video.prototype.deleteVideo = function (e, keyCode) {\n        if (e.selectNode[0].nodeName !== 'VIDEO' && !this.isEmbedVidElem(e.selectNode[0])) {\n            return;\n        }\n        if (this.isEmbedVidElem(e.selectNode[0])) {\n            e.selectNode[0] = e.selectNode[0].classList.contains(classes.CLS_VID_CLICK_ELEM) ? e.selectNode[0] :\n                e.selectNode[0].parentElement;\n        }\n        var args = {\n            element: !this.isEmbedVidElem(e.selectNode[0]) ? e.selectNode[0].querySelector('iframe') :\n                e.selectNode[0],\n            src: !this.isEmbedVidElem(e.selectNode[0]) ? e.selectNode[0].querySelector('source').getAttribute('src') :\n                e.selectNode[0].querySelector('iframe').getAttribute('src')\n        };\n        if (this.parent.formatter.getUndoRedoStack().length === 0) {\n            this.parent.formatter.saveData();\n        }\n        e.selection.restore();\n        this.parent.formatter.process(this.parent, e.args, e.args, {\n            selectNode: e.selectNode,\n            subCommand: e.args.item.subCommand\n        });\n        this.videoRemovePost(args.src);\n        if (this.quickToolObj && document.body.contains(this.quickToolObj.videoQTBar.element)) {\n            this.quickToolObj.videoQTBar.hidePopup();\n        }\n        this.cancelResizeAction();\n        if (isNullOrUndefined(keyCode)) {\n            this.parent.trigger(events.afterMediaDelete, args);\n        }\n    };\n    Video.prototype.videoRemovePost = function (src) {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        var absoluteUrl = '';\n        if (isNOU(this.parent.insertVideoSettings.removeUrl) || this.parent.insertVideoSettings.removeUrl === '') {\n            return;\n        }\n        if (src.indexOf('http://') > -1 || src.indexOf('https://') > -1) {\n            absoluteUrl = src;\n        }\n        else {\n            absoluteUrl = new URL(src, document.baseURI).href;\n        }\n        // eslint-disable-next-line no-useless-escape\n        this.removingVideoName = absoluteUrl.replace(/^.*[\\\\\\/]/, '');\n        var xhr = new XMLHttpRequest();\n        // eslint-disable-next-line @typescript-eslint/tslint/config\n        xhr.addEventListener('readystatechange', function () {\n            if (this.readyState === 4 && this.status === 200) {\n                proxy.triggerPost(this.response);\n            }\n        });\n        xhr.open('GET', absoluteUrl);\n        xhr.responseType = 'blob';\n        xhr.send();\n    };\n    Video.prototype.triggerPost = function (response) {\n        var removeUrl = this.parent.insertVideoSettings.removeUrl;\n        if (isNOU(removeUrl) || removeUrl === '') {\n            return;\n        }\n        var file = new File([response], this.removingVideoName);\n        var ajax = new Ajax(removeUrl, 'POST', true, null);\n        var formData = new FormData();\n        formData.append('UploadFiles', file);\n        ajax.send(formData);\n    };\n    Video.prototype.onDocumentClick = function (e) {\n        var target = e.target;\n        if (target.nodeName === 'VIDEO' || this.isEmbedVidElem(target)) {\n            this.videoEle = !this.isEmbedVidElem(target) ? target : target.querySelector('iframe');\n        }\n        if (!isNullOrUndefined(this.dialogObj) && ((\n        // eslint-disable-next-line\n        !closest(target, '[id=' + \"'\" + this.dialogObj.element.id + \"'\" + ']') && this.parent.toolbarSettings.enable && this.parent.getToolbarElement() &&\n            !this.parent.getToolbarElement().contains(e.target)) ||\n            (this.parent.getToolbarElement() && this.parent.getToolbarElement().contains(e.target) &&\n                !closest(target, '#' + this.parent.getID() + '_toolbar_Video') &&\n                !target.querySelector('#' + this.parent.getID() + '_toolbar_Video')))) {\n            /* eslint-disable */\n            if (e.offsetX > e.target.clientWidth || e.offsetY > e.target.clientHeight) {\n            }\n            else {\n                this.parent.notify(events.documentClickClosedBy, { closedBy: \"outside click\" });\n                this.dialogObj.hide({ returnValue: true });\n                this.parent.isBlur = true;\n                dispatchEvent(this.parent.element, 'focusout');\n            }\n            /* eslint-enable */\n        }\n        // if (((e.target as HTMLElement).tagName !== 'VIDEO' || !this.isEmbedVidElem(e.target as HTMLElement)) && this.vidResizeDiv && !(this.quickToolObj &&\n        //     this.quickToolObj.videoQTBar && this.quickToolObj.videoQTBar.element.contains(e.target as HTMLElement)) &&\n        //     this.contentModule.getEditPanel().contains(this.vidResizeDiv)) {\n        //     this.cancelResizeAction();\n        // }\n        if (this.contentModule.getEditPanel().querySelector('.e-vid-resize')) {\n            if (target.tagName !== 'VIDEO' && !this.isEmbedVidElem(target)) {\n                this.removeResizeEle();\n            }\n            if ((target.tagName !== 'VIDEO' && !this.isEmbedVidElem(target)) && !isNOU(this.videoEle)) {\n                this.videoEle.style.outline = '';\n            }\n            else if (!isNOU(this.prevSelectedVidEle) &&\n                this.prevSelectedVidEle !== ((target.tagName === 'IFRAME' || target.tagName === 'VIDEO') ? target : target.querySelector('iframe'))) {\n                this.prevSelectedVidEle.style.outline = '';\n            }\n        }\n    };\n    Video.prototype.removeResizeEle = function () {\n        EventHandler.remove(this.contentModule.getDocument(), Browser.touchMoveEvent, this.resizing);\n        EventHandler.remove(this.contentModule.getDocument(), Browser.touchEndEvent, this.resizeEnd);\n        detach(this.contentModule.getEditPanel().querySelector('.e-vid-resize'));\n    };\n    Video.prototype.onWindowResize = function () {\n        if (!isNOU(this.contentModule) && !isNOU(this.contentModule.getEditPanel().querySelector('.e-vid-resize'))) {\n            this.cancelResizeAction();\n        }\n    };\n    Video.prototype.break = function (e) {\n        if (e.selectNode[0].nodeName !== 'VIDEO' && !this.isEmbedVidElem(e.selectNode[0])) {\n            return;\n        }\n        var subCommand = (e.args.item) ?\n            e.args.item.subCommand : 'Break';\n        this.parent.formatter.process(this.parent, e.args, e.args, { selectNode: e.selectNode, subCommand: subCommand });\n    };\n    Video.prototype.inline = function (e) {\n        if (e.selectNode[0].nodeName !== 'VIDEO' && !this.isEmbedVidElem(e.selectNode[0])) {\n            return;\n        }\n        var subCommand = (e.args.item) ?\n            e.args.item.subCommand : 'Inline';\n        this.parent.formatter.process(this.parent, e.args, e.args, { selectNode: e.selectNode, subCommand: subCommand });\n    };\n    Video.prototype.alignVideo = function (e, type) {\n        var subCommand = (e.args.item) ?\n            e.args.item.subCommand : type;\n        this.parent.formatter.process(this.parent, e.args, e.args, { selectNode: e.selectNode, subCommand: subCommand });\n    };\n    Video.prototype.editAreaClickHandler = function (e) {\n        if (this.parent.readonly) {\n            this.hideVideoQuickToolbar();\n            return;\n        }\n        var args = e.args;\n        var showOnRightClick = this.parent.quickToolbarSettings.showOnRightClick;\n        if (args.which === 2 || (showOnRightClick && args.which === 1) || (!showOnRightClick && args.which === 3)) {\n            if ((showOnRightClick && args.which === 1) && !isNullOrUndefined(args.target) &&\n                (args.target.tagName === 'VIDEO' || this.isEmbedVidElem(args.target))) {\n                this.parent.formatter.editorManager.nodeSelection.Clear(this.contentModule.getDocument());\n                this.parent.formatter.editorManager.nodeSelection.setSelectionContents(this.contentModule.getDocument(), args.target);\n            }\n            return;\n        }\n        if (this.parent.editorMode === 'HTML' && this.parent.quickToolbarModule && this.parent.quickToolbarModule.videoQTBar) {\n            this.quickToolObj = this.parent.quickToolbarModule;\n            var target = args.target;\n            this.contentModule = this.rendererFactory.getRenderer(RenderType.Content);\n            var isPopupOpen = this.quickToolObj.videoQTBar.element.classList.contains('e-rte-pop');\n            if ((target.nodeName === 'VIDEO' || this.isEmbedVidElem(target)) && this.parent.quickToolbarModule) {\n                if (isPopupOpen) {\n                    return;\n                }\n                this.parent.formatter.editorManager.nodeSelection.Clear(this.contentModule.getDocument());\n                this.parent.formatter.editorManager.nodeSelection.setSelectionContents(this.contentModule.getDocument(), target);\n                if (isIDevice()) {\n                    this.parent.notify(events.selectionSave, e);\n                }\n                addClass([!this.isEmbedVidElem(target) ? target : target.querySelector('iframe')], classes.CLS_VID_FOCUS);\n                this.showVideoQuickToolbar({ args: args, type: 'Videos', elements: [args.target] });\n            }\n            else {\n                this.hideVideoQuickToolbar();\n            }\n        }\n    };\n    Video.prototype.showVideoQuickToolbar = function (e) {\n        var _this = this;\n        if (e.type !== 'Videos' || (!isNullOrUndefined(e.args) && e.args.detail === 2) || isNullOrUndefined(this.parent.quickToolbarModule)\n            || isNullOrUndefined(this.parent.quickToolbarModule.videoQTBar) || isNullOrUndefined(e.args)) {\n            return;\n        }\n        this.quickToolObj = this.parent.quickToolbarModule;\n        var args = e.args;\n        var target = e.elements;\n        [].forEach.call(e.elements, function (element, index) {\n            if (index === 0) {\n                target = element;\n            }\n        });\n        if (target.tagName === 'VIDEO' || this.isEmbedVidElem(target)) {\n            addClass([(!this.isEmbedVidElem(target) || target.tagName === 'IFRAME') ? target : target.querySelector('iframe')], [classes.CLS_VID_FOCUS]);\n        }\n        var pageY = (this.parent.iframeSettings.enable) ? window.pageYOffset +\n            this.parent.element.getBoundingClientRect().top + args.clientY : args.pageY;\n        if (this.parent.quickToolbarModule.videoQTBar) {\n            if (e.isNotify) {\n                setTimeout(function () {\n                    _this.parent.formatter.editorManager.nodeSelection.Clear(_this.contentModule.getDocument());\n                    _this.parent.formatter.editorManager.nodeSelection.setSelectionContents(_this.contentModule.getDocument(), target);\n                    _this.quickToolObj.videoQTBar.showPopup(args.pageX - 50, pageY + (target.getBoundingClientRect().height / 2) - target.offsetTop, target);\n                }, 400);\n            }\n            else {\n                this.quickToolObj.videoQTBar.showPopup(args.pageX - 50, pageY + (target.getBoundingClientRect().height / 2) - target.offsetTop, target);\n            }\n        }\n    };\n    Video.prototype.hideVideoQuickToolbar = function () {\n        if (!isNullOrUndefined(this.contentModule.getEditPanel().querySelector('.' + classes.CLS_VID_FOCUS))) {\n            removeClass([this.contentModule.getEditPanel().querySelector('.' + classes.CLS_VID_FOCUS)], classes.CLS_VID_FOCUS);\n            if (!isNOU(this.videoEle)) {\n                this.videoEle.style.outline = '';\n            }\n            if (!isNOU(this.contentModule.getEditPanel().querySelector('.e-vid-resize'))) {\n                detach(this.contentModule.getEditPanel().querySelector('.e-vid-resize'));\n            }\n            if (this.quickToolObj && this.quickToolObj.videoQTBar && document.body.contains(this.quickToolObj.videoQTBar.element)) {\n                this.quickToolObj.videoQTBar.hidePopup();\n            }\n        }\n    };\n    Video.prototype.isEmbedVidElem = function (target) {\n        if ((target && target.nodeType !== 3 && target.nodeName !== 'BR' && (target.classList && target.classList.contains(classes.CLS_VID_CLICK_ELEM))) ||\n            (target && target.nodeName === 'IFRAME')) {\n            return true;\n        }\n        else {\n            return false;\n        }\n    };\n    Video.prototype.insertingVideo = function (e) {\n        this.insertVideo(e);\n        if (!isNullOrUndefined(this.dialogObj)) {\n            this.dialogObj.element.style.maxHeight = 'inherit';\n            var dialogContent = this.dialogObj.element.querySelector('.e-video-content');\n            if (!isNullOrUndefined(this.parent.insertVideoSettings.path) || this.parent.editorMode === 'HTML') {\n                document.getElementById(this.rteID + '_insertVideo').focus();\n            }\n            else {\n                dialogContent.querySelector('.e-video-url').focus();\n            }\n        }\n    };\n    Video.prototype.insertVideo = function (e) {\n        var _this = this;\n        if (this.dialogObj) {\n            this.dialogObj.hide({ returnValue: true });\n            return;\n        }\n        var videoDialog = this.parent.createElement('div', { className: 'e-rte-video-dialog', id: this.rteID + '_video' });\n        this.parent.element.appendChild(videoDialog);\n        var videoInsert = this.i10n.getConstant('dialogInsert');\n        var videolinkCancel = this.i10n.getConstant('dialogCancel');\n        var videoHeader = this.i10n.getConstant('videoHeader');\n        var selection = e.selection;\n        var selectObj = { selfVideo: this, selection: e.selection, args: e.args, selectParent: e.selectParent };\n        var dialogModel = {\n            header: videoHeader,\n            cssClass: classes.CLS_RTE_ELEMENTS,\n            enableRtl: this.parent.enableRtl,\n            locale: this.parent.locale,\n            showCloseIcon: true, closeOnEscape: true, width: (Browser.isDevice) ? '290px' : '340px',\n            isModal: Browser.isDevice,\n            buttons: [{\n                    click: this.insertVideoUrl.bind(selectObj),\n                    buttonModel: { content: videoInsert, cssClass: 'e-flat e-insertVideo', isPrimary: true, disabled: true }\n                },\n                {\n                    click: function (e) {\n                        _this.cancelDialog(e);\n                    },\n                    buttonModel: { cssClass: 'e-flat e-cancel', content: videolinkCancel }\n                }],\n            target: (Browser.isDevice) ? document.body : this.parent.element,\n            animationSettings: { effect: 'None' },\n            close: function (event) {\n                if (_this.isVideoUploaded) {\n                    _this.uploadObj.removing();\n                }\n                _this.parent.isBlur = false;\n                if (event && event.event.returnValue) {\n                    if (_this.parent.editorMode === 'HTML') {\n                        selection.restore();\n                    }\n                }\n                _this.dialogObj.destroy();\n                detach(_this.dialogObj.element);\n                _this.dialogRenderObj.close(event);\n                _this.dialogObj = null;\n            }\n        };\n        var dialogContent = this.parent.createElement('div', { className: 'e-video-content' });\n        if (!isNullOrUndefined(this.parent.insertVideoSettings.path) || this.parent.editorMode === 'HTML') {\n            dialogContent.appendChild(this.videoUpload(e));\n        }\n        var linkHeader = this.parent.createElement('div', { className: 'e-videoheader' });\n        var embedLinkHeader = this.parent.createElement('div', { className: 'e-embed-videoheader' });\n        var linkHeaderText = this.i10n.getConstant('videoLinkHeader');\n        var embedLinkHeaderText = this.i10n.getConstant('embedVideoLinkHeader');\n        if (this.parent.editorMode === 'HTML') {\n            linkHeader.innerHTML = linkHeaderText;\n            embedLinkHeader.innerHTML = embedLinkHeaderText;\n        }\n        dialogContent.appendChild(this.urlPopup(e));\n        if (e.selectNode && e.selectNode[0].nodeType === 1 && (e.selectNode[0].tagName === 'VIDEO' || this.isEmbedVidElem(e.selectNode[0]))) {\n            dialogModel.header = this.parent.localeObj.getConstant('editVideoHeader');\n            dialogModel.content = dialogContent;\n        }\n        else {\n            dialogModel.content = dialogContent;\n        }\n        this.dialogObj = this.dialogRenderObj.render(dialogModel);\n        this.dialogObj.createElement = this.parent.createElement;\n        this.dialogObj.appendTo(videoDialog);\n        if (e.selectNode && e.selectNode[0].nodeType === 1 && (e.selectNode[0].tagName === 'VIDEO' || this.isEmbedVidElem(e.selectNode[0]))\n            && (e.name === 'insertVideo')) {\n            this.dialogObj.element.querySelector('.e-insertVideo').textContent = this.parent.localeObj.getConstant('dialogUpdate');\n        }\n        videoDialog.style.maxHeight = 'inherit';\n        if (this.quickToolObj) {\n            if (this.quickToolObj.videoQTBar && document.body.contains(this.quickToolObj.videoQTBar.element)) {\n                this.quickToolObj.videoQTBar.hidePopup();\n                if (!isNullOrUndefined(e.selectParent)) {\n                    removeClass([e.selectParent[0]], classes.CLS_VID_FOCUS);\n                }\n            }\n            if (this.quickToolObj.inlineQTBar && document.body.contains(this.quickToolObj.inlineQTBar.element)) {\n                this.quickToolObj.inlineQTBar.hidePopup();\n            }\n            if (this.quickToolObj.textQTBar && this.parent.element.ownerDocument.body.contains(this.quickToolObj.textQTBar.element)) {\n                this.quickToolObj.textQTBar.hidePopup();\n            }\n        }\n    };\n    // eslint-disable-next-line\n    Video.prototype.urlPopup = function (e) {\n        var _this = this;\n        var videoUrl = this.parent.createElement('div', { className: 'e-video-url-wrap' });\n        var urlContent = this.parent.createElement('div', { id: 'urlcontent' });\n        var placeUrl = this.i10n.getConstant('videoUrl');\n        var content = '<input id=\"embedURL\" type=\"radio\">' + '<input id=\"webURL\" type=\"radio\" >';\n        var contentElem = parseHtml(content);\n        videoUrl.appendChild(contentElem);\n        videoUrl.appendChild(urlContent);\n        this.embedInputUrl = this.parent.createElement('textarea', {\n            className: 'e-input e-embed-video-url',\n            attrs: { placeholder: this.i10n.getConstant('pasteEmbeddedCodeHere'), type: 'text', tabindex: '-1', 'aria-label': this.i10n.getConstant('embedVideoLinkHeader') }\n        });\n        this.embedInputUrl.addEventListener('keyup', function () {\n            if (!isNOU(_this.embedInputUrl)) {\n                if (_this.embedInputUrl.value.length === 0) {\n                    _this.dialogObj.getButtons(0).element.disabled = true;\n                }\n                else {\n                    _this.dialogObj.getButtons(0).element.removeAttribute('disabled');\n                }\n            }\n        });\n        this.inputUrl = this.parent.createElement('input', {\n            className: 'e-input e-video-url',\n            attrs: { placeholder: placeUrl, spellcheck: 'false' }\n        });\n        this.inputUrl.addEventListener('input', function () {\n            if (!isNOU(_this.inputUrl)) {\n                if (_this.inputUrl.value.length === 0) {\n                    _this.dialogObj.getButtons(0).element.disabled = true;\n                }\n                else {\n                    _this.dialogObj.getButtons(0).element.removeAttribute('disabled');\n                }\n            }\n        });\n        if (e.selectNode && ((e.selectNode[0] && e.selectNode[0].nodeType !== 3 &&\n            e.selectNode[0].nodeName !== 'BR' &&\n            (e.selectNode[0].classList &&\n                e.selectNode[0].classList.contains(classes.CLS_VID_CLICK_ELEM))) ||\n            e.selectNode[0].nodeName === 'IFRAME' || e.selectNode[0].nodeName === 'VIDEO')) {\n            var regex = new RegExp(/([^\\S]|^)(((https?\\:\\/\\/)|(www\\.))(\\S+))/gi);\n            var sourceElement = e.selectNode[0].querySelector('source');\n            this.inputUrl.value = sourceElement.src.match(regex) ? sourceElement.src : '';\n        }\n        var embedUrlBtn = new RadioButton({\n            label: this.i10n.getConstant('embeddedCode'),\n            checked: true,\n            name: 'URL',\n            created: function () {\n                urlContent.appendChild(_this.embedInputUrl);\n            },\n            change: function () {\n                urlContent.innerHTML = '';\n                urlContent.appendChild(_this.embedInputUrl);\n            }\n        });\n        embedUrlBtn.appendTo(videoUrl.querySelector('#embedURL'));\n        var webUrlBtn = new RadioButton({\n            label: this.i10n.getConstant('webUrl'),\n            name: 'URL',\n            change: function () {\n                urlContent.innerHTML = '';\n                urlContent.appendChild(_this.inputUrl);\n            }\n        });\n        webUrlBtn.appendTo(videoUrl.querySelector('#webURL'));\n        return videoUrl;\n    };\n    Video.prototype.videoUpload = function (e) {\n        var _this = this;\n        var save;\n        var selectParent;\n        // eslint-disable-next-line\n        var proxy = this;\n        var iframe = proxy.parent.iframeSettings.enable;\n        if (proxy.parent.editorMode === 'HTML' && (!iframe && isNullOrUndefined(closest(e.selection.range.startContainer.parentNode, '[id='\n            // eslint-disable-next-line\n            + \"'\" + this.parent.contentModule.getPanel().id + \"'\" + ']'))\n            || (iframe && !hasClass(e.selection.range.startContainer.parentNode.ownerDocument.querySelector('body'), 'e-lib')))) {\n            this.contentModule.getEditPanel().focus();\n            var range = this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());\n            save = this.parent.formatter.editorManager.nodeSelection.save(range, this.parent.contentModule.getDocument());\n            selectParent = this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(range);\n        }\n        else {\n            save = e.selection;\n            selectParent = e.selectParent;\n        }\n        var uploadParentEle = this.parent.createElement('div', { className: 'e-vid-uploadwrap e-droparea' });\n        var deviceVideoUpMsg = this.i10n.getConstant('videoDeviceUploadMessage');\n        var videoUpMsg = this.i10n.getConstant('videoUploadMessage');\n        var span = this.parent.createElement('span', { className: 'e-droptext' });\n        var spanMsg = this.parent.createElement('span', {\n            className: 'e-rte-upload-text', innerHTML: ((Browser.isDevice) ? deviceVideoUpMsg : videoUpMsg)\n        });\n        span.appendChild(spanMsg);\n        var btnEle = this.parent.createElement('button', {\n            className: 'e-browsebtn', id: this.rteID + '_insertVideo', attrs: { autofocus: 'true', type: 'button' }\n        });\n        span.appendChild(btnEle);\n        uploadParentEle.appendChild(span);\n        var browserMsg = this.i10n.getConstant('browse');\n        var button = new Button({ content: browserMsg, enableRtl: this.parent.enableRtl });\n        button.isStringTemplate = true;\n        button.createElement = this.parent.createElement;\n        button.appendTo(btnEle);\n        var btnClick = (Browser.isDevice) ? span : btnEle;\n        EventHandler.add(btnClick, 'click', this.fileSelect, this);\n        var uploadEle = this.parent.createElement('input', {\n            id: this.rteID + '_upload', attrs: { type: 'File', name: 'UploadFiles' }\n        });\n        uploadParentEle.appendChild(uploadEle);\n        var fileName;\n        var selectArgs;\n        var filesData;\n        this.uploadObj = new Uploader({\n            asyncSettings: { saveUrl: this.parent.insertVideoSettings.saveUrl, removeUrl: this.parent.insertVideoSettings.removeUrl },\n            dropArea: span, multiple: false, enableRtl: this.parent.enableRtl,\n            allowedExtensions: this.parent.insertVideoSettings.allowedTypes.toString(),\n            selected: function (e) {\n                proxy.isVideoUploaded = true;\n                selectArgs = e;\n                // eslint-disable-next-line\n                filesData = e.filesData;\n                _this.parent.trigger(events.fileSelected, selectArgs, function (selectArgs) {\n                    if (!selectArgs.cancel) {\n                        _this.checkExtension(selectArgs.filesData[0]);\n                        fileName = selectArgs.filesData[0].name;\n                        if (_this.parent.editorMode === 'HTML' && isNullOrUndefined(_this.parent.insertVideoSettings.path)) {\n                            var reader_1 = new FileReader();\n                            // eslint-disable-next-line\n                            reader_1.addEventListener('load', function (e) {\n                                var url = _this.parent.insertVideoSettings.saveFormat === 'Base64' ? reader_1.result :\n                                    URL.createObjectURL(convertToBlob(reader_1.result));\n                                proxy.uploadUrl = {\n                                    url: url, selection: save, fileName: fileName,\n                                    selectParent: selectParent\n                                };\n                                proxy.inputUrl.setAttribute('disabled', 'true');\n                                proxy.embedInputUrl.setAttribute('disabled', 'true');\n                                if (isNullOrUndefined(proxy.parent.insertVideoSettings.saveUrl) && _this.isAllowedTypes\n                                    && !isNullOrUndefined(_this.dialogObj)) {\n                                    _this.dialogObj.getButtons(0).element.removeAttribute('disabled');\n                                }\n                            });\n                            reader_1.readAsDataURL(selectArgs.filesData[0].rawFile);\n                        }\n                    }\n                });\n            },\n            beforeUpload: function (args) {\n                _this.parent.trigger(events.beforeFileUpload, args);\n            },\n            uploading: function (e) {\n                if (!_this.parent.isServerRendered) {\n                    _this.parent.trigger(events.fileUploading, e);\n                }\n            },\n            success: function (e) {\n                _this.parent.trigger(events.fileUploadSuccess, e, function (e) {\n                    if (!isNullOrUndefined(_this.parent.insertVideoSettings.path)) {\n                        var url = _this.parent.insertVideoSettings.path + e.file.name;\n                        // eslint-disable-next-line\n                        var value = { url: url, selection: save };\n                        proxy.uploadUrl = {\n                            url: url, selection: save, fileName: fileName, selectParent: selectParent,\n                            width: {\n                                width: proxy.parent.insertVideoSettings.width, minWidth: proxy.parent.insertVideoSettings.minWidth,\n                                maxWidth: proxy.parent.getInsertImgMaxWidth()\n                            },\n                            height: {\n                                height: proxy.parent.insertVideoSettings.height, minHeight: proxy.parent.insertVideoSettings.minHeight,\n                                maxHeight: proxy.parent.insertVideoSettings.maxHeight\n                            }\n                        };\n                        //proxy.inputUrl.setAttribute('disabled', 'true');\n                        proxy.embedInputUrl.setAttribute('disabled', 'true');\n                    }\n                    if (e.operation === 'upload' && !isNullOrUndefined(_this.dialogObj)) {\n                        _this.dialogObj.getButtons(0).element.removeAttribute('disabled');\n                    }\n                });\n            },\n            failure: function (e) {\n                _this.parent.trigger(events.fileUploadFailed, e);\n            },\n            removing: function () {\n                // eslint-disable-next-line\n                _this.parent.trigger(events.fileRemoving, e, function (e) {\n                    proxy.isVideoUploaded = false;\n                    _this.dialogObj.getButtons(0).element.disabled = true;\n                    //proxy.inputUrl.removeAttribute('disabled');\n                    proxy.embedInputUrl.removeAttribute('disabled');\n                    if (proxy.uploadUrl) {\n                        proxy.uploadUrl.url = '';\n                    }\n                });\n            }\n        });\n        this.uploadObj.isStringTemplate = true;\n        this.uploadObj.createElement = this.parent.createElement;\n        this.uploadObj.appendTo(uploadEle);\n        return uploadParentEle;\n    };\n    Video.prototype.checkExtension = function (e) {\n        if (this.uploadObj.allowedExtensions) {\n            if (this.uploadObj.allowedExtensions.toLocaleLowerCase().indexOf(('.' + e.type).toLocaleLowerCase()) === -1) {\n                this.dialogObj.getButtons(0).element.setAttribute('disabled', 'disabled');\n                this.isAllowedTypes = false;\n            }\n            else {\n                this.isAllowedTypes = true;\n            }\n        }\n    };\n    Video.prototype.fileSelect = function () {\n        this.dialogObj.element.getElementsByClassName('e-file-select-wrap')[0].querySelector('button').click();\n        return false;\n    };\n    // eslint-disable-next-line\n    Video.prototype.cancelDialog = function (e) {\n        this.parent.isBlur = false;\n        this.dialogObj.hide({ returnValue: true });\n        if (this.isVideoUploaded) {\n            this.uploadObj.removing();\n        }\n    };\n    // eslint-disable-next-line\n    Video.prototype.insertVideoUrl = function (e) {\n        var proxy = this.selfVideo;\n        //let audioSelectParent: Node = proxy.uploadUrl.selectParent[0];\n        proxy.isVideoUploaded = false;\n        var url = proxy.inputUrl.value;\n        var embedUrl = proxy.embedInputUrl.value;\n        if (proxy.parent.formatter.getUndoRedoStack().length === 0) {\n            proxy.parent.formatter.saveData();\n        }\n        if (!isNullOrUndefined(proxy.uploadUrl) && proxy.uploadUrl.url !== '') {\n            proxy.uploadUrl.cssClass = (proxy.parent.insertVideoSettings.layoutOption === 'Inline' ?\n                classes.CLS_VIDEOINLINE : classes.CLS_VIDEOBREAK);\n            proxy.dialogObj.hide({ returnValue: false });\n            proxy.parent.formatter.process(proxy.parent, this.args, this.args.originalEvent, proxy.uploadUrl);\n            proxy.uploadUrl.url = '';\n        }\n        else if (proxy.parent.editorMode === 'HTML' && (url !== '' || embedUrl !== '')) {\n            if (proxy.parent.editorMode === 'HTML' && isNullOrUndefined(closest(\n            // eslint-disable-next-line\n            this.selection.range.startContainer.parentNode, '[id=' + \"'\" + proxy.contentModule.getPanel().id + \"'\" + ']'))) {\n                proxy.contentModule.getEditPanel().focus();\n                var range = proxy.parent.formatter.editorManager.nodeSelection.getRange(proxy.contentModule.getDocument());\n                this.selection = proxy.parent.formatter.editorManager.nodeSelection.save(range, proxy.contentModule.getDocument());\n                this.selectParent = proxy.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(range);\n            }\n            var webUrlBtn = document.getElementById('webURL');\n            var name_1 = webUrlBtn.checked ? url.split('/')[url.split('/').length - 1] : embedUrl;\n            var value = {\n                cssClass: (proxy.parent.insertVideoSettings.layoutOption === 'Inline' ? classes.CLS_VIDEOINLINE : classes.CLS_VIDEOBREAK),\n                url: url, selection: this.selection, fileName: name_1, isEmbedUrl: !webUrlBtn.checked,\n                selectParent: this.selectParent, width: {\n                    width: proxy.parent.insertVideoSettings.width, minWidth: proxy.parent.insertVideoSettings.minWidth,\n                    maxWidth: proxy.parent.getInsertImgMaxWidth()\n                },\n                height: {\n                    height: proxy.parent.insertVideoSettings.height, minHeight: proxy.parent.insertVideoSettings.minHeight,\n                    maxHeight: proxy.parent.insertVideoSettings.maxHeight\n                }\n            };\n            proxy.parent.formatter.process(proxy.parent, this.args, this.args.originalEvent, value);\n            proxy.dialogObj.hide({ returnValue: false });\n        }\n    };\n    /* eslint-disable */\n    /**\n     * Destroys the ToolBar.\n     *\n     * @method destroy\n     * @returns {void}\n     * @hidden\n\n     */\n    /* eslint-enable */\n    Video.prototype.destroy = function () {\n        this.prevSelectedVidEle = undefined;\n        this.removeEventListener();\n    };\n    /**\n     * For internal use only - Get the module name.\n     *\n     * @returns {void}\n     * @hidden\n     */\n    Video.prototype.getModuleName = function () {\n        return 'video';\n    };\n    return Video;\n}());\nexport { Video };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}