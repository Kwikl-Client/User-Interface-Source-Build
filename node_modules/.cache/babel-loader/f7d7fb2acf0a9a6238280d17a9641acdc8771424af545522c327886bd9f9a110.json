{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n    return extendStatics(d, b);\n  };\n  return function (d, b) {\n    extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\nimport { remove, createElement, closest, formatUnit, Browser, extend } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined, removeClass } from '@syncfusion/ej2-base';\nimport { DataManager } from '@syncfusion/ej2-data';\nimport { dataReady, modelChanged, refreshVirtualBlock, contentReady } from '../base/constant';\nimport * as events from '../base/constant';\nimport { RenderType } from '../base/enum';\nimport { ContentRender } from './content-renderer';\nimport { HeaderRender } from './header-renderer';\nimport { InterSectionObserver } from '../services/intersection-observer';\nimport { VirtualRowModelGenerator } from '../services/virtual-row-model-generator';\nimport { isGroupAdaptive, ensureLastRow, ensureFirstRow, getEditedDataIndex, getTransformValues } from '../base/util';\nimport { setStyleAttribute } from '@syncfusion/ej2-base';\nimport * as literals from '../base/string-literals';\n/**\n * VirtualContentRenderer\n *\n * @hidden\n */\nvar VirtualContentRenderer = /** @class */function (_super) {\n  __extends(VirtualContentRenderer, _super);\n  function VirtualContentRenderer(parent, locator) {\n    var _this = _super.call(this, parent, locator) || this;\n    _this.prevHeight = 0;\n    /** @hidden */\n    _this.startIndex = 0;\n    _this.preStartIndex = 0;\n    _this.preventEvent = false;\n    _this.actions = ['filtering', 'searching', 'grouping', 'ungrouping'];\n    /** @hidden */\n    _this.offsets = {};\n    _this.tmpOffsets = {};\n    /** @hidden */\n    _this.virtualEle = new VirtualElementHandler();\n    _this.offsetKeys = [];\n    _this.isFocused = false;\n    _this.isSelection = false;\n    _this.isBottom = false;\n    _this.diff = 0;\n    _this.heightChange = false;\n    /** @hidden */\n    _this.isTop = false;\n    _this.empty = undefined;\n    _this.isCancel = false;\n    _this.requestTypes = ['beginEdit', 'cancel', 'delete', 'add', 'save', 'sorting'];\n    _this.isNormaledit = _this.parent.editSettings.mode === 'Normal';\n    /** @hidden */\n    _this.virtualData = {};\n    _this.emptyRowData = {};\n    _this.isContextMenuOpen = false;\n    _this.isSelectionScroll = false;\n    _this.validationCheck = false;\n    _this.locator = locator;\n    _this.eventListener('on');\n    _this.widthServices = locator.getService('widthService');\n    _this.parent.on(events.columnVisibilityChanged, _this.setVisible, _this);\n    _this.vgenerator = _this.generator;\n    return _this;\n  }\n  VirtualContentRenderer.prototype.renderTable = function () {\n    this.header = this.locator.getService('rendererFactory').getRenderer(RenderType.Header);\n    _super.prototype.renderTable.call(this);\n    this.virtualEle.table = this.getTable();\n    this.virtualEle.content = this.content = this.getPanel().querySelector('.' + literals.content);\n    this.virtualEle.renderWrapper(this.parent.height);\n    this.virtualEle.renderPlaceHolder();\n    if (!(!this.parent.enableVirtualization && this.parent.enableColumnVirtualization)) {\n      this.virtualEle.wrapper.style.position = 'absolute';\n    }\n    var debounceEvent = this.parent.dataSource instanceof DataManager && !this.parent.dataSource.dataSource.offline;\n    var opt = {\n      container: this.content,\n      pageHeight: this.getBlockHeight() * 2,\n      debounceEvent: debounceEvent,\n      axes: this.parent.enableColumnVirtualization ? ['X', 'Y'] : ['Y']\n    };\n    this.observer = new InterSectionObserver(this.virtualEle.wrapper, opt);\n  };\n  VirtualContentRenderer.prototype.renderEmpty = function (tbody) {\n    this.getTable().appendChild(tbody);\n    if (this.parent.frozenRows) {\n      this.parent.getHeaderContent().querySelector(literals.tbody).innerHTML = '';\n    }\n    this.virtualEle.adjustTable(0, 0);\n  };\n  VirtualContentRenderer.prototype.getReorderedFrozenRows = function (args) {\n    var blockIndex = args.virtualInfo.blockIndexes;\n    var colsIndex = args.virtualInfo.columnIndexes;\n    var page = args.virtualInfo.page;\n    args.virtualInfo.blockIndexes = [1, 2];\n    args.virtualInfo.page = 1;\n    if (!args.renderMovableContent) {\n      args.virtualInfo.columnIndexes = [];\n    }\n    var recordslength = this.parent.getCurrentViewRecords().length;\n    var firstRecords = this.parent.renderModule.data.dataManager.dataSource.json.slice(0, recordslength);\n    var virtualRows = this.vgenerator.generateRows(firstRecords, args);\n    args.virtualInfo.blockIndexes = blockIndex;\n    args.virtualInfo.columnIndexes = colsIndex;\n    args.virtualInfo.page = page;\n    return virtualRows.splice(0, this.parent.frozenRows);\n  };\n  VirtualContentRenderer.prototype.scrollListener = function (scrollArgs) {\n    if (!this.parent.enableVirtualization && this.parent.enableColumnVirtualization && (scrollArgs.direction === 'up' || scrollArgs.direction === 'down')) {\n      return;\n    }\n    this.scrollAfterEdit();\n    if (this.parent.enablePersistence) {\n      this.parent.scrollPosition = scrollArgs.offset;\n    }\n    if (this.preventEvent || this.parent.isDestroyed) {\n      this.preventEvent = false;\n      return;\n    }\n    if (this.parent.islazyloadRequest && scrollArgs.direction === 'down') {\n      this.parent.removeMaskRow();\n      this.parent.islazyloadRequest = false;\n      return;\n    }\n    if (isNullOrUndefined(document.activeElement)) {\n      this.isFocused = false;\n    } else {\n      this.isFocused = this.content === closest(document.activeElement, '.' + literals.content) || this.content === document.activeElement;\n    }\n    var info = scrollArgs.sentinel;\n    var viewInfo = this.currentInfo = this.getInfoFromView(scrollArgs.direction, info, scrollArgs.offset);\n    if (isGroupAdaptive(this.parent)) {\n      if (viewInfo.blockIndexes && this.prevInfo.blockIndexes.toString() === viewInfo.blockIndexes.toString()) {\n        this.parent.removeMaskRow();\n        return;\n      } else {\n        viewInfo.event = 'refresh-virtual-block';\n        if (!isNullOrUndefined(viewInfo.offsets)) {\n          viewInfo.offsets.top = this.content.scrollTop;\n        }\n        this.parent.pageSettings.currentPage = viewInfo.page;\n        if (this.parent.enableVirtualMaskRow) {\n          this.parent.showMaskRow(info.axis);\n          this.parent.addShimmerEffect();\n        }\n        this.parent.notify(viewInfo.event, {\n          requestType: 'virtualscroll',\n          virtualInfo: viewInfo,\n          focusElement: scrollArgs.focusElement\n        });\n        return;\n      }\n    }\n    if (this.prevInfo && (info.axis === 'Y' && this.prevInfo.blockIndexes.toString() === viewInfo.blockIndexes.toString() || info.axis === 'X' && this.prevInfo.columnIndexes.toString() === viewInfo.columnIndexes.toString())) {\n      this.parent.removeMaskRow();\n      if (Browser.isIE) {\n        this.parent.hideSpinner();\n      }\n      this.requestType = this.requestType === 'virtualscroll' ? this.empty : this.requestType;\n      if (info.axis === 'Y') {\n        this.restoreEdit();\n      }\n      if (this.parent.groupSettings.enableLazyLoading && this.prevInfo.blockIndexes[0] === 1 && viewInfo.blockIndexes[0] === 1 && scrollArgs.direction === 'up') {\n        this.virtualEle.adjustTable(0, viewInfo.offsets.top < this.offsets[1] ? 0 : this.getBlockHeight());\n      }\n      return;\n    }\n    this.parent.setColumnIndexesInView(this.parent.enableColumnVirtualization ? viewInfo.columnIndexes : []);\n    if (!(!this.parent.enableVirtualization && this.parent.enableColumnVirtualization)) {\n      this.parent.pageSettings.currentPage = viewInfo.loadNext && !viewInfo.loadSelf ? viewInfo.nextInfo.page : viewInfo.page;\n    }\n    this.requestType = 'virtualscroll';\n    if (this.parent.enableVirtualMaskRow) {\n      this.parent.showMaskRow(info.axis);\n      this.parent.addShimmerEffect();\n    }\n    this.parent.islazyloadRequest = false;\n    this.parent.notify(viewInfo.event, {\n      requestType: 'virtualscroll',\n      virtualInfo: viewInfo,\n      focusElement: scrollArgs.focusElement\n    });\n    if (this.parent.enableColumnVirtualization && !this.parent.getContentTable().querySelector('tr.e-row')) {\n      this.parent.removeMaskRow();\n      this.appendContent(undefined, undefined, {\n        requestType: 'virtualscroll',\n        virtualInfo: viewInfo,\n        focusElement: scrollArgs.focusElement\n      });\n      this.prevInfo = viewInfo;\n    }\n  };\n  VirtualContentRenderer.prototype.block = function (blk) {\n    return this.vgenerator.isBlockAvailable(blk);\n  };\n  VirtualContentRenderer.prototype.getInfoFromView = function (direction, info, e) {\n    var isBlockAdded = false;\n    var tempBlocks = [];\n    var infoType = {\n      direction: direction,\n      sentinelInfo: info,\n      offsets: e,\n      startIndex: this.preStartIndex,\n      endIndex: this.preEndIndex\n    };\n    infoType.page = this.getPageFromTop(e.top, infoType);\n    infoType.blockIndexes = tempBlocks = this.vgenerator.getBlockIndexes(infoType.page);\n    infoType.loadSelf = !this.vgenerator.isBlockAvailable(tempBlocks[infoType.block]);\n    var blocks = this.ensureBlocks(infoType);\n    if (this.activeKey === 'upArrow' && infoType.blockIndexes.toString() !== blocks.toString()) {\n      // To avoid dupilcate row index problem in key focus support\n      var newBlock = blocks[blocks.length - 1];\n      if (infoType.blockIndexes.indexOf(newBlock) === -1) {\n        isBlockAdded = true;\n      }\n    }\n    if (!(!this.parent.enableVirtualization && this.parent.enableColumnVirtualization)) {\n      infoType.blockIndexes = blocks;\n    }\n    infoType.loadNext = !blocks.filter(function (val) {\n      return tempBlocks.indexOf(val) === -1;\n    }).every(this.block.bind(this));\n    infoType.event = infoType.loadNext || infoType.loadSelf ? modelChanged : refreshVirtualBlock;\n    infoType.nextInfo = infoType.loadNext ? {\n      page: Math.max(1, infoType.page + (direction === 'down' ? 1 : -1))\n    } : {};\n    if (isBlockAdded) {\n      infoType.blockIndexes = [infoType.blockIndexes[0] - 1, infoType.blockIndexes[0], infoType.blockIndexes[0] + 1];\n    }\n    if (this.activeKey === 'downArrow' && !isNaN(this.rowIndex)) {\n      var firstBlock = Math.ceil(this.rowIndex / this.getBlockSize());\n      if (firstBlock !== 1 && (infoType.blockIndexes[1] !== firstBlock || infoType.blockIndexes.length < 3)) {\n        infoType.blockIndexes = [firstBlock - 1, firstBlock, firstBlock + 1];\n      }\n    }\n    infoType.columnIndexes = info.axis === 'X' ? this.vgenerator.getColumnIndexes() : this.parent.getColumnIndexesInView();\n    if (this.parent.enableColumnVirtualization && info.axis === 'X') {\n      infoType.event = refreshVirtualBlock;\n    }\n    return infoType;\n  };\n  VirtualContentRenderer.prototype.ensureBlocks = function (info) {\n    var _this = this;\n    var index = info.blockIndexes[info.block];\n    var mIdx;\n    var old = index;\n    var max = Math.max;\n    var indexes = info.direction === 'down' ? [max(index, 1), ++index, ++index] : [max(index - 1, 1), index, index + 1];\n    this.prevInfo = this.prevInfo || this.vgenerator.getData();\n    indexes = indexes.filter(function (val, ind) {\n      return indexes.indexOf(val) === ind;\n    });\n    if (this.prevInfo.blockIndexes.toString() === indexes.toString()) {\n      return indexes;\n    }\n    if (info.loadSelf || info.direction === 'down' && this.isEndBlock(old)) {\n      indexes = this.vgenerator.getBlockIndexes(info.page);\n    }\n    indexes.some(function (val, ind) {\n      var result = val === (isGroupAdaptive(_this.parent) ? _this.getGroupedTotalBlocks() : _this.getTotalBlocks());\n      if (result) {\n        mIdx = ind;\n      }\n      return result;\n    });\n    if (mIdx !== undefined) {\n      indexes = indexes.slice(0, mIdx + 1);\n      if (info.block === 0 && indexes.length === 1 && this.vgenerator.isBlockAvailable(indexes[0] - 1)) {\n        indexes = [indexes[0] - 1, indexes[0]];\n      }\n    }\n    return indexes;\n  };\n  // tslint:disable-next-line:max-func-body-length\n  VirtualContentRenderer.prototype.appendContent = function (target, newChild, e) {\n    var _this = this;\n    // currentInfo value will be used if there are multiple dom updates happened due to mousewheel\n    var info = e.virtualInfo.sentinelInfo && e.virtualInfo.sentinelInfo.axis === 'Y' && this.currentInfo.page && this.currentInfo.page !== e.virtualInfo.page ? this.currentInfo : e.virtualInfo;\n    this.prevInfo = this.prevInfo || e.virtualInfo;\n    var cBlock = info.columnIndexes[0] - 1;\n    var cOffset = this.getColumnOffset(cBlock);\n    var width;\n    var blocks = info.blockIndexes;\n    if (this.parent.groupSettings.columns.length) {\n      this.refreshOffsets();\n    }\n    if (this.parent.height === '100%') {\n      this.parent.element.style.height = '100%';\n    }\n    var vHeight = this.parent.height.toString().indexOf('%') < 0 ? this.content.getBoundingClientRect().height : this.parent.element.getBoundingClientRect().height;\n    if (!this.parent.enableVirtualization && this.parent.enableColumnVirtualization) {\n      vHeight = 0;\n    }\n    var reduceWidth = 0;\n    if (this.parent.enableColumnVirtualization && this.parent.isFrozenGrid()) {\n      var frzLeftWidth_1 = 0;\n      this.parent.getColumns().filter(function (col) {\n        if (col.visible) {\n          reduceWidth += parseInt(col.width.toString(), 10);\n          if (col.freeze === 'Left') {\n            frzLeftWidth_1 += parseInt(col.width.toString(), 10);\n          }\n        }\n      });\n      var cIndex = info.columnIndexes;\n      width = this.getColumnOffset(cIndex[cIndex.length - 1]) - this.getColumnOffset(cIndex[0] - 1) + '';\n      if (cBlock > this.parent.getVisibleFrozenLeftCount()) {\n        cOffset = cOffset - frzLeftWidth_1;\n      }\n      this.resetStickyLeftPos(cOffset, newChild);\n    }\n    if (!this.requestTypes.some(function (value) {\n      return value === _this.requestType;\n    })) {\n      var translate = this.getTranslateY(this.content.scrollTop, vHeight, info);\n      if (this.parent.groupSettings.enableLazyLoading && info && this.prevInfo && this.prevInfo.blockIndexes[0] === 1 && info.blockIndexes[0] === 1 && info.direction === 'up') {\n        this.virtualEle.adjustTable(0, this.content.scrollTop < this.offsets[1] ? 0 : this.getBlockHeight());\n      } else {\n        this.virtualEle.adjustTable(cOffset, translate);\n      }\n    }\n    if (this.parent.enableColumnVirtualization) {\n      this.header.virtualEle.adjustTable(cOffset, 0);\n    }\n    if (this.parent.enableColumnVirtualization) {\n      var cIndex = info.columnIndexes;\n      width = this.getColumnOffset(cIndex[cIndex.length - 1]) - this.getColumnOffset(cIndex[0] - 1) + '';\n      if (this.parent.isFrozenGrid()) {\n        width = reduceWidth.toString();\n        if (this.parent.allowResizing) {\n          this.parent.getHeaderTable().style.width = reduceWidth + 'px';\n          this.parent.getContentTable().style.width = reduceWidth + 'Px';\n        }\n      }\n      this.header.virtualEle.setWrapperWidth(width);\n    }\n    this.virtualEle.setWrapperWidth(width, Browser.isIE || Browser.info.name === 'edge');\n    if (this.parent.enableColumnVirtualization && isNullOrUndefined(target) && isNullOrUndefined(newChild)) {\n      return;\n    }\n    if (!isNullOrUndefined(target) && !isNullOrUndefined(target.parentNode)) {\n      remove(target);\n    }\n    var tbody = this.parent.element.querySelector('.' + literals.content).querySelector(literals.tbody);\n    if (tbody) {\n      remove(tbody);\n      target = null;\n    }\n    var isReact = this.parent.isReact && !isNullOrUndefined(this.parent.rowTemplate);\n    if (!isReact) {\n      target = this.parent.createElement(literals.tbody, {\n        attrs: {\n          role: 'rowgroup'\n        }\n      });\n      target.appendChild(newChild);\n    } else {\n      target = newChild;\n    }\n    if (this.parent.frozenRows && e.requestType === 'virtualscroll' && this.parent.pageSettings.currentPage === 1) {\n      for (var i = 0; i < this.parent.frozenRows; i++) {\n        target.children[0].remove();\n      }\n    }\n    this.getTable().appendChild(target);\n    this.requestType = this.requestType === 'virtualscroll' ? this.empty : this.requestType;\n    if (!this.parent.enableVirtualization && this.parent.enableColumnVirtualization && (info.direction === 'right' || info.direction === 'left')) {\n      this.content.scrollTop = this.currentInfo.offsets.top;\n      this.content.scrollLeft = this.currentInfo.offsets.left;\n    }\n    if (this.parent.groupSettings.columns.length) {\n      if (!isGroupAdaptive(this.parent) && info.direction === 'up') {\n        var blk = this.offsets[this.getTotalBlocks()] - this.prevHeight;\n        if (!this.parent.groupSettings.enableLazyLoading) {\n          this.preventEvent = true;\n        }\n        var sTop = this.content.scrollTop;\n        this.content.scrollTop = sTop + blk;\n      }\n      this.setVirtualHeight();\n      if (!this.parent.groupSettings.enableLazyLoading) {\n        this.observer.setPageHeight(this.getOffset(blocks[blocks.length - 1]) - this.getOffset(blocks[0] - 1));\n      }\n    }\n    if (e.requestType === 'ungrouping' && !this.parent.groupSettings.enableLazyLoading && this.parent.groupSettings.columns.length === 0) {\n      this.observer.setPageHeight(this.getBlockHeight() * 2);\n    }\n    this.prevInfo = info;\n    if (this.isFocused && this.activeKey !== 'downArrow' && this.activeKey !== 'upArrow') {\n      this.content.focus();\n    }\n    var lastPage = Math.ceil(this.getTotalBlocks() / 2);\n    if (this.isBottom) {\n      this.isBottom = false;\n      this.parent.getContent().firstElementChild.scrollTop = this.offsets[this.offsetKeys.length - 1];\n    }\n    if ((this.parent.pageSettings.currentPage + 1 === lastPage || this.parent.pageSettings.currentPage === lastPage) && blocks.length === 2 && e.requestType === 'delete') {\n      this.parent.getContent().firstElementChild.scrollTop = this.offsets[this.offsetKeys.length - 1];\n    }\n    if (this.parent.pageSettings.currentPage === lastPage && blocks.length === 1) {\n      this.isBottom = true;\n      this.parent.getContent().firstElementChild.scrollTop = this.offsets[this.offsetKeys.length - 2];\n    }\n    if (this.isTop) {\n      this.parent.getContent().firstElementChild.scrollTop = 0;\n      this.isTop = false;\n    }\n    if (e.requestType === 'virtualscroll' && e.virtualInfo.sentinelInfo.axis === 'X') {\n      this.parent.notify(events.autoCol, {});\n    }\n    this.focusCell(e);\n    this.restoreEdit(e);\n    this.restoreAdd();\n    this.ensureSelectedRowPosition();\n    this.validationScrollLeft();\n    if (this.parent.isFrozenGrid() && this.parent.enableColumnVirtualization) {\n      this.widthServices.refreshFrozenScrollbar();\n    }\n    if (!this.initialRowTop) {\n      var gridTop = this.parent.element.getBoundingClientRect().top;\n      if (this.parent.getRowByIndex(0)) {\n        this.initialRowTop = this.parent.getRowByIndex(0).getBoundingClientRect().top - gridTop;\n      }\n    }\n  };\n  VirtualContentRenderer.prototype.validationScrollLeft = function () {\n    if (this.validationCheck) {\n      if (this.validationCol) {\n        var offset = this.vgenerator.cOffsets[this.validationCol.index - this.parent.getVisibleFrozenColumns() - 1];\n        this.validationCol = null;\n        this.content.scrollLeft = offset;\n      } else {\n        this.validationCheck = false;\n        this.parent.editModule.editFormValidate();\n      }\n    }\n  };\n  VirtualContentRenderer.prototype.ensureSelectedRowPosition = function () {\n    if (!this.isSelection && this.isSelectionScroll && !isNullOrUndefined(this.selectRowIndex)) {\n      this.isSelectionScroll = false;\n      var row = this.parent.getRowByIndex(this.selectRowIndex);\n      if (row && !this.isRowInView(row)) {\n        this.rowSelected({\n          rowIndex: this.selectRowIndex,\n          row: row\n        }, true);\n      }\n    }\n  };\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  VirtualContentRenderer.prototype.focusCell = function (e) {\n    if (this.activeKey !== 'upArrow' && this.activeKey !== 'downArrow') {\n      return;\n    }\n    var row = this.parent.getRowByIndex(this.rowIndex);\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    var cell = row.cells[this.cellIndex];\n    cell.focus({\n      preventScroll: true\n    });\n    if (!this.parent.selectionSettings.checkboxOnly) {\n      this.parent.selectRow(parseInt(row.getAttribute(literals.dataRowIndex), 10));\n    }\n    this.activeKey = this.empty;\n  };\n  VirtualContentRenderer.prototype.restoreEdit = function (e) {\n    if (this.isNormaledit) {\n      if (this.parent.editSettings.allowEditing && this.parent.editModule && !isNullOrUndefined(this.editedRowIndex)) {\n        var row = this.getRowByIndex(this.editedRowIndex);\n        var content = this.content;\n        var keys = Object.keys(this.virtualData);\n        var isXaxis = e && e.virtualInfo && e.virtualInfo.sentinelInfo.axis === 'X';\n        if (keys.length && row && !content.querySelector('.' + literals.editedRow)) {\n          var top_1 = row.getBoundingClientRect().top;\n          if (isXaxis || top_1 < this.content.offsetHeight && top_1 > this.parent.getRowHeight()) {\n            this.parent.isEdit = false;\n            this.parent.editModule.startEdit(row);\n          }\n        }\n        if (row && this.content.querySelector('.' + literals.editedRow) && !keys.length) {\n          var rowData = !this.parent.enableVirtualization && this.parent.enableColumnVirtualization ? extend({}, this.parent.getCurrentViewRecords()[this.editedRowIndex]) : extend({}, this.getRowObjectByIndex(this.editedRowIndex));\n          this.virtualData = this.getVirtualEditedData(rowData);\n        }\n      }\n      this.restoreAdd();\n    }\n  };\n  VirtualContentRenderer.prototype.getVirtualEditedData = function (rowData) {\n    var editForms = [].slice.call(this.parent.element.getElementsByClassName('e-gridform'));\n    var isFormDestroyed = this.parent.editModule && this.parent.editModule.formObj && this.parent.editModule.formObj.isDestroyed;\n    if (!isFormDestroyed) {\n      for (var i = 0; i < editForms.length; i++) {\n        rowData = this.parent.editModule.getCurrentEditedData(editForms[parseInt(i.toString(), 10)], rowData);\n      }\n    }\n    return rowData;\n  };\n  VirtualContentRenderer.prototype.restoreAdd = function () {\n    var startAdd = !this.parent.element.querySelector('.' + literals.addedRow);\n    if (this.isNormaledit && this.isAdd && startAdd) {\n      var isTop = this.parent.editSettings.newRowPosition === 'Top' && this.content.scrollTop < this.parent.getRowHeight();\n      var isBottom = this.parent.editSettings.newRowPosition === 'Bottom' && this.parent.pageSettings.currentPage === this.maxPage;\n      if (isTop || isBottom) {\n        this.parent.isEdit = false;\n        this.parent.addRecord();\n      }\n    }\n  };\n  VirtualContentRenderer.prototype.onDataReady = function (e) {\n    if (!isNullOrUndefined(e.count)) {\n      this.count = e.count;\n      this.maxPage = Math.ceil(e.count / this.parent.pageSettings.pageSize);\n    }\n    this.vgenerator.checkAndResetCache(e.requestType);\n    if (['refresh', 'filtering', 'searching', 'grouping', 'ungrouping', 'reorder', undefined].some(function (value) {\n      return e.requestType === value;\n    })) {\n      this.refreshOffsets();\n    }\n    this.setVirtualHeight();\n    this.resetScrollPosition(e.requestType);\n  };\n  /**\n   * @param {number} height - specifies the height\n   * @returns {void}\n   * @hidden\n   */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  VirtualContentRenderer.prototype.setVirtualHeight = function (height) {\n    var width = this.parent.enableColumnVirtualization ? this.getColumnOffset(this.parent.columns.length + this.parent.groupSettings.columns.length - 1) + 'px' : '100%';\n    var virtualHeight = this.offsets[isGroupAdaptive(this.parent) && this.count !== 0 ? this.getGroupedTotalBlocks() : this.getTotalBlocks()];\n    if (!this.parent.enableVirtualization && this.parent.enableColumnVirtualization) {\n      virtualHeight = 0;\n    }\n    var lastPage = Math.ceil(this.getTotalBlocks() / 2);\n    var placeHolderBottom = Math.round(this.virtualEle.placeholder.getBoundingClientRect().bottom);\n    var wrapperBottom = Math.round(this.virtualEle.wrapper.getBoundingClientRect().bottom);\n    if ((this.currentInfo.page === lastPage || this.currentInfo.page + 1 === lastPage) && this.currentInfo.direction === 'down' && placeHolderBottom > wrapperBottom && !this.diff) {\n      this.diff = placeHolderBottom - wrapperBottom;\n    }\n    if (this.diff && this.currentInfo.page === lastPage && placeHolderBottom > wrapperBottom) {\n      virtualHeight -= this.diff;\n      this.heightChange = true;\n    } else if (this.diff && this.heightChange && this.requestType === 'virtualscroll') {\n      virtualHeight -= this.diff;\n      this.heightChange = false;\n    }\n    this.virtualEle.setVirtualHeight(virtualHeight, width);\n    if (this.virtualEle && this.virtualEle.wrapper) {\n      if (!this.parent.enableVirtualization && this.parent.enableColumnVirtualization) {\n        this.virtualEle.wrapper.style.minHeight = '';\n      } else {\n        this.virtualEle.wrapper.style.minHeight = !isNullOrUndefined(virtualHeight) ? formatUnit(this.parent.height) : '0px';\n      }\n    }\n    if (this.parent.enableColumnVirtualization) {\n      this.header.virtualEle.setVirtualHeight(1, width);\n    }\n  };\n  VirtualContentRenderer.prototype.getPageFromTop = function (sTop, info) {\n    var _this = this;\n    var total = isGroupAdaptive(this.parent) ? this.getGroupedTotalBlocks() : this.getTotalBlocks();\n    var page = 0;\n    this.offsetKeys.some(function (offset) {\n      var iOffset = Number(offset);\n      var border = sTop <= _this.offsets[\"\" + offset] || iOffset === total && sTop > _this.offsets[\"\" + offset];\n      if (border) {\n        if (_this.offsetKeys.length % 2 !== 0 && iOffset.toString() === _this.offsetKeys[_this.offsetKeys.length - 2] && sTop <= _this.offsets[_this.offsetKeys.length - 1]) {\n          iOffset = iOffset + 1;\n        }\n        info.block = iOffset % 2 === 0 ? 1 : 0;\n        page = Math.max(1, Math.min(_this.vgenerator.getPage(iOffset), _this.maxPage));\n      }\n      return border;\n    });\n    return page;\n  };\n  VirtualContentRenderer.prototype.getTranslateY = function (sTop, cHeight, info, isOnenter) {\n    if (info === undefined) {\n      info = {\n        page: this.getPageFromTop(sTop, {})\n      };\n      info.blockIndexes = this.vgenerator.getBlockIndexes(info.page);\n    }\n    var block = (info.blockIndexes[0] || 1) - 1;\n    var translate = this.getOffset(block);\n    var endTranslate = this.getOffset(info.blockIndexes[info.blockIndexes.length - 1]);\n    if (isOnenter) {\n      info = this.prevInfo;\n    }\n    var result = translate > sTop ? this.getOffset(block - 1) : endTranslate < sTop + cHeight ? this.getOffset(block + 1) : translate;\n    var blockHeight = this.offsets[info.blockIndexes[info.blockIndexes.length - 1]] - this.tmpOffsets[info.blockIndexes[0]];\n    var totalBlocks = isGroupAdaptive(this.parent) ? this.getGroupedTotalBlocks() : this.getTotalBlocks();\n    if (result + blockHeight > this.offsets[parseInt(totalBlocks.toString(), 10)]) {\n      result -= result + blockHeight - this.offsets[parseInt(totalBlocks.toString(), 10)];\n    }\n    if (!this.parent.enableVirtualization && this.parent.enableColumnVirtualization) {\n      result = 0;\n    }\n    return result;\n  };\n  VirtualContentRenderer.prototype.getOffset = function (block) {\n    return Math.min(this.offsets[parseInt(block.toString(), 10)] | 0, this.offsets[this.maxBlock] | 0);\n  };\n  VirtualContentRenderer.prototype.onEntered = function () {\n    var _this = this;\n    return function (element, current, direction, e, isWheel, check) {\n      if ((direction === 'down' || direction === 'up') && !_this.parent.enableVirtualization && _this.parent.enableColumnVirtualization) {\n        return;\n      }\n      if (Browser.isIE && !isWheel && check && !_this.preventEvent && !_this.parent.enableVirtualMaskRow) {\n        _this.parent.showSpinner();\n      }\n      if (_this.parent.enableVirtualMaskRow && !_this.preventEvent) {\n        var firstOffSetKey = parseInt(_this.offsetKeys[0], 10);\n        var lastOffSetKey = parseInt(_this.offsetKeys[_this.offsetKeys.length - 1], 10);\n        var blockIndex = _this.currentInfo.blockIndexes;\n        if (!(blockIndex && blockIndex[0] === firstOffSetKey && direction === 'up' || blockIndex && blockIndex[blockIndex.length - 1] === lastOffSetKey && direction === 'down')) {\n          setTimeout(function () {\n            _this.parent.showMaskRow(current.axis);\n          }, 0);\n        }\n      }\n      _this.prevInfo = _this.prevInfo || _this.vgenerator.getData();\n      var xAxis = current.axis === 'X';\n      var top = _this.prevInfo.offsets ? _this.prevInfo.offsets.top : null;\n      var height = _this.content.getBoundingClientRect().height;\n      var x = _this.getColumnOffset(xAxis ? _this.vgenerator.getColumnIndexes()[0] - 1 : _this.prevInfo.columnIndexes[0] - 1);\n      if (xAxis) {\n        var idx = Object.keys(_this.vgenerator.cOffsets).length - _this.prevInfo.columnIndexes.length;\n        var maxLeft = _this.vgenerator.cOffsets[idx - 1];\n        x = x > maxLeft ? maxLeft : x; //TODO: This fix horizontal scrollbar jumping issue in column virtualization.\n      }\n      if (!_this.parent.enableVirtualization && _this.parent.enableColumnVirtualization) {\n        _this.virtualEle.adjustTable(x, 0);\n      } else {\n        var y = _this.getTranslateY(e.top, height, xAxis && top === e.top ? _this.prevInfo : undefined, true);\n        _this.virtualEle.adjustTable(x, Math.min(y, _this.offsets[_this.maxBlock]));\n      }\n      if (_this.parent.enableColumnVirtualization) {\n        _this.header.virtualEle.adjustTable(x, 0);\n        if (_this.parent.isFrozenGrid()) {\n          _this.resetStickyLeftPos(x);\n        }\n      }\n    };\n  };\n  VirtualContentRenderer.prototype.dataBound = function () {\n    this.parent.notify(events.refreshVirtualFrozenHeight, {});\n    if (this.isSelection && this.activeKey !== 'upArrow' && this.activeKey !== 'downArrow') {\n      this.parent.selectRow(this.selectedRowIndex);\n    } else {\n      this.activeKey = this.empty;\n    }\n  };\n  VirtualContentRenderer.prototype.resetStickyLeftPos = function (valueX, newChild) {\n    var cells = [].slice.call(this.parent.getHeaderContent().querySelectorAll('.e-leftfreeze,.e-rightfreeze,.e-fixedfreeze')).concat([].slice.call((newChild ? newChild : this.parent.getContent()).querySelectorAll('.e-leftfreeze,.e-rightfreeze,.e-fixedfreeze')));\n    var frzLeftWidth = 0;\n    var frzRightWidth = 0;\n    if (this.parent.getHeaderContent().querySelectorAll('.e-fixedfreeze').length) {\n      frzLeftWidth = this.parent.leftrightColumnWidth('left');\n      frzRightWidth = this.parent.leftrightColumnWidth('right');\n    }\n    if (cells.length) {\n      for (var i = 0; i < cells.length; i++) {\n        var cell = cells[parseInt(i.toString(), 10)];\n        var col = void 0;\n        if (cell.classList.contains('e-rowcell')) {\n          if (isNullOrUndefined(cell.getAttribute('data-colindex')) && cell.querySelector('[e-mappinguid]')) {\n            var uid = cell.querySelector('[e-mappinguid]').getAttribute('e-mappinguid');\n            col = this.parent.getColumnByUid(uid);\n          } else {\n            var idx = parseInt(cell.getAttribute('data-colindex'), 10);\n            col = this.parent.getColumnByIndex(parseInt(idx.toString(), 10));\n          }\n        } else {\n          if (cell.classList.contains('e-headercell') || cell.classList.contains('e-filterbarcell')) {\n            var uid = cell.classList.contains('e-filterbarcell') ? cell.getAttribute('e-mappinguid') : cell.querySelector('[e-mappinguid]').getAttribute('e-mappinguid');\n            col = this.parent.getColumnByUid(uid);\n          }\n        }\n        if (col.freeze === 'Left') {\n          cell.style.left = col.valueX - valueX + 'px';\n        } else if (col.freeze === 'Right') {\n          cell.style.right = col.valueX + valueX + 'px';\n        } else if (col.freeze === 'Fixed') {\n          cell.style.left = frzLeftWidth - valueX + 'px';\n          cell.style.right = frzRightWidth + valueX + 'px';\n        }\n      }\n    }\n    this.parent.translateX = valueX;\n  };\n  VirtualContentRenderer.prototype.rowSelected = function (args, isSelection) {\n    if ((this.isSelection || isSelection) && !this.isLastBlockRow(args.rowIndex)) {\n      var transform = getTransformValues(this.content.firstElementChild);\n      var gridTop = this.parent.element.getBoundingClientRect().top;\n      var rowTop = args.row.getBoundingClientRect().top - gridTop;\n      var height = this.content.getBoundingClientRect().height;\n      var isBottom = height < rowTop;\n      var remainHeight = isBottom ? rowTop - height : this.initialRowTop - rowTop;\n      var translateY = isBottom ? transform.height - remainHeight : transform.height + remainHeight;\n      this.virtualEle.adjustTable(transform.width, translateY);\n      var lastRowTop = this.content.querySelector('tbody').lastElementChild.getBoundingClientRect().top - gridTop;\n      if (lastRowTop < height) {\n        translateY = translateY + (height - (args.row.getBoundingClientRect().top - gridTop));\n        this.virtualEle.adjustTable(transform.width, translateY - this.parent.getRowHeight() / 2);\n      }\n      if (this.parent.enableColumnVirtualization && this.parent.isFrozenGrid()) {\n        this.resetStickyLeftPos(transform.width);\n      }\n    }\n    this.isSelection = false;\n  };\n  VirtualContentRenderer.prototype.isLastBlockRow = function (index) {\n    var scrollEle = this.parent.getContent().firstElementChild;\n    var visibleRowCount = Math.floor(scrollEle.offsetHeight / this.parent.getRowHeight()) - 1;\n    var startIdx = this.maxPage * this.parent.pageSettings.pageSize - visibleRowCount;\n    return index >= startIdx;\n  };\n  VirtualContentRenderer.prototype.refreshMaxPage = function () {\n    if (this.parent.groupSettings.columns.length && this.parent.vcRows.length) {\n      this.maxPage = Math.ceil(this.parent.vcRows.length / this.parent.pageSettings.pageSize);\n    }\n  };\n  VirtualContentRenderer.prototype.setVirtualPageQuery = function (args) {\n    var row = this.parent.getContent().querySelector('.e-row');\n    if (row && this.parent.isManualRefresh && this.currentInfo.blockIndexes && this.currentInfo.blockIndexes.length === 3) {\n      this.vgenerator.startIndex = parseInt(row.getAttribute('data-rowindex'), 10);\n      this.vgenerator.currentInfo = extend({}, this.currentInfo);\n      this.vgenerator.currentInfo.blockIndexes = this.currentInfo.blockIndexes.slice();\n      var includePrevPage = this.vgenerator.includePrevPage = this.currentInfo.blockIndexes[0] % 2 === 0;\n      if (includePrevPage) {\n        this.vgenerator.startIndex = this.vgenerator.startIndex - this.getBlockSize();\n        this.vgenerator.currentInfo.blockIndexes.unshift(this.currentInfo.blockIndexes[0] - 1);\n      } else {\n        this.vgenerator.currentInfo.blockIndexes.push(this.currentInfo.blockIndexes[this.currentInfo.blockIndexes.length - 1] + 1);\n      }\n      var skip = (this.vgenerator.currentInfo.blockIndexes[0] - 1) * this.getBlockSize();\n      var take = this.vgenerator.currentInfo.blockIndexes.length * this.getBlockSize();\n      args.query.skip(skip);\n      args.query.take(take);\n      args.skipPage = true;\n    }\n  };\n  VirtualContentRenderer.prototype.eventListener = function (action) {\n    var _this = this;\n    this.parent[\"\" + action](dataReady, this.onDataReady, this);\n    this.parent.addEventListener(events.dataBound, this.dataBound.bind(this));\n    this.parent.addEventListener(events.actionBegin, this.actionBegin.bind(this));\n    this.parent.addEventListener(events.actionComplete, this.actionComplete.bind(this));\n    this.parent.addEventListener(events.rowSelected, this.rowSelected.bind(this));\n    this.parent[\"\" + action](refreshVirtualBlock, this.refreshContentRows, this);\n    this.parent[\"\" + action](events.refreshVirtualLazyLoadCache, this.refreshVirtualLazyLoadCache, this);\n    this.parent[\"\" + action](events.selectVirtualRow, this.selectVirtualRow, this);\n    this.parent[\"\" + action](events.virtaulCellFocus, this.virtualCellFocus, this);\n    this.parent[\"\" + action](events.virtualScrollEditActionBegin, this.editActionBegin, this);\n    this.parent[\"\" + action](events.virtualScrollAddActionBegin, this.addActionBegin, this);\n    this.parent[\"\" + action](events.virtualScrollEdit, this.restoreEdit, this);\n    this.parent[\"\" + action](events.virtualScrollEditSuccess, this.editSuccess, this);\n    this.parent[\"\" + action](events.refreshVirtualCache, this.refreshCache, this);\n    this.parent[\"\" + action](events.editReset, this.resetIsedit, this);\n    this.parent[\"\" + action](events.getVirtualData, this.getVirtualData, this);\n    this.parent[\"\" + action](events.virtualScrollEditCancel, this.editCancel, this);\n    this.parent[\"\" + action](events.refreshVirtualMaxPage, this.refreshMaxPage, this);\n    this.parent[\"\" + action](events.setVirtualPageQuery, this.setVirtualPageQuery, this);\n    this.parent[\"\" + action](events.selectRowOnContextOpen, this.selectRowOnContextOpen, this);\n    this.parent[\"\" + action](events.resetVirtualFocus, this.resetVirtualFocus, this);\n    this.parent[\"\" + action](events.refreshVirtualEditFormCells, this.refreshCells, this);\n    this.parent[\"\" + action](events.scrollToEdit, this.scrollToEdit, this);\n    var event = this.actions;\n    for (var i = 0; i < event.length; i++) {\n      this.parent[\"\" + action](event[parseInt(i.toString(), 10)] + \"-begin\", this.onActionBegin, this);\n    }\n    var fn = function () {\n      _this.observer.observe(function (scrollArgs) {\n        return _this.scrollListener(scrollArgs);\n      }, _this.onEntered());\n      var gObj = _this.parent;\n      if (gObj.enablePersistence && gObj.scrollPosition) {\n        _this.content.scrollTop = gObj.scrollPosition.top;\n        var scrollValues = {\n          direction: 'down',\n          sentinel: _this.observer.sentinelInfo.down,\n          offset: gObj.scrollPosition,\n          focusElement: gObj.element\n        };\n        _this.scrollListener(scrollValues);\n        if (gObj.enableColumnVirtualization) {\n          _this.content.scrollLeft = gObj.scrollPosition.left;\n        }\n      }\n      _this.parent.off(contentReady, fn);\n    };\n    this.parent.on(contentReady, fn, this);\n  };\n  VirtualContentRenderer.prototype.refreshVirtualLazyLoadCache = function (e) {\n    var blockIndex = this.currentInfo.blockIndexes;\n    if (isNullOrUndefined(this.currentInfo.blockIndexes)) {\n      blockIndex = [1, 2];\n    }\n    var block;\n    var index;\n    var cache;\n    for (var i = 0; i < blockIndex.length; i++) {\n      var rows = this.vgenerator.cache[blockIndex[parseInt(i.toString(), 10)]];\n      for (var j = 0; j < rows.length; j++) {\n        if (rows[parseInt(j.toString(), 10)].uid === e.uid) {\n          block = blockIndex[parseInt(i.toString(), 10)];\n          index = j;\n          cache = rows;\n          break;\n        }\n      }\n    }\n    if (e.count) {\n      this.vgenerator.cache[parseInt(block.toString(), 10)].splice(index + 1, e.count);\n    } else if (e.rows && e.rows.length) {\n      this.vgenerator.cache[parseInt(block.toString(), 10)] = [].slice.call(cache.slice(0, index + 1)).concat([].slice.call(e.rows)).concat([].slice.call(cache.slice(index + 1, cache.length)));\n    }\n    this.refreshOffsets();\n  };\n  VirtualContentRenderer.prototype.scrollToEdit = function (col) {\n    var allowScroll = true;\n    this.validationCheck = true;\n    if (this.isAdd && this.content.scrollTop > 0) {\n      allowScroll = false;\n      var keys = Object.keys(this.offsets);\n      this.content.scrollTop = this.parent.editSettings.newRowPosition === 'Top' ? 0 : this.offsets[keys.length - 1];\n    }\n    var row = this.parent.getRowByIndex(this.editedRowIndex);\n    if (!row && !isNullOrUndefined(this.editedRowIndex)) {\n      if (!row || !this.isRowInView(row)) {\n        var rowIndex = this.parent.getRowHeight();\n        var scrollTop = this.editedRowIndex * rowIndex;\n        if (!isNullOrUndefined(scrollTop)) {\n          allowScroll = false;\n          this.content.scrollTop = scrollTop;\n        }\n      }\n    }\n    if (col && allowScroll) {\n      var offset = this.vgenerator.cOffsets[col.index - this.parent.getVisibleFrozenColumns() - 1];\n      if (!this.parent.enableColumnVirtualization) {\n        var header = this.parent.getHeaderContent().querySelector('.e-headercelldiv[e-mappinguid=\"' + col.uid + '\"]');\n        offset = header.parentElement.offsetLeft;\n      }\n      if (this.parent.enableColumnVirtualization && this.parent.getVisibleFrozenLeftCount()) {\n        offset -= this.parent.leftrightColumnWidth('left');\n      }\n      this.content.scrollLeft = this.parent.enableRtl ? -Math.abs(offset) : offset;\n    }\n    if (col && !allowScroll) {\n      this.validationCol = col;\n    }\n  };\n  VirtualContentRenderer.prototype.refreshCells = function (rowObj) {\n    rowObj.cells = this.vgenerator.generateCells(rowObj.foreignKeyData);\n  };\n  VirtualContentRenderer.prototype.resetVirtualFocus = function (e) {\n    this.isCancel = e.isCancel;\n  };\n  /**\n   * @param {Object} data - specifies the data\n   * @param {Object} data.virtualData -specifies the data\n   * @param {boolean} data.isAdd - specifies isAdd\n   * @param {boolean} data.isCancel - specifies boolean in cancel\n   * @param {boolean} data.isScroll - specifies boolean for scroll\n   * @returns {void}\n   * @hidden\n   */\n  VirtualContentRenderer.prototype.getVirtualData = function (data) {\n    if (this.isNormaledit) {\n      var error = this.parent.element.querySelector('.e-griderror:not([style*=\"display: none\"])');\n      var keys = Object.keys(this.virtualData);\n      data.isScroll = keys.length !== 0 && this.currentInfo.sentinelInfo && this.currentInfo.sentinelInfo.axis === 'X';\n      if (error) {\n        return;\n      }\n      this.virtualData = keys.length ? this.virtualData : data.virtualData;\n      this.getVirtualEditedData(this.virtualData);\n      data.virtualData = this.virtualData;\n      data.isAdd = this.isAdd;\n      data.isCancel = this.isCancel;\n    }\n  };\n  VirtualContentRenderer.prototype.selectRowOnContextOpen = function (args) {\n    this.isContextMenuOpen = args.isOpen;\n  };\n  VirtualContentRenderer.prototype.editCancel = function (args) {\n    var dataIndex = getEditedDataIndex(this.parent, args.data);\n    if (!isNullOrUndefined(dataIndex)) {\n      args.data = this.parent.getCurrentViewRecords()[parseInt(dataIndex.toString(), 10)];\n    }\n  };\n  VirtualContentRenderer.prototype.editSuccess = function (args) {\n    if (this.isNormaledit) {\n      if (!this.isAdd && args.data) {\n        this.updateCurrentViewData(args.data);\n      }\n      this.isAdd = false;\n    }\n  };\n  VirtualContentRenderer.prototype.updateCurrentViewData = function (data) {\n    var dataIndex = getEditedDataIndex(this.parent, data);\n    if (!isNullOrUndefined(dataIndex)) {\n      this.parent.getCurrentViewRecords()[parseInt(dataIndex.toString(), 10)] = data;\n    }\n  };\n  VirtualContentRenderer.prototype.actionBegin = function (args) {\n    if (args.requestType !== 'virtualscroll') {\n      this.requestType = args.requestType;\n    }\n    if (!args.cancel) {\n      this.parent.notify(events.refreshVirtualFrozenRows, args);\n    }\n  };\n  VirtualContentRenderer.prototype.virtualCellFocus = function (e) {\n    // To decide the action (select or scroll), when using arrow keys for cell focus\n    var ele = document.activeElement;\n    if (!ele.classList.contains(literals.rowCell) && (ele instanceof HTMLInputElement || !isNullOrUndefined(ele.closest('.e-templatecell')))) {\n      ele = ele.closest('.e-rowcell');\n    }\n    if (ele && ele.classList.contains(literals.rowCell) && e && (e.action === 'upArrow' || e.action === 'downArrow')) {\n      var rowIndex = parseInt(ele.parentElement.getAttribute(literals.dataRowIndex), 10);\n      if (e && (e.action === 'downArrow' || e.action === 'upArrow')) {\n        var scrollEle = this.parent.getContent().firstElementChild;\n        if (e.action === 'downArrow') {\n          rowIndex += 1;\n        } else {\n          rowIndex -= 1;\n        }\n        this.rowIndex = rowIndex;\n        this.cellIndex = parseInt(ele.getAttribute(literals.dataColIndex), 10);\n        var row = this.parent.getRowByIndex(rowIndex);\n        var page = this.parent.pageSettings.currentPage;\n        var visibleRowCount = Math.floor(scrollEle.offsetHeight / this.parent.getRowHeight()) - 1;\n        var emptyRow = false;\n        if (isNullOrUndefined(row)) {\n          emptyRow = true;\n          if (e.action === 'downArrow' && page === this.maxPage - 1 || e.action === 'upArrow' && page === 1) {\n            emptyRow = false;\n          }\n        }\n        if (emptyRow || ensureLastRow(row, this.parent) && e.action === 'downArrow' || ensureFirstRow(row, this.parent.getRowHeight() * 2) && e.action === 'upArrow') {\n          this.activeKey = e.action;\n          scrollEle.scrollTop = e.action === 'downArrow' ? (rowIndex - visibleRowCount) * this.parent.getRowHeight() : rowIndex * this.parent.getRowHeight();\n        } else {\n          this.activeKey = this.empty;\n        }\n        if (!this.parent.selectionSettings.checkboxOnly) {\n          this.parent.selectRow(rowIndex);\n        }\n      }\n    }\n  };\n  VirtualContentRenderer.prototype.editActionBegin = function (e) {\n    this.editedRowIndex = e.index;\n    var rowData = !this.parent.enableVirtualization && this.parent.enableColumnVirtualization ? extend({}, this.parent.getCurrentViewRecords()[e.index]) : extend({}, this.getRowObjectByIndex(e.index));\n    var keys = Object.keys(this.virtualData);\n    e.data = keys.length ? this.virtualData : rowData;\n    e.isScroll = keys.length !== 0 && this.currentInfo.sentinelInfo && this.currentInfo.sentinelInfo.axis === 'X';\n  };\n  VirtualContentRenderer.prototype.getEditedRowObject = function () {\n    var rowObjects = this.parent.vcRows;\n    var editedrow;\n    for (var i = 0; i < rowObjects.length; i++) {\n      if (rowObjects[parseInt(i.toString(), 10)].index === this.editedRowIndex) {\n        editedrow = rowObjects[parseInt(i.toString(), 10)];\n      }\n    }\n    return editedrow;\n  };\n  VirtualContentRenderer.prototype.refreshCache = function (args) {\n    var block = Math.ceil((this.editedRowIndex + 1) / this.getBlockSize());\n    if (this.parent.allowPaging && this.parent.enableColumnVirtualization) {\n      block = Math.ceil((this.editedRowIndex + 1 + (this.parent.pageSettings.currentPage - 1) * this.parent.pageSettings.pageSize) / this.getBlockSize());\n    }\n    var index = this.parent.allowPaging && this.parent.enableColumnVirtualization ? this.editedRowIndex % this.getBlockSize() : this.editedRowIndex - (block - 1) * this.getBlockSize();\n    if (this.parent.groupSettings.columns.length) {\n      this.getEditedRowObject().data = args.data;\n    } else {\n      this.vgenerator.cache[parseInt(block.toString(), 10)][parseInt(index.toString(), 10)].data = args.data;\n    }\n  };\n  VirtualContentRenderer.prototype.actionComplete = function (args) {\n    if (!(this.parent.enableVirtualization || this.parent.enableColumnVirtualization)) {\n      return;\n    }\n    var editRequestTypes = ['delete', 'save', 'cancel'];\n    var dataActionRequestTypes = ['sorting', 'filtering', 'grouping', 'refresh', 'searching', 'ungrouping', 'reorder'];\n    if (editRequestTypes.some(function (value) {\n      return value === args.requestType;\n    })) {\n      this.refreshOffsets();\n      this.refreshVirtualElement();\n    }\n    if (this.isNormaledit && (dataActionRequestTypes.some(function (value) {\n      return value === args.requestType;\n    }) || editRequestTypes.some(function (value) {\n      return value === args.requestType;\n    }))) {\n      this.isCancel = true;\n      this.isAdd = false;\n      this.editedRowIndex = this.empty;\n      this.virtualData = {};\n      if (this.parent.editModule) {\n        this.parent.editModule.editModule.previousData = undefined;\n      }\n    }\n    if (this.parent.enableColumnVirtualization && args.requestType === 'filterAfterOpen' && this.currentInfo.columnIndexes && this.currentInfo.columnIndexes[0] > 0) {\n      this.parent.resetFilterDlgPosition(args.columnName);\n    }\n  };\n  VirtualContentRenderer.prototype.resetIsedit = function () {\n    if (this.parent.enableVirtualization && this.isNormaledit) {\n      if (this.parent.editSettings.allowEditing && Object.keys(this.virtualData).length || this.parent.editSettings.allowAdding && this.isAdd) {\n        this.parent.isEdit = true;\n      }\n    }\n  };\n  VirtualContentRenderer.prototype.scrollAfterEdit = function () {\n    if (this.parent.editModule && this.parent.editSettings.allowEditing && this.isNormaledit) {\n      if (this.parent.element.querySelector('.e-gridform')) {\n        var editForm = this.parent.element.querySelector('.' + literals.editedRow);\n        var addForm = this.parent.element.querySelector('.' + literals.addedRow);\n        if (editForm || addForm) {\n          var rowData = editForm ? extend({}, this.getRowObjectByIndex(this.editedRowIndex)) : extend({}, this.emptyRowData);\n          var keys = Object.keys(this.virtualData);\n          this.virtualData = keys.length ? this.getVirtualEditedData(this.virtualData) : this.getVirtualEditedData(rowData);\n        }\n      }\n    }\n  };\n  VirtualContentRenderer.prototype.createEmptyRowdata = function () {\n    var _this = this;\n    this.parent.columnModel.filter(function (e) {\n      _this.emptyRowData[e.field] = _this.empty;\n    });\n  };\n  VirtualContentRenderer.prototype.addActionBegin = function (args) {\n    if (this.isNormaledit) {\n      if (!Object.keys(this.emptyRowData).length) {\n        this.createEmptyRowdata();\n      }\n      this.isAdd = true;\n      var page = this.parent.pageSettings.currentPage;\n      if (!this.parent.frozenRows && this.content.scrollTop > 0 && this.parent.editSettings.newRowPosition === 'Top') {\n        this.isAdd = true;\n        this.onActionBegin();\n        args.startEdit = false;\n        this.content.scrollTop = 0;\n      }\n      if (page < this.maxPage - 1 && this.parent.editSettings.newRowPosition === 'Bottom') {\n        this.isAdd = true;\n        this.parent.setProperties({\n          pageSettings: {\n            currentPage: this.maxPage - 1\n          }\n        }, true);\n        args.startEdit = false;\n        this.content.scrollTop = this.offsets[this.offsetKeys.length];\n      }\n    }\n  };\n  /**\n   * @param {number} index - specifies the index\n   * @returns {Object} returns the object\n   * @hidden\n   */\n  VirtualContentRenderer.prototype.getRowObjectByIndex = function (index) {\n    var data = this.getRowCollection(index, true);\n    return data;\n  };\n  VirtualContentRenderer.prototype.getBlockSize = function () {\n    return this.parent.pageSettings.pageSize >> 1;\n  };\n  VirtualContentRenderer.prototype.getBlockHeight = function () {\n    return this.getBlockSize() * this.parent.getRowHeight();\n  };\n  VirtualContentRenderer.prototype.isEndBlock = function (index) {\n    var totalBlocks = isGroupAdaptive(this.parent) ? this.getGroupedTotalBlocks() : this.getTotalBlocks();\n    return index >= totalBlocks || index === totalBlocks - 1;\n  };\n  VirtualContentRenderer.prototype.getGroupedTotalBlocks = function () {\n    var rows = this.parent.vcRows;\n    return Math.floor(rows.length / this.getBlockSize() < 1 ? 1 : rows.length / this.getBlockSize());\n  };\n  VirtualContentRenderer.prototype.getTotalBlocks = function () {\n    return Math.ceil(this.count / this.getBlockSize());\n  };\n  VirtualContentRenderer.prototype.getColumnOffset = function (block) {\n    return this.vgenerator.cOffsets[parseInt(block.toString(), 10)] | 0;\n  };\n  VirtualContentRenderer.prototype.getModelGenerator = function () {\n    return new VirtualRowModelGenerator(this.parent);\n  };\n  VirtualContentRenderer.prototype.resetScrollPosition = function (action) {\n    if (this.actions.some(function (value) {\n      return value === action;\n    })) {\n      this.preventEvent = this.content.scrollTop !== 0;\n      this.content.scrollTop = 0;\n    }\n    if (action !== 'virtualscroll') {\n      this.isAdd = false;\n    }\n  };\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  VirtualContentRenderer.prototype.onActionBegin = function (e) {\n    //Update property silently..\n    this.parent.setProperties({\n      pageSettings: {\n        currentPage: 1\n      }\n    }, true);\n  };\n  VirtualContentRenderer.prototype.getRows = function () {\n    return this.vgenerator.getRows();\n  };\n  VirtualContentRenderer.prototype.getRowByIndex = function (index) {\n    var row;\n    if (isGroupAdaptive(this.parent)) {\n      if (!isNullOrUndefined(index) && this.parent.enableVirtualization && this.parent.groupSettings.columns.length) {\n        for (var i = 0; i < this.parent.getDataRows().length; i++) {\n          if (this.parent.getDataRows()[parseInt(i.toString(), 10)].getAttribute(literals.dataRowIndex) === index.toString()) {\n            row = this.parent.getDataRows()[parseInt(i.toString(), 10)];\n          }\n        }\n      } else {\n        row = !isNullOrUndefined(index) ? this.parent.getDataRows()[parseInt(index.toString(), 10)] : undefined;\n      }\n    } else if (!this.parent.enableVirtualization && this.parent.enableColumnVirtualization) {\n      row = !isNullOrUndefined(index) ? this.parent.getDataRows()[parseInt(index.toString(), 10)] : undefined;\n    } else if (this.prevInfo) {\n      row = this.getRowCollection(index, false);\n    }\n    return row;\n  };\n  VirtualContentRenderer.prototype.getMovableVirtualRowByIndex = function (index) {\n    return this.getRowCollection(index, false);\n  };\n  VirtualContentRenderer.prototype.getFrozenRightVirtualRowByIndex = function (index) {\n    return this.getRowCollection(index, false);\n  };\n  VirtualContentRenderer.prototype.getRowCollection = function (index, isRowObject) {\n    var prev = this.prevInfo.blockIndexes;\n    var startIdx = (prev[0] - 1) * this.getBlockSize();\n    if (this.parent.pageSettings.pageSize % 2 !== 0) {\n      startIdx += Math.floor(startIdx / this.getBlockSize() / 2);\n    }\n    var rowCollection = this.parent.getDataRows();\n    rowCollection = rowCollection;\n    var collection = isRowObject ? this.parent.getCurrentViewRecords() : rowCollection;\n    if (isRowObject && this.parent.allowGrouping && this.parent.groupSettings.columns.length) {\n      startIdx = parseInt(this.parent.getRows()[0].getAttribute(literals.dataRowIndex), 10);\n      collection = collection.filter(function (m) {\n        return isNullOrUndefined(m.items);\n      });\n    }\n    var selectedRow = collection[index - startIdx];\n    if (this.parent.frozenRows && this.parent.pageSettings.currentPage > 1) {\n      if (!isRowObject) {\n        selectedRow = index <= this.parent.frozenRows ? rowCollection[parseInt(index.toString(), 10)] : rowCollection[index - startIdx + this.parent.frozenRows];\n      } else {\n        selectedRow = index <= this.parent.frozenRows ? this.parent.getRowsObject()[parseInt(index.toString(), 10)].data : selectedRow;\n      }\n    }\n    return selectedRow;\n  };\n  VirtualContentRenderer.prototype.getVirtualRowIndex = function (index) {\n    var prev = this.prevInfo.blockIndexes;\n    var startIdx = (prev[0] - 1) * this.getBlockSize();\n    if (this.parent.enableVirtualization && this.parent.allowGrouping && this.parent.groupSettings.columns.length) {\n      var vGroupedRows = this.vgenerator.cache[prev[0]];\n      for (var i = 0; i < vGroupedRows.length; i++) {\n        if (vGroupedRows[\"\" + i].isDataRow) {\n          startIdx = vGroupedRows[\"\" + i].index;\n          break;\n        }\n      }\n    }\n    return startIdx + index;\n  };\n  /**\n   * @returns {void}\n   * @hidden */\n  VirtualContentRenderer.prototype.refreshOffsets = function () {\n    var gObj = this.parent;\n    var row = 0;\n    var bSize = this.getBlockSize();\n    var total = isGroupAdaptive(this.parent) ? this.getGroupedTotalBlocks() : this.getTotalBlocks();\n    this.prevHeight = this.offsets[parseInt(total.toString(), 10)];\n    this.maxBlock = total % 2 === 0 ? total - 2 : total - 1;\n    this.offsets = {};\n    //Row offset update\n    // eslint-disable-next-line prefer-spread\n    var blocks = Array.apply(null, Array(total)).map(function () {\n      return ++row;\n    });\n    for (var i = 0; i < blocks.length; i++) {\n      var tmp = (this.vgenerator.cache[blocks[parseInt(i.toString(), 10)]] || []).length;\n      var rem = !isGroupAdaptive(this.parent) ? this.count % bSize : gObj.vcRows.length % bSize;\n      var size = !isGroupAdaptive(this.parent) && blocks[parseInt(i.toString(), 10)] in this.vgenerator.cache ? tmp * this.parent.getRowHeight() : rem && blocks[parseInt(i.toString(), 10)] === total ? rem * this.parent.getRowHeight() : this.getBlockHeight();\n      // let size: number = this.parent.groupSettings.columns.length && block in this.vgenerator.cache ?\n      // tmp * getRowHeight() : this.getBlockHeight();\n      this.offsets[blocks[parseInt(i.toString(), 10)]] = (this.offsets[blocks[parseInt(i.toString(), 10)] - 1] | 0) + size;\n      this.tmpOffsets[blocks[parseInt(i.toString(), 10)]] = this.offsets[blocks[parseInt(i.toString(), 10)] - 1] | 0;\n    }\n    this.offsetKeys = Object.keys(this.offsets);\n    if (isGroupAdaptive(this.parent)) {\n      this.parent.vGroupOffsets = this.offsets;\n    }\n    //Column offset update\n    if (this.parent.enableColumnVirtualization) {\n      this.vgenerator.refreshColOffsets();\n    }\n  };\n  VirtualContentRenderer.prototype.refreshVirtualElement = function () {\n    this.vgenerator.refreshColOffsets();\n    this.setVirtualHeight();\n  };\n  VirtualContentRenderer.prototype.setVisible = function (columns) {\n    var gObj = this.parent;\n    var rows = [];\n    rows = this.getRows();\n    var testRow;\n    rows.some(function (r) {\n      if (r.isDataRow) {\n        testRow = r;\n      }\n      return r.isDataRow;\n    });\n    var isRefresh = true;\n    if (!gObj.groupSettings.columns.length && testRow) {\n      isRefresh = false;\n    }\n    var tr = gObj.getDataRows();\n    for (var c = 0, clen = columns.length; c < clen; c++) {\n      var column = columns[parseInt(c.toString(), 10)];\n      var idx = gObj.getNormalizedColumnIndex(column.uid);\n      var displayVal = column.visible === true ? '' : 'none';\n      var colGrp = this.getColGroup().children;\n      if (idx !== -1 && testRow && idx < testRow.cells.length) {\n        setStyleAttribute(colGrp[parseInt(idx.toString(), 10)], {\n          'display': displayVal\n        });\n      }\n      if (!isRefresh) {\n        var width = void 0;\n        if (column.width) {\n          if (column.visible) {\n            width = this.virtualEle.wrapper.offsetWidth + parseInt(column.width.toString(), 10);\n          } else {\n            width = this.virtualEle.wrapper.offsetWidth - parseInt(column.width.toString(), 10);\n          }\n        }\n        if (width > gObj.width) {\n          this.setDisplayNone(tr, idx, displayVal, rows);\n          if (this.parent.enableColumnVirtualization) {\n            this.virtualEle.setWrapperWidth(width + '');\n          }\n          this.refreshVirtualElement();\n        } else {\n          isRefresh = true;\n        }\n      }\n      if (!this.parent.invokedFromMedia && column.hideAtMedia) {\n        this.parent.updateMediaColumns(column);\n      }\n      this.parent.invokedFromMedia = false;\n    }\n    if (isRefresh) {\n      this.refreshContentRows({\n        requestType: 'refresh'\n      });\n    } else {\n      this.parent.notify(events.partialRefresh, {\n        rows: rows,\n        args: {\n          isFrozen: false,\n          rows: rows\n        }\n      });\n    }\n  };\n  VirtualContentRenderer.prototype.selectVirtualRow = function (args) {\n    var _this = this;\n    args.isAvailable = args.selectedIndex < this.count;\n    if (args.isAvailable && !this.isContextMenuOpen && this.activeKey !== 'upArrow' && this.activeKey !== 'downArrow' && !this.isSelection && !this.requestTypes.some(function (value) {\n      return value === _this.requestType;\n    }) && !this.parent.selectionModule.isInteracted) {\n      var selectedRow = this.parent.getRowByIndex(args.selectedIndex);\n      var rowHeight = this.parent.getRowHeight();\n      if (!selectedRow || !this.isRowInView(selectedRow)) {\n        this.isSelection = true;\n        this.selectedRowIndex = args.selectedIndex;\n        var scrollTop = (args.selectedIndex + 1) * rowHeight;\n        if (!isNullOrUndefined(scrollTop)) {\n          var direction = this.content.scrollTop < scrollTop ? 'down' : 'up';\n          this.selectRowIndex = args.selectedIndex;\n          this.content.scrollTop = scrollTop;\n          this.isSelectionScroll = this.observer.check(direction);\n        }\n      }\n    }\n    this.requestType = this.empty;\n  };\n  VirtualContentRenderer.prototype.isRowInView = function (row) {\n    var top = row.getBoundingClientRect().top;\n    var bottom = row.getBoundingClientRect().bottom;\n    return top >= this.content.getBoundingClientRect().top && bottom <= this.content.getBoundingClientRect().bottom;\n  };\n  return VirtualContentRenderer;\n}(ContentRender);\nexport { VirtualContentRenderer };\n/**\n * @hidden\n */\nvar VirtualHeaderRenderer = /** @class */function (_super) {\n  __extends(VirtualHeaderRenderer, _super);\n  function VirtualHeaderRenderer(parent, locator) {\n    var _this = _super.call(this, parent, locator) || this;\n    _this.virtualEle = new VirtualElementHandler();\n    _this.isMovable = false;\n    _this.gen = new VirtualRowModelGenerator(_this.parent);\n    _this.parent.on(events.columnVisibilityChanged, _this.setVisible, _this);\n    _this.parent.on(refreshVirtualBlock, function (e) {\n      return e.virtualInfo.sentinelInfo.axis === 'X' ? _this.refreshUI() : null;\n    }, _this);\n    return _this;\n  }\n  VirtualHeaderRenderer.prototype.renderTable = function () {\n    this.gen.refreshColOffsets();\n    this.parent.setColumnIndexesInView(this.gen.getColumnIndexes(this.getPanel().querySelector('.' + literals.headerContent)));\n    _super.prototype.renderTable.call(this);\n    this.virtualEle.table = this.getTable();\n    this.virtualEle.content = this.getPanel().querySelector('.' + literals.headerContent);\n    this.virtualEle.content.style.position = 'relative';\n    this.virtualEle.renderWrapper();\n    !this.parent.enableVirtualization && this.parent.enableColumnVirtualization ? this.virtualEle.renderPlaceHolder() : this.virtualEle.renderPlaceHolder('absolute');\n  };\n  VirtualHeaderRenderer.prototype.appendContent = function (table) {\n    this.virtualEle.wrapper.appendChild(table);\n  };\n  VirtualHeaderRenderer.prototype.refreshUI = function () {\n    this.gen.refreshColOffsets();\n    this.parent.setColumnIndexesInView(this.gen.getColumnIndexes(this.getPanel().querySelector('.' + literals.headerContent)));\n    _super.prototype.refreshUI.call(this);\n  };\n  VirtualHeaderRenderer.prototype.setVisible = function (columns) {\n    var gObj = this.parent;\n    var displayVal;\n    var idx;\n    var needFullRefresh;\n    for (var c = 0, clen = columns.length; c < clen; c++) {\n      var column = columns[parseInt(c.toString(), 10)];\n      idx = gObj.getNormalizedColumnIndex(column.uid);\n      displayVal = column.visible ? '' : 'none';\n      var colGrp = this.getColGroup().children;\n      setStyleAttribute(colGrp[parseInt(idx.toString(), 10)], {\n        'display': displayVal\n      });\n      if (gObj.enableColumnVirtualization && !gObj.groupSettings.columns.length) {\n        var tablewidth = void 0;\n        if (column.visible) {\n          tablewidth = this.virtualEle.wrapper.offsetWidth + parseInt(column.width.toString(), 10);\n        } else {\n          tablewidth = this.virtualEle.wrapper.offsetWidth - parseInt(column.width.toString(), 10);\n        }\n        if (tablewidth > gObj.width) {\n          this.setDisplayNone(column, displayVal);\n          this.virtualEle.setWrapperWidth(tablewidth + '');\n          this.gen.refreshColOffsets();\n        } else {\n          needFullRefresh = true;\n        }\n      } else {\n        needFullRefresh = true;\n      }\n      if (needFullRefresh) {\n        this.refreshUI();\n      }\n    }\n  };\n  VirtualHeaderRenderer.prototype.setDisplayNone = function (col, displayVal) {\n    var table = this.getTable();\n    for (var _i = 0, _a = [].slice.apply(table.querySelectorAll('th.e-headercell')); _i < _a.length; _i++) {\n      var ele = _a[_i];\n      if (ele.querySelector('[e-mappinguid]') && ele.querySelector('[e-mappinguid]').getAttribute('e-mappinguid') === col.uid) {\n        setStyleAttribute(ele, {\n          'display': displayVal\n        });\n        if (displayVal === '') {\n          removeClass([ele], 'e-hide');\n        }\n        break;\n      }\n    }\n  };\n  return VirtualHeaderRenderer;\n}(HeaderRender);\nexport { VirtualHeaderRenderer };\n/**\n * @hidden\n */\nvar VirtualElementHandler = /** @class */function () {\n  function VirtualElementHandler() {}\n  VirtualElementHandler.prototype.renderWrapper = function (height) {\n    this.wrapper = createElement('div', {\n      className: 'e-virtualtable',\n      styles: \"min-height:\" + formatUnit(height)\n    });\n    this.wrapper.appendChild(this.table);\n    this.content.appendChild(this.wrapper);\n  };\n  VirtualElementHandler.prototype.renderPlaceHolder = function (position) {\n    if (position === void 0) {\n      position = 'relative';\n    }\n    this.placeholder = createElement('div', {\n      className: 'e-virtualtrack',\n      styles: \"position:\" + position\n    });\n    this.content.appendChild(this.placeholder);\n  };\n  VirtualElementHandler.prototype.renderFrozenWrapper = function (height) {\n    this.wrapper = createElement('div', {\n      className: 'e-virtualtable',\n      styles: \"min-height:\" + formatUnit(height) + \"; display: flex\"\n    });\n    this.content.appendChild(this.wrapper);\n  };\n  VirtualElementHandler.prototype.renderFrozenPlaceHolder = function () {\n    this.placeholder = createElement('div', {\n      className: 'e-virtualtrack'\n    });\n    this.content.appendChild(this.placeholder);\n  };\n  VirtualElementHandler.prototype.renderMovableWrapper = function (height) {\n    this.movableWrapper = createElement('div', {\n      className: 'e-virtualtable',\n      styles: \"min-height:\" + formatUnit(height)\n    });\n    this.movableContent.appendChild(this.movableWrapper);\n  };\n  VirtualElementHandler.prototype.renderMovablePlaceHolder = function () {\n    this.movablePlaceholder = createElement('div', {\n      className: 'e-virtualtrack'\n    });\n    this.movableContent.appendChild(this.movablePlaceholder);\n  };\n  VirtualElementHandler.prototype.adjustTable = function (xValue, yValue) {\n    this.wrapper.style.transform = \"translate(\" + xValue + \"px, \" + yValue + \"px)\";\n  };\n  VirtualElementHandler.prototype.adjustMovableTable = function (xValue, yValue) {\n    this.movableWrapper.style.transform = \"translate(\" + xValue + \"px, \" + yValue + \"px)\";\n  };\n  VirtualElementHandler.prototype.setMovableWrapperWidth = function (width, full) {\n    this.movableWrapper.style.width = width ? width + \"px\" : full ? '100%' : '';\n  };\n  VirtualElementHandler.prototype.setMovableVirtualHeight = function (height, width) {\n    this.movablePlaceholder.style.height = height + \"px\";\n    this.movablePlaceholder.style.width = width;\n  };\n  VirtualElementHandler.prototype.setWrapperWidth = function (width, full) {\n    if (width && width.indexOf('%') === -1 && !(this.content.getBoundingClientRect().width < parseInt(width))) {\n      width = undefined;\n      full = true;\n    }\n    this.wrapper.style.width = width ? width + \"px\" : full ? '100%' : '';\n  };\n  VirtualElementHandler.prototype.setVirtualHeight = function (height, width) {\n    this.placeholder.style.height = !isNullOrUndefined(height) ? height + \"px\" : '0px';\n    if (width && width.indexOf('%') === -1 && !(this.content.getBoundingClientRect().width < parseInt(width))) {\n      width = '100%';\n    }\n    this.placeholder.style.width = width;\n  };\n  VirtualElementHandler.prototype.setFreezeWrapperWidth = function (wrapper, width, full) {\n    wrapper.style.width = width ? width + \"px\" : full ? '100%' : '';\n  };\n  return VirtualElementHandler;\n}();\nexport { VirtualElementHandler };","map":{"version":3,"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","remove","createElement","closest","formatUnit","Browser","extend","isNullOrUndefined","removeClass","DataManager","dataReady","modelChanged","refreshVirtualBlock","contentReady","events","RenderType","ContentRender","HeaderRender","InterSectionObserver","VirtualRowModelGenerator","isGroupAdaptive","ensureLastRow","ensureFirstRow","getEditedDataIndex","getTransformValues","setStyleAttribute","literals","VirtualContentRenderer","_super","parent","locator","_this","call","prevHeight","startIndex","preStartIndex","preventEvent","actions","offsets","tmpOffsets","virtualEle","VirtualElementHandler","offsetKeys","isFocused","isSelection","isBottom","diff","heightChange","isTop","empty","undefined","isCancel","requestTypes","isNormaledit","editSettings","mode","virtualData","emptyRowData","isContextMenuOpen","isSelectionScroll","validationCheck","eventListener","widthServices","getService","on","columnVisibilityChanged","setVisible","vgenerator","generator","renderTable","header","getRenderer","Header","table","getTable","content","getPanel","querySelector","renderWrapper","height","renderPlaceHolder","enableVirtualization","enableColumnVirtualization","wrapper","style","position","debounceEvent","dataSource","offline","opt","container","pageHeight","getBlockHeight","axes","observer","renderEmpty","tbody","appendChild","frozenRows","getHeaderContent","innerHTML","adjustTable","getReorderedFrozenRows","args","blockIndex","virtualInfo","blockIndexes","colsIndex","columnIndexes","page","renderMovableContent","recordslength","getCurrentViewRecords","length","firstRecords","renderModule","data","dataManager","json","slice","virtualRows","generateRows","splice","scrollListener","scrollArgs","direction","scrollAfterEdit","enablePersistence","scrollPosition","offset","isDestroyed","islazyloadRequest","removeMaskRow","document","activeElement","info","sentinel","viewInfo","currentInfo","getInfoFromView","prevInfo","toString","event","top","scrollTop","pageSettings","currentPage","enableVirtualMaskRow","showMaskRow","axis","addShimmerEffect","notify","requestType","focusElement","isIE","hideSpinner","restoreEdit","groupSettings","enableLazyLoading","setColumnIndexesInView","loadNext","loadSelf","nextInfo","getContentTable","appendContent","block","blk","isBlockAvailable","e","isBlockAdded","tempBlocks","infoType","sentinelInfo","endIndex","preEndIndex","getPageFromTop","getBlockIndexes","blocks","ensureBlocks","activeKey","newBlock","indexOf","filter","val","every","bind","Math","max","isNaN","rowIndex","firstBlock","ceil","getBlockSize","getColumnIndexes","getColumnIndexesInView","index","mIdx","old","indexes","getData","ind","isEndBlock","some","result","getGroupedTotalBlocks","getTotalBlocks","target","newChild","cBlock","cOffset","getColumnOffset","width","columns","refreshOffsets","element","vHeight","getBoundingClientRect","reduceWidth","isFrozenGrid","frzLeftWidth_1","getColumns","col","visible","parseInt","freeze","cIndex","getVisibleFrozenLeftCount","resetStickyLeftPos","value","translate","getTranslateY","allowResizing","getHeaderTable","setWrapperWidth","name","parentNode","isReact","rowTemplate","attrs","role","i","children","scrollLeft","left","sTop","setVirtualHeight","setPageHeight","getOffset","focus","lastPage","getContent","firstElementChild","autoCol","focusCell","restoreAdd","ensureSelectedRowPosition","validationScrollLeft","refreshFrozenScrollbar","initialRowTop","gridTop","getRowByIndex","validationCol","cOffsets","getVisibleFrozenColumns","editModule","editFormValidate","selectRowIndex","row","isRowInView","rowSelected","cell","cells","cellIndex","preventScroll","selectionSettings","checkboxOnly","selectRow","getAttribute","dataRowIndex","allowEditing","editedRowIndex","keys","isXaxis","editedRow","top_1","offsetHeight","getRowHeight","isEdit","startEdit","rowData","getRowObjectByIndex","getVirtualEditedData","editForms","getElementsByClassName","isFormDestroyed","formObj","getCurrentEditedData","startAdd","addedRow","isAdd","newRowPosition","maxPage","addRecord","onDataReady","count","pageSize","checkAndResetCache","resetScrollPosition","virtualHeight","placeHolderBottom","round","placeholder","bottom","wrapperBottom","minHeight","total","iOffset","Number","border","min","getPage","cHeight","isOnenter","endTranslate","blockHeight","totalBlocks","maxBlock","onEntered","current","isWheel","check","showSpinner","firstOffSetKey","lastOffSetKey","setTimeout","xAxis","x","idx","maxLeft","y","dataBound","refreshVirtualFrozenHeight","selectedRowIndex","valueX","querySelectorAll","concat","frzLeftWidth","frzRightWidth","leftrightColumnWidth","classList","contains","uid","getColumnByUid","getColumnByIndex","right","translateX","isLastBlockRow","transform","rowTop","remainHeight","translateY","lastRowTop","lastElementChild","scrollEle","visibleRowCount","floor","startIdx","refreshMaxPage","vcRows","setVirtualPageQuery","isManualRefresh","includePrevPage","unshift","push","skip","take","query","skipPage","action","addEventListener","actionBegin","actionComplete","refreshContentRows","refreshVirtualLazyLoadCache","selectVirtualRow","virtaulCellFocus","virtualCellFocus","virtualScrollEditActionBegin","editActionBegin","virtualScrollAddActionBegin","addActionBegin","virtualScrollEdit","virtualScrollEditSuccess","editSuccess","refreshVirtualCache","refreshCache","editReset","resetIsedit","getVirtualData","virtualScrollEditCancel","editCancel","refreshVirtualMaxPage","selectRowOnContextOpen","resetVirtualFocus","refreshVirtualEditFormCells","refreshCells","scrollToEdit","onActionBegin","fn","observe","gObj","scrollValues","down","off","cache","rows","j","allowScroll","parentElement","offsetLeft","enableRtl","abs","rowObj","generateCells","foreignKeyData","error","isScroll","isOpen","dataIndex","updateCurrentViewData","cancel","refreshVirtualFrozenRows","ele","rowCell","HTMLInputElement","dataColIndex","emptyRow","getEditedRowObject","rowObjects","editedrow","allowPaging","editRequestTypes","dataActionRequestTypes","refreshVirtualElement","previousData","resetFilterDlgPosition","columnName","allowAdding","editForm","addForm","createEmptyRowdata","columnModel","field","setProperties","getRowCollection","getModelGenerator","getRows","getDataRows","getMovableVirtualRowByIndex","getFrozenRightVirtualRowByIndex","isRowObject","prev","rowCollection","collection","allowGrouping","m","items","selectedRow","getRowsObject","getVirtualRowIndex","vGroupedRows","isDataRow","bSize","apply","map","tmp","rem","size","vGroupOffsets","refreshColOffsets","testRow","r","isRefresh","tr","c","clen","column","getNormalizedColumnIndex","displayVal","colGrp","getColGroup","offsetWidth","setDisplayNone","invokedFromMedia","hideAtMedia","updateMediaColumns","partialRefresh","isFrozen","isAvailable","selectedIndex","selectionModule","isInteracted","rowHeight","VirtualHeaderRenderer","isMovable","gen","refreshUI","headerContent","needFullRefresh","tablewidth","_i","_a","className","styles","renderFrozenWrapper","renderFrozenPlaceHolder","renderMovableWrapper","movableWrapper","movableContent","renderMovablePlaceHolder","movablePlaceholder","xValue","yValue","adjustMovableTable","setMovableWrapperWidth","full","setMovableVirtualHeight","setFreezeWrapperWidth"],"sources":["/Users/saleem/Desktop/KClient/Web App/Ver_3.6/User Interface/website_Source files/node_modules/@syncfusion/ej2-grids/src/grid/renderer/virtual-content-renderer.js"],"sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { remove, createElement, closest, formatUnit, Browser, extend } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined, removeClass } from '@syncfusion/ej2-base';\nimport { DataManager } from '@syncfusion/ej2-data';\nimport { dataReady, modelChanged, refreshVirtualBlock, contentReady } from '../base/constant';\nimport * as events from '../base/constant';\nimport { RenderType } from '../base/enum';\nimport { ContentRender } from './content-renderer';\nimport { HeaderRender } from './header-renderer';\nimport { InterSectionObserver } from '../services/intersection-observer';\nimport { VirtualRowModelGenerator } from '../services/virtual-row-model-generator';\nimport { isGroupAdaptive, ensureLastRow, ensureFirstRow, getEditedDataIndex, getTransformValues } from '../base/util';\nimport { setStyleAttribute } from '@syncfusion/ej2-base';\nimport * as literals from '../base/string-literals';\n/**\n * VirtualContentRenderer\n *\n * @hidden\n */\nvar VirtualContentRenderer = /** @class */ (function (_super) {\n    __extends(VirtualContentRenderer, _super);\n    function VirtualContentRenderer(parent, locator) {\n        var _this = _super.call(this, parent, locator) || this;\n        _this.prevHeight = 0;\n        /** @hidden */\n        _this.startIndex = 0;\n        _this.preStartIndex = 0;\n        _this.preventEvent = false;\n        _this.actions = ['filtering', 'searching', 'grouping', 'ungrouping'];\n        /** @hidden */\n        _this.offsets = {};\n        _this.tmpOffsets = {};\n        /** @hidden */\n        _this.virtualEle = new VirtualElementHandler();\n        _this.offsetKeys = [];\n        _this.isFocused = false;\n        _this.isSelection = false;\n        _this.isBottom = false;\n        _this.diff = 0;\n        _this.heightChange = false;\n        /** @hidden */\n        _this.isTop = false;\n        _this.empty = undefined;\n        _this.isCancel = false;\n        _this.requestTypes = ['beginEdit', 'cancel', 'delete', 'add', 'save', 'sorting'];\n        _this.isNormaledit = _this.parent.editSettings.mode === 'Normal';\n        /** @hidden */\n        _this.virtualData = {};\n        _this.emptyRowData = {};\n        _this.isContextMenuOpen = false;\n        _this.isSelectionScroll = false;\n        _this.validationCheck = false;\n        _this.locator = locator;\n        _this.eventListener('on');\n        _this.widthServices = locator.getService('widthService');\n        _this.parent.on(events.columnVisibilityChanged, _this.setVisible, _this);\n        _this.vgenerator = _this.generator;\n        return _this;\n    }\n    VirtualContentRenderer.prototype.renderTable = function () {\n        this.header = this.locator.getService('rendererFactory').getRenderer(RenderType.Header);\n        _super.prototype.renderTable.call(this);\n        this.virtualEle.table = this.getTable();\n        this.virtualEle.content = this.content = this.getPanel().querySelector('.' + literals.content);\n        this.virtualEle.renderWrapper(this.parent.height);\n        this.virtualEle.renderPlaceHolder();\n        if (!(!this.parent.enableVirtualization && this.parent.enableColumnVirtualization)) {\n            this.virtualEle.wrapper.style.position = 'absolute';\n        }\n        var debounceEvent = (this.parent.dataSource instanceof DataManager && !this.parent.dataSource.dataSource.offline);\n        var opt = {\n            container: this.content, pageHeight: this.getBlockHeight() * 2, debounceEvent: debounceEvent,\n            axes: this.parent.enableColumnVirtualization ? ['X', 'Y'] : ['Y']\n        };\n        this.observer = new InterSectionObserver(this.virtualEle.wrapper, opt);\n    };\n    VirtualContentRenderer.prototype.renderEmpty = function (tbody) {\n        this.getTable().appendChild(tbody);\n        if (this.parent.frozenRows) {\n            this.parent.getHeaderContent().querySelector(literals.tbody).innerHTML = '';\n        }\n        this.virtualEle.adjustTable(0, 0);\n    };\n    VirtualContentRenderer.prototype.getReorderedFrozenRows = function (args) {\n        var blockIndex = args.virtualInfo.blockIndexes;\n        var colsIndex = args.virtualInfo.columnIndexes;\n        var page = args.virtualInfo.page;\n        args.virtualInfo.blockIndexes = [1, 2];\n        args.virtualInfo.page = 1;\n        if (!args.renderMovableContent) {\n            args.virtualInfo.columnIndexes = [];\n        }\n        var recordslength = this.parent.getCurrentViewRecords().length;\n        var firstRecords = this.parent.renderModule.data.dataManager.dataSource.json.slice(0, recordslength);\n        var virtualRows = this.vgenerator.generateRows(firstRecords, args);\n        args.virtualInfo.blockIndexes = blockIndex;\n        args.virtualInfo.columnIndexes = colsIndex;\n        args.virtualInfo.page = page;\n        return virtualRows.splice(0, this.parent.frozenRows);\n    };\n    VirtualContentRenderer.prototype.scrollListener = function (scrollArgs) {\n        if (!this.parent.enableVirtualization && this.parent.enableColumnVirtualization && (scrollArgs.direction === 'up' || scrollArgs.direction === 'down')) {\n            return;\n        }\n        this.scrollAfterEdit();\n        if (this.parent.enablePersistence) {\n            this.parent.scrollPosition = scrollArgs.offset;\n        }\n        if (this.preventEvent || this.parent.isDestroyed) {\n            this.preventEvent = false;\n            return;\n        }\n        if (this.parent.islazyloadRequest && scrollArgs.direction === 'down') {\n            this.parent.removeMaskRow();\n            this.parent.islazyloadRequest = false;\n            return;\n        }\n        if (isNullOrUndefined(document.activeElement)) {\n            this.isFocused = false;\n        }\n        else {\n            this.isFocused = this.content === closest(document.activeElement, '.' + literals.content) || this.content === document.activeElement;\n        }\n        var info = scrollArgs.sentinel;\n        var viewInfo = this.currentInfo = this.getInfoFromView(scrollArgs.direction, info, scrollArgs.offset);\n        if (isGroupAdaptive(this.parent)) {\n            if (viewInfo.blockIndexes && this.prevInfo.blockIndexes.toString() === viewInfo.blockIndexes.toString()) {\n                this.parent.removeMaskRow();\n                return;\n            }\n            else {\n                viewInfo.event = 'refresh-virtual-block';\n                if (!isNullOrUndefined(viewInfo.offsets)) {\n                    viewInfo.offsets.top = this.content.scrollTop;\n                }\n                this.parent.pageSettings.currentPage = viewInfo.page;\n                if (this.parent.enableVirtualMaskRow) {\n                    this.parent.showMaskRow(info.axis);\n                    this.parent.addShimmerEffect();\n                }\n                this.parent.notify(viewInfo.event, { requestType: 'virtualscroll', virtualInfo: viewInfo, focusElement: scrollArgs.focusElement });\n                return;\n            }\n        }\n        if (this.prevInfo && ((info.axis === 'Y' && this.prevInfo.blockIndexes.toString() === viewInfo.blockIndexes.toString())\n            || (info.axis === 'X' && this.prevInfo.columnIndexes.toString() === viewInfo.columnIndexes.toString()))) {\n            this.parent.removeMaskRow();\n            if (Browser.isIE) {\n                this.parent.hideSpinner();\n            }\n            this.requestType = this.requestType === 'virtualscroll' ? this.empty : this.requestType;\n            if (info.axis === 'Y') {\n                this.restoreEdit();\n            }\n            if (this.parent.groupSettings.enableLazyLoading && this.prevInfo.blockIndexes[0] === 1 && viewInfo.blockIndexes[0] === 1 &&\n                scrollArgs.direction === 'up') {\n                this.virtualEle.adjustTable(0, viewInfo.offsets.top < this.offsets[1] ? 0 : this.getBlockHeight());\n            }\n            return;\n        }\n        this.parent.setColumnIndexesInView(this.parent.enableColumnVirtualization ? viewInfo.columnIndexes : []);\n        if (!(!this.parent.enableVirtualization && this.parent.enableColumnVirtualization)) {\n            this.parent.pageSettings.currentPage = viewInfo.loadNext && !viewInfo.loadSelf ? viewInfo.nextInfo.page : viewInfo.page;\n        }\n        this.requestType = 'virtualscroll';\n        if (this.parent.enableVirtualMaskRow) {\n            this.parent.showMaskRow(info.axis);\n            this.parent.addShimmerEffect();\n        }\n        this.parent.islazyloadRequest = false;\n        this.parent.notify(viewInfo.event, {\n            requestType: 'virtualscroll', virtualInfo: viewInfo,\n            focusElement: scrollArgs.focusElement\n        });\n        if (this.parent.enableColumnVirtualization && !this.parent.getContentTable().querySelector('tr.e-row')) {\n            this.parent.removeMaskRow();\n            this.appendContent(undefined, undefined, {\n                requestType: 'virtualscroll', virtualInfo: viewInfo,\n                focusElement: scrollArgs.focusElement\n            });\n            this.prevInfo = viewInfo;\n        }\n    };\n    VirtualContentRenderer.prototype.block = function (blk) {\n        return this.vgenerator.isBlockAvailable(blk);\n    };\n    VirtualContentRenderer.prototype.getInfoFromView = function (direction, info, e) {\n        var isBlockAdded = false;\n        var tempBlocks = [];\n        var infoType = { direction: direction, sentinelInfo: info, offsets: e,\n            startIndex: this.preStartIndex, endIndex: this.preEndIndex };\n        infoType.page = this.getPageFromTop(e.top, infoType);\n        infoType.blockIndexes = tempBlocks = this.vgenerator.getBlockIndexes(infoType.page);\n        infoType.loadSelf = !this.vgenerator.isBlockAvailable(tempBlocks[infoType.block]);\n        var blocks = this.ensureBlocks(infoType);\n        if (this.activeKey === 'upArrow' && infoType.blockIndexes.toString() !== blocks.toString()) {\n            // To avoid dupilcate row index problem in key focus support\n            var newBlock = blocks[blocks.length - 1];\n            if (infoType.blockIndexes.indexOf(newBlock) === -1) {\n                isBlockAdded = true;\n            }\n        }\n        if (!(!this.parent.enableVirtualization && this.parent.enableColumnVirtualization)) {\n            infoType.blockIndexes = blocks;\n        }\n        infoType.loadNext = !blocks.filter(function (val) { return tempBlocks.indexOf(val) === -1; })\n            .every(this.block.bind(this));\n        infoType.event = (infoType.loadNext || infoType.loadSelf) ? modelChanged : refreshVirtualBlock;\n        infoType.nextInfo = infoType.loadNext ? { page: Math.max(1, infoType.page + (direction === 'down' ? 1 : -1)) } : {};\n        if (isBlockAdded) {\n            infoType.blockIndexes = [infoType.blockIndexes[0] - 1, infoType.blockIndexes[0], infoType.blockIndexes[0] + 1];\n        }\n        if (this.activeKey === 'downArrow' && !isNaN(this.rowIndex)) {\n            var firstBlock = Math.ceil(this.rowIndex / this.getBlockSize());\n            if (firstBlock !== 1 && (infoType.blockIndexes[1] !== firstBlock || infoType.blockIndexes.length < 3)) {\n                infoType.blockIndexes = [firstBlock - 1, firstBlock, firstBlock + 1];\n            }\n        }\n        infoType.columnIndexes = info.axis === 'X' ? this.vgenerator.getColumnIndexes() : this.parent.getColumnIndexesInView();\n        if (this.parent.enableColumnVirtualization && info.axis === 'X') {\n            infoType.event = refreshVirtualBlock;\n        }\n        return infoType;\n    };\n    VirtualContentRenderer.prototype.ensureBlocks = function (info) {\n        var _this = this;\n        var index = info.blockIndexes[info.block];\n        var mIdx;\n        var old = index;\n        var max = Math.max;\n        var indexes = info.direction === 'down' ? [max(index, 1), ++index, ++index] : [max(index - 1, 1), index, index + 1];\n        this.prevInfo = this.prevInfo || this.vgenerator.getData();\n        indexes = indexes.filter(function (val, ind) { return indexes.indexOf(val) === ind; });\n        if (this.prevInfo.blockIndexes.toString() === indexes.toString()) {\n            return indexes;\n        }\n        if (info.loadSelf || (info.direction === 'down' && this.isEndBlock(old))) {\n            indexes = this.vgenerator.getBlockIndexes(info.page);\n        }\n        indexes.some(function (val, ind) {\n            var result = val === (isGroupAdaptive(_this.parent) ? _this.getGroupedTotalBlocks() : _this.getTotalBlocks());\n            if (result) {\n                mIdx = ind;\n            }\n            return result;\n        });\n        if (mIdx !== undefined) {\n            indexes = indexes.slice(0, mIdx + 1);\n            if (info.block === 0 && indexes.length === 1 && this.vgenerator.isBlockAvailable(indexes[0] - 1)) {\n                indexes = [indexes[0] - 1, indexes[0]];\n            }\n        }\n        return indexes;\n    };\n    // tslint:disable-next-line:max-func-body-length\n    VirtualContentRenderer.prototype.appendContent = function (target, newChild, e) {\n        var _this = this;\n        // currentInfo value will be used if there are multiple dom updates happened due to mousewheel\n        var info = e.virtualInfo.sentinelInfo && e.virtualInfo.sentinelInfo.axis === 'Y' && this.currentInfo.page &&\n            this.currentInfo.page !== e.virtualInfo.page ? this.currentInfo : e.virtualInfo;\n        this.prevInfo = this.prevInfo || e.virtualInfo;\n        var cBlock = (info.columnIndexes[0]) - 1;\n        var cOffset = this.getColumnOffset(cBlock);\n        var width;\n        var blocks = info.blockIndexes;\n        if (this.parent.groupSettings.columns.length) {\n            this.refreshOffsets();\n        }\n        if (this.parent.height === '100%') {\n            this.parent.element.style.height = '100%';\n        }\n        var vHeight = this.parent.height.toString().indexOf('%') < 0 ? this.content.getBoundingClientRect().height :\n            this.parent.element.getBoundingClientRect().height;\n        if (!this.parent.enableVirtualization && this.parent.enableColumnVirtualization) {\n            vHeight = 0;\n        }\n        var reduceWidth = 0;\n        if (this.parent.enableColumnVirtualization && this.parent.isFrozenGrid()) {\n            var frzLeftWidth_1 = 0;\n            this.parent.getColumns().filter(function (col) {\n                if (col.visible) {\n                    reduceWidth += parseInt(col.width.toString(), 10);\n                    if (col.freeze === 'Left') {\n                        frzLeftWidth_1 += parseInt(col.width.toString(), 10);\n                    }\n                }\n            });\n            var cIndex = info.columnIndexes;\n            width = this.getColumnOffset(cIndex[cIndex.length - 1]) - this.getColumnOffset(cIndex[0] - 1) + '';\n            if (cBlock > this.parent.getVisibleFrozenLeftCount()) {\n                cOffset = cOffset - frzLeftWidth_1;\n            }\n            this.resetStickyLeftPos(cOffset, newChild);\n        }\n        if (!this.requestTypes.some(function (value) { return value === _this.requestType; })) {\n            var translate = this.getTranslateY(this.content.scrollTop, vHeight, info);\n            if (this.parent.groupSettings.enableLazyLoading && info && this.prevInfo && this.prevInfo.blockIndexes[0] === 1 &&\n                info.blockIndexes[0] === 1 && info.direction === 'up') {\n                this.virtualEle.adjustTable(0, this.content.scrollTop < this.offsets[1] ? 0 : this.getBlockHeight());\n            }\n            else {\n                this.virtualEle.adjustTable(cOffset, translate);\n            }\n        }\n        if (this.parent.enableColumnVirtualization) {\n            this.header.virtualEle.adjustTable(cOffset, 0);\n        }\n        if (this.parent.enableColumnVirtualization) {\n            var cIndex = info.columnIndexes;\n            width = this.getColumnOffset(cIndex[cIndex.length - 1]) - this.getColumnOffset(cIndex[0] - 1) + '';\n            if (this.parent.isFrozenGrid()) {\n                width = reduceWidth.toString();\n                if (this.parent.allowResizing) {\n                    this.parent.getHeaderTable().style.width = reduceWidth + 'px';\n                    this.parent.getContentTable().style.width = reduceWidth + 'Px';\n                }\n            }\n            this.header.virtualEle.setWrapperWidth(width);\n        }\n        this.virtualEle.setWrapperWidth(width, Browser.isIE || Browser.info.name === 'edge');\n        if (this.parent.enableColumnVirtualization && isNullOrUndefined(target) && isNullOrUndefined(newChild)) {\n            return;\n        }\n        if (!isNullOrUndefined(target) && !isNullOrUndefined(target.parentNode)) {\n            remove(target);\n        }\n        var tbody = this.parent.element.querySelector('.' + literals.content).querySelector(literals.tbody);\n        if (tbody) {\n            remove(tbody);\n            target = null;\n        }\n        var isReact = this.parent.isReact && !isNullOrUndefined(this.parent.rowTemplate);\n        if (!isReact) {\n            target = this.parent.createElement(literals.tbody, { attrs: { role: 'rowgroup' } });\n            target.appendChild(newChild);\n        }\n        else {\n            target = newChild;\n        }\n        if (this.parent.frozenRows && e.requestType === 'virtualscroll' && this.parent.pageSettings.currentPage === 1) {\n            for (var i = 0; i < this.parent.frozenRows; i++) {\n                target.children[0].remove();\n            }\n        }\n        this.getTable().appendChild(target);\n        this.requestType = this.requestType === 'virtualscroll' ? this.empty : this.requestType;\n        if (!this.parent.enableVirtualization && this.parent.enableColumnVirtualization && (info.direction === 'right' || info.direction === 'left')) {\n            this.content.scrollTop = this.currentInfo.offsets.top;\n            this.content.scrollLeft = this.currentInfo.offsets.left;\n        }\n        if (this.parent.groupSettings.columns.length) {\n            if (!isGroupAdaptive(this.parent) && info.direction === 'up') {\n                var blk = this.offsets[this.getTotalBlocks()] - this.prevHeight;\n                if (!this.parent.groupSettings.enableLazyLoading) {\n                    this.preventEvent = true;\n                }\n                var sTop = this.content.scrollTop;\n                this.content.scrollTop = sTop + blk;\n            }\n            this.setVirtualHeight();\n            if (!this.parent.groupSettings.enableLazyLoading) {\n                this.observer.setPageHeight(this.getOffset(blocks[blocks.length - 1]) - this.getOffset(blocks[0] - 1));\n            }\n        }\n        if (e.requestType === 'ungrouping' && !this.parent.groupSettings.enableLazyLoading &&\n            this.parent.groupSettings.columns.length === 0) {\n            this.observer.setPageHeight(this.getBlockHeight() * 2);\n        }\n        this.prevInfo = info;\n        if (this.isFocused && this.activeKey !== 'downArrow' && this.activeKey !== 'upArrow') {\n            this.content.focus();\n        }\n        var lastPage = Math.ceil(this.getTotalBlocks() / 2);\n        if (this.isBottom) {\n            this.isBottom = false;\n            this.parent.getContent().firstElementChild.scrollTop = this.offsets[this.offsetKeys.length - 1];\n        }\n        if ((this.parent.pageSettings.currentPage + 1 === lastPage || this.parent.pageSettings.currentPage === lastPage) &&\n            blocks.length === 2 && e.requestType === 'delete') {\n            this.parent.getContent().firstElementChild.scrollTop = this.offsets[this.offsetKeys.length - 1];\n        }\n        if ((this.parent.pageSettings.currentPage === lastPage) && blocks.length === 1) {\n            this.isBottom = true;\n            this.parent.getContent().firstElementChild.scrollTop = this.offsets[this.offsetKeys.length - 2];\n        }\n        if (this.isTop) {\n            this.parent.getContent().firstElementChild.scrollTop = 0;\n            this.isTop = false;\n        }\n        if (e.requestType === 'virtualscroll' && e.virtualInfo.sentinelInfo.axis === 'X') {\n            this.parent.notify(events.autoCol, {});\n        }\n        this.focusCell(e);\n        this.restoreEdit(e);\n        this.restoreAdd();\n        this.ensureSelectedRowPosition();\n        this.validationScrollLeft();\n        if (this.parent.isFrozenGrid() && this.parent.enableColumnVirtualization) {\n            this.widthServices.refreshFrozenScrollbar();\n        }\n        if (!this.initialRowTop) {\n            var gridTop = this.parent.element.getBoundingClientRect().top;\n            if (this.parent.getRowByIndex(0)) {\n                this.initialRowTop = this.parent.getRowByIndex(0).getBoundingClientRect().top - gridTop;\n            }\n        }\n    };\n    VirtualContentRenderer.prototype.validationScrollLeft = function () {\n        if (this.validationCheck) {\n            if (this.validationCol) {\n                var offset = this.vgenerator.cOffsets[(this.validationCol.index - this.parent.getVisibleFrozenColumns()) - 1];\n                this.validationCol = null;\n                this.content.scrollLeft = offset;\n            }\n            else {\n                this.validationCheck = false;\n                this.parent.editModule.editFormValidate();\n            }\n        }\n    };\n    VirtualContentRenderer.prototype.ensureSelectedRowPosition = function () {\n        if (!this.isSelection && this.isSelectionScroll && !isNullOrUndefined(this.selectRowIndex)) {\n            this.isSelectionScroll = false;\n            var row = this.parent.getRowByIndex(this.selectRowIndex);\n            if (row && !this.isRowInView(row)) {\n                this.rowSelected({ rowIndex: this.selectRowIndex, row: row }, true);\n            }\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    VirtualContentRenderer.prototype.focusCell = function (e) {\n        if (this.activeKey !== 'upArrow' && this.activeKey !== 'downArrow') {\n            return;\n        }\n        var row = this.parent.getRowByIndex(this.rowIndex);\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var cell = row.cells[this.cellIndex];\n        cell.focus({ preventScroll: true });\n        if (!this.parent.selectionSettings.checkboxOnly) {\n            this.parent.selectRow(parseInt(row.getAttribute(literals.dataRowIndex), 10));\n        }\n        this.activeKey = this.empty;\n    };\n    VirtualContentRenderer.prototype.restoreEdit = function (e) {\n        if (this.isNormaledit) {\n            if (this.parent.editSettings.allowEditing\n                && this.parent.editModule && !isNullOrUndefined(this.editedRowIndex)) {\n                var row = this.getRowByIndex(this.editedRowIndex);\n                var content = this.content;\n                var keys = Object.keys(this.virtualData);\n                var isXaxis = e && e.virtualInfo && e.virtualInfo.sentinelInfo.axis === 'X';\n                if (keys.length && row && !content.querySelector('.' + literals.editedRow)) {\n                    var top_1 = row.getBoundingClientRect().top;\n                    if (isXaxis || (top_1 < this.content.offsetHeight && top_1 > this.parent.getRowHeight())) {\n                        this.parent.isEdit = false;\n                        this.parent.editModule.startEdit(row);\n                    }\n                }\n                if (row && this.content.querySelector('.' + literals.editedRow) && !keys.length) {\n                    var rowData = (!this.parent.enableVirtualization && this.parent.enableColumnVirtualization) ?\n                        extend({}, this.parent.getCurrentViewRecords()[this.editedRowIndex]) :\n                        extend({}, this.getRowObjectByIndex(this.editedRowIndex));\n                    this.virtualData = this.getVirtualEditedData(rowData);\n                }\n            }\n            this.restoreAdd();\n        }\n    };\n    VirtualContentRenderer.prototype.getVirtualEditedData = function (rowData) {\n        var editForms = [].slice.call(this.parent.element.getElementsByClassName('e-gridform'));\n        var isFormDestroyed = this.parent.editModule && this.parent.editModule.formObj\n            && this.parent.editModule.formObj.isDestroyed;\n        if (!isFormDestroyed) {\n            for (var i = 0; i < editForms.length; i++) {\n                rowData = this.parent.editModule.getCurrentEditedData(editForms[parseInt(i.toString(), 10)], rowData);\n            }\n        }\n        return rowData;\n    };\n    VirtualContentRenderer.prototype.restoreAdd = function () {\n        var startAdd = !this.parent.element.querySelector('.' + literals.addedRow);\n        if (this.isNormaledit && this.isAdd && startAdd) {\n            var isTop = this.parent.editSettings.newRowPosition === 'Top' && this.content.scrollTop < this.parent.getRowHeight();\n            var isBottom = this.parent.editSettings.newRowPosition === 'Bottom'\n                && this.parent.pageSettings.currentPage === this.maxPage;\n            if (isTop || isBottom) {\n                this.parent.isEdit = false;\n                this.parent.addRecord();\n            }\n        }\n    };\n    VirtualContentRenderer.prototype.onDataReady = function (e) {\n        if (!isNullOrUndefined(e.count)) {\n            this.count = e.count;\n            this.maxPage = Math.ceil(e.count / this.parent.pageSettings.pageSize);\n        }\n        this.vgenerator.checkAndResetCache(e.requestType);\n        if (['refresh', 'filtering', 'searching', 'grouping', 'ungrouping', 'reorder', undefined]\n            .some(function (value) { return e.requestType === value; })) {\n            this.refreshOffsets();\n        }\n        this.setVirtualHeight();\n        this.resetScrollPosition(e.requestType);\n    };\n    /**\n     * @param {number} height - specifies the height\n     * @returns {void}\n     * @hidden\n     */\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    VirtualContentRenderer.prototype.setVirtualHeight = function (height) {\n        var width = this.parent.enableColumnVirtualization ?\n            this.getColumnOffset(this.parent.columns.length + this.parent.groupSettings.columns.length - 1) + 'px' : '100%';\n        var virtualHeight = (this.offsets[isGroupAdaptive(this.parent) && this.count !== 0 ? this.getGroupedTotalBlocks() :\n            this.getTotalBlocks()]);\n        if (!this.parent.enableVirtualization && this.parent.enableColumnVirtualization) {\n            virtualHeight = 0;\n        }\n        var lastPage = Math.ceil(this.getTotalBlocks() / 2);\n        var placeHolderBottom = Math.round(this.virtualEle.placeholder.getBoundingClientRect().bottom);\n        var wrapperBottom = Math.round(this.virtualEle.wrapper.getBoundingClientRect().bottom);\n        if ((this.currentInfo.page === lastPage || this.currentInfo.page + 1 === lastPage) && this.currentInfo.direction === 'down' &&\n            placeHolderBottom > wrapperBottom && !this.diff) {\n            this.diff = placeHolderBottom - wrapperBottom;\n        }\n        if (this.diff && (this.currentInfo.page === lastPage) && placeHolderBottom > wrapperBottom) {\n            virtualHeight -= this.diff;\n            this.heightChange = true;\n        }\n        else if (this.diff && this.heightChange && this.requestType === 'virtualscroll') {\n            virtualHeight -= this.diff;\n            this.heightChange = false;\n        }\n        this.virtualEle.setVirtualHeight(virtualHeight, width);\n        if (this.virtualEle && this.virtualEle.wrapper) {\n            if (!this.parent.enableVirtualization && this.parent.enableColumnVirtualization) {\n                this.virtualEle.wrapper.style.minHeight = '';\n            }\n            else {\n                this.virtualEle.wrapper.style.minHeight = !isNullOrUndefined(virtualHeight) ? formatUnit(this.parent.height) : '0px';\n            }\n        }\n        if (this.parent.enableColumnVirtualization) {\n            this.header.virtualEle.setVirtualHeight(1, width);\n        }\n    };\n    VirtualContentRenderer.prototype.getPageFromTop = function (sTop, info) {\n        var _this = this;\n        var total = (isGroupAdaptive(this.parent)) ? this.getGroupedTotalBlocks() : this.getTotalBlocks();\n        var page = 0;\n        this.offsetKeys.some(function (offset) {\n            var iOffset = Number(offset);\n            var border = sTop <= _this.offsets[\"\" + offset] || (iOffset === total && sTop > _this.offsets[\"\" + offset]);\n            if (border) {\n                if (_this.offsetKeys.length % 2 !== 0 && iOffset.toString() === _this.offsetKeys[_this.offsetKeys.length - 2]\n                    && sTop <= _this.offsets[_this.offsetKeys.length - 1]) {\n                    iOffset = iOffset + 1;\n                }\n                info.block = iOffset % 2 === 0 ? 1 : 0;\n                page = Math.max(1, Math.min(_this.vgenerator.getPage(iOffset), _this.maxPage));\n            }\n            return border;\n        });\n        return page;\n    };\n    VirtualContentRenderer.prototype.getTranslateY = function (sTop, cHeight, info, isOnenter) {\n        if (info === undefined) {\n            info = { page: this.getPageFromTop(sTop, {}) };\n            info.blockIndexes = this.vgenerator.getBlockIndexes(info.page);\n        }\n        var block = (info.blockIndexes[0] || 1) - 1;\n        var translate = this.getOffset(block);\n        var endTranslate = this.getOffset(info.blockIndexes[info.blockIndexes.length - 1]);\n        if (isOnenter) {\n            info = this.prevInfo;\n        }\n        var result = translate > sTop ?\n            this.getOffset(block - 1) : endTranslate < (sTop + cHeight) ? this.getOffset(block + 1) : translate;\n        var blockHeight = this.offsets[info.blockIndexes[info.blockIndexes.length - 1]] -\n            this.tmpOffsets[info.blockIndexes[0]];\n        var totalBlocks = isGroupAdaptive(this.parent) ? this.getGroupedTotalBlocks() : this.getTotalBlocks();\n        if (result + blockHeight > this.offsets[parseInt(totalBlocks.toString(), 10)]) {\n            result -= (result + blockHeight) - this.offsets[parseInt(totalBlocks.toString(), 10)];\n        }\n        if (!this.parent.enableVirtualization && this.parent.enableColumnVirtualization) {\n            result = 0;\n        }\n        return result;\n    };\n    VirtualContentRenderer.prototype.getOffset = function (block) {\n        return Math.min(this.offsets[parseInt(block.toString(), 10)] | 0, this.offsets[this.maxBlock] | 0);\n    };\n    VirtualContentRenderer.prototype.onEntered = function () {\n        var _this = this;\n        return function (element, current, direction, e, isWheel, check) {\n            if ((direction === 'down' || direction === 'up') && !_this.parent.enableVirtualization && _this.parent.enableColumnVirtualization) {\n                return;\n            }\n            if (Browser.isIE && !isWheel && check && !_this.preventEvent && !_this.parent.enableVirtualMaskRow) {\n                _this.parent.showSpinner();\n            }\n            if (_this.parent.enableVirtualMaskRow && !_this.preventEvent) {\n                var firstOffSetKey = parseInt(_this.offsetKeys[0], 10);\n                var lastOffSetKey = parseInt(_this.offsetKeys[_this.offsetKeys.length - 1], 10);\n                var blockIndex = _this.currentInfo.blockIndexes;\n                if (!((blockIndex && blockIndex[0] === firstOffSetKey && direction === 'up') ||\n                    (blockIndex && blockIndex[blockIndex.length - 1] === lastOffSetKey && direction === 'down'))) {\n                    setTimeout(function () {\n                        _this.parent.showMaskRow(current.axis);\n                    }, 0);\n                }\n            }\n            _this.prevInfo = _this.prevInfo || _this.vgenerator.getData();\n            var xAxis = current.axis === 'X';\n            var top = _this.prevInfo.offsets ? _this.prevInfo.offsets.top : null;\n            var height = _this.content.getBoundingClientRect().height;\n            var x = _this.getColumnOffset(xAxis ? _this.vgenerator.getColumnIndexes()[0] - 1 : _this.prevInfo.columnIndexes[0] - 1);\n            if (xAxis) {\n                var idx = Object.keys(_this.vgenerator.cOffsets).length - _this.prevInfo.columnIndexes.length;\n                var maxLeft = _this.vgenerator.cOffsets[idx - 1];\n                x = x > maxLeft ? maxLeft : x; //TODO: This fix horizontal scrollbar jumping issue in column virtualization.\n            }\n            if (!_this.parent.enableVirtualization && _this.parent.enableColumnVirtualization) {\n                _this.virtualEle.adjustTable(x, 0);\n            }\n            else {\n                var y = _this.getTranslateY(e.top, height, xAxis && top === e.top ? _this.prevInfo : undefined, true);\n                _this.virtualEle.adjustTable(x, Math.min(y, _this.offsets[_this.maxBlock]));\n            }\n            if (_this.parent.enableColumnVirtualization) {\n                _this.header.virtualEle.adjustTable(x, 0);\n                if (_this.parent.isFrozenGrid()) {\n                    _this.resetStickyLeftPos(x);\n                }\n            }\n        };\n    };\n    VirtualContentRenderer.prototype.dataBound = function () {\n        this.parent.notify(events.refreshVirtualFrozenHeight, {});\n        if (this.isSelection && this.activeKey !== 'upArrow' && this.activeKey !== 'downArrow') {\n            this.parent.selectRow(this.selectedRowIndex);\n        }\n        else {\n            this.activeKey = this.empty;\n        }\n    };\n    VirtualContentRenderer.prototype.resetStickyLeftPos = function (valueX, newChild) {\n        var cells = [].slice.call(this.parent.getHeaderContent().querySelectorAll('.e-leftfreeze,.e-rightfreeze,.e-fixedfreeze')).concat([].slice.call((newChild ? newChild : this.parent.getContent()).querySelectorAll('.e-leftfreeze,.e-rightfreeze,.e-fixedfreeze')));\n        var frzLeftWidth = 0;\n        var frzRightWidth = 0;\n        if (this.parent.getHeaderContent().querySelectorAll('.e-fixedfreeze').length) {\n            frzLeftWidth = this.parent.leftrightColumnWidth('left');\n            frzRightWidth = this.parent.leftrightColumnWidth('right');\n        }\n        if (cells.length) {\n            for (var i = 0; i < cells.length; i++) {\n                var cell = cells[parseInt(i.toString(), 10)];\n                var col = void 0;\n                if (cell.classList.contains('e-rowcell')) {\n                    if (isNullOrUndefined(cell.getAttribute('data-colindex')) && cell.querySelector('[e-mappinguid]')) {\n                        var uid = cell.querySelector('[e-mappinguid]').getAttribute('e-mappinguid');\n                        col = this.parent.getColumnByUid(uid);\n                    }\n                    else {\n                        var idx = parseInt(cell.getAttribute('data-colindex'), 10);\n                        col = this.parent.getColumnByIndex(parseInt(idx.toString(), 10));\n                    }\n                }\n                else {\n                    if (cell.classList.contains('e-headercell') || cell.classList.contains('e-filterbarcell')) {\n                        var uid = cell.classList.contains('e-filterbarcell') ? cell.getAttribute('e-mappinguid') :\n                            cell.querySelector('[e-mappinguid]').getAttribute('e-mappinguid');\n                        col = this.parent.getColumnByUid(uid);\n                    }\n                }\n                if (col.freeze === 'Left') {\n                    cell.style.left = (col.valueX - valueX) + 'px';\n                }\n                else if (col.freeze === 'Right') {\n                    cell.style.right = (col.valueX + valueX) + 'px';\n                }\n                else if (col.freeze === 'Fixed') {\n                    cell.style.left = (frzLeftWidth - valueX) + 'px';\n                    cell.style.right = (frzRightWidth + valueX) + 'px';\n                }\n            }\n        }\n        this.parent.translateX = valueX;\n    };\n    VirtualContentRenderer.prototype.rowSelected = function (args, isSelection) {\n        if ((this.isSelection || isSelection) && !this.isLastBlockRow(args.rowIndex)) {\n            var transform = getTransformValues(this.content.firstElementChild);\n            var gridTop = this.parent.element.getBoundingClientRect().top;\n            var rowTop = args.row.getBoundingClientRect().top - gridTop;\n            var height = this.content.getBoundingClientRect().height;\n            var isBottom = height < rowTop;\n            var remainHeight = isBottom ? rowTop - height : this.initialRowTop - rowTop;\n            var translateY = isBottom ? transform.height - remainHeight : transform.height + remainHeight;\n            this.virtualEle.adjustTable(transform.width, translateY);\n            var lastRowTop = this.content.querySelector('tbody').lastElementChild.getBoundingClientRect().top - gridTop;\n            if (lastRowTop < height) {\n                translateY = translateY + (height - (args.row.getBoundingClientRect().top - gridTop));\n                this.virtualEle.adjustTable(transform.width, translateY - (this.parent.getRowHeight() / 2));\n            }\n            if (this.parent.enableColumnVirtualization && this.parent.isFrozenGrid()) {\n                this.resetStickyLeftPos(transform.width);\n            }\n        }\n        this.isSelection = false;\n    };\n    VirtualContentRenderer.prototype.isLastBlockRow = function (index) {\n        var scrollEle = this.parent.getContent().firstElementChild;\n        var visibleRowCount = Math.floor(scrollEle.offsetHeight / this.parent.getRowHeight()) - 1;\n        var startIdx = (this.maxPage * this.parent.pageSettings.pageSize) - visibleRowCount;\n        return index >= startIdx;\n    };\n    VirtualContentRenderer.prototype.refreshMaxPage = function () {\n        if (this.parent.groupSettings.columns.length && this.parent.vcRows.length) {\n            this.maxPage = Math.ceil(this.parent.vcRows.length / this.parent.pageSettings.pageSize);\n        }\n    };\n    VirtualContentRenderer.prototype.setVirtualPageQuery = function (args) {\n        var row = this.parent.getContent().querySelector('.e-row');\n        if (row && this.parent.isManualRefresh && this.currentInfo.blockIndexes && this.currentInfo.blockIndexes.length === 3) {\n            this.vgenerator.startIndex = parseInt(row.getAttribute('data-rowindex'), 10);\n            this.vgenerator.currentInfo = extend({}, this.currentInfo);\n            this.vgenerator.currentInfo.blockIndexes = this.currentInfo.blockIndexes.slice();\n            var includePrevPage = this.vgenerator.includePrevPage = this.currentInfo.blockIndexes[0] % 2 === 0;\n            if (includePrevPage) {\n                this.vgenerator.startIndex = this.vgenerator.startIndex - this.getBlockSize();\n                this.vgenerator.currentInfo.blockIndexes.unshift(this.currentInfo.blockIndexes[0] - 1);\n            }\n            else {\n                this.vgenerator.currentInfo.blockIndexes.push(this.currentInfo.blockIndexes[this.currentInfo.blockIndexes.length - 1] + 1);\n            }\n            var skip = (this.vgenerator.currentInfo.blockIndexes[0] - 1) * this.getBlockSize();\n            var take = this.vgenerator.currentInfo.blockIndexes.length * this.getBlockSize();\n            args.query.skip(skip);\n            args.query.take(take);\n            args.skipPage = true;\n        }\n    };\n    VirtualContentRenderer.prototype.eventListener = function (action) {\n        var _this = this;\n        this.parent[\"\" + action](dataReady, this.onDataReady, this);\n        this.parent.addEventListener(events.dataBound, this.dataBound.bind(this));\n        this.parent.addEventListener(events.actionBegin, this.actionBegin.bind(this));\n        this.parent.addEventListener(events.actionComplete, this.actionComplete.bind(this));\n        this.parent.addEventListener(events.rowSelected, this.rowSelected.bind(this));\n        this.parent[\"\" + action](refreshVirtualBlock, this.refreshContentRows, this);\n        this.parent[\"\" + action](events.refreshVirtualLazyLoadCache, this.refreshVirtualLazyLoadCache, this);\n        this.parent[\"\" + action](events.selectVirtualRow, this.selectVirtualRow, this);\n        this.parent[\"\" + action](events.virtaulCellFocus, this.virtualCellFocus, this);\n        this.parent[\"\" + action](events.virtualScrollEditActionBegin, this.editActionBegin, this);\n        this.parent[\"\" + action](events.virtualScrollAddActionBegin, this.addActionBegin, this);\n        this.parent[\"\" + action](events.virtualScrollEdit, this.restoreEdit, this);\n        this.parent[\"\" + action](events.virtualScrollEditSuccess, this.editSuccess, this);\n        this.parent[\"\" + action](events.refreshVirtualCache, this.refreshCache, this);\n        this.parent[\"\" + action](events.editReset, this.resetIsedit, this);\n        this.parent[\"\" + action](events.getVirtualData, this.getVirtualData, this);\n        this.parent[\"\" + action](events.virtualScrollEditCancel, this.editCancel, this);\n        this.parent[\"\" + action](events.refreshVirtualMaxPage, this.refreshMaxPage, this);\n        this.parent[\"\" + action](events.setVirtualPageQuery, this.setVirtualPageQuery, this);\n        this.parent[\"\" + action](events.selectRowOnContextOpen, this.selectRowOnContextOpen, this);\n        this.parent[\"\" + action](events.resetVirtualFocus, this.resetVirtualFocus, this);\n        this.parent[\"\" + action](events.refreshVirtualEditFormCells, this.refreshCells, this);\n        this.parent[\"\" + action](events.scrollToEdit, this.scrollToEdit, this);\n        var event = this.actions;\n        for (var i = 0; i < event.length; i++) {\n            this.parent[\"\" + action](event[parseInt(i.toString(), 10)] + \"-begin\", this.onActionBegin, this);\n        }\n        var fn = function () {\n            _this.observer.observe(function (scrollArgs) { return _this.scrollListener(scrollArgs); }, _this.onEntered());\n            var gObj = _this.parent;\n            if (gObj.enablePersistence && gObj.scrollPosition) {\n                _this.content.scrollTop = gObj.scrollPosition.top;\n                var scrollValues = { direction: 'down', sentinel: _this.observer.sentinelInfo.down,\n                    offset: gObj.scrollPosition, focusElement: gObj.element };\n                _this.scrollListener(scrollValues);\n                if (gObj.enableColumnVirtualization) {\n                    _this.content.scrollLeft = gObj.scrollPosition.left;\n                }\n            }\n            _this.parent.off(contentReady, fn);\n        };\n        this.parent.on(contentReady, fn, this);\n    };\n    VirtualContentRenderer.prototype.refreshVirtualLazyLoadCache = function (e) {\n        var blockIndex = this.currentInfo.blockIndexes;\n        if (isNullOrUndefined(this.currentInfo.blockIndexes)) {\n            blockIndex = [1, 2];\n        }\n        var block;\n        var index;\n        var cache;\n        for (var i = 0; i < blockIndex.length; i++) {\n            var rows = this.vgenerator.cache[blockIndex[parseInt(i.toString(), 10)]];\n            for (var j = 0; j < rows.length; j++) {\n                if (rows[parseInt(j.toString(), 10)].uid === e.uid) {\n                    block = blockIndex[parseInt(i.toString(), 10)];\n                    index = j;\n                    cache = rows;\n                    break;\n                }\n            }\n        }\n        if (e.count) {\n            this.vgenerator.cache[parseInt(block.toString(), 10)].splice(index + 1, e.count);\n        }\n        else if (e.rows && e.rows.length) {\n            this.vgenerator.cache[parseInt(block.toString(), 10)] = ([].slice.call(cache.slice(0, index + 1)).concat([].slice.call(e.rows))).concat([].slice.call(cache.slice(index + 1, cache.length)));\n        }\n        this.refreshOffsets();\n    };\n    VirtualContentRenderer.prototype.scrollToEdit = function (col) {\n        var allowScroll = true;\n        this.validationCheck = true;\n        if (this.isAdd && this.content.scrollTop > 0) {\n            allowScroll = false;\n            var keys = Object.keys(this.offsets);\n            this.content.scrollTop = this.parent.editSettings.newRowPosition === 'Top' ? 0 : this.offsets[keys.length - 1];\n        }\n        var row = this.parent.getRowByIndex(this.editedRowIndex);\n        if (!row && !isNullOrUndefined(this.editedRowIndex)) {\n            if (!row || !this.isRowInView(row)) {\n                var rowIndex = this.parent.getRowHeight();\n                var scrollTop = this.editedRowIndex * rowIndex;\n                if (!isNullOrUndefined(scrollTop)) {\n                    allowScroll = false;\n                    this.content.scrollTop = scrollTop;\n                }\n            }\n        }\n        if (col && allowScroll) {\n            var offset = this.vgenerator.cOffsets[(col.index - this.parent.getVisibleFrozenColumns()) - 1];\n            if (!this.parent.enableColumnVirtualization) {\n                var header = this.parent.getHeaderContent().querySelector('.e-headercelldiv[e-mappinguid=\"' + col.uid + '\"]');\n                offset = header.parentElement.offsetLeft;\n            }\n            if (this.parent.enableColumnVirtualization && this.parent.getVisibleFrozenLeftCount()) {\n                offset -= this.parent.leftrightColumnWidth('left');\n            }\n            this.content.scrollLeft = this.parent.enableRtl ? -Math.abs(offset) : offset;\n        }\n        if (col && !allowScroll) {\n            this.validationCol = col;\n        }\n    };\n    VirtualContentRenderer.prototype.refreshCells = function (rowObj) {\n        rowObj.cells = this.vgenerator.generateCells(rowObj.foreignKeyData);\n    };\n    VirtualContentRenderer.prototype.resetVirtualFocus = function (e) {\n        this.isCancel = e.isCancel;\n    };\n    /**\n     * @param {Object} data - specifies the data\n     * @param {Object} data.virtualData -specifies the data\n     * @param {boolean} data.isAdd - specifies isAdd\n     * @param {boolean} data.isCancel - specifies boolean in cancel\n     * @param {boolean} data.isScroll - specifies boolean for scroll\n     * @returns {void}\n     * @hidden\n     */\n    VirtualContentRenderer.prototype.getVirtualData = function (data) {\n        if (this.isNormaledit) {\n            var error = this.parent.element.querySelector('.e-griderror:not([style*=\"display: none\"])');\n            var keys = Object.keys(this.virtualData);\n            data.isScroll = keys.length !== 0 && this.currentInfo.sentinelInfo && this.currentInfo.sentinelInfo.axis === 'X';\n            if (error) {\n                return;\n            }\n            this.virtualData = keys.length ? this.virtualData : data.virtualData;\n            this.getVirtualEditedData(this.virtualData);\n            data.virtualData = this.virtualData;\n            data.isAdd = this.isAdd;\n            data.isCancel = this.isCancel;\n        }\n    };\n    VirtualContentRenderer.prototype.selectRowOnContextOpen = function (args) {\n        this.isContextMenuOpen = args.isOpen;\n    };\n    VirtualContentRenderer.prototype.editCancel = function (args) {\n        var dataIndex = getEditedDataIndex(this.parent, args.data);\n        if (!isNullOrUndefined(dataIndex)) {\n            args.data = this.parent.getCurrentViewRecords()[parseInt(dataIndex.toString(), 10)];\n        }\n    };\n    VirtualContentRenderer.prototype.editSuccess = function (args) {\n        if (this.isNormaledit) {\n            if (!this.isAdd && args.data) {\n                this.updateCurrentViewData(args.data);\n            }\n            this.isAdd = false;\n        }\n    };\n    VirtualContentRenderer.prototype.updateCurrentViewData = function (data) {\n        var dataIndex = getEditedDataIndex(this.parent, data);\n        if (!isNullOrUndefined(dataIndex)) {\n            this.parent.getCurrentViewRecords()[parseInt(dataIndex.toString(), 10)] = data;\n        }\n    };\n    VirtualContentRenderer.prototype.actionBegin = function (args) {\n        if (args.requestType !== 'virtualscroll') {\n            this.requestType = args.requestType;\n        }\n        if (!args.cancel) {\n            this.parent.notify(events.refreshVirtualFrozenRows, args);\n        }\n    };\n    VirtualContentRenderer.prototype.virtualCellFocus = function (e) {\n        // To decide the action (select or scroll), when using arrow keys for cell focus\n        var ele = document.activeElement;\n        if (!ele.classList.contains(literals.rowCell) && (ele instanceof HTMLInputElement\n            || !isNullOrUndefined(ele.closest('.e-templatecell')))) {\n            ele = ele.closest('.e-rowcell');\n        }\n        if (ele && ele.classList.contains(literals.rowCell)\n            && e && (e.action === 'upArrow' || e.action === 'downArrow')) {\n            var rowIndex = parseInt(ele.parentElement.getAttribute(literals.dataRowIndex), 10);\n            if (e && (e.action === 'downArrow' || e.action === 'upArrow')) {\n                var scrollEle = this.parent.getContent().firstElementChild;\n                if (e.action === 'downArrow') {\n                    rowIndex += 1;\n                }\n                else {\n                    rowIndex -= 1;\n                }\n                this.rowIndex = rowIndex;\n                this.cellIndex = parseInt(ele.getAttribute(literals.dataColIndex), 10);\n                var row = this.parent.getRowByIndex(rowIndex);\n                var page = this.parent.pageSettings.currentPage;\n                var visibleRowCount = Math.floor(scrollEle.offsetHeight / this.parent.getRowHeight()) - 1;\n                var emptyRow = false;\n                if (isNullOrUndefined(row)) {\n                    emptyRow = true;\n                    if ((e.action === 'downArrow' && page === this.maxPage - 1) || (e.action === 'upArrow' && page === 1)) {\n                        emptyRow = false;\n                    }\n                }\n                if (emptyRow || (ensureLastRow(row, this.parent) && e.action === 'downArrow')\n                    || (ensureFirstRow(row, this.parent.getRowHeight() * 2) && e.action === 'upArrow')) {\n                    this.activeKey = e.action;\n                    scrollEle.scrollTop = e.action === 'downArrow' ?\n                        (rowIndex - visibleRowCount) * this.parent.getRowHeight() : rowIndex * this.parent.getRowHeight();\n                }\n                else {\n                    this.activeKey = this.empty;\n                }\n                if (!this.parent.selectionSettings.checkboxOnly) {\n                    this.parent.selectRow(rowIndex);\n                }\n            }\n        }\n    };\n    VirtualContentRenderer.prototype.editActionBegin = function (e) {\n        this.editedRowIndex = e.index;\n        var rowData = (!this.parent.enableVirtualization && this.parent.enableColumnVirtualization) ?\n            extend({}, this.parent.getCurrentViewRecords()[e.index]) : extend({}, this.getRowObjectByIndex(e.index));\n        var keys = Object.keys(this.virtualData);\n        e.data = keys.length ? this.virtualData : rowData;\n        e.isScroll = keys.length !== 0 && this.currentInfo.sentinelInfo && this.currentInfo.sentinelInfo.axis === 'X';\n    };\n    VirtualContentRenderer.prototype.getEditedRowObject = function () {\n        var rowObjects = this.parent.vcRows;\n        var editedrow;\n        for (var i = 0; i < rowObjects.length; i++) {\n            if (rowObjects[parseInt(i.toString(), 10)].index === this.editedRowIndex) {\n                editedrow = rowObjects[parseInt(i.toString(), 10)];\n            }\n        }\n        return editedrow;\n    };\n    VirtualContentRenderer.prototype.refreshCache = function (args) {\n        var block = Math.ceil((this.editedRowIndex + 1) / this.getBlockSize());\n        if (this.parent.allowPaging && this.parent.enableColumnVirtualization) {\n            block = Math.ceil((this.editedRowIndex + 1 + ((this.parent.pageSettings.currentPage - 1) *\n                this.parent.pageSettings.pageSize)) / this.getBlockSize());\n        }\n        var index = (this.parent.allowPaging && this.parent.enableColumnVirtualization) ?\n            this.editedRowIndex % this.getBlockSize() : this.editedRowIndex - ((block - 1) * this.getBlockSize());\n        if (this.parent.groupSettings.columns.length) {\n            this.getEditedRowObject().data = args.data;\n        }\n        else {\n            this.vgenerator.cache[parseInt(block.toString(), 10)][parseInt(index.toString(), 10)].data = args.data;\n        }\n    };\n    VirtualContentRenderer.prototype.actionComplete = function (args) {\n        if (!(this.parent.enableVirtualization || this.parent.enableColumnVirtualization)) {\n            return;\n        }\n        var editRequestTypes = ['delete', 'save', 'cancel'];\n        var dataActionRequestTypes = ['sorting', 'filtering', 'grouping', 'refresh', 'searching', 'ungrouping', 'reorder'];\n        if (editRequestTypes.some(function (value) { return value === args.requestType; })) {\n            this.refreshOffsets();\n            this.refreshVirtualElement();\n        }\n        if (this.isNormaledit && (dataActionRequestTypes.some(function (value) { return value === args.requestType; })\n            || editRequestTypes.some(function (value) { return value === args.requestType; }))) {\n            this.isCancel = true;\n            this.isAdd = false;\n            this.editedRowIndex = this.empty;\n            this.virtualData = {};\n            if (this.parent.editModule) {\n                this.parent.editModule.editModule.previousData = undefined;\n            }\n        }\n        if (this.parent.enableColumnVirtualization && args.requestType === 'filterAfterOpen'\n            && this.currentInfo.columnIndexes && this.currentInfo.columnIndexes[0] > 0) {\n            this.parent.resetFilterDlgPosition(args.columnName);\n        }\n    };\n    VirtualContentRenderer.prototype.resetIsedit = function () {\n        if (this.parent.enableVirtualization && this.isNormaledit) {\n            if ((this.parent.editSettings.allowEditing && Object.keys(this.virtualData).length)\n                || (this.parent.editSettings.allowAdding && this.isAdd)) {\n                this.parent.isEdit = true;\n            }\n        }\n    };\n    VirtualContentRenderer.prototype.scrollAfterEdit = function () {\n        if (this.parent.editModule && this.parent.editSettings.allowEditing && this.isNormaledit) {\n            if (this.parent.element.querySelector('.e-gridform')) {\n                var editForm = this.parent.element.querySelector('.' + literals.editedRow);\n                var addForm = this.parent.element.querySelector('.' + literals.addedRow);\n                if (editForm || addForm) {\n                    var rowData = editForm ? extend({}, this.getRowObjectByIndex(this.editedRowIndex))\n                        : extend({}, this.emptyRowData);\n                    var keys = Object.keys(this.virtualData);\n                    this.virtualData = keys.length ? this.getVirtualEditedData(this.virtualData) : this.getVirtualEditedData(rowData);\n                }\n            }\n        }\n    };\n    VirtualContentRenderer.prototype.createEmptyRowdata = function () {\n        var _this = this;\n        this.parent.columnModel.filter(function (e) {\n            _this.emptyRowData[e.field] = _this.empty;\n        });\n    };\n    VirtualContentRenderer.prototype.addActionBegin = function (args) {\n        if (this.isNormaledit) {\n            if (!Object.keys(this.emptyRowData).length) {\n                this.createEmptyRowdata();\n            }\n            this.isAdd = true;\n            var page = this.parent.pageSettings.currentPage;\n            if (!this.parent.frozenRows && this.content.scrollTop > 0 && this.parent.editSettings.newRowPosition === 'Top') {\n                this.isAdd = true;\n                this.onActionBegin();\n                args.startEdit = false;\n                this.content.scrollTop = 0;\n            }\n            if (page < this.maxPage - 1 && this.parent.editSettings.newRowPosition === 'Bottom') {\n                this.isAdd = true;\n                this.parent.setProperties({ pageSettings: { currentPage: this.maxPage - 1 } }, true);\n                args.startEdit = false;\n                this.content.scrollTop = this.offsets[this.offsetKeys.length];\n            }\n        }\n    };\n    /**\n     * @param {number} index - specifies the index\n     * @returns {Object} returns the object\n     * @hidden\n     */\n    VirtualContentRenderer.prototype.getRowObjectByIndex = function (index) {\n        var data = this.getRowCollection(index, true);\n        return data;\n    };\n    VirtualContentRenderer.prototype.getBlockSize = function () {\n        return this.parent.pageSettings.pageSize >> 1;\n    };\n    VirtualContentRenderer.prototype.getBlockHeight = function () {\n        return this.getBlockSize() * this.parent.getRowHeight();\n    };\n    VirtualContentRenderer.prototype.isEndBlock = function (index) {\n        var totalBlocks = isGroupAdaptive(this.parent) ? this.getGroupedTotalBlocks() : this.getTotalBlocks();\n        return index >= totalBlocks || index === totalBlocks - 1;\n    };\n    VirtualContentRenderer.prototype.getGroupedTotalBlocks = function () {\n        var rows = this.parent.vcRows;\n        return Math.floor((rows.length / this.getBlockSize()) < 1 ? 1 : rows.length / this.getBlockSize());\n    };\n    VirtualContentRenderer.prototype.getTotalBlocks = function () {\n        return Math.ceil(this.count / this.getBlockSize());\n    };\n    VirtualContentRenderer.prototype.getColumnOffset = function (block) {\n        return this.vgenerator.cOffsets[parseInt(block.toString(), 10)] | 0;\n    };\n    VirtualContentRenderer.prototype.getModelGenerator = function () {\n        return new VirtualRowModelGenerator(this.parent);\n    };\n    VirtualContentRenderer.prototype.resetScrollPosition = function (action) {\n        if (this.actions.some(function (value) { return value === action; })) {\n            this.preventEvent = this.content.scrollTop !== 0;\n            this.content.scrollTop = 0;\n        }\n        if (action !== 'virtualscroll') {\n            this.isAdd = false;\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    VirtualContentRenderer.prototype.onActionBegin = function (e) {\n        //Update property silently..\n        this.parent.setProperties({ pageSettings: { currentPage: 1 } }, true);\n    };\n    VirtualContentRenderer.prototype.getRows = function () {\n        return this.vgenerator.getRows();\n    };\n    VirtualContentRenderer.prototype.getRowByIndex = function (index) {\n        var row;\n        if (isGroupAdaptive(this.parent)) {\n            if (!isNullOrUndefined(index) && this.parent.enableVirtualization && this.parent.groupSettings.columns.length) {\n                for (var i = 0; i < this.parent.getDataRows().length; i++) {\n                    if (this.parent.getDataRows()[parseInt(i.toString(), 10)].getAttribute(literals.dataRowIndex) === index.toString()) {\n                        row = this.parent.getDataRows()[parseInt(i.toString(), 10)];\n                    }\n                }\n            }\n            else {\n                row = !isNullOrUndefined(index) ? this.parent.getDataRows()[parseInt(index.toString(), 10)] : undefined;\n            }\n        }\n        else if (!this.parent.enableVirtualization && this.parent.enableColumnVirtualization) {\n            row = !isNullOrUndefined(index) ? this.parent.getDataRows()[parseInt(index.toString(), 10)] : undefined;\n        }\n        else if (this.prevInfo) {\n            row = this.getRowCollection(index, false);\n        }\n        return row;\n    };\n    VirtualContentRenderer.prototype.getMovableVirtualRowByIndex = function (index) {\n        return this.getRowCollection(index, false);\n    };\n    VirtualContentRenderer.prototype.getFrozenRightVirtualRowByIndex = function (index) {\n        return this.getRowCollection(index, false);\n    };\n    VirtualContentRenderer.prototype.getRowCollection = function (index, isRowObject) {\n        var prev = this.prevInfo.blockIndexes;\n        var startIdx = (prev[0] - 1) * this.getBlockSize();\n        if (this.parent.pageSettings.pageSize % 2 !== 0) {\n            startIdx += Math.floor((startIdx / this.getBlockSize()) / 2);\n        }\n        var rowCollection = this.parent.getDataRows();\n        rowCollection = rowCollection;\n        var collection = isRowObject ? this.parent.getCurrentViewRecords() : rowCollection;\n        if (isRowObject && this.parent.allowGrouping && this.parent.groupSettings.columns.length) {\n            startIdx = parseInt(this.parent.getRows()[0].getAttribute(literals.dataRowIndex), 10);\n            collection = collection.filter(function (m) { return isNullOrUndefined(m.items); });\n        }\n        var selectedRow = collection[index - startIdx];\n        if (this.parent.frozenRows && this.parent.pageSettings.currentPage > 1) {\n            if (!isRowObject) {\n                selectedRow = index <= this.parent.frozenRows ? rowCollection[parseInt(index.toString(), 10)]\n                    : rowCollection[(index - startIdx) + this.parent.frozenRows];\n            }\n            else {\n                selectedRow = index <= this.parent.frozenRows ? this.parent.getRowsObject()[parseInt(index.toString(), 10)].data\n                    : selectedRow;\n            }\n        }\n        return selectedRow;\n    };\n    VirtualContentRenderer.prototype.getVirtualRowIndex = function (index) {\n        var prev = this.prevInfo.blockIndexes;\n        var startIdx = (prev[0] - 1) * this.getBlockSize();\n        if (this.parent.enableVirtualization && this.parent.allowGrouping && this.parent.groupSettings.columns.length) {\n            var vGroupedRows = this.vgenerator.cache[prev[0]];\n            for (var i = 0; i < vGroupedRows.length; i++) {\n                if (vGroupedRows[\"\" + i].isDataRow) {\n                    startIdx = vGroupedRows[\"\" + i].index;\n                    break;\n                }\n            }\n        }\n        return startIdx + index;\n    };\n    /**\n     * @returns {void}\n     * @hidden */\n    VirtualContentRenderer.prototype.refreshOffsets = function () {\n        var gObj = this.parent;\n        var row = 0;\n        var bSize = this.getBlockSize();\n        var total = isGroupAdaptive(this.parent) ? this.getGroupedTotalBlocks() : this.getTotalBlocks();\n        this.prevHeight = this.offsets[parseInt(total.toString(), 10)];\n        this.maxBlock = total % 2 === 0 ? total - 2 : total - 1;\n        this.offsets = {};\n        //Row offset update\n        // eslint-disable-next-line prefer-spread\n        var blocks = Array.apply(null, Array(total)).map(function () { return ++row; });\n        for (var i = 0; i < blocks.length; i++) {\n            var tmp = (this.vgenerator.cache[blocks[parseInt(i.toString(), 10)]] || []).length;\n            var rem = !isGroupAdaptive(this.parent) ? this.count % bSize : (gObj.vcRows.length % bSize);\n            var size = !isGroupAdaptive(this.parent) && blocks[parseInt(i.toString(), 10)] in this.vgenerator.cache ?\n                tmp * this.parent.getRowHeight() : rem && blocks[parseInt(i.toString(), 10)] === total ? rem * this.parent.getRowHeight() :\n                this.getBlockHeight();\n            // let size: number = this.parent.groupSettings.columns.length && block in this.vgenerator.cache ?\n            // tmp * getRowHeight() : this.getBlockHeight();\n            this.offsets[blocks[parseInt(i.toString(), 10)]] = (this.offsets[blocks[parseInt(i.toString(), 10)] - 1] | 0) + size;\n            this.tmpOffsets[blocks[parseInt(i.toString(), 10)]] = this.offsets[blocks[parseInt(i.toString(), 10)] - 1] | 0;\n        }\n        this.offsetKeys = Object.keys(this.offsets);\n        if (isGroupAdaptive(this.parent)) {\n            this.parent.vGroupOffsets = this.offsets;\n        }\n        //Column offset update\n        if (this.parent.enableColumnVirtualization) {\n            this.vgenerator.refreshColOffsets();\n        }\n    };\n    VirtualContentRenderer.prototype.refreshVirtualElement = function () {\n        this.vgenerator.refreshColOffsets();\n        this.setVirtualHeight();\n    };\n    VirtualContentRenderer.prototype.setVisible = function (columns) {\n        var gObj = this.parent;\n        var rows = [];\n        rows = this.getRows();\n        var testRow;\n        rows.some(function (r) { if (r.isDataRow) {\n            testRow = r;\n        } return r.isDataRow; });\n        var isRefresh = true;\n        if (!gObj.groupSettings.columns.length && testRow) {\n            isRefresh = false;\n        }\n        var tr = gObj.getDataRows();\n        for (var c = 0, clen = columns.length; c < clen; c++) {\n            var column = columns[parseInt(c.toString(), 10)];\n            var idx = gObj.getNormalizedColumnIndex(column.uid);\n            var displayVal = column.visible === true ? '' : 'none';\n            var colGrp = this.getColGroup().children;\n            if (idx !== -1 && testRow && idx < testRow.cells.length) {\n                setStyleAttribute(colGrp[parseInt(idx.toString(), 10)], { 'display': displayVal });\n            }\n            if (!isRefresh) {\n                var width = void 0;\n                if (column.width) {\n                    if (column.visible) {\n                        width = this.virtualEle.wrapper.offsetWidth + parseInt(column.width.toString(), 10);\n                    }\n                    else {\n                        width = this.virtualEle.wrapper.offsetWidth - parseInt(column.width.toString(), 10);\n                    }\n                }\n                if (width > gObj.width) {\n                    this.setDisplayNone(tr, idx, displayVal, rows);\n                    if (this.parent.enableColumnVirtualization) {\n                        this.virtualEle.setWrapperWidth(width + '');\n                    }\n                    this.refreshVirtualElement();\n                }\n                else {\n                    isRefresh = true;\n                }\n            }\n            if (!this.parent.invokedFromMedia && column.hideAtMedia) {\n                this.parent.updateMediaColumns(column);\n            }\n            this.parent.invokedFromMedia = false;\n        }\n        if (isRefresh) {\n            this.refreshContentRows({ requestType: 'refresh' });\n        }\n        else {\n            this.parent.notify(events.partialRefresh, { rows: rows, args: { isFrozen: false, rows: rows } });\n        }\n    };\n    VirtualContentRenderer.prototype.selectVirtualRow = function (args) {\n        var _this = this;\n        args.isAvailable = args.selectedIndex < this.count;\n        if (args.isAvailable && !this.isContextMenuOpen && this.activeKey !== 'upArrow'\n            && this.activeKey !== 'downArrow' && !this.isSelection && !this.requestTypes.some(function (value) { return value === _this.requestType; })\n            && !this.parent.selectionModule.isInteracted) {\n            var selectedRow = this.parent.getRowByIndex(args.selectedIndex);\n            var rowHeight = this.parent.getRowHeight();\n            if (!selectedRow || !this.isRowInView(selectedRow)) {\n                this.isSelection = true;\n                this.selectedRowIndex = args.selectedIndex;\n                var scrollTop = (args.selectedIndex + 1) * rowHeight;\n                if (!isNullOrUndefined(scrollTop)) {\n                    var direction = this.content.scrollTop < scrollTop ? 'down' : 'up';\n                    this.selectRowIndex = args.selectedIndex;\n                    this.content.scrollTop = scrollTop;\n                    this.isSelectionScroll = this.observer.check(direction);\n                }\n            }\n        }\n        this.requestType = this.empty;\n    };\n    VirtualContentRenderer.prototype.isRowInView = function (row) {\n        var top = row.getBoundingClientRect().top;\n        var bottom = row.getBoundingClientRect().bottom;\n        return (top >= this.content.getBoundingClientRect().top && bottom <= this.content.getBoundingClientRect().bottom);\n    };\n    return VirtualContentRenderer;\n}(ContentRender));\nexport { VirtualContentRenderer };\n/**\n * @hidden\n */\nvar VirtualHeaderRenderer = /** @class */ (function (_super) {\n    __extends(VirtualHeaderRenderer, _super);\n    function VirtualHeaderRenderer(parent, locator) {\n        var _this = _super.call(this, parent, locator) || this;\n        _this.virtualEle = new VirtualElementHandler();\n        _this.isMovable = false;\n        _this.gen = new VirtualRowModelGenerator(_this.parent);\n        _this.parent.on(events.columnVisibilityChanged, _this.setVisible, _this);\n        _this.parent.on(refreshVirtualBlock, function (e) { return e.virtualInfo.sentinelInfo.axis === 'X' ? _this.refreshUI() : null; }, _this);\n        return _this;\n    }\n    VirtualHeaderRenderer.prototype.renderTable = function () {\n        this.gen.refreshColOffsets();\n        this.parent.setColumnIndexesInView(this.gen.getColumnIndexes(this.getPanel().querySelector('.' + literals.headerContent)));\n        _super.prototype.renderTable.call(this);\n        this.virtualEle.table = this.getTable();\n        this.virtualEle.content = this.getPanel().querySelector('.' + literals.headerContent);\n        this.virtualEle.content.style.position = 'relative';\n        this.virtualEle.renderWrapper();\n        (!this.parent.enableVirtualization && this.parent.enableColumnVirtualization) ? this.virtualEle.renderPlaceHolder() : this.virtualEle.renderPlaceHolder('absolute');\n    };\n    VirtualHeaderRenderer.prototype.appendContent = function (table) {\n        this.virtualEle.wrapper.appendChild(table);\n    };\n    VirtualHeaderRenderer.prototype.refreshUI = function () {\n        this.gen.refreshColOffsets();\n        this.parent.setColumnIndexesInView(this.gen.getColumnIndexes(this.getPanel().querySelector('.' + literals.headerContent)));\n        _super.prototype.refreshUI.call(this);\n    };\n    VirtualHeaderRenderer.prototype.setVisible = function (columns) {\n        var gObj = this.parent;\n        var displayVal;\n        var idx;\n        var needFullRefresh;\n        for (var c = 0, clen = columns.length; c < clen; c++) {\n            var column = columns[parseInt(c.toString(), 10)];\n            idx = gObj.getNormalizedColumnIndex(column.uid);\n            displayVal = column.visible ? '' : 'none';\n            var colGrp = this.getColGroup().children;\n            setStyleAttribute(colGrp[parseInt(idx.toString(), 10)], { 'display': displayVal });\n            if (gObj.enableColumnVirtualization && !gObj.groupSettings.columns.length) {\n                var tablewidth = void 0;\n                if (column.visible) {\n                    tablewidth = this.virtualEle.wrapper.offsetWidth + parseInt(column.width.toString(), 10);\n                }\n                else {\n                    tablewidth = this.virtualEle.wrapper.offsetWidth - parseInt(column.width.toString(), 10);\n                }\n                if (tablewidth > gObj.width) {\n                    this.setDisplayNone(column, displayVal);\n                    this.virtualEle.setWrapperWidth(tablewidth + '');\n                    this.gen.refreshColOffsets();\n                }\n                else {\n                    needFullRefresh = true;\n                }\n            }\n            else {\n                needFullRefresh = true;\n            }\n            if (needFullRefresh) {\n                this.refreshUI();\n            }\n        }\n    };\n    VirtualHeaderRenderer.prototype.setDisplayNone = function (col, displayVal) {\n        var table = this.getTable();\n        for (var _i = 0, _a = [].slice.apply(table.querySelectorAll('th.e-headercell')); _i < _a.length; _i++) {\n            var ele = _a[_i];\n            if (ele.querySelector('[e-mappinguid]') &&\n                ele.querySelector('[e-mappinguid]').getAttribute('e-mappinguid') === col.uid) {\n                setStyleAttribute(ele, { 'display': displayVal });\n                if (displayVal === '') {\n                    removeClass([ele], 'e-hide');\n                }\n                break;\n            }\n        }\n    };\n    return VirtualHeaderRenderer;\n}(HeaderRender));\nexport { VirtualHeaderRenderer };\n/**\n * @hidden\n */\nvar VirtualElementHandler = /** @class */ (function () {\n    function VirtualElementHandler() {\n    }\n    VirtualElementHandler.prototype.renderWrapper = function (height) {\n        this.wrapper = createElement('div', { className: 'e-virtualtable', styles: \"min-height:\" + formatUnit(height) });\n        this.wrapper.appendChild(this.table);\n        this.content.appendChild(this.wrapper);\n    };\n    VirtualElementHandler.prototype.renderPlaceHolder = function (position) {\n        if (position === void 0) { position = 'relative'; }\n        this.placeholder = createElement('div', { className: 'e-virtualtrack', styles: \"position:\" + position });\n        this.content.appendChild(this.placeholder);\n    };\n    VirtualElementHandler.prototype.renderFrozenWrapper = function (height) {\n        this.wrapper = createElement('div', { className: 'e-virtualtable', styles: \"min-height:\" + formatUnit(height) + \"; display: flex\" });\n        this.content.appendChild(this.wrapper);\n    };\n    VirtualElementHandler.prototype.renderFrozenPlaceHolder = function () {\n        this.placeholder = createElement('div', { className: 'e-virtualtrack' });\n        this.content.appendChild(this.placeholder);\n    };\n    VirtualElementHandler.prototype.renderMovableWrapper = function (height) {\n        this.movableWrapper = createElement('div', { className: 'e-virtualtable', styles: \"min-height:\" + formatUnit(height) });\n        this.movableContent.appendChild(this.movableWrapper);\n    };\n    VirtualElementHandler.prototype.renderMovablePlaceHolder = function () {\n        this.movablePlaceholder = createElement('div', { className: 'e-virtualtrack' });\n        this.movableContent.appendChild(this.movablePlaceholder);\n    };\n    VirtualElementHandler.prototype.adjustTable = function (xValue, yValue) {\n        this.wrapper.style.transform = \"translate(\" + xValue + \"px, \" + yValue + \"px)\";\n    };\n    VirtualElementHandler.prototype.adjustMovableTable = function (xValue, yValue) {\n        this.movableWrapper.style.transform = \"translate(\" + xValue + \"px, \" + yValue + \"px)\";\n    };\n    VirtualElementHandler.prototype.setMovableWrapperWidth = function (width, full) {\n        this.movableWrapper.style.width = width ? width + \"px\" : full ? '100%' : '';\n    };\n    VirtualElementHandler.prototype.setMovableVirtualHeight = function (height, width) {\n        this.movablePlaceholder.style.height = height + \"px\";\n        this.movablePlaceholder.style.width = width;\n    };\n    VirtualElementHandler.prototype.setWrapperWidth = function (width, full) {\n        if (width && width.indexOf('%') === -1 && !(this.content.getBoundingClientRect().width < parseInt(width))) {\n            width = undefined;\n            full = true;\n        }\n        this.wrapper.style.width = width ? width + \"px\" : full ? '100%' : '';\n    };\n    VirtualElementHandler.prototype.setVirtualHeight = function (height, width) {\n        this.placeholder.style.height = !isNullOrUndefined(height) ? height + \"px\" : '0px';\n        if (width && width.indexOf('%') === -1 && !(this.content.getBoundingClientRect().width < parseInt(width))) {\n            width = '100%';\n        }\n        this.placeholder.style.width = width;\n    };\n    VirtualElementHandler.prototype.setFreezeWrapperWidth = function (wrapper, width, full) {\n        wrapper.style.width = width ? width + \"px\" : full ? '100%' : '';\n    };\n    return VirtualElementHandler;\n}());\nexport { VirtualElementHandler };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}