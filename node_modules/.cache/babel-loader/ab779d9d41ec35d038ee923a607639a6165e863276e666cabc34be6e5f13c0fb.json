{"ast":null,"code":"import { isNullOrUndefined as isNOU, detach, Browser } from '@syncfusion/ej2-base';\nimport * as events from '../base/constant';\n/**\n * `EnterKey` module is used to handle enter key press actions.\n */\nvar EnterKeyAction = /** @class */function () {\n  function EnterKeyAction(parent) {\n    this.parent = parent;\n    this.addEventListener();\n  }\n  EnterKeyAction.prototype.addEventListener = function () {\n    this.parent.on(events.enterHandler, this.enterHandler, this);\n    this.parent.on(events.destroy, this.destroy, this);\n    this.parent.on(events.moduleDestroy, this.moduleDestroy, this);\n  };\n  EnterKeyAction.prototype.destroy = function () {\n    if (isNOU(this.parent)) {\n      return;\n    }\n    this.removeEventListener();\n  };\n  EnterKeyAction.prototype.moduleDestroy = function () {\n    this.parent = null;\n  };\n  EnterKeyAction.prototype.removeEventListener = function () {\n    this.parent.off(events.enterHandler, this.enterHandler);\n    this.parent.off(events.destroy, this.destroy);\n    this.parent.off(events.moduleDestroy, this.moduleDestroy);\n  };\n  EnterKeyAction.prototype.getRangeNode = function () {\n    this.range = this.parent.getRange();\n    this.startNode = this.range.startContainer.nodeName === '#text' ? this.range.startContainer.parentElement : this.range.startContainer;\n    this.endNode = this.range.endContainer.nodeName === '#text' ? this.range.endContainer.parentElement : this.range.endContainer;\n  };\n  EnterKeyAction.prototype.enterHandler = function (e) {\n    var _this = this;\n    this.getRangeNode();\n    var isTableEnter = true;\n    this.formatTags = ['h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'blockquote'];\n    if (!isNOU(this.startNode.closest('TABLE')) && !isNOU(this.endNode.closest('TABLE'))) {\n      isTableEnter = false;\n      var curElement = this.startNode;\n      var blockElement = curElement;\n      while (!this.parent.formatter.editorManager.domNode.isBlockNode(curElement)) {\n        curElement = curElement.parentElement;\n        blockElement = curElement;\n      }\n      isTableEnter = blockElement.tagName === 'TD' || blockElement.tagName === 'TBODY' ? false : true;\n    }\n    if (e.args.which === 13 && !e.args.ctrlKey && (!Browser.isDevice ? e.args.code === 'Enter' : e.args.key === 'Enter')) {\n      if (isNOU(this.startNode.closest('LI, UL, OL')) && isNOU(this.endNode.closest('LI, UL, OL')) && isTableEnter && isNOU(this.startNode.closest('PRE')) && isNOU(this.endNode.closest('PRE'))) {\n        var shiftKey_1 = e.args.shiftKey;\n        var actionBeginArgs = {\n          cancel: false,\n          name: events.actionBegin,\n          requestType: shiftKey_1 ? 'ShiftEnterAction' : 'EnterAction',\n          originalEvent: e.args\n        };\n        this.parent.trigger(events.actionBegin, actionBeginArgs, function (actionBeginArgs) {\n          if (!actionBeginArgs.cancel) {\n            if (!(_this.range.startOffset === _this.range.endOffset && _this.range.startContainer === _this.range.endContainer)) {\n              if (!(_this.range.startContainer.nodeName === 'SPAN' && (_this.range.startContainer.classList.contains('e-video-wrap') || _this.range.startContainer.classList.contains('e-audio-wrap')))) {\n                _this.range.deleteContents();\n              }\n              if (_this.range.startContainer.nodeName === '#text' && _this.range.startContainer.textContent.length === 0 && _this.range.startContainer.parentElement !== _this.parent.inputElement) {\n                if (_this.parent.enterKey === 'BR') {\n                  _this.range.startContainer.parentElement.innerHTML = '&#8203;';\n                } else {\n                  _this.range.startContainer.parentElement.innerHTML = '<br>';\n                }\n              } else if (_this.range.startContainer === _this.parent.inputElement && _this.range.startContainer.innerHTML === '') {\n                _this.range.startContainer.innerHTML = '<br>';\n                var focusElem = _this.range.startContainer.childNodes[_this.range.startOffset];\n                _this.parent.formatter.editorManager.nodeSelection.setCursorPoint(_this.parent.contentModule.getDocument(), focusElem, 0);\n              } else if (_this.parent.inputElement === _this.range.startContainer) {\n                var focusElem = _this.range.startContainer.childNodes[_this.range.startOffset];\n                if (focusElem.nodeName === '#text' && focusElem.textContent.length === 0) {\n                  _this.parent.formatter.editorManager.nodeSelection.setCursorPoint(_this.parent.contentModule.getDocument(), focusElem, focusElem.textContent.length === 0 ? 0 : focusElem.previousSibling.textContent.length);\n                } else {\n                  _this.parent.formatter.editorManager.nodeSelection.setCursorPoint(_this.parent.contentModule.getDocument(), focusElem, focusElem.textContent.length >= 0 ? 0 : 1);\n                  if (focusElem.previousSibling.textContent.length === 0) {\n                    detach(focusElem.previousSibling);\n                    if (!shiftKey_1) {\n                      var currentFocusElem = !isNOU(focusElem.lastChild) ? focusElem.lastChild : focusElem;\n                      while (!isNOU(currentFocusElem) && currentFocusElem.nodeName !== '#text' && currentFocusElem.nodeName !== 'BR') {\n                        currentFocusElem = currentFocusElem.lastChild;\n                      }\n                      if (currentFocusElem.nodeName !== 'BR' && currentFocusElem.parentElement.textContent.length === 0 && currentFocusElem.parentElement.innerHTML.length === 0 && currentFocusElem.parentElement.nodeName !== 'BR') {\n                        currentFocusElem.parentElement.appendChild(_this.parent.createElement('BR'));\n                      }\n                      _this.parent.formatter.editorManager.nodeSelection.setCursorPoint(_this.parent.contentModule.getDocument(), currentFocusElem.nodeName === 'BR' ? currentFocusElem : currentFocusElem.parentElement, currentFocusElem.parentElement.textContent.length >= 0 || currentFocusElem.nodeName === 'BR' ? 0 : 1);\n                    }\n                  } else if (focusElem.textContent.length === 0) {\n                    var currentFocusElem = focusElem.previousSibling.nodeName === '#text' ? focusElem.previousSibling : focusElem.previousSibling.lastChild;\n                    while (!isNOU(currentFocusElem) && currentFocusElem.nodeName !== '#text') {\n                      currentFocusElem = currentFocusElem.lastChild;\n                    }\n                    _this.parent.formatter.editorManager.nodeSelection.setCursorPoint(_this.parent.contentModule.getDocument(), currentFocusElem, currentFocusElem.textContent.length);\n                    detach(focusElem);\n                  } else if (_this.parent.enterKey !== 'BR' && focusElem.previousSibling.textContent.length !== 0 && focusElem.textContent.length !== 0) {\n                    e.args.preventDefault();\n                    return;\n                  }\n                }\n                _this.getRangeNode();\n              }\n            }\n            if (_this.range.startContainer === _this.range.endContainer && _this.range.startOffset === _this.range.endOffset && _this.range.startContainer === _this.parent.inputElement) {\n              if (!(_this.parent.inputElement.childNodes.length === 1 && _this.parent.inputElement.childNodes[0].nodeName === 'TABLE')) {\n                if (isNOU(_this.range.startContainer.childNodes[_this.range.startOffset])) {\n                  var currentLastElem = _this.range.startContainer.childNodes[_this.range.startOffset - 1];\n                  while (currentLastElem.lastChild !== null && currentLastElem.nodeName !== '#text') {\n                    currentLastElem = currentLastElem.lastChild;\n                  }\n                  _this.parent.formatter.editorManager.nodeSelection.setCursorPoint(_this.parent.contentModule.getDocument(), currentLastElem, currentLastElem.nodeName === 'BR' ? 0 : currentLastElem.textContent.length);\n                } else {\n                  _this.parent.formatter.editorManager.nodeSelection.setCursorPoint(_this.parent.contentModule.getDocument(), _this.range.startContainer.childNodes[_this.range.startOffset], 0);\n                }\n              }\n              _this.getRangeNode();\n            }\n            if (_this.parent.enterKey === 'P' && !shiftKey_1 || _this.parent.enterKey === 'DIV' && !shiftKey_1 || _this.parent.shiftEnterKey === 'P' && shiftKey_1 || _this.parent.shiftEnterKey === 'DIV' && shiftKey_1) {\n              if (_this.range.startOffset === 1 && _this.parent.inputElement.childNodes.length === 1 && _this.parent.inputElement.childNodes[0].nodeName === 'TABLE') {\n                var newElem = _this.createInsertElement(shiftKey_1);\n                newElem.appendChild(_this.parent.createElement('BR'));\n                _this.parent.inputElement.appendChild(newElem);\n                _this.parent.formatter.editorManager.nodeSelection.setCursorPoint(_this.parent.contentModule.getDocument(), newElem, 0);\n              } else {\n                var nearBlockNode = void 0;\n                if (isTableEnter && _this.parent.formatter.editorManager.domNode.isBlockNode(_this.startNode)) {\n                  nearBlockNode = _this.startNode;\n                } else {\n                  nearBlockNode = _this.parent.formatter.editorManager.domNode.blockParentNode(_this.startNode);\n                }\n                var isMediaNode = false; // To check the image audio and video node cases\n                var isFocusedFirst = false;\n                if (_this.range.startOffset !== 0 && _this.range.endOffset !== 0 && _this.range.startContainer === _this.range.endContainer && !(!isNOU(nearBlockNode.childNodes[0]) && (nearBlockNode.childNodes[0].nodeName === 'IMG' || nearBlockNode.querySelectorAll('img, audio, video').length > 0))) {\n                  var startNodeText = _this.range.startContainer.textContent;\n                  var splitFirstText = startNodeText.substring(0, _this.range.startOffset);\n                  // eslint-disable-next-line max-len\n                  if (splitFirstText.charCodeAt(_this.range.startOffset - 1) !== 160 && splitFirstText.trim().length === 0) {\n                    isFocusedFirst = true;\n                  }\n                } else if (_this.range.startOffset === 0 && _this.range.endOffset === 0) {\n                  isFocusedFirst = true;\n                }\n                _this.removeBRElement(nearBlockNode);\n                var fireFoxEnterAtMiddle = Browser.userAgent.indexOf('Firefox') !== -1 && _this.range.startOffset === 0 && _this.range.startContainer === _this.range.endContainer && _this.range.startContainer.nodeName === '#text' && !_this.parent.formatter.editorManager.domNode.isBlockNode(_this.range.startContainer.previousSibling) && _this.range.startContainer.parentElement === _this.range.startContainer.previousSibling.parentElement;\n                // eslint-disable-next-line max-len\n                if (!fireFoxEnterAtMiddle && (_this.range.startOffset === 0 && _this.range.endOffset === 0 || isFocusedFirst) && !(!isNOU(_this.range.startContainer.previousSibling) && (_this.range.startContainer.previousSibling.nodeName === 'IMG' || _this.range.startContainer.previousSibling.nodeName === 'BR'))) {\n                  var isNearBlockLengthZero = void 0;\n                  var newElem = void 0;\n                  if (!isNOU(_this.range.startContainer.childNodes) && (_this.range.startContainer.textContent.length === 0 || _this.range.startContainer.nodeName !== '#text' && !isNOU(_this.range.startContainer.querySelector('.e-video-clickelem')) && _this.range.startContainer.querySelector('.e-video-clickelem').textContent.length === 0) && (_this.range.startContainer.querySelectorAll('img, audio, video').length > 0 || !isNOU(_this.range.startContainer.querySelector('.e-video-clickelem')) || _this.range.startContainer.nodeName === 'IMG' || _this.range.startContainer.nodeName === 'TABLE')) {\n                    newElem = _this.createInsertElement(shiftKey_1);\n                    isMediaNode = true;\n                    isNearBlockLengthZero = false;\n                  } else {\n                    if (nearBlockNode.textContent.trim().length !== 0 || nearBlockNode.childNodes[0].nodeName === 'IMG' || nearBlockNode.textContent.trim() === '' && nearBlockNode.querySelectorAll('img, audio, video').length > 0) {\n                      if (_this.range.startOffset === _this.range.endOffset && _this.range.startOffset !== 0) {\n                        newElem = _this.parent.formatter.editorManager.nodeCutter.SplitNode(_this.range, nearBlockNode, false).cloneNode(true);\n                      } else {\n                        newElem = _this.parent.formatter.editorManager.nodeCutter.SplitNode(_this.range, nearBlockNode, true).cloneNode(true);\n                        isMediaNode = true;\n                      }\n                      isNearBlockLengthZero = false;\n                    } else {\n                      newElem = _this.parent.formatter.editorManager.nodeCutter.SplitNode(_this.range, nearBlockNode, true).cloneNode(true);\n                      isNearBlockLengthZero = true;\n                    }\n                  }\n                  var insertElem = void 0;\n                  if (_this.formatTags.indexOf(newElem.nodeName.toLocaleLowerCase()) < 0) {\n                    insertElem = _this.createInsertElement(shiftKey_1);\n                  } else {\n                    insertElem = _this.parent.createElement(newElem.nodeName);\n                  }\n                  while (newElem.firstChild) {\n                    insertElem.appendChild(newElem.firstChild);\n                  }\n                  nearBlockNode.parentElement.insertBefore(insertElem, nearBlockNode);\n                  if (!isNearBlockLengthZero) {\n                    var currentFocusElem = insertElem;\n                    var finalFocusElem = void 0;\n                    if (_this.range.startOffset === _this.range.endOffset && _this.range.startOffset !== 0) {\n                      while (!isNOU(currentFocusElem) && currentFocusElem.nodeName !== '#text' && currentFocusElem.nodeName !== 'BR') {\n                        finalFocusElem = currentFocusElem;\n                        currentFocusElem = currentFocusElem.lastChild;\n                      }\n                    } else {\n                      finalFocusElem = currentFocusElem;\n                    }\n                    finalFocusElem.innerHTML = '<br>';\n                    if (!isMediaNode) {\n                      detach(nearBlockNode);\n                    }\n                  }\n                  _this.parent.formatter.editorManager.nodeSelection.setCursorPoint(_this.parent.contentModule.getDocument(), insertElem.nextElementSibling, 0);\n                } else if (nearBlockNode.textContent.length === 0 && !(!isNOU(nearBlockNode.childNodes[0]) && nearBlockNode.childNodes[0].nodeName === 'IMG' || nearBlockNode.querySelectorAll('video').length > 0 || nearBlockNode.querySelectorAll('audio').length > 0 || nearBlockNode.querySelectorAll('img').length > 0)) {\n                  if (!isNOU(nearBlockNode.children[0]) && nearBlockNode.children[0].tagName !== 'BR') {\n                    var newElem = _this.parent.formatter.editorManager.nodeCutter.SplitNode(_this.range, nearBlockNode, false).cloneNode(true);\n                    _this.parent.formatter.editorManager.domNode.insertAfter(newElem, nearBlockNode);\n                    _this.parent.formatter.editorManager.nodeSelection.setCursorPoint(_this.parent.contentModule.getDocument(), newElem, newElem.textContent.length >= 0 ? 0 : 1);\n                  } else {\n                    var insertElem = _this.createInsertElement(shiftKey_1);\n                    insertElem.innerHTML = '<br>';\n                    _this.parent.formatter.editorManager.domNode.insertAfter(insertElem, nearBlockNode);\n                    _this.parent.formatter.editorManager.nodeSelection.setCursorPoint(_this.parent.contentModule.getDocument(), insertElem, 0);\n                  }\n                } else if (_this.range.startContainer === _this.range.endContainer && _this.range.startContainer.nodeName === 'SPAN' && (_this.range.startContainer.classList.contains('e-video-wrap') || _this.range.startContainer.classList.contains('e-audio-wrap'))) {\n                  if (nearBlockNode.textContent.trim().length > 0) {\n                    var newElem = _this.parent.formatter.editorManager.nodeCutter.SplitNode(_this.range, nearBlockNode, true);\n                    var audioVideoElem = !isNOU(newElem.previousSibling.querySelector('.e-video-wrap')) ? newElem.previousSibling.querySelector('.e-video-wrap') : newElem.previousSibling.querySelector('.e-audio-wrap');\n                    var isBRInserted = false;\n                    var lastNode = audioVideoElem.previousSibling;\n                    while (!isNOU(lastNode) && lastNode.nodeName !== '#text') {\n                      lastNode = lastNode.lastChild;\n                    }\n                    if (isNOU(lastNode)) {\n                      var brElm = _this.parent.createElement('br');\n                      audioVideoElem.parentElement.appendChild(brElm);\n                      isBRInserted = true;\n                    }\n                    if (isBRInserted) {\n                      _this.parent.formatter.editorManager.nodeSelection.setCursorPoint(_this.parent.contentModule.getDocument(), audioVideoElem.parentElement, 0);\n                    } else {\n                      _this.parent.formatter.editorManager.nodeSelection.setCursorPoint(_this.parent.contentModule.getDocument(), lastNode, lastNode.textContent.length);\n                    }\n                    detach(audioVideoElem);\n                  } else {\n                    var newElem = _this.parent.formatter.editorManager.nodeCutter.SplitNode(_this.range, nearBlockNode, true);\n                    var focusElem = newElem.previousSibling;\n                    while (!isNOU(focusElem.firstChild)) {\n                      detach(focusElem.firstChild);\n                    }\n                    var brElm = _this.parent.createElement('br');\n                    focusElem.appendChild(brElm);\n                    _this.parent.formatter.editorManager.nodeSelection.setCursorPoint(_this.parent.contentModule.getDocument(), focusElem, 0);\n                  }\n                  if (!isNOU(_this.parent.audioModule)) {\n                    _this.parent.audioModule.hideAudioQuickToolbar();\n                  }\n                  if (!isNOU(_this.parent.videoModule)) {\n                    _this.parent.videoModule.hideVideoQuickToolbar();\n                  }\n                } else {\n                  var newElem = _this.parent.formatter.editorManager.nodeCutter.SplitNode(_this.range, nearBlockNode, true);\n                  if (!isNOU(newElem.childNodes[0]) && newElem.childNodes[0].nodeName === '#text' && newElem.childNodes[0].textContent.length === 0) {\n                    detach(newElem.childNodes[0]);\n                  }\n                  if (newElem.textContent.trim().length === 0) {\n                    var brElm = _this.parent.createElement('br');\n                    if (_this.startNode.nodeName === 'A') {\n                      var startParentElem = _this.startNode.parentElement;\n                      _this.startNode.parentElement.insertBefore(brElm, _this.startNode);\n                      detach(_this.startNode);\n                      _this.startNode = startParentElem;\n                    } else {\n                      if (_this.startNode.nodeName !== 'BR') {\n                        _this.startNode.appendChild(brElm);\n                      }\n                    }\n                    if (newElem.childNodes[0].textContent === '\\n') {\n                      detach(newElem.childNodes[0]);\n                    }\n                    _this.parent.formatter.editorManager.nodeSelection.setCursorPoint(_this.parent.contentModule.getDocument(), _this.startNode, 0);\n                  }\n                  if ((_this.parent.enterKey === 'P' || _this.parent.enterKey === 'DIV') && !shiftKey_1 || (_this.parent.shiftEnterKey === 'DIV' || _this.parent.shiftEnterKey === 'P') && shiftKey_1) {\n                    var isHeadingTag = _this.formatTags.indexOf(newElem.nodeName.toLocaleLowerCase());\n                    if (isHeadingTag < 0 || isHeadingTag >= 0 && newElem.textContent.trim().length === 0) {\n                      var insertElm = _this.createInsertElement(shiftKey_1);\n                      while (newElem.firstChild) {\n                        insertElm.appendChild(newElem.firstChild);\n                      }\n                      _this.parent.formatter.editorManager.domNode.insertAfter(insertElm, newElem);\n                      detach(newElem);\n                      _this.parent.formatter.editorManager.nodeSelection.setCursorPoint(_this.parent.contentModule.getDocument(), _this.parent.formatter.editorManager.domNode.isBlockNode(_this.startNode) ? insertElm : _this.startNode, 0);\n                    }\n                  }\n                }\n              }\n              e.args.preventDefault();\n            }\n            if (_this.parent.enterKey === 'BR' && !shiftKey_1 || _this.parent.shiftEnterKey === 'BR' && shiftKey_1) {\n              var currentParent = void 0;\n              if (!_this.parent.formatter.editorManager.domNode.isBlockNode(_this.startNode)) {\n                var currentNode = _this.startNode;\n                var previousNode = currentNode;\n                while (!_this.parent.formatter.editorManager.domNode.isBlockNode(currentNode)) {\n                  previousNode = currentNode;\n                  currentNode = currentNode.parentElement;\n                }\n                currentParent = currentNode === _this.parent.inputElement ? previousNode : currentNode;\n              } else {\n                currentParent = _this.startNode;\n              }\n              _this.removeBRElement(currentParent);\n              var isEmptyBrInserted = false;\n              var currentParentLastChild = currentParent.lastChild;\n              while (!isNOU(currentParentLastChild) && !(currentParentLastChild.nodeName === '#text' || currentParentLastChild.nodeName === 'BR' || currentParentLastChild.nodeName === 'IMG')) {\n                currentParentLastChild = currentParentLastChild.lastChild;\n              }\n              var isLastNodeLength = _this.range.startContainer === currentParentLastChild ? _this.range.startContainer.textContent.length : currentParent.textContent.length;\n              var isImageElement = _this.range.startContainer.nodeName === 'IMG' || _this.range.startContainer.childNodes.length > 0 && _this.range.startContainer.childNodes[_this.range.startOffset].nodeName === 'IMG';\n              if (currentParent !== _this.parent.inputElement && _this.parent.formatter.editorManager.domNode.isBlockNode(currentParent) && _this.range.startOffset === _this.range.endOffset && (_this.range.startOffset === isLastNodeLength || currentParent.textContent.trim().length === 0 && isImageElement)) {\n                var focusBRElem = _this.parent.createElement('br');\n                if (_this.range.startOffset === 0 && _this.range.startContainer.nodeName === 'TABLE') {\n                  _this.range.startContainer.parentElement.insertBefore(focusBRElem, _this.range.startContainer);\n                } else {\n                  if (currentParentLastChild.nodeName === 'BR' && currentParent.textContent.length === 0) {\n                    _this.parent.formatter.editorManager.domNode.insertAfter(focusBRElem, currentParentLastChild);\n                  } else if (_this.range.startOffset === 0 && _this.range.endOffset === 0 && isImageElement) {\n                    var imageElement = _this.range.startContainer.nodeName === 'IMG' ? _this.range.startContainer : _this.range.startContainer.childNodes[_this.range.startOffset];\n                    currentParent.insertBefore(focusBRElem, imageElement);\n                    focusBRElem = imageElement;\n                  } else {\n                    var lineBreakBRElem = _this.parent.createElement('br');\n                    _this.parent.formatter.editorManager.domNode.insertAfter(focusBRElem, _this.range.startContainer);\n                    _this.parent.formatter.editorManager.domNode.insertAfter(lineBreakBRElem, _this.range.startContainer);\n                  }\n                }\n                _this.parent.formatter.editorManager.nodeSelection.setCursorPoint(_this.parent.contentModule.getDocument(), focusBRElem, 0);\n              } else if (!isNOU(currentParent) && currentParent !== _this.parent.inputElement && currentParent.nodeName !== 'BR') {\n                if (currentParent.textContent.trim().length === 0 || currentParent.textContent.trim().length === 1 && currentParent.textContent.charCodeAt(0) === 8203) {\n                  var newElem = _this.parent.formatter.editorManager.nodeCutter.SplitNode(_this.range, currentParent, true).cloneNode(true);\n                  _this.parent.formatter.editorManager.domNode.insertAfter(newElem, currentParent);\n                  var outerBRElem = _this.parent.createElement('br');\n                  newElem.parentElement.insertBefore(outerBRElem, newElem);\n                  _this.parent.formatter.editorManager.nodeSelection.setCursorPoint(_this.parent.contentModule.getDocument(), newElem, 0);\n                } else {\n                  var newElem = void 0;\n                  var outerBRElem = _this.parent.createElement('br');\n                  if (_this.range.startOffset === 0 && _this.range.endOffset === 0 && !isNOU(currentParent.previousSibling) && currentParent.previousSibling.nodeName === 'BR' && currentParent.nodeName !== 'P' && currentParent.nodeName !== 'DIV') {\n                    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n                    newElem = _this.parent.formatter.editorManager.nodeCutter.SplitNode(_this.range, currentParent, false).cloneNode(true);\n                    _this.parent.formatter.editorManager.domNode.insertAfter(outerBRElem, currentParent);\n                    _this.insertFocusContent();\n                    var currentFocusElem = outerBRElem.nextSibling;\n                    while (!isNOU(currentFocusElem) && currentFocusElem.nodeName !== '#text') {\n                      currentFocusElem = currentFocusElem.lastChild;\n                    }\n                    _this.parent.formatter.editorManager.nodeSelection.setCursorPoint(_this.parent.contentModule.getDocument(), currentFocusElem, 0);\n                    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n                    isEmptyBrInserted = true;\n                  } else {\n                    _this.insertBRElement();\n                  }\n                }\n              } else {\n                _this.insertBRElement();\n              }\n              e.args.preventDefault();\n            }\n            _this.parent.trigger(events.actionComplete, {\n              requestType: shiftKey_1 ? 'ShiftEnterAction' : 'EnterAction',\n              args: e.args\n            });\n          }\n        });\n      }\n    }\n  };\n  EnterKeyAction.prototype.removeBRElement = function (currentElement) {\n    if (Browser.userAgent.indexOf('Firefox') !== -1 && this.range.endOffset === currentElement.textContent.length && (currentElement.textContent.length !== 0 || currentElement.querySelectorAll('BR').length > 1) && !isNOU(currentElement.lastChild) && currentElement.lastChild.nodeName === 'BR') {\n      detach(currentElement.lastChild);\n    }\n  };\n  EnterKeyAction.prototype.insertBRElement = function () {\n    var isEmptyBrInserted = false;\n    var isFocusTextNode = true;\n    if (this.range.endContainer.textContent.length === 0 && this.range.startContainer.nodeName === 'BR') {\n      isFocusTextNode = false;\n    }\n    var brElm = this.parent.createElement('br');\n    if (this.startNode.nodeName === 'BR' && this.endNode.nodeName === 'BR' && this.range.startOffset === 0 && this.range.startOffset === this.range.endOffset) {\n      this.parent.formatter.editorManager.domNode.insertAfter(brElm, this.startNode);\n      isEmptyBrInserted = true;\n    } else {\n      if (this.startNode === this.parent.inputElement && !isNOU(this.range.startContainer.previousSibling) && this.range.startContainer.previousSibling.nodeName === 'BR' && this.range.startContainer.textContent.length === 0) {\n        isEmptyBrInserted = true;\n      }\n      this.range.insertNode(brElm);\n    }\n    if (isEmptyBrInserted || !isNOU(brElm.nextElementSibling) && brElm.nextElementSibling.tagName === 'BR' || !isNOU(brElm.nextSibling) && brElm.nextSibling.textContent.length > 0) {\n      this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(), !isNOU(brElm.nextSibling) && isFocusTextNode ? brElm.nextSibling : brElm, 0);\n      isEmptyBrInserted = false;\n    } else {\n      var brElm2 = this.parent.createElement('br');\n      this.range.insertNode(brElm2);\n      this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(), brElm, 0);\n    }\n  };\n  EnterKeyAction.prototype.insertFocusContent = function () {\n    if (this.range.startContainer.textContent.length === 0) {\n      if (this.range.startContainer.nodeName === '#text') {\n        this.range.startContainer.parentElement.innerHTML = '&#8203;';\n      } else {\n        this.range.startContainer.innerHTML = '&#8203;';\n      }\n    }\n  };\n  EnterKeyAction.prototype.createInsertElement = function (shiftKey) {\n    var insertElem;\n    if (this.parent.enterKey === 'DIV' && !shiftKey || this.parent.shiftEnterKey === 'DIV' && shiftKey) {\n      insertElem = this.parent.createElement('div');\n    } else if (this.parent.enterKey === 'P' && !shiftKey || this.parent.shiftEnterKey === 'P' && shiftKey) {\n      insertElem = this.parent.createElement('p');\n    }\n    var previousBlockNode = this.parent.formatter.editorManager.domNode.blockNodes()[0].previousSibling;\n    var nextBlockNode = this.parent.formatter.editorManager.domNode.blockNodes()[0].nextSibling;\n    if (!isNOU(previousBlockNode) && previousBlockNode.hasAttribute('style')) {\n      insertElem.setAttribute('style', previousBlockNode.getAttribute('style'));\n    }\n    if (isNOU(previousBlockNode) && !isNOU(nextBlockNode) && nextBlockNode.hasAttribute('style')) {\n      insertElem.setAttribute('style', nextBlockNode.getAttribute('style'));\n    }\n    return insertElem;\n  };\n  return EnterKeyAction;\n}();\nexport { EnterKeyAction };","map":{"version":3,"names":["isNullOrUndefined","isNOU","detach","Browser","events","EnterKeyAction","parent","addEventListener","prototype","on","enterHandler","destroy","moduleDestroy","removeEventListener","off","getRangeNode","range","getRange","startNode","startContainer","nodeName","parentElement","endNode","endContainer","e","_this","isTableEnter","formatTags","closest","curElement","blockElement","formatter","editorManager","domNode","isBlockNode","tagName","args","which","ctrlKey","isDevice","code","key","shiftKey_1","shiftKey","actionBeginArgs","cancel","name","actionBegin","requestType","originalEvent","trigger","startOffset","endOffset","classList","contains","deleteContents","textContent","length","inputElement","enterKey","innerHTML","focusElem","childNodes","nodeSelection","setCursorPoint","contentModule","getDocument","previousSibling","currentFocusElem","lastChild","appendChild","createElement","preventDefault","currentLastElem","shiftEnterKey","newElem","createInsertElement","nearBlockNode","blockParentNode","isMediaNode","isFocusedFirst","querySelectorAll","startNodeText","splitFirstText","substring","charCodeAt","trim","removeBRElement","fireFoxEnterAtMiddle","userAgent","indexOf","isNearBlockLengthZero","querySelector","nodeCutter","SplitNode","cloneNode","insertElem","toLocaleLowerCase","firstChild","insertBefore","finalFocusElem","nextElementSibling","children","insertAfter","audioVideoElem","isBRInserted","lastNode","brElm","audioModule","hideAudioQuickToolbar","videoModule","hideVideoQuickToolbar","startParentElem","isHeadingTag","insertElm","currentParent","currentNode","previousNode","isEmptyBrInserted","currentParentLastChild","isLastNodeLength","isImageElement","focusBRElem","imageElement","lineBreakBRElem","outerBRElem","insertFocusContent","nextSibling","insertBRElement","actionComplete","currentElement","isFocusTextNode","insertNode","brElm2","previousBlockNode","blockNodes","nextBlockNode","hasAttribute","setAttribute","getAttribute"],"sources":["/Users/saleem/Desktop/KClient/Web App/Ver_3.6/User Interface/website_Source files/node_modules/@syncfusion/ej2-richtexteditor/src/rich-text-editor/actions/enter-key.js"],"sourcesContent":["import { isNullOrUndefined as isNOU, detach, Browser } from '@syncfusion/ej2-base';\nimport * as events from '../base/constant';\n/**\n * `EnterKey` module is used to handle enter key press actions.\n */\nvar EnterKeyAction = /** @class */ (function () {\n    function EnterKeyAction(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    EnterKeyAction.prototype.addEventListener = function () {\n        this.parent.on(events.enterHandler, this.enterHandler, this);\n        this.parent.on(events.destroy, this.destroy, this);\n        this.parent.on(events.moduleDestroy, this.moduleDestroy, this);\n    };\n    EnterKeyAction.prototype.destroy = function () {\n        if (isNOU(this.parent)) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    EnterKeyAction.prototype.moduleDestroy = function () {\n        this.parent = null;\n    };\n    EnterKeyAction.prototype.removeEventListener = function () {\n        this.parent.off(events.enterHandler, this.enterHandler);\n        this.parent.off(events.destroy, this.destroy);\n        this.parent.off(events.moduleDestroy, this.moduleDestroy);\n    };\n    EnterKeyAction.prototype.getRangeNode = function () {\n        this.range = this.parent.getRange();\n        this.startNode = this.range.startContainer.nodeName === '#text' ? this.range.startContainer.parentElement :\n            this.range.startContainer;\n        this.endNode = this.range.endContainer.nodeName === '#text' ? this.range.endContainer.parentElement :\n            this.range.endContainer;\n    };\n    EnterKeyAction.prototype.enterHandler = function (e) {\n        var _this = this;\n        this.getRangeNode();\n        var isTableEnter = true;\n        this.formatTags = ['h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'blockquote'];\n        if (!isNOU(this.startNode.closest('TABLE')) && !isNOU(this.endNode.closest('TABLE'))) {\n            isTableEnter = false;\n            var curElement = this.startNode;\n            var blockElement = curElement;\n            while (!this.parent.formatter.editorManager.domNode.isBlockNode(curElement)) {\n                curElement = curElement.parentElement;\n                blockElement = curElement;\n            }\n            isTableEnter = blockElement.tagName === 'TD' || blockElement.tagName === 'TBODY' ? false : true;\n        }\n        if (e.args.which === 13 && !e.args.ctrlKey && (!Browser.isDevice ? e.args.code === 'Enter' : e.args.key === 'Enter')) {\n            if (isNOU(this.startNode.closest('LI, UL, OL')) && isNOU(this.endNode.closest('LI, UL, OL')) && isTableEnter &&\n                isNOU(this.startNode.closest('PRE')) && isNOU(this.endNode.closest('PRE'))) {\n                var shiftKey_1 = e.args.shiftKey;\n                var actionBeginArgs = {\n                    cancel: false,\n                    name: events.actionBegin,\n                    requestType: shiftKey_1 ? 'ShiftEnterAction' : 'EnterAction',\n                    originalEvent: e.args\n                };\n                this.parent.trigger(events.actionBegin, actionBeginArgs, function (actionBeginArgs) {\n                    if (!actionBeginArgs.cancel) {\n                        if (!(_this.range.startOffset === _this.range.endOffset && _this.range.startContainer === _this.range.endContainer)) {\n                            if (!(_this.range.startContainer.nodeName === 'SPAN' && (_this.range.startContainer.classList.contains('e-video-wrap') ||\n                                _this.range.startContainer.classList.contains('e-audio-wrap')))) {\n                                _this.range.deleteContents();\n                            }\n                            if (_this.range.startContainer.nodeName === '#text' && _this.range.startContainer.textContent.length === 0 &&\n                                _this.range.startContainer.parentElement !== _this.parent.inputElement) {\n                                if (_this.parent.enterKey === 'BR') {\n                                    _this.range.startContainer.parentElement.innerHTML = '&#8203;';\n                                }\n                                else {\n                                    _this.range.startContainer.parentElement.innerHTML = '<br>';\n                                }\n                            }\n                            else if (_this.range.startContainer === _this.parent.inputElement && _this.range.startContainer.innerHTML === '') {\n                                _this.range.startContainer.innerHTML = '<br>';\n                                var focusElem = _this.range.startContainer.childNodes[_this.range.startOffset];\n                                _this.parent.formatter.editorManager.nodeSelection.setCursorPoint(_this.parent.contentModule.getDocument(), focusElem, 0);\n                            }\n                            else if (_this.parent.inputElement === _this.range.startContainer) {\n                                var focusElem = _this.range.startContainer.childNodes[_this.range.startOffset];\n                                if (focusElem.nodeName === '#text' && focusElem.textContent.length === 0) {\n                                    _this.parent.formatter.editorManager.nodeSelection.setCursorPoint(_this.parent.contentModule.getDocument(), focusElem, focusElem.textContent.length === 0 ? 0 : focusElem.previousSibling.textContent.length);\n                                }\n                                else {\n                                    _this.parent.formatter.editorManager.nodeSelection.setCursorPoint(_this.parent.contentModule.getDocument(), focusElem, focusElem.textContent.length >= 0 ? 0 : 1);\n                                    if (focusElem.previousSibling.textContent.length === 0) {\n                                        detach(focusElem.previousSibling);\n                                        if (!shiftKey_1) {\n                                            var currentFocusElem = !isNOU(focusElem.lastChild) ? focusElem.lastChild : focusElem;\n                                            while (!isNOU(currentFocusElem) && currentFocusElem.nodeName !== '#text' && currentFocusElem.nodeName !== 'BR') {\n                                                currentFocusElem = currentFocusElem.lastChild;\n                                            }\n                                            if (currentFocusElem.nodeName !== 'BR' && currentFocusElem.parentElement.textContent.length === 0 && currentFocusElem.parentElement.innerHTML.length === 0 &&\n                                                currentFocusElem.parentElement.nodeName !== 'BR') {\n                                                currentFocusElem.parentElement.appendChild(_this.parent.createElement('BR'));\n                                            }\n                                            _this.parent.formatter.editorManager.nodeSelection.setCursorPoint(_this.parent.contentModule.getDocument(), currentFocusElem.nodeName === 'BR' ? currentFocusElem : currentFocusElem.parentElement, currentFocusElem.parentElement.textContent.length >= 0 || currentFocusElem.nodeName === 'BR' ? 0 : 1);\n                                        }\n                                    }\n                                    else if (focusElem.textContent.length === 0) {\n                                        var currentFocusElem = focusElem.previousSibling.nodeName === '#text' ? focusElem.previousSibling : focusElem.previousSibling.lastChild;\n                                        while (!isNOU(currentFocusElem) && currentFocusElem.nodeName !== '#text') {\n                                            currentFocusElem = currentFocusElem.lastChild;\n                                        }\n                                        _this.parent.formatter.editorManager.nodeSelection.setCursorPoint(_this.parent.contentModule.getDocument(), currentFocusElem, currentFocusElem.textContent.length);\n                                        detach(focusElem);\n                                    }\n                                    else if (_this.parent.enterKey !== 'BR' &&\n                                        focusElem.previousSibling.textContent.length !== 0 && focusElem.textContent.length !== 0) {\n                                        e.args.preventDefault();\n                                        return;\n                                    }\n                                }\n                                _this.getRangeNode();\n                            }\n                        }\n                        if (_this.range.startContainer === _this.range.endContainer &&\n                            _this.range.startOffset === _this.range.endOffset && _this.range.startContainer === _this.parent.inputElement) {\n                            if (!(_this.parent.inputElement.childNodes.length === 1 && _this.parent.inputElement.childNodes[0].nodeName === 'TABLE')) {\n                                if (isNOU(_this.range.startContainer.childNodes[_this.range.startOffset])) {\n                                    var currentLastElem = _this.range.startContainer.childNodes[_this.range.startOffset - 1];\n                                    while (currentLastElem.lastChild !== null && currentLastElem.nodeName !== '#text') {\n                                        currentLastElem = currentLastElem.lastChild;\n                                    }\n                                    _this.parent.formatter.editorManager.nodeSelection.setCursorPoint(_this.parent.contentModule.getDocument(), currentLastElem, (currentLastElem.nodeName === 'BR' ? 0 : currentLastElem.textContent.length));\n                                }\n                                else {\n                                    _this.parent.formatter.editorManager.nodeSelection.setCursorPoint(_this.parent.contentModule.getDocument(), _this.range.startContainer.childNodes[_this.range.startOffset], 0);\n                                }\n                            }\n                            _this.getRangeNode();\n                        }\n                        if ((_this.parent.enterKey === 'P' && !shiftKey_1) || (_this.parent.enterKey === 'DIV' && !shiftKey_1) ||\n                            (_this.parent.shiftEnterKey === 'P' && shiftKey_1) ||\n                            (_this.parent.shiftEnterKey === 'DIV' && shiftKey_1)) {\n                            if (_this.range.startOffset === 1 && _this.parent.inputElement.childNodes.length === 1 && _this.parent.inputElement.childNodes[0].nodeName === 'TABLE') {\n                                var newElem = _this.createInsertElement(shiftKey_1);\n                                newElem.appendChild(_this.parent.createElement('BR'));\n                                _this.parent.inputElement.appendChild(newElem);\n                                _this.parent.formatter.editorManager.nodeSelection.setCursorPoint(_this.parent.contentModule.getDocument(), newElem, 0);\n                            }\n                            else {\n                                var nearBlockNode = void 0;\n                                if (isTableEnter && _this.parent.formatter.editorManager.domNode.isBlockNode(_this.startNode)) {\n                                    nearBlockNode = _this.startNode;\n                                }\n                                else {\n                                    nearBlockNode = _this.parent.formatter.editorManager.domNode.blockParentNode(_this.startNode);\n                                }\n                                var isMediaNode = false; // To check the image audio and video node cases\n                                var isFocusedFirst = false;\n                                if (_this.range.startOffset !== 0 && _this.range.endOffset !== 0 &&\n                                    _this.range.startContainer === _this.range.endContainer && !(!isNOU(nearBlockNode.childNodes[0])\n                                    && (nearBlockNode.childNodes[0].nodeName === 'IMG' || nearBlockNode.querySelectorAll('img, audio, video').length > 0))) {\n                                    var startNodeText = _this.range.startContainer.textContent;\n                                    var splitFirstText = startNodeText.substring(0, _this.range.startOffset);\n                                    // eslint-disable-next-line max-len\n                                    if (splitFirstText.charCodeAt(_this.range.startOffset - 1) !== 160 && splitFirstText.trim().length === 0) {\n                                        isFocusedFirst = true;\n                                    }\n                                }\n                                else if (_this.range.startOffset === 0 && _this.range.endOffset === 0) {\n                                    isFocusedFirst = true;\n                                }\n                                _this.removeBRElement(nearBlockNode);\n                                var fireFoxEnterAtMiddle = Browser.userAgent.indexOf('Firefox') !== -1 && _this.range.startOffset === 0 && _this.range.startContainer === _this.range.endContainer &&\n                                    _this.range.startContainer.nodeName === '#text' && !_this.parent.formatter.editorManager.domNode.isBlockNode(_this.range.startContainer.previousSibling) &&\n                                    _this.range.startContainer.parentElement === _this.range.startContainer.previousSibling.parentElement;\n                                // eslint-disable-next-line max-len\n                                if (!fireFoxEnterAtMiddle && ((_this.range.startOffset === 0 && _this.range.endOffset === 0) || isFocusedFirst) &&\n                                    !(!isNOU(_this.range.startContainer.previousSibling) &&\n                                        (_this.range.startContainer.previousSibling.nodeName === 'IMG' || _this.range.startContainer.previousSibling.nodeName === 'BR'))) {\n                                    var isNearBlockLengthZero = void 0;\n                                    var newElem = void 0;\n                                    if (!isNOU(_this.range.startContainer.childNodes) &&\n                                        (_this.range.startContainer.textContent.length === 0 ||\n                                            (_this.range.startContainer.nodeName !== '#text' && !isNOU(_this.range.startContainer.querySelector('.e-video-clickelem')) &&\n                                                _this.range.startContainer.querySelector('.e-video-clickelem').textContent.length === 0)) &&\n                                        (_this.range.startContainer.querySelectorAll('img, audio, video').length > 0 ||\n                                            !isNOU(_this.range.startContainer.querySelector('.e-video-clickelem')) ||\n                                            _this.range.startContainer.nodeName === 'IMG' || _this.range.startContainer.nodeName === 'TABLE')) {\n                                        newElem = _this.createInsertElement(shiftKey_1);\n                                        isMediaNode = true;\n                                        isNearBlockLengthZero = false;\n                                    }\n                                    else {\n                                        if ((nearBlockNode.textContent.trim().length !== 0 ||\n                                            nearBlockNode.childNodes[0].nodeName === 'IMG' ||\n                                            (nearBlockNode.textContent.trim() === '' && nearBlockNode.querySelectorAll('img, audio, video').length > 0))) {\n                                            if ((_this.range.startOffset === _this.range.endOffset && _this.range.startOffset !== 0)) {\n                                                newElem = _this.parent.formatter.editorManager.nodeCutter.SplitNode(_this.range, nearBlockNode, false).cloneNode(true);\n                                            }\n                                            else {\n                                                newElem = _this.parent.formatter.editorManager.nodeCutter.SplitNode(_this.range, nearBlockNode, true).cloneNode(true);\n                                                isMediaNode = true;\n                                            }\n                                            isNearBlockLengthZero = false;\n                                        }\n                                        else {\n                                            newElem = _this.parent.formatter.editorManager.nodeCutter.SplitNode(_this.range, nearBlockNode, true).cloneNode(true);\n                                            isNearBlockLengthZero = true;\n                                        }\n                                    }\n                                    var insertElem = void 0;\n                                    if (_this.formatTags.indexOf(newElem.nodeName.toLocaleLowerCase()) < 0) {\n                                        insertElem = _this.createInsertElement(shiftKey_1);\n                                    }\n                                    else {\n                                        insertElem = _this.parent.createElement(newElem.nodeName);\n                                    }\n                                    while (newElem.firstChild) {\n                                        insertElem.appendChild(newElem.firstChild);\n                                    }\n                                    nearBlockNode.parentElement.insertBefore(insertElem, nearBlockNode);\n                                    if (!isNearBlockLengthZero) {\n                                        var currentFocusElem = insertElem;\n                                        var finalFocusElem = void 0;\n                                        if (_this.range.startOffset === _this.range.endOffset && _this.range.startOffset !== 0) {\n                                            while (!isNOU(currentFocusElem) && currentFocusElem.nodeName !== '#text' &&\n                                                currentFocusElem.nodeName !== 'BR') {\n                                                finalFocusElem = currentFocusElem;\n                                                currentFocusElem = currentFocusElem.lastChild;\n                                            }\n                                        }\n                                        else {\n                                            finalFocusElem = currentFocusElem;\n                                        }\n                                        finalFocusElem.innerHTML = '<br>';\n                                        if (!isMediaNode) {\n                                            detach(nearBlockNode);\n                                        }\n                                    }\n                                    _this.parent.formatter.editorManager.nodeSelection.setCursorPoint(_this.parent.contentModule.getDocument(), insertElem.nextElementSibling, 0);\n                                }\n                                else if (nearBlockNode.textContent.length === 0 && !(!isNOU(nearBlockNode.childNodes[0]) && nearBlockNode.childNodes[0].nodeName === 'IMG' ||\n                                    (nearBlockNode.querySelectorAll('video').length > 0) || (nearBlockNode.querySelectorAll('audio').length > 0) || (nearBlockNode.querySelectorAll('img').length > 0))) {\n                                    if (!isNOU(nearBlockNode.children[0]) && nearBlockNode.children[0].tagName !== 'BR') {\n                                        var newElem = _this.parent.formatter.editorManager.nodeCutter.SplitNode(_this.range, nearBlockNode, false).cloneNode(true);\n                                        _this.parent.formatter.editorManager.domNode.insertAfter(newElem, nearBlockNode);\n                                        _this.parent.formatter.editorManager.nodeSelection.setCursorPoint(_this.parent.contentModule.getDocument(), newElem, newElem.textContent.length >= 0 ? 0 : 1);\n                                    }\n                                    else {\n                                        var insertElem = _this.createInsertElement(shiftKey_1);\n                                        insertElem.innerHTML = '<br>';\n                                        _this.parent.formatter.editorManager.domNode.insertAfter(insertElem, nearBlockNode);\n                                        _this.parent.formatter.editorManager.nodeSelection.setCursorPoint(_this.parent.contentModule.getDocument(), insertElem, 0);\n                                    }\n                                }\n                                else if (_this.range.startContainer === _this.range.endContainer && _this.range.startContainer.nodeName === 'SPAN' &&\n                                    (_this.range.startContainer.classList.contains('e-video-wrap') ||\n                                        _this.range.startContainer.classList.contains('e-audio-wrap'))) {\n                                    if (nearBlockNode.textContent.trim().length > 0) {\n                                        var newElem = _this.parent.formatter.editorManager.nodeCutter.SplitNode(_this.range, nearBlockNode, true);\n                                        var audioVideoElem = !isNOU(newElem.previousSibling.querySelector('.e-video-wrap')) ?\n                                            newElem.previousSibling.querySelector('.e-video-wrap') : newElem.previousSibling.querySelector('.e-audio-wrap');\n                                        var isBRInserted = false;\n                                        var lastNode = audioVideoElem.previousSibling;\n                                        while (!isNOU(lastNode) && lastNode.nodeName !== '#text') {\n                                            lastNode = lastNode.lastChild;\n                                        }\n                                        if (isNOU(lastNode)) {\n                                            var brElm = _this.parent.createElement('br');\n                                            audioVideoElem.parentElement.appendChild(brElm);\n                                            isBRInserted = true;\n                                        }\n                                        if (isBRInserted) {\n                                            _this.parent.formatter.editorManager.nodeSelection.setCursorPoint(_this.parent.contentModule.getDocument(), audioVideoElem.parentElement, 0);\n                                        }\n                                        else {\n                                            _this.parent.formatter.editorManager.nodeSelection.setCursorPoint(_this.parent.contentModule.getDocument(), lastNode, lastNode.textContent.length);\n                                        }\n                                        detach(audioVideoElem);\n                                    }\n                                    else {\n                                        var newElem = _this.parent.formatter.editorManager.nodeCutter.SplitNode(_this.range, nearBlockNode, true);\n                                        var focusElem = newElem.previousSibling;\n                                        while (!isNOU(focusElem.firstChild)) {\n                                            detach(focusElem.firstChild);\n                                        }\n                                        var brElm = _this.parent.createElement('br');\n                                        focusElem.appendChild(brElm);\n                                        _this.parent.formatter.editorManager.nodeSelection.setCursorPoint(_this.parent.contentModule.getDocument(), focusElem, 0);\n                                    }\n                                    if (!isNOU(_this.parent.audioModule)) {\n                                        _this.parent.audioModule.hideAudioQuickToolbar();\n                                    }\n                                    if (!isNOU(_this.parent.videoModule)) {\n                                        _this.parent.videoModule.hideVideoQuickToolbar();\n                                    }\n                                }\n                                else {\n                                    var newElem = _this.parent.formatter.editorManager.nodeCutter.SplitNode(_this.range, nearBlockNode, true);\n                                    if (!isNOU(newElem.childNodes[0]) && newElem.childNodes[0].nodeName === '#text' &&\n                                        newElem.childNodes[0].textContent.length === 0) {\n                                        detach(newElem.childNodes[0]);\n                                    }\n                                    if (newElem.textContent.trim().length === 0) {\n                                        var brElm = _this.parent.createElement('br');\n                                        if (_this.startNode.nodeName === 'A') {\n                                            var startParentElem = _this.startNode.parentElement;\n                                            _this.startNode.parentElement.insertBefore(brElm, _this.startNode);\n                                            detach(_this.startNode);\n                                            _this.startNode = startParentElem;\n                                        }\n                                        else {\n                                            if (_this.startNode.nodeName !== 'BR') {\n                                                _this.startNode.appendChild(brElm);\n                                            }\n                                        }\n                                        if (newElem.childNodes[0].textContent === '\\n') {\n                                            detach(newElem.childNodes[0]);\n                                        }\n                                        _this.parent.formatter.editorManager.nodeSelection.setCursorPoint(_this.parent.contentModule.getDocument(), _this.startNode, 0);\n                                    }\n                                    if (((_this.parent.enterKey === 'P' || _this.parent.enterKey === 'DIV') && !shiftKey_1) || ((_this.parent.shiftEnterKey === 'DIV' ||\n                                        _this.parent.shiftEnterKey === 'P') && shiftKey_1)) {\n                                        var isHeadingTag = _this.formatTags.indexOf(newElem.nodeName.toLocaleLowerCase());\n                                        if ((isHeadingTag < 0) || (isHeadingTag >= 0 && newElem.textContent.trim().length === 0)) {\n                                            var insertElm = _this.createInsertElement(shiftKey_1);\n                                            while (newElem.firstChild) {\n                                                insertElm.appendChild(newElem.firstChild);\n                                            }\n                                            _this.parent.formatter.editorManager.domNode.insertAfter(insertElm, newElem);\n                                            detach(newElem);\n                                            _this.parent.formatter.editorManager.nodeSelection.setCursorPoint(_this.parent.contentModule.getDocument(), _this.parent.formatter.editorManager.domNode.isBlockNode(_this.startNode) ?\n                                                insertElm : _this.startNode, 0);\n                                        }\n                                    }\n                                }\n                            }\n                            e.args.preventDefault();\n                        }\n                        if ((_this.parent.enterKey === 'BR' && !shiftKey_1) || (_this.parent.shiftEnterKey === 'BR' && shiftKey_1)) {\n                            var currentParent = void 0;\n                            if (!_this.parent.formatter.editorManager.domNode.isBlockNode(_this.startNode)) {\n                                var currentNode = _this.startNode;\n                                var previousNode = currentNode;\n                                while (!_this.parent.formatter.editorManager.domNode.isBlockNode(currentNode)) {\n                                    previousNode = currentNode;\n                                    currentNode = currentNode.parentElement;\n                                }\n                                currentParent = currentNode === _this.parent.inputElement ?\n                                    previousNode : currentNode;\n                            }\n                            else {\n                                currentParent = _this.startNode;\n                            }\n                            _this.removeBRElement(currentParent);\n                            var isEmptyBrInserted = false;\n                            var currentParentLastChild = currentParent.lastChild;\n                            while (!isNOU(currentParentLastChild) && !(currentParentLastChild.nodeName === '#text' || currentParentLastChild.nodeName === 'BR'\n                                || currentParentLastChild.nodeName === 'IMG')) {\n                                currentParentLastChild = currentParentLastChild.lastChild;\n                            }\n                            var isLastNodeLength = _this.range.startContainer === currentParentLastChild ?\n                                _this.range.startContainer.textContent.length : currentParent.textContent.length;\n                            var isImageElement = (_this.range.startContainer.nodeName === 'IMG' || (_this.range.startContainer.childNodes.length > 0\n                                && _this.range.startContainer.childNodes[_this.range.startOffset].nodeName === 'IMG'));\n                            if (currentParent !== _this.parent.inputElement &&\n                                _this.parent.formatter.editorManager.domNode.isBlockNode(currentParent) &&\n                                _this.range.startOffset === _this.range.endOffset &&\n                                (_this.range.startOffset === isLastNodeLength ||\n                                    (currentParent.textContent.trim().length === 0 && isImageElement))) {\n                                var focusBRElem = _this.parent.createElement('br');\n                                if (_this.range.startOffset === 0 && _this.range.startContainer.nodeName === 'TABLE') {\n                                    _this.range.startContainer.parentElement.insertBefore(focusBRElem, _this.range.startContainer);\n                                }\n                                else {\n                                    if (currentParentLastChild.nodeName === 'BR' && currentParent.textContent.length === 0) {\n                                        _this.parent.formatter.editorManager.domNode.insertAfter(focusBRElem, currentParentLastChild);\n                                    }\n                                    else if (_this.range.startOffset === 0 && _this.range.endOffset === 0 && isImageElement) {\n                                        var imageElement = _this.range.startContainer.nodeName === 'IMG' ? _this.range.startContainer :\n                                            _this.range.startContainer.childNodes[_this.range.startOffset];\n                                        currentParent.insertBefore(focusBRElem, imageElement);\n                                        focusBRElem = imageElement;\n                                    }\n                                    else {\n                                        var lineBreakBRElem = _this.parent.createElement('br');\n                                        _this.parent.formatter.editorManager.domNode.insertAfter(focusBRElem, _this.range.startContainer);\n                                        _this.parent.formatter.editorManager.domNode.insertAfter(lineBreakBRElem, _this.range.startContainer);\n                                    }\n                                }\n                                _this.parent.formatter.editorManager.nodeSelection.setCursorPoint(_this.parent.contentModule.getDocument(), focusBRElem, 0);\n                            }\n                            else if (!isNOU(currentParent) && currentParent !== _this.parent.inputElement && currentParent.nodeName !== 'BR') {\n                                if (currentParent.textContent.trim().length === 0 || (currentParent.textContent.trim().length === 1 &&\n                                    currentParent.textContent.charCodeAt(0) === 8203)) {\n                                    var newElem = _this.parent.formatter.editorManager.nodeCutter.SplitNode(_this.range, currentParent, true).cloneNode(true);\n                                    _this.parent.formatter.editorManager.domNode.insertAfter(newElem, currentParent);\n                                    var outerBRElem = _this.parent.createElement('br');\n                                    newElem.parentElement.insertBefore(outerBRElem, newElem);\n                                    _this.parent.formatter.editorManager.nodeSelection.setCursorPoint(_this.parent.contentModule.getDocument(), newElem, 0);\n                                }\n                                else {\n                                    var newElem = void 0;\n                                    var outerBRElem = _this.parent.createElement('br');\n                                    if (_this.range.startOffset === 0 && _this.range.endOffset === 0 &&\n                                        !isNOU(currentParent.previousSibling) && currentParent.previousSibling.nodeName === 'BR' && currentParent.nodeName !== 'P' && currentParent.nodeName !== 'DIV') {\n                                        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n                                        newElem = _this.parent.formatter.editorManager.nodeCutter.SplitNode(_this.range, currentParent, false).cloneNode(true);\n                                        _this.parent.formatter.editorManager.domNode.insertAfter(outerBRElem, currentParent);\n                                        _this.insertFocusContent();\n                                        var currentFocusElem = outerBRElem.nextSibling;\n                                        while (!isNOU(currentFocusElem) && currentFocusElem.nodeName !== '#text') {\n                                            currentFocusElem = currentFocusElem.lastChild;\n                                        }\n                                        _this.parent.formatter.editorManager.nodeSelection.setCursorPoint(_this.parent.contentModule.getDocument(), currentFocusElem, 0);\n                                        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n                                        isEmptyBrInserted = true;\n                                    }\n                                    else {\n                                        _this.insertBRElement();\n                                    }\n                                }\n                            }\n                            else {\n                                _this.insertBRElement();\n                            }\n                            e.args.preventDefault();\n                        }\n                        _this.parent.trigger(events.actionComplete, { requestType: shiftKey_1 ? 'ShiftEnterAction' : 'EnterAction', args: e.args });\n                    }\n                });\n            }\n        }\n    };\n    EnterKeyAction.prototype.removeBRElement = function (currentElement) {\n        if (Browser.userAgent.indexOf('Firefox') !== -1 &&\n            this.range.endOffset === currentElement.textContent.length && (currentElement.textContent.length !== 0 ||\n            currentElement.querySelectorAll('BR').length > 1) &&\n            !isNOU(currentElement.lastChild) && currentElement.lastChild.nodeName === 'BR') {\n            detach(currentElement.lastChild);\n        }\n    };\n    EnterKeyAction.prototype.insertBRElement = function () {\n        var isEmptyBrInserted = false;\n        var isFocusTextNode = true;\n        if (this.range.endContainer.textContent.length === 0 && this.range.startContainer.nodeName === 'BR') {\n            isFocusTextNode = false;\n        }\n        var brElm = this.parent.createElement('br');\n        if (this.startNode.nodeName === 'BR' && this.endNode.nodeName === 'BR' && this.range.startOffset === 0 && this.range.startOffset === this.range.endOffset) {\n            this.parent.formatter.editorManager.domNode.insertAfter(brElm, this.startNode);\n            isEmptyBrInserted = true;\n        }\n        else {\n            if (this.startNode === this.parent.inputElement && !isNOU(this.range.startContainer.previousSibling) &&\n                this.range.startContainer.previousSibling.nodeName === 'BR' && this.range.startContainer.textContent.length === 0) {\n                isEmptyBrInserted = true;\n            }\n            this.range.insertNode(brElm);\n        }\n        if (isEmptyBrInserted || (!isNOU(brElm.nextElementSibling) && brElm.nextElementSibling.tagName === 'BR') || (!isNOU(brElm.nextSibling) && brElm.nextSibling.textContent.length > 0)) {\n            this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(), !isNOU(brElm.nextSibling) && isFocusTextNode ? brElm.nextSibling : brElm, 0);\n            isEmptyBrInserted = false;\n        }\n        else {\n            var brElm2 = this.parent.createElement('br');\n            this.range.insertNode(brElm2);\n            this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(), brElm, 0);\n        }\n    };\n    EnterKeyAction.prototype.insertFocusContent = function () {\n        if (this.range.startContainer.textContent.length === 0) {\n            if (this.range.startContainer.nodeName === '#text') {\n                this.range.startContainer.parentElement.innerHTML = '&#8203;';\n            }\n            else {\n                this.range.startContainer.innerHTML = '&#8203;';\n            }\n        }\n    };\n    EnterKeyAction.prototype.createInsertElement = function (shiftKey) {\n        var insertElem;\n        if ((this.parent.enterKey === 'DIV' && !shiftKey) || (this.parent.shiftEnterKey === 'DIV' && shiftKey)) {\n            insertElem = this.parent.createElement('div');\n        }\n        else if ((this.parent.enterKey === 'P' && !shiftKey) || (this.parent.shiftEnterKey === 'P' && shiftKey)) {\n            insertElem = this.parent.createElement('p');\n        }\n        var previousBlockNode = this.parent.formatter.editorManager.domNode.blockNodes()[0].previousSibling;\n        var nextBlockNode = this.parent.formatter.editorManager.domNode.blockNodes()[0].nextSibling;\n        if (!isNOU(previousBlockNode) && previousBlockNode.hasAttribute('style')) {\n            insertElem.setAttribute('style', previousBlockNode.getAttribute('style'));\n        }\n        if (isNOU(previousBlockNode) && !isNOU(nextBlockNode) && nextBlockNode.hasAttribute('style')) {\n            insertElem.setAttribute('style', nextBlockNode.getAttribute('style'));\n        }\n        return insertElem;\n    };\n    return EnterKeyAction;\n}());\nexport { EnterKeyAction };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}