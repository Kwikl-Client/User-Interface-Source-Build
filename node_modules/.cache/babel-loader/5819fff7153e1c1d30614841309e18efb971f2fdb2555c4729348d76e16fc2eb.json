{"ast":null,"code":"import { PageRenderer, FormFieldsBase, AnnotationRenderer, SignatureBase, BookmarkStyles, BookmarkDestination, BookmarkBase, AnnotBounds } from './index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { DataFormat, PdfAnnotationExportSettings, PdfDocument, PdfRotationAngle, PdfTextStyle, PdfDocumentLinkAnnotation, PdfTextWebLinkAnnotation, PdfUriAnnotation, PdfPermissionFlag, PdfFormFieldExportSettings, _bytesToString, _encode } from '@syncfusion/ej2-pdf';\nimport { Size } from '@syncfusion/ej2-drawings';\n/**\n * PdfRenderer\n *\n * @hidden\n */\nvar PdfRenderer = /** @class */function () {\n  /**\n   * @param {PdfViewer} pdfViewer - The PdfViewer.\n   * @param {PdfViewerBase} pdfViewerBase - The PdfViewerBase.\n   * @private\n   */\n  function PdfRenderer(pdfViewer, pdfViewerBase) {\n    /**\n     * @private\n     **/\n    this.bookmarkStyles = [];\n    /**\n     * @private\n     **/\n    this.bookmarkCollection = [];\n    /**\n     * @private\n     **/\n    this.pageRotationCollection = [];\n    /**\n     * @private\n     **/\n    this.bookmarkDictionary = {};\n    this.annotationDetailCollection = {};\n    this.pageSizes = {};\n    this.m_isCompletePageSizeNotReceieved = true;\n    this.x = 0;\n    this.y = 0;\n    this.zoom = 1;\n    this.id = 0;\n    this.pageIndex = 0;\n    this.scaleFactor = 1.5;\n    this.restrictionList = [];\n    this.securityList = ['Print', 'EditContent', 'CopyContent', 'EditAnnotations', 'FillFields', 'AccessibilityCopyContent', 'AssembleDocument', 'FullQualityPrint'];\n    this._fallbackFontCollection = {};\n    this.pdfViewer = pdfViewer;\n    this.pdfViewerBase = pdfViewerBase;\n  }\n  Object.defineProperty(PdfRenderer.prototype, \"PageCount\", {\n    /**\n     * @private\n     */\n    get: function () {\n      return this.pageCount;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(PdfRenderer.prototype, \"ReferencePath\", {\n    /**\n     * @private\n     */\n    get: function () {\n      return this.m_referencePath;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(PdfRenderer.prototype, \"referencePath\", {\n    /**\n     * @private\n     */\n    set: function (v) {\n      this.m_referencePath = v;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(PdfRenderer.prototype, \"ScaleFactor\", {\n    /**\n     * @private\n     */\n    get: function () {\n      return this.scaleFactor;\n    },\n    /**\n     * @private\n     */\n    set: function (v) {\n      this.scaleFactor = v;\n      if (this.scaleFactor <= 0) {\n        this.scaleFactor = 1;\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(PdfRenderer.prototype, \"FallbackFontCollection\", {\n    /**\n     * @private\n     */\n    get: function () {\n      return this._fallbackFontCollection;\n      ;\n    },\n    /**\n     * @private\n     */\n    set: function (v) {\n      this._fallbackFontCollection = v;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  /**\n   * @private\n   */\n  PdfRenderer.prototype.load = function (documentData, documentId, password, jsonObject) {\n    try {\n      if (jsonObject.action !== \"VirtualLoad\") {\n        this.loadedDocument = new PdfDocument(documentData, password ? password : '');\n        this.loadedBase64String = documentData;\n        this.password = password;\n        this.m_isCompletePageSizeNotReceieved = true;\n      }\n    } catch (error) {\n      if (error.message === 'Invalid PDF structure.') {\n        return '3';\n      } else if (error.message === 'Cannot open an encrypted document. The password is invalid.') {\n        return '4';\n      } else if (error.message === 'Invalid cross reference') {\n        return '4';\n      } else {\n        return error.message;\n      }\n    }\n    var jsonResult = this.loadDocument(documentData, documentId, password, jsonObject);\n    this.bookmarkStyles = [];\n    this.bookmarkCollection = [];\n    this.bookmarkDictionary = {};\n    return JSON.stringify(jsonResult);\n  };\n  /**\n   * @private\n   */\n  PdfRenderer.prototype.loadDocument = function (documentData, documentId, password, jsonObject) {\n    if (jsonObject.hasOwnProperty(\"isCompletePageSizeNotReceived\")) {\n      this.m_isCompletePageSizeNotReceieved = !jsonObject.isCompletePageSizeNotReceived;\n    }\n    this.pageCount = this.loadedDocument.pageCount;\n    this.pageSizes = this.getPageSizes(this.pageCount);\n    var pdfRenderedFormFields = [];\n    var isDigitalSignaturePresent = false;\n    var isTaggedPdf = false; //Need to check and set if loaddocument is tagged pdf\n    this.m_formFields = new FormFieldsBase(this.pdfViewer, this.pdfViewerBase, isDigitalSignaturePresent);\n    this.restrictionList = [];\n    if (!isNullOrUndefined(this.loadedDocument)) {\n      this.documentSecurity(password);\n    }\n    if (!isNullOrUndefined(this.loadedDocument)) {\n      if (jsonObject.hasOwnProperty(\"hideEmptyDigitalSignatureFields\")) {\n        this.m_formFields.hideEmptyDigitalSignatureFields = jsonObject[\"hideEmptyDigitalSignatureFields\"];\n      }\n      if (jsonObject.hasOwnProperty(\"showDigitalSignatureAppearance\")) {\n        this.m_formFields.showDigitalSignatureAppearance = jsonObject[\"showDigitalSignatureAppearance\"];\n      }\n    }\n    if (!isNullOrUndefined(this.m_formFields) && this.pageCount <= 100) {\n      this.m_formFields.GetFormFields();\n      pdfRenderedFormFields = this.m_formFields.PdfRenderedFormFields;\n    }\n    if (this.m_formFields.m_isDigitalSignaturePresent) {\n      this.digitialByteArray = this.loadedDocument.save();\n    }\n    // eslint-disable-next-line max-len\n    return {\n      pageCount: this.pageCount,\n      pageSizes: this.pageSizes,\n      uniqueId: documentId,\n      PdfRenderedFormFields: pdfRenderedFormFields,\n      RestrictionSummary: this.restrictionList,\n      documentData: documentData,\n      isDigitalSignaturePresent: this.m_formFields.m_isDigitalSignaturePresent,\n      digitialSignatureFile: this.digitialByteArray ? _encode(this.digitialByteArray) : \"\",\n      isTaggedPdf: isTaggedPdf,\n      pageRotation: this.pageRotationCollection\n    };\n  };\n  PdfRenderer.prototype.documentSecurity = function (password) {\n    // eslint-disable-next-line max-len\n    var isOwnerPassword = this.loadedDocument.isEncrypted && (!this.loadedDocument.isUserPassword || this.loadedDocument._hasUserPasswordOnly);\n    if (!isNullOrUndefined(password) && password !== '' && isOwnerPassword) {\n      this.restrictionSummary(password, true);\n    } else {\n      this.restrictionSummary(password, false);\n    }\n  };\n  PdfRenderer.prototype.restrictionSummary = function (password, isOwner) {\n    var ownerPassword = password ? password : ''; //Need to set owner password from loaded document\n    var userPassword = password ? password : ''; //Need to set user password from loaded document\n    var permissionList = this.getPermissionArray(this.loadedDocument.permissions);\n    var isEncrypted = this.loadedDocument.isEncrypted;\n    if (!(permissionList.length === 1 && permissionList[0] === 'Default') || isEncrypted && ownerPassword === '' && userPassword === '') {\n      for (var i = 0; i < this.securityList.length; i++) {\n        var isExist = false;\n        for (var j = 0; j < permissionList.length; j++) {\n          if (permissionList[parseInt(j.toString(), 10)].trim() === this.securityList[parseInt(i.toString(), 10)].trim()) {\n            isExist = true;\n            break;\n          }\n        }\n        if (!isExist && !isOwner) {\n          this.restrictionList.push(this.securityList[parseInt(i.toString(), 10)].trim());\n        }\n      }\n    } else if (permissionList.length === 1 && permissionList[0] === 'Default' && isEncrypted && !isOwner) {\n      for (var i = 0; i < this.securityList.length; i++) {\n        this.restrictionList.push(this.securityList[parseInt(i.toString(), 10)].trim());\n      }\n    }\n  };\n  PdfRenderer.prototype.getPermissionArray = function (permission) {\n    var permissionArray = [];\n    var length = !isNullOrUndefined(permission.count) ? permission.count : 1;\n    for (var i = 0; i < length; i++) {\n      switch (permission) {\n        case PdfPermissionFlag.fullQualityPrint:\n          permissionArray.push('FullQualityPrint');\n          break;\n        case PdfPermissionFlag.assembleDocument:\n          permissionArray.push('AssembleDocument');\n          break;\n        case PdfPermissionFlag.accessibilityCopyContent:\n          permissionArray.push('AccessibilityCopyContent');\n          break;\n        case PdfPermissionFlag.fillFields:\n          permissionArray.push('FillFields');\n          break;\n        case PdfPermissionFlag.editAnnotations:\n          permissionArray.push('EditAnnotations');\n          break;\n        case PdfPermissionFlag.copyContent:\n          permissionArray.push('CopyContent');\n          break;\n        case PdfPermissionFlag.editContent:\n          permissionArray.push('EditContent');\n          break;\n        case PdfPermissionFlag.print:\n          permissionArray.push('Print');\n          break;\n        case PdfPermissionFlag.default:\n          permissionArray.push('Default');\n          break;\n      }\n    }\n    return permissionArray;\n  };\n  PdfRenderer.prototype.getPageSizes = function (pageCount) {\n    var pageSizes = {};\n    var pageLimit = pageCount;\n    if (pageCount > 100) {\n      pageLimit = 100;\n    }\n    if (this.m_isCompletePageSizeNotReceieved) {\n      for (var i = 0; i < pageLimit; i++) {\n        pageSizes[i.toString()] = this.getPageSize(i);\n        var page = this.loadedDocument.getPage(i);\n        var rotation = page.rotation % 4;\n        this.pageRotationCollection.push(rotation);\n      }\n    } else {\n      for (var i = pageLimit; i < pageCount; i++) {\n        pageSizes[i.toString()] = this.getPageSize(i);\n        var page = this.loadedDocument.getPage(i);\n        var rotation = page.rotation % 4;\n        this.pageRotationCollection.push(rotation);\n      }\n    }\n    return pageSizes;\n  };\n  PdfRenderer.prototype.getPageSize = function (pageNumber) {\n    var page = this.loadedDocument.getPage(pageNumber);\n    var size = page.size;\n    var rotation = page.rotation % 4;\n    // eslint-disable-next-line max-len\n    if (rotation === PdfRotationAngle.angle0 || rotation === PdfRotationAngle.angle180) {\n      return new Size(this.convertPointToPixel(size[0]), this.convertPointToPixel(size[1]));\n    } else {\n      return new Size(this.convertPointToPixel(size[1]), this.convertPointToPixel(size[0]));\n    }\n  };\n  PdfRenderer.prototype.convertPointToPixel = function (number) {\n    return number * 96 / 72;\n  };\n  PdfRenderer.prototype.convertPixelToPoint = function (value) {\n    return value * (72 / 96);\n  };\n  /**\n   * @private\n   */\n  PdfRenderer.prototype.getDocumentAsBase64 = function (jsonObject) {\n    var base64string = null;\n    if (jsonObject.hasOwnProperty('digitalSignatureDocumentEdited') && !jsonObject.digitalSignatureDocumentEdited) {\n      this.loadedDocument = new PdfDocument(this.loadedBase64String, this.password);\n      return \"data:application/pdf;base64,\" + _encode(this.loadedDocument.save());\n    } else {\n      var annotationRenderer = new AnnotationRenderer(this.pdfViewer, this.pdfViewerBase);\n      var formfields = new FormFieldsBase(this.pdfViewer, this.pdfViewerBase);\n      var signatureModule = new SignatureBase(this.pdfViewer, this.pdfViewerBase);\n      // create object for form fields signature\n      annotationRenderer.removeSignatureTypeAnnot(jsonObject, this.loadedDocument);\n      this.orderAnnotations(jsonObject);\n      return \"data:application/pdf;base64,\" + _encode(this.loadedDocument.save());\n    }\n  };\n  /**\n   * @private\n   */\n  PdfRenderer.prototype.importAnnotations = function (jsonObject) {\n    try {\n      var annotationRenderer = new AnnotationRenderer(this.pdfViewer, this.pdfViewerBase);\n      var annotData = jsonObject['importedData'];\n      annotationRenderer.removeSignatureTypeAnnot(jsonObject, this.loadedDocument);\n      var annotationDataFormat = jsonObject['annotationDataFormat'];\n      if (typeof annotationDataFormat === 'string') {\n        this.loadedDocument._allowImportCustomData = true;\n        switch (annotationDataFormat.toLowerCase()) {\n          case 'json':\n            this.loadedDocument.importAnnotations(annotData, DataFormat.json);\n            break;\n          case 'xfdf':\n            this.loadedDocument.importAnnotations(annotData, DataFormat.xfdf);\n            break;\n          default:\n            break;\n        }\n        for (var i = 0; i < this.loadedDocument.pageCount; i++) {\n          var pageNumber = i;\n          var pageSize = this.getPageSize(pageNumber);\n          var renderer = new PageRenderer(this.pdfViewer, this.pdfViewerBase);\n          renderer.exportAnnotationComments(pageNumber, pageSize);\n          this.annotationDetailCollection[i.toString()] = new Annotations();\n          this.annotationDetailCollection[parseInt(i.toString(), 10)].textMarkupAnnotation = renderer.textMarkupAnnotationList;\n          this.annotationDetailCollection[parseInt(i.toString(), 10)].shapeAnnotation = renderer.shapeAnnotationList;\n          this.annotationDetailCollection[parseInt(i.toString(), 10)].measureShapeAnnotation = renderer.measureAnnotationList;\n          this.annotationDetailCollection[parseInt(i.toString(), 10)].stampAnnotations = renderer.rubberStampAnnotationList;\n          this.annotationDetailCollection[parseInt(i.toString(), 10)].stickyNotesAnnotation = renderer.stickyAnnotationList;\n          this.annotationDetailCollection[parseInt(i.toString(), 10)].freeTextAnnotation = renderer.freeTextAnnotationList;\n          this.annotationDetailCollection[parseInt(i.toString(), 10)].signatureAnnotation = renderer.signatureAnnotationList;\n          this.annotationDetailCollection[parseInt(i.toString(), 10)].signatureInkAnnotation = renderer.signatureInkAnnotationList;\n          this.annotationDetailCollection[parseInt(i.toString(), 10)].annotationOrder = renderer.annotationOrder;\n          this.removeAnnotationsFromCollection(renderer);\n        }\n        var returnAnnot = JSON.parse(JSON.stringify(this.annotationDetailCollection));\n        if (jsonObject.hasOwnProperty('uniqueId')) {\n          return {\n            pdfAnnotation: returnAnnot,\n            uniqueId: jsonObject['uniqueId']\n          };\n        } else {\n          return {\n            pdfAnnotation: returnAnnot\n          };\n        }\n      }\n    } catch (e) {\n      return e.message;\n    }\n  };\n  PdfRenderer.prototype.removeAnnotationsFromCollection = function (renderer) {\n    renderer.textMarkupAnnotationList = [];\n    renderer.shapeAnnotationList = [];\n    renderer.measureAnnotationList = [];\n    renderer.rubberStampAnnotationList = [];\n    renderer.stickyAnnotationList = [];\n    renderer.freeTextAnnotationList = [];\n    renderer.signatureAnnotationList = [];\n    renderer.signatureInkAnnotationList = [];\n    renderer.annotationOrder = [];\n  };\n  /**\n   * @private\n   */\n  PdfRenderer.prototype.exportAnnotation = function (jsonObject, isObject) {\n    var annotationRenderer = new AnnotationRenderer(this.pdfViewer, this.pdfViewerBase);\n    annotationRenderer.removeSignatureTypeAnnot(jsonObject, this.loadedDocument);\n    this.orderAnnotations(jsonObject);\n    var settings = new PdfAnnotationExportSettings();\n    var annotationDataFormat = jsonObject['annotationDataFormat'];\n    var fileName;\n    var exportObject;\n    if (typeof annotationDataFormat === 'string') {\n      switch (annotationDataFormat.toLowerCase()) {\n        case 'json':\n          settings.dataFormat = DataFormat.json;\n          if (isObject) {\n            settings.exportAppearance = isObject;\n            exportObject = this.loadedDocument.exportAnnotations(settings);\n            return \"data:application/json;base64,\" + _encode(this.loadedDocument.exportAnnotations(settings));\n          } else {\n            fileName = this.changeFileExtension(this.pdfViewer.fileName, 'json');\n            return \"data:application/json;base64,\" + _encode(this.loadedDocument.exportAnnotations(settings));\n          }\n        case 'xfdf':\n          settings.dataFormat = DataFormat.xfdf;\n          if (isObject) {\n            settings.exportAppearance = isObject;\n            exportObject = this.loadedDocument.exportAnnotations(settings);\n            return \"data:application/json;base64,\" + _encode(this.loadedDocument.exportAnnotations(settings));\n          } else {\n            fileName = this.changeFileExtension(this.pdfViewer.fileName, 'xfdf');\n            return \"data:application/json;base64,\" + _encode(this.loadedDocument.exportAnnotations(settings));\n          }\n        // Add more cases for other supported formats as needed\n        default:\n          break;\n      }\n    }\n    return '';\n  };\n  PdfRenderer.prototype.changeFileExtension = function (filename, newExtension) {\n    var lastDotIndex = filename.lastIndexOf('.');\n    if (lastDotIndex === -1) {\n      // No extension found in the filename\n      return filename + '.' + newExtension;\n    }\n    var nameWithoutExtension = filename.slice(0, lastDotIndex);\n    return nameWithoutExtension + '.' + newExtension;\n  };\n  PdfRenderer.prototype.orderAnnotations = function (jsonObject) {\n    var annotationRenderer = new AnnotationRenderer(this.pdfViewer, this.pdfViewerBase);\n    var formfields = new FormFieldsBase(this.pdfViewer, this.pdfViewerBase);\n    var signatureModule = new SignatureBase(this.pdfViewer, this.pdfViewerBase);\n    if (jsonObject.hasOwnProperty('isAnnotationsExist') && jsonObject.isAnnotationsExist) {\n      if (jsonObject.hasOwnProperty('annotationCollection')) {\n        var annotationDetails = JSON.parse(jsonObject.annotationCollection);\n        var count = annotationDetails.length;\n        var _loop_1 = function (i) {\n          var annotationType = annotationDetails[parseInt(i.toString(), 10)].shapeAnnotationType;\n          var details = annotationDetails[parseInt(i.toString(), 10)];\n          if (details.hasOwnProperty('calibrate') && (details['shapeAnnotationType'] === 'Circle' || details['shapeAnnotationType'] === 'Line' || details['shapeAnnotationType'] === 'Polygon' || details['shapeAnnotationType'] === 'Polyline')) {\n            annotationType = 'measureShapes';\n          } else if (!details.hasOwnProperty('calibrate') && (details['shapeAnnotationType'] === 'Line' || details['shapeAnnotationType'] === 'Circle' || details['shapeAnnotationType'] === 'Polygon' || details['shapeAnnotationType'] === 'Square')) {\n            annotationType = 'shapeAnnotation';\n          }\n          switch (annotationType) {\n            case 'textMarkup':\n              if (jsonObject.hasOwnProperty('textMarkupAnnotations')) {\n                var textMarkupDetails = JSON.parse(jsonObject.textMarkupAnnotations);\n                var pageNumber = details['pageNumber'].toString();\n                var annotationCount = textMarkupDetails[parseInt(pageNumber, 10)];\n                var pageAnnotations = annotationCount;\n                var textMarkup = pageAnnotations.find(function (obj) {\n                  return obj['annotName'].toString() === details['annotationId'].toString();\n                });\n                if (textMarkup) {\n                  details = textMarkup;\n                  annotationRenderer.addTextMarkup(details, this_1.loadedDocument);\n                }\n              }\n              break;\n            case 'shapeAnnotation':\n              if (jsonObject.hasOwnProperty('shapeAnnotations')) {\n                var shapeDetails = JSON.parse(jsonObject.shapeAnnotations);\n                var pageNumber = details['pageNumber'].toString();\n                var annotationCount = shapeDetails[parseInt(pageNumber, 10)];\n                var pageAnnotations = annotationCount;\n                var page = this_1.loadedDocument.getPage(parseInt(pageNumber, 10));\n                var shape = pageAnnotations.find(function (obj) {\n                  return obj['annotName'].toString() === details['annotationId'].toString();\n                });\n                if (shape) {\n                  details = shape;\n                  annotationRenderer.addShape(details, page);\n                }\n              }\n              break;\n            case 'stamp':\n              if (jsonObject.hasOwnProperty('stampAnnotations')) {\n                var stampdetails = JSON.parse(jsonObject.stampAnnotations);\n                var pageNumber = details['pageNumber'].toString();\n                var annotationCount = stampdetails[parseInt(pageNumber, 10)];\n                var pageAnnotations = annotationCount;\n                var page = this_1.loadedDocument.getPage(parseInt(pageNumber, 10));\n                var stamp = pageAnnotations.find(function (obj) {\n                  return obj['annotName'].toString() === details['annotationId'].toString();\n                });\n                if (stamp) {\n                  details = stamp;\n                  annotationRenderer.addCustomStampAnnotation(details, page);\n                }\n              }\n              break;\n            case 'measureShapes':\n              if (jsonObject.hasOwnProperty('measureShapeAnnotations')) {\n                var shapeDetails = JSON.parse(jsonObject.measureShapeAnnotations);\n                var pageNumber = details['pageNumber'].toString();\n                var annotationCount = shapeDetails[parseInt(pageNumber, 10)];\n                var pageAnnotations = annotationCount;\n                var page = this_1.loadedDocument.getPage(parseInt(pageNumber, 10));\n                var shape = pageAnnotations.find(function (obj) {\n                  return obj['annotName'].toString() === details['annotationId'].toString();\n                });\n                if (shape) {\n                  details = shape;\n                  annotationRenderer.addMeasure(details, page);\n                }\n              }\n              break;\n            case 'sticky':\n              if (jsonObject.hasOwnProperty('stickyNotesAnnotation')) {\n                var shapeDetails = JSON.parse(jsonObject.stickyNotesAnnotation);\n                var pageNumber = details['pageNumber'].toString();\n                var annotationCount = shapeDetails[parseInt(pageNumber, 10)];\n                var pageAnnotations = annotationCount;\n                var page = this_1.loadedDocument.getPage(parseInt(pageNumber, 10));\n                var shape = pageAnnotations.find(function (obj) {\n                  return obj['annotName'].toString() === details['annotationId'].toString();\n                });\n                if (shape) {\n                  details = shape;\n                  annotationRenderer.addStickyNotes(details, page);\n                }\n              }\n              break;\n            case \"Ink\":\n              if (jsonObject.hasOwnProperty('inkSignatureData')) {\n                var shapeDetails = JSON.parse(jsonObject.inkSignatureData);\n                var pageNumber = details['pageNumber'].toString();\n                var annotationCount = shapeDetails[parseInt(pageNumber, 10)];\n                var pageAnnotations = annotationCount;\n                var page = this_1.loadedDocument.getPage(parseInt(pageNumber, 10));\n                var shape = pageAnnotations.find(function (obj) {\n                  return obj['annotName'].toString() === details['annotationId'].toString();\n                });\n                if (shape) {\n                  details = shape;\n                  annotationRenderer.saveInkSignature(details, page);\n                }\n              }\n              break;\n            case 'FreeText':\n              if (jsonObject.hasOwnProperty('freeTextAnnotation')) {\n                var freeTextDetails = JSON.parse(jsonObject.freeTextAnnotation);\n                var pageNumber = details['pageNumber'].toString();\n                var annotationCount = freeTextDetails[parseInt(pageNumber, 10)];\n                var pageAnnotations = annotationCount;\n                var page = this_1.loadedDocument.getPage(parseInt(pageNumber, 10));\n                var freeText = pageAnnotations.find(function (obj) {\n                  return obj['annotName'].toString() === details['annotationId'].toString();\n                });\n                if (!isNullOrUndefined(freeText)) {\n                  details = freeText;\n                  if (!isNullOrUndefined(this_1.FallbackFontCollection) && this_1.FallbackFontCollection.length !== 0) {\n                    annotationRenderer.addFreeText(details, page, this_1.FallbackFontCollection);\n                  } else {\n                    annotationRenderer.addFreeText(details, page);\n                  }\n                }\n              }\n              break;\n            default:\n              break;\n          }\n        };\n        var this_1 = this;\n        for (var i = 0; i < count; i++) {\n          _loop_1(i);\n        }\n        if (jsonObject.signatureData) {\n          if (jsonObject.isSignatureEdited) {\n            signatureModule.saveSignatureAsAnnotatation(jsonObject, this.loadedDocument);\n          } else {\n            signatureModule.saveSignatureData(jsonObject, this.loadedDocument);\n          }\n        }\n      }\n    }\n    if (jsonObject.hasOwnProperty('isFormFieldAnnotationsExist') && jsonObject.isFormFieldAnnotationsExist) {\n      if (jsonObject.hasOwnProperty('formDesigner')) {\n        formfields.saveFormFieldsDesignerData(jsonObject);\n      } else if (jsonObject.hasOwnProperty('fieldsData')) {\n        formfields.saveFormFieldsData(jsonObject);\n      }\n    }\n  };\n  /**\n   * @private\n   */\n  PdfRenderer.prototype.getAnnotationComments = function (jsonObject) {\n    try {\n      var loadedDocument = this.loadedDocument;\n      if (jsonObject.hasOwnProperty('pageStartIndex') && !isNullOrUndefined(jsonObject.pageStartIndex)) {\n        var pageStartIndex = parseInt(jsonObject.pageStartIndex, 10);\n        var pageEndIndex = parseInt(jsonObject.pageEndIndex, 10);\n        var annotationDetails = {};\n        for (var i = pageStartIndex; i < pageEndIndex; i++) {\n          var pageNumber = i;\n          var pageSize = this.getPageSize(pageNumber);\n          this.renderer = new PageRenderer(this.pdfViewer, this.pdfViewerBase);\n          annotationDetails[pageNumber.toString()] = this.renderer.exportAnnotationComments(pageNumber, pageSize);\n        }\n        // eslint-disable-next-line max-len\n        return {\n          uniqueId: jsonObject.uniqueId,\n          annotationDetails: annotationDetails,\n          startPageIndex: pageStartIndex,\n          endPageIndex: pageEndIndex,\n          isAnnotationPresent: this.renderer.isAnnotationPresent\n        };\n      }\n      return '';\n    } catch (error) {\n      return error.message;\n    }\n  };\n  /**\n   * @private\n   */\n  PdfRenderer.prototype.getBookmarks = function (jsonObject) {\n    try {\n      var bookmark = this.loadedDocument.bookmarks;\n      if (!isNullOrUndefined(bookmark) && jsonObject.hasOwnProperty('bookmarkStyles')) {\n        for (var i = 0; i < bookmark.count; i++) {\n          this.retrieveFontStyles(bookmark.at(i), false);\n        }\n      }\n      // eslint-disable-next-line max-len\n      if (isNullOrUndefined(bookmark) || isNullOrUndefined(bookmark.count) || bookmark.count === 0) {\n        return null;\n      } else {\n        for (var i = 0; i < bookmark.count; i++) {\n          var pdfLoadedBookmark = bookmark.at(i);\n          var parentBookmarkDestination = new BookmarkDestination();\n          // eslint-disable-next-line max-len\n          var bookmarkDestination = pdfLoadedBookmark.destination ? pdfLoadedBookmark.destination : pdfLoadedBookmark.namedDestination ? pdfLoadedBookmark.namedDestination.destination ? pdfLoadedBookmark.namedDestination.destination : null : null;\n          // eslint-disable-next-line max-len\n          parentBookmarkDestination.X = !isNullOrUndefined(bookmarkDestination) ? bookmarkDestination.location[0] : 0;\n          // eslint-disable-next-line max-len\n          parentBookmarkDestination.PageIndex = !isNullOrUndefined(bookmarkDestination) ? bookmarkDestination.pageIndex : 0;\n          // eslint-disable-next-line max-len\n          parentBookmarkDestination.Zoom = !isNullOrUndefined(bookmarkDestination) ? bookmarkDestination.zoom : 0;\n          // eslint-disable-next-line max-len\n          var parentBookmark = new BookmarkBase();\n          parentBookmark.Id = ++this.id;\n          parentBookmark.Title = pdfLoadedBookmark.title;\n          parentBookmark.Child = [];\n          parentBookmark.FileName = !isNullOrUndefined(pdfLoadedBookmark.action) ? pdfLoadedBookmark.action.toString() : '';\n          if (!isNullOrUndefined(bookmarkDestination)) {\n            if (bookmarkDestination.page.rotation === PdfRotationAngle.angle90) {\n              // eslint-disable-next-line max-len\n              parentBookmarkDestination.Y = this.convertPointToPixel(bookmarkDestination.page.size[0]) - this.convertPointToPixel(Math.abs(bookmarkDestination.location[1]));\n            } else if (bookmarkDestination.page.rotation === PdfRotationAngle.angle270) {\n              parentBookmarkDestination.Y = this.convertPointToPixel(Math.abs(bookmarkDestination.location[1]));\n            } else {\n              // eslint-disable-next-line max-len\n              parentBookmarkDestination.Y = this.convertPointToPixel(bookmarkDestination.page.size[1]) - this.convertPointToPixel(Math.abs(bookmarkDestination.location[1]));\n            }\n          } else {\n            parentBookmarkDestination.Y = 0;\n          }\n          this.bookmarkDictionary[this.id.toString()] = parentBookmarkDestination;\n          parentBookmark.Child = this.getChildrenBookmark(pdfLoadedBookmark);\n          if (parentBookmark.Child.length > 0) {\n            parentBookmark.HasChild = true;\n          }\n          this.bookmarkCollection.push(parentBookmark);\n        }\n      }\n      if (jsonObject.hasOwnProperty('uniqueId')) {\n        return {\n          Bookmarks: JSON.parse(JSON.stringify(this.bookmarkCollection)),\n          BookmarksDestination: JSON.parse(JSON.stringify(this.bookmarkDictionary)),\n          uniqueId: jsonObject['uniqueId'].toString(),\n          Bookmarkstyles: JSON.parse(JSON.stringify(this.bookmarkStyles))\n        };\n      } else {\n        // eslint-disable-next-line max-len\n        return {\n          Bookmarks: JSON.parse(JSON.stringify(this.bookmarkCollection)),\n          BookmarksDestination: JSON.parse(JSON.stringify(this.bookmarkDictionary)),\n          Bookmarkstyles: JSON.parse(JSON.stringify(this.bookmarkStyles))\n        };\n      }\n    } catch (error) {\n      return error.message;\n    }\n  };\n  PdfRenderer.prototype.retrieveFontStyles = function (listElement, isChild) {\n    var currentElement = listElement;\n    var currentStyles = new BookmarkStyles();\n    if (!isNullOrUndefined(currentElement)) {\n      if (!isNullOrUndefined(currentElement.color)) {\n        currentStyles.Color = 'rgba(' + currentElement.color[0] + ',' + currentElement.color[1] + ',' + currentElement.color[2] + ',' + 1 + ')';\n      }\n      currentStyles.FontStyle = this.getPdfTextStyleString(currentElement.textStyle);\n      currentStyles.Text = currentElement.title;\n      currentStyles.IsChild = isChild;\n      this.bookmarkStyles.push(currentStyles);\n      this.getChildrenStyles(listElement);\n    }\n  };\n  PdfRenderer.prototype.getPdfTextStyleString = function (textStyle) {\n    switch (textStyle) {\n      case PdfTextStyle.bold:\n        return 'Bold';\n      case PdfTextStyle.italic:\n        return 'Italic';\n      case PdfTextStyle.regular:\n        return 'Regular';\n      default:\n        return 'Regular';\n    }\n  };\n  PdfRenderer.prototype.getChildrenStyles = function (bookmarks) {\n    for (var i = 0; i < bookmarks.count; i++) {\n      this.retrieveFontStyles(bookmarks.at(i), true);\n    }\n  };\n  PdfRenderer.prototype.getChildrenBookmark = function (pdfLoadedBookmark) {\n    var childBookmarkCollection = [];\n    if (!isNullOrUndefined(pdfLoadedBookmark) && !isNullOrUndefined(pdfLoadedBookmark.count) && pdfLoadedBookmark.count > 0) {\n      for (var i = 0; i < pdfLoadedBookmark.count; i++) {\n        var child = pdfLoadedBookmark.at(i);\n        // eslint-disable-next-line max-len\n        var childBookmarkDestination = child.destination ? child.destination : child.namedDestination ? child.namedDestination.destination ? child.namedDestination.destination : null : null;\n        this.id++;\n        var title = child.title;\n        this.pageIndex = !isNullOrUndefined(childBookmarkDestination) ? childBookmarkDestination.pageIndex : 0;\n        this.x = !isNullOrUndefined(childBookmarkDestination) ? childBookmarkDestination.location[0] : 0;\n        var yPosition = !isNullOrUndefined(childBookmarkDestination) ? Math.abs(childBookmarkDestination.location[1]) : 0;\n        if (!isNullOrUndefined(childBookmarkDestination)) {\n          if (childBookmarkDestination.page.rotation === PdfRotationAngle.angle90) {\n            this.y = this.convertPointToPixel(childBookmarkDestination.page.size[0]) - this.convertPointToPixel(yPosition);\n          } else if (childBookmarkDestination.page.rotation === PdfRotationAngle.angle270) {\n            this.y = this.convertPointToPixel(yPosition);\n          } else {\n            this.y = this.convertPointToPixel(childBookmarkDestination.page.size[1]) - this.convertPointToPixel(yPosition);\n          }\n          this.zoom = childBookmarkDestination.zoom;\n        } else {\n          this.y = 0;\n          this.zoom = 0;\n        }\n        var childrenBookmark = new BookmarkBase();\n        childrenBookmark.Title = title;\n        childrenBookmark.Id = this.id;\n        childrenBookmark.Child = [];\n        childrenBookmark.FileName = !isNullOrUndefined(child.action) ? child.action.toString() : '';\n        var childrenBookmarkDestination = new BookmarkDestination();\n        childrenBookmarkDestination.X = this.x;\n        childrenBookmarkDestination.Y = this.y;\n        childrenBookmarkDestination.PageIndex = this.pageIndex;\n        childrenBookmarkDestination.Zoom = this.zoom;\n        this.bookmarkDictionary[this.id.toString()] = childrenBookmarkDestination;\n        childBookmarkCollection.push(childrenBookmark);\n        childrenBookmark.Child = this.getChildrenBookmark(child);\n        if (childrenBookmark.Child.length > 0) {\n          childrenBookmark.HasChild = true;\n        }\n      }\n    }\n    return childBookmarkCollection;\n  };\n  /**\n   * @private\n   */\n  PdfRenderer.prototype.getHyperlinks = function (pageIndex) {\n    if (isNullOrUndefined(this.renderer)) {\n      this.renderer = new PageRenderer(this.pdfViewer, this.pdfViewerBase);\n    }\n    if (isNullOrUndefined(this.renderer.hyperlinks)) {\n      this.renderer.hyperlinks = [];\n    }\n    this.exportHyperlinks(pageIndex, this.getPageSize(pageIndex), false, true);\n    return {\n      hyperlinks: this.renderer.hyperlinks,\n      hyperlinkBounds: this.renderer.hyperlinkBounds,\n      linkAnnotation: this.renderer.annotationList,\n      linkPage: this.renderer.annotationDestPage,\n      annotationLocation: this.renderer.annotationYPosition\n    };\n  };\n  PdfRenderer.prototype.exportHyperlinks = function (pageIndex, pageSize, isExport, isAnnotationNeeded) {\n    var page = this.loadedDocument.getPage(pageIndex);\n    this.renderer.hyperlinks = [];\n    this.renderer.hyperlinkBounds = [];\n    this.renderer.annotationDestPage = [];\n    this.renderer.annotationList = [];\n    this.renderer.annotationYPosition = [];\n    for (var i = 0; i < page.annotations.count; i++) {\n      if (page.annotations.at(i) instanceof PdfUriAnnotation) {\n        var pdfLoadedUriAnnotation = page.annotations.at(i);\n        var rectangle = this.getHyperlinkBounds(pdfLoadedUriAnnotation.bounds, pageSize, page.rotation);\n        if (isNullOrUndefined(this.renderer.hyperlinks)) {\n          this.renderer.hyperlinks = [];\n          this.renderer.hyperlinkBounds = [];\n        }\n        this.renderer.hyperlinks.push(pdfLoadedUriAnnotation.uri);\n        this.renderer.hyperlinkBounds.push(rectangle);\n      } else if (page.annotations.at(i) instanceof PdfTextWebLinkAnnotation) {\n        var pdfLoadedTextWebLinkAnnotation = page.annotations.at(i);\n        var rectangle = this.getHyperlinkBounds(pdfLoadedTextWebLinkAnnotation.bounds, pageSize, page.rotation);\n        if (isNullOrUndefined(this.renderer.hyperlinks)) {\n          this.renderer.hyperlinks = [];\n          this.renderer.hyperlinkBounds = [];\n        }\n        this.renderer.hyperlinks.push(pdfLoadedTextWebLinkAnnotation.url);\n        this.renderer.hyperlinkBounds.push(rectangle);\n      } else if (page.annotations.at(i) instanceof PdfDocumentLinkAnnotation) {\n        var pdfLoadedDocumentLinkAnnotation = page.annotations.at(i);\n        var rectangle = this.getHyperlinkBounds(pdfLoadedDocumentLinkAnnotation.bounds, pageSize, page.rotation);\n        if (isNullOrUndefined(this.renderer.annotationDestPage)) {\n          this.renderer.annotationDestPage = [];\n          this.renderer.annotationList = [];\n          this.renderer.annotationYPosition = [];\n        }\n        if (!isNullOrUndefined(pdfLoadedDocumentLinkAnnotation.destination)) {\n          var linkPageIndex = pdfLoadedDocumentLinkAnnotation.destination.pageIndex;\n          this.renderer.annotationDestPage.push(linkPageIndex);\n          this.renderer.annotationList.push(rectangle);\n          if (page.rotation === PdfRotationAngle.angle180) {\n            this.renderer.annotationYPosition.push(this.convertPointToPixel(Math.abs(pdfLoadedDocumentLinkAnnotation.destination.location[1])));\n          } else if (page.rotation === PdfRotationAngle.angle90 || page.rotation === PdfRotationAngle.angle270) {\n            this.renderer.annotationYPosition.push(pageSize.width - this.convertPointToPixel(Math.abs(pdfLoadedDocumentLinkAnnotation.destination.location[1])));\n          } else {\n            this.renderer.annotationYPosition.push(pageSize.height - this.convertPointToPixel(Math.abs(pdfLoadedDocumentLinkAnnotation.destination.location[1])));\n          }\n        }\n      }\n    }\n  };\n  PdfRenderer.prototype.getHyperlinkBounds = function (bounds, pageSize, pageRotation) {\n    var bound;\n    if (pageRotation === PdfRotationAngle.angle0) {\n      bound = new AnnotBounds(this.convertPointToPixel(bounds.x), this.convertPointToPixel(bounds.y), this.convertPointToPixel(bounds.width), this.convertPointToPixel(bounds.height));\n    } else if (pageRotation === PdfRotationAngle.angle90) {\n      bound = new AnnotBounds(pageSize.width - this.convertPointToPixel(bounds.y - bounds.height), this.convertPointToPixel(bounds.x), this.convertPointToPixel(bounds.height), this.convertPointToPixel(bounds.width));\n    } else if (pageRotation === PdfRotationAngle.angle180) {\n      bound = new AnnotBounds(pageSize.width - this.convertPointToPixel(bounds.x - bounds.width), pageSize.height - this.convertPointToPixel(bounds.y - bounds.height), this.convertPointToPixel(bounds.width), this.convertPointToPixel(bounds.height));\n    } else if (pageRotation === PdfRotationAngle.angle270) {\n      bound = new AnnotBounds(this.convertPointToPixel(bounds.y), pageSize.height - this.convertPointToPixel(bounds.x - bounds.width), this.convertPointToPixel(bounds.height), this.convertPointToPixel(bounds.width));\n    }\n    return bound;\n  };\n  /**\n   * @private\n   */\n  PdfRenderer.prototype.exportFormFields = function (jsonObject, isObjects) {\n    var formFields = new FormFieldsBase(this.pdfViewer, this.pdfViewerBase);\n    formFields.saveFormFieldsData(jsonObject);\n    formFields.saveFormFieldsDesignerData(jsonObject);\n    if (!jsonObject.hasOwnProperty(\"fileName\")) {\n      jsonObject[\"fileName\"] = \"undefined.pdf\";\n    }\n    this.loadedDocument.form.exportEmptyFields = true;\n    var dataFormat = DataFormat.json;\n    if (jsonObject.hasOwnProperty(\"formFieldDataFormat\")) {\n      dataFormat = this.exportDataFormat(jsonObject[\"formFieldDataFormat\"]);\n    }\n    var settings = new PdfFormFieldExportSettings();\n    var fileName;\n    var exportFormFieldObject;\n    settings.dataFormat = dataFormat;\n    if (isObjects) {\n      exportFormFieldObject = this.loadedDocument.exportFormData(settings);\n      return _bytesToString(exportFormFieldObject);\n    } else {\n      fileName = this.changeFileExtension(this.pdfViewer.fileName, this.fileFormat(dataFormat));\n      return \"data:application/json;base64,\" + _encode(this.loadedDocument.exportFormData(settings));\n    }\n  };\n  /**\n   * @private\n   */\n  PdfRenderer.prototype.importFormFields = function (jsonObject) {\n    try {\n      var formFields = new FormFieldsBase(this.pdfViewer, this.pdfViewerBase);\n      formFields.saveFormFieldsDesignerData(jsonObject);\n      var dataFormat = this.exportDataFormat(jsonObject[\"formFieldDataFormat\"]);\n      if (!this.isBase64(jsonObject[\"data\"]) && !this.isUint8Array(jsonObject[\"data\"])) {\n        if (jsonObject[\"formFieldDataFormat\"] === \"Json\") {\n          jsonObject[\"data\"] = JSON.parse(jsonObject[\"data\"]);\n        }\n        var encoder = new TextEncoder();\n        var uint8ArrayLike = encoder.encode(jsonObject[\"data\"]);\n        jsonObject[\"data\"] = new Uint8Array(uint8ArrayLike);\n      }\n      if (jsonObject.hasOwnProperty(\"formFieldDataFormat\")) {\n        this.loadedDocument.importFormData(jsonObject[\"data\"], dataFormat);\n      }\n      formFields = new FormFieldsBase(this.pdfViewer, this.pdfViewerBase);\n      formFields.GetFormFields();\n      var PdfRenderedFormFields = [];\n      PdfRenderedFormFields = formFields.PdfRenderedFormFields;\n      return {\n        PdfRenderedFormFields: PdfRenderedFormFields\n      };\n    } catch (e) {\n      return null;\n    }\n  };\n  PdfRenderer.prototype.isUint8Array = function (value) {\n    return value instanceof Uint8Array;\n  };\n  PdfRenderer.prototype.isBase64 = function (str) {\n    // Base64 regular expression pattern\n    /* eslint-disable-next-line security/detect-unsafe-regex */\n    var base64Regex = /^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/;\n    return base64Regex.test(str);\n  };\n  PdfRenderer.prototype.exportDataFormat = function (format) {\n    var exportFormat;\n    switch (format) {\n      case \"Json\":\n        exportFormat = DataFormat.json;\n        break;\n      case \"Xfdf\":\n        exportFormat = DataFormat.xfdf;\n        break;\n      case \"Fdf\":\n        exportFormat = DataFormat.fdf;\n        break;\n      case \"Xml\":\n        exportFormat = DataFormat.xml;\n        break;\n    }\n    return exportFormat;\n  };\n  PdfRenderer.prototype.fileFormat = function (value) {\n    var fileExtention;\n    switch (value) {\n      case 0:\n        fileExtention = \"fdf\";\n        break;\n      case 1:\n        fileExtention = \"xfdf\";\n        break;\n      case 2:\n        fileExtention = \"json\";\n        break;\n      case 3:\n        fileExtention = \"xml\";\n        break;\n    }\n    return fileExtention;\n  };\n  PdfRenderer.prototype.exportAsImage = function (pageIndex) {\n    var _this = this;\n    return new Promise(function (resolve, reject) {\n      resolve(_this.pdfiumExportAsImage(pageIndex));\n    });\n  };\n  PdfRenderer.prototype.exportAsImages = function (startIndex, endIndex) {\n    var _this = this;\n    return new Promise(function (resolve, reject) {\n      resolve(_this.pdfiumExportAsImages(startIndex, endIndex));\n    });\n  };\n  PdfRenderer.prototype.pdfiumExportAsImage = function (pageIndex) {\n    var _this = this;\n    return new Promise(function (resolve, reject) {\n      if (!isNullOrUndefined(_this.pdfViewerBase.pdfViewerRunner) && !isNullOrUndefined(_this.loadedDocument)) {\n        _this.pdfViewerBase.pdfViewerRunner.postMessage({\n          pageIndex: pageIndex,\n          message: 'extractImage',\n          zoomFactor: _this.pdfViewer.magnificationModule.zoomFactor,\n          isTextNeed: false\n        });\n        _this.pdfViewerBase.pdfViewerRunner.onmessage = function (event) {\n          if (event.data.message === 'imageExtracted') {\n            var canvas = document.createElement('canvas');\n            var _a = event.data,\n              value = _a.value,\n              width = _a.width,\n              height = _a.height;\n            canvas.width = width;\n            canvas.height = height;\n            var canvasContext = canvas.getContext('2d');\n            var imageData = canvasContext.createImageData(width, height);\n            imageData.data.set(value);\n            canvasContext.putImageData(imageData, 0, 0);\n            var imageUrl = canvas.toDataURL();\n            resolve(imageUrl);\n          }\n        };\n      } else {\n        resolve(null);\n      }\n    });\n  };\n  PdfRenderer.prototype.pdfiumExportAsImages = function (startIndex, endIndex) {\n    var _this = this;\n    return new Promise(function (resolve, reject) {\n      if (!isNullOrUndefined(_this.pdfViewerBase.pdfViewerRunner) && !isNullOrUndefined(_this.loadedDocument)) {\n        if (startIndex < 0) {\n          startIndex = 0;\n        }\n        if (endIndex > _this.loadedDocument.pageCount - 1) {\n          endIndex = _this.loadedDocument.pageCount - 1;\n        }\n        if (startIndex > endIndex) {\n          reject('Invalid page index');\n        }\n        var imageUrls_1 = [];\n        var count_1 = endIndex - startIndex + 1;\n        for (var i = startIndex; i <= endIndex; i++) {\n          _this.pdfViewerBase.pdfViewerRunner.postMessage({\n            pageIndex: i,\n            message: 'extractImage',\n            zoomFactor: _this.pdfViewer.magnificationModule.zoomFactor,\n            isTextNeed: false\n          });\n        }\n        _this.pdfViewerBase.pdfViewerRunner.onmessage = function (event) {\n          if (event.data.message === 'imageExtracted') {\n            var canvas = document.createElement('canvas');\n            var _a = event.data,\n              value = _a.value,\n              width = _a.width,\n              height = _a.height;\n            canvas.width = width;\n            canvas.height = height;\n            var canvasContext = canvas.getContext('2d');\n            var imageData = canvasContext.createImageData(width, height);\n            imageData.data.set(value);\n            canvasContext.putImageData(imageData, 0, 0);\n            var imageUrl = canvas.toDataURL();\n            imageUrls_1.push(imageUrl);\n            if (imageUrls_1.length === count_1) {\n              resolve(imageUrls_1);\n            }\n          }\n        };\n      } else {\n        resolve(null);\n      }\n    });\n  };\n  PdfRenderer.prototype.extractText = function (pageIndex, isLayout) {\n    var _this = this;\n    return new Promise(function (resolve, reject) {\n      resolve(_this.textExtraction(pageIndex, !isNullOrUndefined(isLayout) ? isLayout : true));\n    });\n  };\n  // eslint-disable-next-line max-len\n  PdfRenderer.prototype.textExtraction = function (pageIndex, isLayout, isRenderText) {\n    var _this = this;\n    var extractedText = '';\n    var textDataCollection = [];\n    var proxy = this;\n    return new Promise(function (resolve, reject) {\n      if (!isNullOrUndefined(_this.pdfViewerBase.pdfViewerRunner)) {\n        _this.pdfViewerBase.pdfViewerRunner.postMessage({\n          pageIndex: pageIndex,\n          message: 'extractText',\n          zoomFactor: _this.pdfViewer.magnificationModule.zoomFactor,\n          isTextNeed: true\n        });\n        _this.pdfViewerBase.pdfViewerRunner.onmessage = function (event) {\n          if (event.data.message === 'textExtracted') {\n            var characterDetails = event.data.characterBounds;\n            for (var i = 0; i < characterDetails.length; i++) {\n              if (!isLayout && characterDetails[parseInt(i.toString(), 10)].Text.indexOf('\\r') !== -1) {\n                extractedText += '';\n              } else {\n                extractedText += characterDetails[parseInt(i.toString(), 10)].Text;\n              }\n              var cropBox = proxy.loadedDocument.getPage(pageIndex).cropBox;\n              // eslint-disable-next-line max-len\n              var bound = new AnnotBounds(proxy.convertPixelToPoint(characterDetails[parseInt(i.toString(), 10)].X), proxy.convertPixelToPoint(characterDetails[parseInt(i.toString(), 10)].Y + cropBox[1]), proxy.convertPixelToPoint(characterDetails[parseInt(i.toString(), 10)].Width), proxy.convertPixelToPoint(characterDetails[parseInt(i.toString(), 10)].Height));\n              textDataCollection.push(new TextData(characterDetails[parseInt(i.toString(), 10)].Text, bound));\n            }\n            var result = {};\n            if (isRenderText) {\n              result.extractedTextDetails = {\n                textDataCollection: textDataCollection,\n                extractedText: extractedText\n              };\n              result.textBounds = event.data.textBounds;\n              result.textContent = event.data.textContent;\n              result.rotation = event.data.rotation;\n              result.pageText = event.data.pageText;\n              result.characterBounds = event.data.characterBounds;\n            } else {\n              result = {\n                textDataCollection: textDataCollection,\n                extractedText: extractedText\n              };\n            }\n            resolve(result);\n          }\n        };\n      } else {\n        resolve(null);\n      }\n    });\n  };\n  PdfRenderer.prototype.extractTextWithPageSize = function (pageIndex) {\n    var _this = this;\n    return new Promise(function (resolve, reject) {\n      resolve(_this.extractTextDetailsWithPageSize(pageIndex));\n    });\n  };\n  PdfRenderer.prototype.extractTextDetailsWithPageSize = function (pageIndex, isRenderText) {\n    var _this = this;\n    var pageTextDataCollection = {};\n    return new Promise(function (resolve, reject) {\n      // eslint-disable-next-line max-len\n      _this.textExtraction(pageIndex, true, isRenderText).then(function (textData) {\n        if (!isNullOrUndefined(textData)) {\n          var textDetails = textData;\n          if (isRenderText) {\n            textDetails = textData.extractedTextDetails;\n          }\n          // eslint-disable-next-line security/detect-object-injection\n          pageTextDataCollection[pageIndex] = new PageTextData(new SizeBase(_this.getPageSize(pageIndex).width, _this.getPageSize(pageIndex).height), textDetails.textDataCollection, textDetails.extractedText);\n          if (isRenderText) {\n            // eslint-disable-next-line max-len\n            resolve({\n              pageTextDataCollection: pageTextDataCollection,\n              textBounds: textData.textBounds,\n              textContent: textData.textContent,\n              rotation: textData.rotation,\n              characterBounds: textData.characterBounds\n            });\n          } else {\n            resolve(pageTextDataCollection);\n          }\n        } else {\n          resolve(null);\n        }\n      });\n    });\n  };\n  /**\n   * @private\n   */\n  PdfRenderer.prototype.getDocumentText = function (jsonObject) {\n    var _this = this;\n    var pageStartIndex = !isNullOrUndefined(jsonObject.pageStartIndex) ? jsonObject.pageStartIndex : jsonObject.pageIndex;\n    var pageEndIndex = !isNullOrUndefined(jsonObject.pageEndIndex) ? jsonObject.pageEndIndex : jsonObject.pageIndex + 1;\n    var pageCount = this.loadedDocument.pageCount;\n    var documentTextCollection = [];\n    return new Promise(function (resolve, reject) {\n      for (var pageIndex = pageStartIndex; pageIndex < pageEndIndex; pageIndex++) {\n        _this.extractTextDetailsWithPageSize(pageIndex, true).then(function (value) {\n          documentTextCollection.push(value.pageTextDataCollection);\n          if (documentTextCollection.length === pageEndIndex - pageStartIndex) {\n            resolve({\n              uniqueId: jsonObject.uniqueId,\n              documentTextCollection: documentTextCollection,\n              pageStartIndex: pageStartIndex,\n              pageEndIndex: pageEndIndex,\n              textBounds: value.textBounds,\n              textContent: value.textContent,\n              rotation: value.rotation,\n              characterBounds: value.characterBounds\n            });\n          }\n        });\n      }\n    });\n  };\n  PdfRenderer.IsLinuxOS = false;\n  PdfRenderer.IsWindowsOS = false;\n  return PdfRenderer;\n}();\nexport { PdfRenderer };\nvar TextData = /** @class */function () {\n  function TextData(text, bounds) {\n    this.Text = text;\n    this.Bounds = bounds;\n  }\n  return TextData;\n}();\nvar PageTextData = /** @class */function () {\n  function PageTextData(pageSize, textData, pageText) {\n    this.PageSize = pageSize;\n    this.TextData = textData;\n    this.PageText = pageText;\n  }\n  return PageTextData;\n}();\n/**\n *\n * @hidden\n */\nvar SizeBase = /** @class */function () {\n  function SizeBase(_Width, _Height) {\n    this.IsEmpty = true;\n    this.Width = _Width;\n    this.Height = _Height;\n    this.IsEmpty = false;\n  }\n  return SizeBase;\n}();\nexport { SizeBase };\n/**\n *\n * @hidden\n */\nvar Annotations = /** @class */function () {\n  function Annotations() {}\n  return Annotations;\n}();\nexport { Annotations };","map":{"version":3,"names":["PageRenderer","FormFieldsBase","AnnotationRenderer","SignatureBase","BookmarkStyles","BookmarkDestination","BookmarkBase","AnnotBounds","isNullOrUndefined","DataFormat","PdfAnnotationExportSettings","PdfDocument","PdfRotationAngle","PdfTextStyle","PdfDocumentLinkAnnotation","PdfTextWebLinkAnnotation","PdfUriAnnotation","PdfPermissionFlag","PdfFormFieldExportSettings","_bytesToString","_encode","Size","PdfRenderer","pdfViewer","pdfViewerBase","bookmarkStyles","bookmarkCollection","pageRotationCollection","bookmarkDictionary","annotationDetailCollection","pageSizes","m_isCompletePageSizeNotReceieved","x","y","zoom","id","pageIndex","scaleFactor","restrictionList","securityList","_fallbackFontCollection","Object","defineProperty","prototype","get","pageCount","enumerable","configurable","m_referencePath","set","v","load","documentData","documentId","password","jsonObject","action","loadedDocument","loadedBase64String","error","message","jsonResult","loadDocument","JSON","stringify","hasOwnProperty","isCompletePageSizeNotReceived","getPageSizes","pdfRenderedFormFields","isDigitalSignaturePresent","isTaggedPdf","m_formFields","documentSecurity","hideEmptyDigitalSignatureFields","showDigitalSignatureAppearance","GetFormFields","PdfRenderedFormFields","m_isDigitalSignaturePresent","digitialByteArray","save","uniqueId","RestrictionSummary","digitialSignatureFile","pageRotation","isOwnerPassword","isEncrypted","isUserPassword","_hasUserPasswordOnly","restrictionSummary","isOwner","ownerPassword","userPassword","permissionList","getPermissionArray","permissions","length","i","isExist","j","parseInt","toString","trim","push","permission","permissionArray","count","fullQualityPrint","assembleDocument","accessibilityCopyContent","fillFields","editAnnotations","copyContent","editContent","print","default","pageLimit","getPageSize","page","getPage","rotation","pageNumber","size","angle0","angle180","convertPointToPixel","number","convertPixelToPoint","value","getDocumentAsBase64","base64string","digitalSignatureDocumentEdited","annotationRenderer","formfields","signatureModule","removeSignatureTypeAnnot","orderAnnotations","importAnnotations","annotData","annotationDataFormat","_allowImportCustomData","toLowerCase","json","xfdf","pageSize","renderer","exportAnnotationComments","Annotations","textMarkupAnnotation","textMarkupAnnotationList","shapeAnnotation","shapeAnnotationList","measureShapeAnnotation","measureAnnotationList","stampAnnotations","rubberStampAnnotationList","stickyNotesAnnotation","stickyAnnotationList","freeTextAnnotation","freeTextAnnotationList","signatureAnnotation","signatureAnnotationList","signatureInkAnnotation","signatureInkAnnotationList","annotationOrder","removeAnnotationsFromCollection","returnAnnot","parse","pdfAnnotation","e","exportAnnotation","isObject","settings","fileName","exportObject","dataFormat","exportAppearance","exportAnnotations","changeFileExtension","filename","newExtension","lastDotIndex","lastIndexOf","nameWithoutExtension","slice","isAnnotationsExist","annotationDetails","annotationCollection","_loop_1","annotationType","shapeAnnotationType","details","textMarkupDetails","textMarkupAnnotations","annotationCount","pageAnnotations","textMarkup","find","obj","addTextMarkup","this_1","shapeDetails","shapeAnnotations","shape","addShape","stampdetails","stamp","addCustomStampAnnotation","measureShapeAnnotations","addMeasure","addStickyNotes","inkSignatureData","saveInkSignature","freeTextDetails","freeText","FallbackFontCollection","addFreeText","signatureData","isSignatureEdited","saveSignatureAsAnnotatation","saveSignatureData","isFormFieldAnnotationsExist","saveFormFieldsDesignerData","saveFormFieldsData","getAnnotationComments","pageStartIndex","pageEndIndex","startPageIndex","endPageIndex","isAnnotationPresent","getBookmarks","bookmark","bookmarks","retrieveFontStyles","at","pdfLoadedBookmark","parentBookmarkDestination","bookmarkDestination","destination","namedDestination","X","location","PageIndex","Zoom","parentBookmark","Id","Title","title","Child","FileName","angle90","Y","Math","abs","angle270","getChildrenBookmark","HasChild","Bookmarks","BookmarksDestination","Bookmarkstyles","listElement","isChild","currentElement","currentStyles","color","Color","FontStyle","getPdfTextStyleString","textStyle","Text","IsChild","getChildrenStyles","bold","italic","regular","childBookmarkCollection","child","childBookmarkDestination","yPosition","childrenBookmark","childrenBookmarkDestination","getHyperlinks","hyperlinks","exportHyperlinks","hyperlinkBounds","linkAnnotation","annotationList","linkPage","annotationDestPage","annotationLocation","annotationYPosition","isExport","isAnnotationNeeded","annotations","pdfLoadedUriAnnotation","rectangle","getHyperlinkBounds","bounds","uri","pdfLoadedTextWebLinkAnnotation","url","pdfLoadedDocumentLinkAnnotation","linkPageIndex","width","height","bound","exportFormFields","isObjects","formFields","form","exportEmptyFields","exportDataFormat","exportFormFieldObject","exportFormData","fileFormat","importFormFields","isBase64","isUint8Array","encoder","TextEncoder","uint8ArrayLike","encode","Uint8Array","importFormData","str","base64Regex","test","format","exportFormat","fdf","xml","fileExtention","exportAsImage","_this","Promise","resolve","reject","pdfiumExportAsImage","exportAsImages","startIndex","endIndex","pdfiumExportAsImages","pdfViewerRunner","postMessage","zoomFactor","magnificationModule","isTextNeed","onmessage","event","data","canvas","document","createElement","_a","canvasContext","getContext","imageData","createImageData","putImageData","imageUrl","toDataURL","imageUrls_1","count_1","extractText","isLayout","textExtraction","isRenderText","extractedText","textDataCollection","proxy","characterDetails","characterBounds","indexOf","cropBox","Width","Height","TextData","result","extractedTextDetails","textBounds","textContent","pageText","extractTextWithPageSize","extractTextDetailsWithPageSize","pageTextDataCollection","then","textData","textDetails","PageTextData","SizeBase","getDocumentText","documentTextCollection","IsLinuxOS","IsWindowsOS","text","Bounds","PageSize","PageText","_Width","_Height","IsEmpty"],"sources":["/Users/saleem/Desktop/KClient/Web App/Ver_3.6/User Interface/website_Source files/node_modules/@syncfusion/ej2-pdfviewer/src/pdfviewer/pdf-base/pdf-renderer.js"],"sourcesContent":["import { PageRenderer, FormFieldsBase, AnnotationRenderer, SignatureBase, BookmarkStyles, BookmarkDestination, BookmarkBase, AnnotBounds } from './index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { DataFormat, PdfAnnotationExportSettings, PdfDocument, PdfRotationAngle, PdfTextStyle, PdfDocumentLinkAnnotation, PdfTextWebLinkAnnotation, PdfUriAnnotation, PdfPermissionFlag, PdfFormFieldExportSettings, _bytesToString, _encode } from '@syncfusion/ej2-pdf';\nimport { Size } from '@syncfusion/ej2-drawings';\n/**\n * PdfRenderer\n *\n * @hidden\n */\nvar PdfRenderer = /** @class */ (function () {\n    /**\n     * @param {PdfViewer} pdfViewer - The PdfViewer.\n     * @param {PdfViewerBase} pdfViewerBase - The PdfViewerBase.\n     * @private\n     */\n    function PdfRenderer(pdfViewer, pdfViewerBase) {\n        /**\n         * @private\n         **/\n        this.bookmarkStyles = [];\n        /**\n         * @private\n         **/\n        this.bookmarkCollection = [];\n        /**\n         * @private\n         **/\n        this.pageRotationCollection = [];\n        /**\n         * @private\n         **/\n        this.bookmarkDictionary = {};\n        this.annotationDetailCollection = {};\n        this.pageSizes = {};\n        this.m_isCompletePageSizeNotReceieved = true;\n        this.x = 0;\n        this.y = 0;\n        this.zoom = 1;\n        this.id = 0;\n        this.pageIndex = 0;\n        this.scaleFactor = 1.5;\n        this.restrictionList = [];\n        this.securityList = ['Print', 'EditContent', 'CopyContent', 'EditAnnotations', 'FillFields', 'AccessibilityCopyContent', 'AssembleDocument', 'FullQualityPrint'];\n        this._fallbackFontCollection = {};\n        this.pdfViewer = pdfViewer;\n        this.pdfViewerBase = pdfViewerBase;\n    }\n    Object.defineProperty(PdfRenderer.prototype, \"PageCount\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.pageCount;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PdfRenderer.prototype, \"ReferencePath\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.m_referencePath;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PdfRenderer.prototype, \"referencePath\", {\n        /**\n         * @private\n         */\n        set: function (v) {\n            this.m_referencePath = v;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PdfRenderer.prototype, \"ScaleFactor\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.scaleFactor;\n        },\n        /**\n         * @private\n         */\n        set: function (v) {\n            this.scaleFactor = v;\n            if (this.scaleFactor <= 0) {\n                this.scaleFactor = 1;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PdfRenderer.prototype, \"FallbackFontCollection\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this._fallbackFontCollection;\n            ;\n        },\n        /**\n         * @private\n         */\n        set: function (v) {\n            this._fallbackFontCollection = v;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    PdfRenderer.prototype.load = function (documentData, documentId, password, jsonObject) {\n        try {\n            if (jsonObject.action !== \"VirtualLoad\") {\n                this.loadedDocument = new PdfDocument(documentData, password ? password : '');\n                this.loadedBase64String = documentData;\n                this.password = password;\n                this.m_isCompletePageSizeNotReceieved = true;\n            }\n        }\n        catch (error) {\n            if (error.message === 'Invalid PDF structure.') {\n                return '3';\n            }\n            else if (error.message === 'Cannot open an encrypted document. The password is invalid.') {\n                return '4';\n            }\n            else if (error.message === 'Invalid cross reference') {\n                return '4';\n            }\n            else {\n                return error.message;\n            }\n        }\n        var jsonResult = this.loadDocument(documentData, documentId, password, jsonObject);\n        this.bookmarkStyles = [];\n        this.bookmarkCollection = [];\n        this.bookmarkDictionary = {};\n        return JSON.stringify(jsonResult);\n    };\n    /**\n     * @private\n     */\n    PdfRenderer.prototype.loadDocument = function (documentData, documentId, password, jsonObject) {\n        if (jsonObject.hasOwnProperty(\"isCompletePageSizeNotReceived\")) {\n            this.m_isCompletePageSizeNotReceieved = !jsonObject.isCompletePageSizeNotReceived;\n        }\n        this.pageCount = this.loadedDocument.pageCount;\n        this.pageSizes = this.getPageSizes(this.pageCount);\n        var pdfRenderedFormFields = [];\n        var isDigitalSignaturePresent = false;\n        var isTaggedPdf = false; //Need to check and set if loaddocument is tagged pdf\n        this.m_formFields = new FormFieldsBase(this.pdfViewer, this.pdfViewerBase, isDigitalSignaturePresent);\n        this.restrictionList = [];\n        if (!isNullOrUndefined(this.loadedDocument)) {\n            this.documentSecurity(password);\n        }\n        if (!isNullOrUndefined(this.loadedDocument)) {\n            if (jsonObject.hasOwnProperty(\"hideEmptyDigitalSignatureFields\")) {\n                this.m_formFields.hideEmptyDigitalSignatureFields = jsonObject[\"hideEmptyDigitalSignatureFields\"];\n            }\n            if (jsonObject.hasOwnProperty(\"showDigitalSignatureAppearance\")) {\n                this.m_formFields.showDigitalSignatureAppearance = jsonObject[\"showDigitalSignatureAppearance\"];\n            }\n        }\n        if (!isNullOrUndefined(this.m_formFields) && this.pageCount <= 100) {\n            this.m_formFields.GetFormFields();\n            pdfRenderedFormFields = this.m_formFields.PdfRenderedFormFields;\n        }\n        if (this.m_formFields.m_isDigitalSignaturePresent) {\n            this.digitialByteArray = this.loadedDocument.save();\n        }\n        // eslint-disable-next-line max-len\n        return { pageCount: this.pageCount, pageSizes: this.pageSizes, uniqueId: documentId, PdfRenderedFormFields: pdfRenderedFormFields, RestrictionSummary: this.restrictionList, documentData: documentData, isDigitalSignaturePresent: this.m_formFields.m_isDigitalSignaturePresent, digitialSignatureFile: this.digitialByteArray ? _encode(this.digitialByteArray) : \"\", isTaggedPdf: isTaggedPdf, pageRotation: this.pageRotationCollection };\n    };\n    PdfRenderer.prototype.documentSecurity = function (password) {\n        // eslint-disable-next-line max-len\n        var isOwnerPassword = this.loadedDocument.isEncrypted && (!this.loadedDocument.isUserPassword || this.loadedDocument._hasUserPasswordOnly);\n        if (!isNullOrUndefined(password) && password !== '' && isOwnerPassword) {\n            this.restrictionSummary(password, true);\n        }\n        else {\n            this.restrictionSummary(password, false);\n        }\n    };\n    PdfRenderer.prototype.restrictionSummary = function (password, isOwner) {\n        var ownerPassword = password ? password : ''; //Need to set owner password from loaded document\n        var userPassword = password ? password : ''; //Need to set user password from loaded document\n        var permissionList = this.getPermissionArray(this.loadedDocument.permissions);\n        var isEncrypted = this.loadedDocument.isEncrypted;\n        if ((!(permissionList.length === 1 && permissionList[0] === 'Default')) || (isEncrypted && ownerPassword === '' && userPassword === '')) {\n            for (var i = 0; i < this.securityList.length; i++) {\n                var isExist = false;\n                for (var j = 0; j < permissionList.length; j++) {\n                    if (permissionList[parseInt(j.toString(), 10)].trim() === this.securityList[parseInt(i.toString(), 10)].trim()) {\n                        isExist = true;\n                        break;\n                    }\n                }\n                if (!isExist && !isOwner) {\n                    this.restrictionList.push(this.securityList[parseInt(i.toString(), 10)].trim());\n                }\n            }\n        }\n        else if (permissionList.length === 1 && permissionList[0] === 'Default' && isEncrypted && !isOwner) {\n            for (var i = 0; i < this.securityList.length; i++) {\n                this.restrictionList.push(this.securityList[parseInt(i.toString(), 10)].trim());\n            }\n        }\n    };\n    PdfRenderer.prototype.getPermissionArray = function (permission) {\n        var permissionArray = [];\n        var length = !isNullOrUndefined(permission.count) ? permission.count : 1;\n        for (var i = 0; i < length; i++) {\n            switch (permission) {\n                case PdfPermissionFlag.fullQualityPrint:\n                    permissionArray.push('FullQualityPrint');\n                    break;\n                case PdfPermissionFlag.assembleDocument:\n                    permissionArray.push('AssembleDocument');\n                    break;\n                case PdfPermissionFlag.accessibilityCopyContent:\n                    permissionArray.push('AccessibilityCopyContent');\n                    break;\n                case PdfPermissionFlag.fillFields:\n                    permissionArray.push('FillFields');\n                    break;\n                case PdfPermissionFlag.editAnnotations:\n                    permissionArray.push('EditAnnotations');\n                    break;\n                case PdfPermissionFlag.copyContent:\n                    permissionArray.push('CopyContent');\n                    break;\n                case PdfPermissionFlag.editContent:\n                    permissionArray.push('EditContent');\n                    break;\n                case PdfPermissionFlag.print:\n                    permissionArray.push('Print');\n                    break;\n                case PdfPermissionFlag.default:\n                    permissionArray.push('Default');\n                    break;\n            }\n        }\n        return permissionArray;\n    };\n    PdfRenderer.prototype.getPageSizes = function (pageCount) {\n        var pageSizes = {};\n        var pageLimit = pageCount;\n        if (pageCount > 100) {\n            pageLimit = 100;\n        }\n        if (this.m_isCompletePageSizeNotReceieved) {\n            for (var i = 0; i < pageLimit; i++) {\n                pageSizes[i.toString()] = this.getPageSize(i);\n                var page = this.loadedDocument.getPage(i);\n                var rotation = page.rotation % 4;\n                this.pageRotationCollection.push(rotation);\n            }\n        }\n        else {\n            for (var i = pageLimit; i < pageCount; i++) {\n                pageSizes[i.toString()] = this.getPageSize(i);\n                var page = this.loadedDocument.getPage(i);\n                var rotation = page.rotation % 4;\n                this.pageRotationCollection.push(rotation);\n            }\n        }\n        return pageSizes;\n    };\n    PdfRenderer.prototype.getPageSize = function (pageNumber) {\n        var page = this.loadedDocument.getPage(pageNumber);\n        var size = page.size;\n        var rotation = page.rotation % 4;\n        // eslint-disable-next-line max-len\n        if (rotation === PdfRotationAngle.angle0 || rotation === PdfRotationAngle.angle180) {\n            return new Size(this.convertPointToPixel(size[0]), this.convertPointToPixel(size[1]));\n        }\n        else {\n            return new Size(this.convertPointToPixel(size[1]), this.convertPointToPixel(size[0]));\n        }\n    };\n    PdfRenderer.prototype.convertPointToPixel = function (number) {\n        return number * 96 / 72;\n    };\n    PdfRenderer.prototype.convertPixelToPoint = function (value) {\n        return (value * (72 / 96));\n    };\n    /**\n     * @private\n     */\n    PdfRenderer.prototype.getDocumentAsBase64 = function (jsonObject) {\n        var base64string = null;\n        if (jsonObject.hasOwnProperty('digitalSignatureDocumentEdited') && !jsonObject.digitalSignatureDocumentEdited) {\n            this.loadedDocument = new PdfDocument(this.loadedBase64String, this.password);\n            return \"data:application/pdf;base64,\" + _encode(this.loadedDocument.save());\n        }\n        else {\n            var annotationRenderer = new AnnotationRenderer(this.pdfViewer, this.pdfViewerBase);\n            var formfields = new FormFieldsBase(this.pdfViewer, this.pdfViewerBase);\n            var signatureModule = new SignatureBase(this.pdfViewer, this.pdfViewerBase);\n            // create object for form fields signature\n            annotationRenderer.removeSignatureTypeAnnot(jsonObject, this.loadedDocument);\n            this.orderAnnotations(jsonObject);\n            return \"data:application/pdf;base64,\" + _encode(this.loadedDocument.save());\n        }\n    };\n    /**\n     * @private\n     */\n    PdfRenderer.prototype.importAnnotations = function (jsonObject) {\n        try {\n            var annotationRenderer = new AnnotationRenderer(this.pdfViewer, this.pdfViewerBase);\n            var annotData = jsonObject['importedData'];\n            annotationRenderer.removeSignatureTypeAnnot(jsonObject, this.loadedDocument);\n            var annotationDataFormat = jsonObject['annotationDataFormat'];\n            if (typeof annotationDataFormat === 'string') {\n                this.loadedDocument._allowImportCustomData = true;\n                switch (annotationDataFormat.toLowerCase()) {\n                    case 'json':\n                        this.loadedDocument.importAnnotations(annotData, DataFormat.json);\n                        break;\n                    case 'xfdf':\n                        this.loadedDocument.importAnnotations(annotData, DataFormat.xfdf);\n                        break;\n                    default:\n                        break;\n                }\n                for (var i = 0; i < this.loadedDocument.pageCount; i++) {\n                    var pageNumber = i;\n                    var pageSize = this.getPageSize(pageNumber);\n                    var renderer = new PageRenderer(this.pdfViewer, this.pdfViewerBase);\n                    renderer.exportAnnotationComments(pageNumber, pageSize);\n                    this.annotationDetailCollection[i.toString()] = new Annotations();\n                    this.annotationDetailCollection[parseInt(i.toString(), 10)].textMarkupAnnotation = renderer.textMarkupAnnotationList;\n                    this.annotationDetailCollection[parseInt(i.toString(), 10)].shapeAnnotation = renderer.shapeAnnotationList;\n                    this.annotationDetailCollection[parseInt(i.toString(), 10)].measureShapeAnnotation = renderer.measureAnnotationList;\n                    this.annotationDetailCollection[parseInt(i.toString(), 10)].stampAnnotations = renderer.rubberStampAnnotationList;\n                    this.annotationDetailCollection[parseInt(i.toString(), 10)].stickyNotesAnnotation = renderer.stickyAnnotationList;\n                    this.annotationDetailCollection[parseInt(i.toString(), 10)].freeTextAnnotation = renderer.freeTextAnnotationList;\n                    this.annotationDetailCollection[parseInt(i.toString(), 10)].signatureAnnotation = renderer.signatureAnnotationList;\n                    this.annotationDetailCollection[parseInt(i.toString(), 10)].signatureInkAnnotation = renderer.signatureInkAnnotationList;\n                    this.annotationDetailCollection[parseInt(i.toString(), 10)].annotationOrder = renderer.annotationOrder;\n                    this.removeAnnotationsFromCollection(renderer);\n                }\n                var returnAnnot = JSON.parse(JSON.stringify(this.annotationDetailCollection));\n                if (jsonObject.hasOwnProperty('uniqueId')) {\n                    return { pdfAnnotation: returnAnnot, uniqueId: jsonObject['uniqueId'] };\n                }\n                else {\n                    return { pdfAnnotation: returnAnnot };\n                }\n            }\n        }\n        catch (e) {\n            return e.message;\n        }\n    };\n    PdfRenderer.prototype.removeAnnotationsFromCollection = function (renderer) {\n        renderer.textMarkupAnnotationList = [];\n        renderer.shapeAnnotationList = [];\n        renderer.measureAnnotationList = [];\n        renderer.rubberStampAnnotationList = [];\n        renderer.stickyAnnotationList = [];\n        renderer.freeTextAnnotationList = [];\n        renderer.signatureAnnotationList = [];\n        renderer.signatureInkAnnotationList = [];\n        renderer.annotationOrder = [];\n    };\n    /**\n     * @private\n     */\n    PdfRenderer.prototype.exportAnnotation = function (jsonObject, isObject) {\n        var annotationRenderer = new AnnotationRenderer(this.pdfViewer, this.pdfViewerBase);\n        annotationRenderer.removeSignatureTypeAnnot(jsonObject, this.loadedDocument);\n        this.orderAnnotations(jsonObject);\n        var settings = new PdfAnnotationExportSettings();\n        var annotationDataFormat = jsonObject['annotationDataFormat'];\n        var fileName;\n        var exportObject;\n        if (typeof annotationDataFormat === 'string') {\n            switch (annotationDataFormat.toLowerCase()) {\n                case 'json':\n                    settings.dataFormat = DataFormat.json;\n                    if (isObject) {\n                        settings.exportAppearance = isObject;\n                        exportObject = this.loadedDocument.exportAnnotations(settings);\n                        return \"data:application/json;base64,\" + _encode(this.loadedDocument.exportAnnotations(settings));\n                    }\n                    else {\n                        fileName = this.changeFileExtension(this.pdfViewer.fileName, 'json');\n                        return \"data:application/json;base64,\" + _encode(this.loadedDocument.exportAnnotations(settings));\n                    }\n                case 'xfdf':\n                    settings.dataFormat = DataFormat.xfdf;\n                    if (isObject) {\n                        settings.exportAppearance = isObject;\n                        exportObject = this.loadedDocument.exportAnnotations(settings);\n                        return \"data:application/json;base64,\" + _encode(this.loadedDocument.exportAnnotations(settings));\n                    }\n                    else {\n                        fileName = this.changeFileExtension(this.pdfViewer.fileName, 'xfdf');\n                        return \"data:application/json;base64,\" + _encode(this.loadedDocument.exportAnnotations(settings));\n                    }\n                // Add more cases for other supported formats as needed\n                default:\n                    break;\n            }\n        }\n        return '';\n    };\n    PdfRenderer.prototype.changeFileExtension = function (filename, newExtension) {\n        var lastDotIndex = filename.lastIndexOf('.');\n        if (lastDotIndex === -1) {\n            // No extension found in the filename\n            return filename + '.' + newExtension;\n        }\n        var nameWithoutExtension = filename.slice(0, lastDotIndex);\n        return nameWithoutExtension + '.' + newExtension;\n    };\n    PdfRenderer.prototype.orderAnnotations = function (jsonObject) {\n        var annotationRenderer = new AnnotationRenderer(this.pdfViewer, this.pdfViewerBase);\n        var formfields = new FormFieldsBase(this.pdfViewer, this.pdfViewerBase);\n        var signatureModule = new SignatureBase(this.pdfViewer, this.pdfViewerBase);\n        if (jsonObject.hasOwnProperty('isAnnotationsExist') && jsonObject.isAnnotationsExist) {\n            if (jsonObject.hasOwnProperty('annotationCollection')) {\n                var annotationDetails = JSON.parse(jsonObject.annotationCollection);\n                var count = annotationDetails.length;\n                var _loop_1 = function (i) {\n                    var annotationType = annotationDetails[parseInt(i.toString(), 10)].shapeAnnotationType;\n                    var details = annotationDetails[parseInt(i.toString(), 10)];\n                    if (details.hasOwnProperty('calibrate') && (details['shapeAnnotationType'] === 'Circle' || details['shapeAnnotationType'] === 'Line' || details['shapeAnnotationType'] === 'Polygon' || details['shapeAnnotationType'] === 'Polyline')) {\n                        annotationType = 'measureShapes';\n                    }\n                    else if (!(details.hasOwnProperty('calibrate')) && (details['shapeAnnotationType'] === 'Line' || details['shapeAnnotationType'] === 'Circle' || details['shapeAnnotationType'] === 'Polygon' || details['shapeAnnotationType'] === 'Square')) {\n                        annotationType = 'shapeAnnotation';\n                    }\n                    switch (annotationType) {\n                        case 'textMarkup':\n                            if (jsonObject.hasOwnProperty('textMarkupAnnotations')) {\n                                var textMarkupDetails = JSON.parse(jsonObject.textMarkupAnnotations);\n                                var pageNumber = details['pageNumber'].toString();\n                                var annotationCount = textMarkupDetails[parseInt(pageNumber, 10)];\n                                var pageAnnotations = annotationCount;\n                                var textMarkup = pageAnnotations.find(function (obj) { return obj['annotName'].toString() === details['annotationId'].toString(); });\n                                if (textMarkup) {\n                                    details = textMarkup;\n                                    annotationRenderer.addTextMarkup(details, this_1.loadedDocument);\n                                }\n                            }\n                            break;\n                        case 'shapeAnnotation':\n                            if (jsonObject.hasOwnProperty('shapeAnnotations')) {\n                                var shapeDetails = JSON.parse(jsonObject.shapeAnnotations);\n                                var pageNumber = details['pageNumber'].toString();\n                                var annotationCount = shapeDetails[parseInt(pageNumber, 10)];\n                                var pageAnnotations = annotationCount;\n                                var page = this_1.loadedDocument.getPage(parseInt(pageNumber, 10));\n                                var shape = pageAnnotations.find(function (obj) { return obj['annotName'].toString() === details['annotationId'].toString(); });\n                                if (shape) {\n                                    details = shape;\n                                    annotationRenderer.addShape(details, page);\n                                }\n                            }\n                            break;\n                        case 'stamp':\n                            if (jsonObject.hasOwnProperty('stampAnnotations')) {\n                                var stampdetails = JSON.parse(jsonObject.stampAnnotations);\n                                var pageNumber = details['pageNumber'].toString();\n                                var annotationCount = stampdetails[parseInt(pageNumber, 10)];\n                                var pageAnnotations = annotationCount;\n                                var page = this_1.loadedDocument.getPage(parseInt(pageNumber, 10));\n                                var stamp = pageAnnotations.find(function (obj) { return obj['annotName'].toString() === details['annotationId'].toString(); });\n                                if (stamp) {\n                                    details = stamp;\n                                    annotationRenderer.addCustomStampAnnotation(details, page);\n                                }\n                            }\n                            break;\n                        case 'measureShapes':\n                            if (jsonObject.hasOwnProperty('measureShapeAnnotations')) {\n                                var shapeDetails = JSON.parse(jsonObject.measureShapeAnnotations);\n                                var pageNumber = details['pageNumber'].toString();\n                                var annotationCount = shapeDetails[parseInt(pageNumber, 10)];\n                                var pageAnnotations = annotationCount;\n                                var page = this_1.loadedDocument.getPage(parseInt(pageNumber, 10));\n                                var shape = pageAnnotations.find(function (obj) { return obj['annotName'].toString() === details['annotationId'].toString(); });\n                                if (shape) {\n                                    details = shape;\n                                    annotationRenderer.addMeasure(details, page);\n                                }\n                            }\n                            break;\n                        case 'sticky':\n                            if (jsonObject.hasOwnProperty('stickyNotesAnnotation')) {\n                                var shapeDetails = JSON.parse(jsonObject.stickyNotesAnnotation);\n                                var pageNumber = details['pageNumber'].toString();\n                                var annotationCount = shapeDetails[parseInt(pageNumber, 10)];\n                                var pageAnnotations = annotationCount;\n                                var page = this_1.loadedDocument.getPage(parseInt(pageNumber, 10));\n                                var shape = pageAnnotations.find(function (obj) { return obj['annotName'].toString() === details['annotationId'].toString(); });\n                                if (shape) {\n                                    details = shape;\n                                    annotationRenderer.addStickyNotes(details, page);\n                                }\n                            }\n                            break;\n                        case \"Ink\":\n                            if (jsonObject.hasOwnProperty('inkSignatureData')) {\n                                var shapeDetails = JSON.parse(jsonObject.inkSignatureData);\n                                var pageNumber = details['pageNumber'].toString();\n                                var annotationCount = shapeDetails[parseInt(pageNumber, 10)];\n                                var pageAnnotations = annotationCount;\n                                var page = this_1.loadedDocument.getPage(parseInt(pageNumber, 10));\n                                var shape = pageAnnotations.find(function (obj) { return obj['annotName'].toString() === details['annotationId'].toString(); });\n                                if (shape) {\n                                    details = shape;\n                                    annotationRenderer.saveInkSignature(details, page);\n                                }\n                            }\n                            break;\n                        case 'FreeText':\n                            if (jsonObject.hasOwnProperty('freeTextAnnotation')) {\n                                var freeTextDetails = JSON.parse(jsonObject.freeTextAnnotation);\n                                var pageNumber = details['pageNumber'].toString();\n                                var annotationCount = freeTextDetails[parseInt(pageNumber, 10)];\n                                var pageAnnotations = annotationCount;\n                                var page = this_1.loadedDocument.getPage(parseInt(pageNumber, 10));\n                                var freeText = pageAnnotations.find(function (obj) { return obj['annotName'].toString() === details['annotationId'].toString(); });\n                                if (!isNullOrUndefined(freeText)) {\n                                    details = freeText;\n                                    if (!isNullOrUndefined(this_1.FallbackFontCollection) && this_1.FallbackFontCollection.length !== 0) {\n                                        annotationRenderer.addFreeText(details, page, this_1.FallbackFontCollection);\n                                    }\n                                    else {\n                                        annotationRenderer.addFreeText(details, page);\n                                    }\n                                }\n                            }\n                            break;\n                        default:\n                            break;\n                    }\n                };\n                var this_1 = this;\n                for (var i = 0; i < count; i++) {\n                    _loop_1(i);\n                }\n                if (jsonObject.signatureData) {\n                    if (jsonObject.isSignatureEdited) {\n                        signatureModule.saveSignatureAsAnnotatation(jsonObject, this.loadedDocument);\n                    }\n                    else {\n                        signatureModule.saveSignatureData(jsonObject, this.loadedDocument);\n                    }\n                }\n            }\n        }\n        if (jsonObject.hasOwnProperty('isFormFieldAnnotationsExist') && jsonObject.isFormFieldAnnotationsExist) {\n            if (jsonObject.hasOwnProperty('formDesigner')) {\n                formfields.saveFormFieldsDesignerData(jsonObject);\n            }\n            else if (jsonObject.hasOwnProperty('fieldsData')) {\n                formfields.saveFormFieldsData(jsonObject);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    PdfRenderer.prototype.getAnnotationComments = function (jsonObject) {\n        try {\n            var loadedDocument = this.loadedDocument;\n            if (jsonObject.hasOwnProperty('pageStartIndex') && !isNullOrUndefined(jsonObject.pageStartIndex)) {\n                var pageStartIndex = parseInt(jsonObject.pageStartIndex, 10);\n                var pageEndIndex = parseInt(jsonObject.pageEndIndex, 10);\n                var annotationDetails = {};\n                for (var i = pageStartIndex; i < pageEndIndex; i++) {\n                    var pageNumber = i;\n                    var pageSize = this.getPageSize(pageNumber);\n                    this.renderer = new PageRenderer(this.pdfViewer, this.pdfViewerBase);\n                    annotationDetails[pageNumber.toString()] = this.renderer.exportAnnotationComments(pageNumber, pageSize);\n                }\n                // eslint-disable-next-line max-len\n                return { uniqueId: jsonObject.uniqueId, annotationDetails: annotationDetails, startPageIndex: pageStartIndex, endPageIndex: pageEndIndex, isAnnotationPresent: this.renderer.isAnnotationPresent };\n            }\n            return '';\n        }\n        catch (error) {\n            return error.message;\n        }\n    };\n    /**\n     * @private\n     */\n    PdfRenderer.prototype.getBookmarks = function (jsonObject) {\n        try {\n            var bookmark = this.loadedDocument.bookmarks;\n            if (!isNullOrUndefined(bookmark) && jsonObject.hasOwnProperty('bookmarkStyles')) {\n                for (var i = 0; i < bookmark.count; i++) {\n                    this.retrieveFontStyles(bookmark.at(i), false);\n                }\n            }\n            // eslint-disable-next-line max-len\n            if (isNullOrUndefined(bookmark) || isNullOrUndefined(bookmark.count) || bookmark.count === 0) {\n                return null;\n            }\n            else {\n                for (var i = 0; i < bookmark.count; i++) {\n                    var pdfLoadedBookmark = bookmark.at(i);\n                    var parentBookmarkDestination = new BookmarkDestination();\n                    // eslint-disable-next-line max-len\n                    var bookmarkDestination = pdfLoadedBookmark.destination ? pdfLoadedBookmark.destination : pdfLoadedBookmark.namedDestination ? pdfLoadedBookmark.namedDestination.destination ? pdfLoadedBookmark.namedDestination.destination : null : null;\n                    // eslint-disable-next-line max-len\n                    parentBookmarkDestination.X = !isNullOrUndefined(bookmarkDestination) ? bookmarkDestination.location[0] : 0;\n                    // eslint-disable-next-line max-len\n                    parentBookmarkDestination.PageIndex = !isNullOrUndefined(bookmarkDestination) ? bookmarkDestination.pageIndex : 0;\n                    // eslint-disable-next-line max-len\n                    parentBookmarkDestination.Zoom = !isNullOrUndefined(bookmarkDestination) ? bookmarkDestination.zoom : 0;\n                    // eslint-disable-next-line max-len\n                    var parentBookmark = new BookmarkBase();\n                    parentBookmark.Id = ++this.id;\n                    parentBookmark.Title = pdfLoadedBookmark.title;\n                    parentBookmark.Child = [];\n                    parentBookmark.FileName = !isNullOrUndefined(pdfLoadedBookmark.action) ? pdfLoadedBookmark.action.toString() : '';\n                    if (!isNullOrUndefined(bookmarkDestination)) {\n                        if (bookmarkDestination.page.rotation === PdfRotationAngle.angle90) {\n                            // eslint-disable-next-line max-len\n                            parentBookmarkDestination.Y = this.convertPointToPixel(bookmarkDestination.page.size[0]) - this.convertPointToPixel(Math.abs(bookmarkDestination.location[1]));\n                        }\n                        else if (bookmarkDestination.page.rotation === PdfRotationAngle.angle270) {\n                            parentBookmarkDestination.Y = this.convertPointToPixel(Math.abs(bookmarkDestination.location[1]));\n                        }\n                        else {\n                            // eslint-disable-next-line max-len\n                            parentBookmarkDestination.Y = this.convertPointToPixel(bookmarkDestination.page.size[1]) - this.convertPointToPixel(Math.abs(bookmarkDestination.location[1]));\n                        }\n                    }\n                    else {\n                        parentBookmarkDestination.Y = 0;\n                    }\n                    this.bookmarkDictionary[this.id.toString()] = parentBookmarkDestination;\n                    parentBookmark.Child = this.getChildrenBookmark(pdfLoadedBookmark);\n                    if (parentBookmark.Child.length > 0) {\n                        parentBookmark.HasChild = true;\n                    }\n                    this.bookmarkCollection.push(parentBookmark);\n                }\n            }\n            if (jsonObject.hasOwnProperty('uniqueId')) {\n                return { Bookmarks: JSON.parse(JSON.stringify(this.bookmarkCollection)), BookmarksDestination: JSON.parse(JSON.stringify(this.bookmarkDictionary)), uniqueId: jsonObject['uniqueId'].toString(), Bookmarkstyles: JSON.parse(JSON.stringify(this.bookmarkStyles)) };\n            }\n            else {\n                // eslint-disable-next-line max-len\n                return { Bookmarks: JSON.parse(JSON.stringify(this.bookmarkCollection)), BookmarksDestination: JSON.parse(JSON.stringify(this.bookmarkDictionary)), Bookmarkstyles: JSON.parse(JSON.stringify(this.bookmarkStyles)) };\n            }\n        }\n        catch (error) {\n            return error.message;\n        }\n    };\n    PdfRenderer.prototype.retrieveFontStyles = function (listElement, isChild) {\n        var currentElement = listElement;\n        var currentStyles = new BookmarkStyles();\n        if (!isNullOrUndefined(currentElement)) {\n            if (!isNullOrUndefined(currentElement.color)) {\n                currentStyles.Color = 'rgba(' + currentElement.color[0] + ',' + currentElement.color[1] + ',' + currentElement.color[2] + ',' + 1 + ')';\n            }\n            currentStyles.FontStyle = this.getPdfTextStyleString(currentElement.textStyle);\n            currentStyles.Text = currentElement.title;\n            currentStyles.IsChild = isChild;\n            this.bookmarkStyles.push(currentStyles);\n            this.getChildrenStyles(listElement);\n        }\n    };\n    PdfRenderer.prototype.getPdfTextStyleString = function (textStyle) {\n        switch (textStyle) {\n            case PdfTextStyle.bold:\n                return 'Bold';\n            case PdfTextStyle.italic:\n                return 'Italic';\n            case PdfTextStyle.regular:\n                return 'Regular';\n            default:\n                return 'Regular';\n        }\n    };\n    PdfRenderer.prototype.getChildrenStyles = function (bookmarks) {\n        for (var i = 0; i < bookmarks.count; i++) {\n            this.retrieveFontStyles(bookmarks.at(i), true);\n        }\n    };\n    PdfRenderer.prototype.getChildrenBookmark = function (pdfLoadedBookmark) {\n        var childBookmarkCollection = [];\n        if (!isNullOrUndefined(pdfLoadedBookmark) && !isNullOrUndefined(pdfLoadedBookmark.count) && pdfLoadedBookmark.count > 0) {\n            for (var i = 0; i < pdfLoadedBookmark.count; i++) {\n                var child = pdfLoadedBookmark.at(i);\n                // eslint-disable-next-line max-len\n                var childBookmarkDestination = child.destination ? child.destination : child.namedDestination ? child.namedDestination.destination ? child.namedDestination.destination : null : null;\n                this.id++;\n                var title = child.title;\n                this.pageIndex = !isNullOrUndefined(childBookmarkDestination) ? childBookmarkDestination.pageIndex : 0;\n                this.x = !isNullOrUndefined(childBookmarkDestination) ? childBookmarkDestination.location[0] : 0;\n                var yPosition = !isNullOrUndefined(childBookmarkDestination) ? Math.abs(childBookmarkDestination.location[1]) : 0;\n                if (!isNullOrUndefined(childBookmarkDestination)) {\n                    if (childBookmarkDestination.page.rotation === PdfRotationAngle.angle90) {\n                        this.y = this.convertPointToPixel(childBookmarkDestination.page.size[0]) - this.convertPointToPixel(yPosition);\n                    }\n                    else if (childBookmarkDestination.page.rotation === PdfRotationAngle.angle270) {\n                        this.y = this.convertPointToPixel(yPosition);\n                    }\n                    else {\n                        this.y = this.convertPointToPixel(childBookmarkDestination.page.size[1]) - this.convertPointToPixel(yPosition);\n                    }\n                    this.zoom = childBookmarkDestination.zoom;\n                }\n                else {\n                    this.y = 0;\n                    this.zoom = 0;\n                }\n                var childrenBookmark = new BookmarkBase();\n                childrenBookmark.Title = title;\n                childrenBookmark.Id = this.id;\n                childrenBookmark.Child = [];\n                childrenBookmark.FileName = !isNullOrUndefined(child.action) ? child.action.toString() : '';\n                var childrenBookmarkDestination = new BookmarkDestination();\n                childrenBookmarkDestination.X = this.x;\n                childrenBookmarkDestination.Y = this.y;\n                childrenBookmarkDestination.PageIndex = this.pageIndex;\n                childrenBookmarkDestination.Zoom = this.zoom;\n                this.bookmarkDictionary[this.id.toString()] = childrenBookmarkDestination;\n                childBookmarkCollection.push(childrenBookmark);\n                childrenBookmark.Child = this.getChildrenBookmark(child);\n                if (childrenBookmark.Child.length > 0) {\n                    childrenBookmark.HasChild = true;\n                }\n            }\n        }\n        return childBookmarkCollection;\n    };\n    /**\n     * @private\n     */\n    PdfRenderer.prototype.getHyperlinks = function (pageIndex) {\n        if (isNullOrUndefined(this.renderer)) {\n            this.renderer = new PageRenderer(this.pdfViewer, this.pdfViewerBase);\n        }\n        if (isNullOrUndefined(this.renderer.hyperlinks)) {\n            this.renderer.hyperlinks = [];\n        }\n        this.exportHyperlinks(pageIndex, this.getPageSize(pageIndex), false, true);\n        return { hyperlinks: this.renderer.hyperlinks, hyperlinkBounds: this.renderer.hyperlinkBounds, linkAnnotation: this.renderer.annotationList, linkPage: this.renderer.annotationDestPage, annotationLocation: this.renderer.annotationYPosition };\n    };\n    PdfRenderer.prototype.exportHyperlinks = function (pageIndex, pageSize, isExport, isAnnotationNeeded) {\n        var page = this.loadedDocument.getPage(pageIndex);\n        this.renderer.hyperlinks = [];\n        this.renderer.hyperlinkBounds = [];\n        this.renderer.annotationDestPage = [];\n        this.renderer.annotationList = [];\n        this.renderer.annotationYPosition = [];\n        for (var i = 0; i < page.annotations.count; i++) {\n            if (page.annotations.at(i) instanceof PdfUriAnnotation) {\n                var pdfLoadedUriAnnotation = page.annotations.at(i);\n                var rectangle = this.getHyperlinkBounds(pdfLoadedUriAnnotation.bounds, pageSize, page.rotation);\n                if (isNullOrUndefined(this.renderer.hyperlinks)) {\n                    this.renderer.hyperlinks = [];\n                    this.renderer.hyperlinkBounds = [];\n                }\n                this.renderer.hyperlinks.push(pdfLoadedUriAnnotation.uri);\n                this.renderer.hyperlinkBounds.push(rectangle);\n            }\n            else if (page.annotations.at(i) instanceof PdfTextWebLinkAnnotation) {\n                var pdfLoadedTextWebLinkAnnotation = page.annotations.at(i);\n                var rectangle = this.getHyperlinkBounds(pdfLoadedTextWebLinkAnnotation.bounds, pageSize, page.rotation);\n                if (isNullOrUndefined(this.renderer.hyperlinks)) {\n                    this.renderer.hyperlinks = [];\n                    this.renderer.hyperlinkBounds = [];\n                }\n                this.renderer.hyperlinks.push(pdfLoadedTextWebLinkAnnotation.url);\n                this.renderer.hyperlinkBounds.push(rectangle);\n            }\n            else if (page.annotations.at(i) instanceof PdfDocumentLinkAnnotation) {\n                var pdfLoadedDocumentLinkAnnotation = page.annotations.at(i);\n                var rectangle = this.getHyperlinkBounds(pdfLoadedDocumentLinkAnnotation.bounds, pageSize, page.rotation);\n                if (isNullOrUndefined(this.renderer.annotationDestPage)) {\n                    this.renderer.annotationDestPage = [];\n                    this.renderer.annotationList = [];\n                    this.renderer.annotationYPosition = [];\n                }\n                if (!isNullOrUndefined(pdfLoadedDocumentLinkAnnotation.destination)) {\n                    var linkPageIndex = pdfLoadedDocumentLinkAnnotation.destination.pageIndex;\n                    this.renderer.annotationDestPage.push(linkPageIndex);\n                    this.renderer.annotationList.push(rectangle);\n                    if (page.rotation === PdfRotationAngle.angle180) {\n                        this.renderer.annotationYPosition.push(this.convertPointToPixel(Math.abs(pdfLoadedDocumentLinkAnnotation.destination.location[1])));\n                    }\n                    else if (page.rotation === PdfRotationAngle.angle90 || page.rotation === PdfRotationAngle.angle270) {\n                        this.renderer.annotationYPosition.push(pageSize.width - this.convertPointToPixel(Math.abs(pdfLoadedDocumentLinkAnnotation.destination.location[1])));\n                    }\n                    else {\n                        this.renderer.annotationYPosition.push(pageSize.height - this.convertPointToPixel(Math.abs(pdfLoadedDocumentLinkAnnotation.destination.location[1])));\n                    }\n                }\n            }\n        }\n    };\n    PdfRenderer.prototype.getHyperlinkBounds = function (bounds, pageSize, pageRotation) {\n        var bound;\n        if (pageRotation === PdfRotationAngle.angle0) {\n            bound = new AnnotBounds(this.convertPointToPixel(bounds.x), this.convertPointToPixel(bounds.y), this.convertPointToPixel(bounds.width), this.convertPointToPixel(bounds.height));\n        }\n        else if (pageRotation === PdfRotationAngle.angle90) {\n            bound = new AnnotBounds(pageSize.width - this.convertPointToPixel(bounds.y - bounds.height), this.convertPointToPixel(bounds.x), this.convertPointToPixel(bounds.height), this.convertPointToPixel(bounds.width));\n        }\n        else if (pageRotation === PdfRotationAngle.angle180) {\n            bound = new AnnotBounds(pageSize.width - this.convertPointToPixel(bounds.x - bounds.width), pageSize.height - this.convertPointToPixel(bounds.y - bounds.height), this.convertPointToPixel(bounds.width), this.convertPointToPixel(bounds.height));\n        }\n        else if (pageRotation === PdfRotationAngle.angle270) {\n            bound = new AnnotBounds(this.convertPointToPixel(bounds.y), pageSize.height - this.convertPointToPixel(bounds.x - bounds.width), this.convertPointToPixel(bounds.height), this.convertPointToPixel(bounds.width));\n        }\n        return bound;\n    };\n    /**\n     * @private\n     */\n    PdfRenderer.prototype.exportFormFields = function (jsonObject, isObjects) {\n        var formFields = new FormFieldsBase(this.pdfViewer, this.pdfViewerBase);\n        formFields.saveFormFieldsData(jsonObject);\n        formFields.saveFormFieldsDesignerData(jsonObject);\n        if (!jsonObject.hasOwnProperty(\"fileName\")) {\n            jsonObject[\"fileName\"] = \"undefined.pdf\";\n        }\n        this.loadedDocument.form.exportEmptyFields = true;\n        var dataFormat = DataFormat.json;\n        if (jsonObject.hasOwnProperty(\"formFieldDataFormat\")) {\n            dataFormat = this.exportDataFormat(jsonObject[\"formFieldDataFormat\"]);\n        }\n        var settings = new PdfFormFieldExportSettings();\n        var fileName;\n        var exportFormFieldObject;\n        settings.dataFormat = dataFormat;\n        if (isObjects) {\n            exportFormFieldObject = this.loadedDocument.exportFormData(settings);\n            return _bytesToString(exportFormFieldObject);\n        }\n        else {\n            fileName = this.changeFileExtension(this.pdfViewer.fileName, this.fileFormat(dataFormat));\n            return \"data:application/json;base64,\" + _encode(this.loadedDocument.exportFormData(settings));\n        }\n    };\n    /**\n     * @private\n     */\n    PdfRenderer.prototype.importFormFields = function (jsonObject) {\n        try {\n            var formFields = new FormFieldsBase(this.pdfViewer, this.pdfViewerBase);\n            formFields.saveFormFieldsDesignerData(jsonObject);\n            var dataFormat = this.exportDataFormat(jsonObject[\"formFieldDataFormat\"]);\n            if (!this.isBase64(jsonObject[\"data\"]) && !this.isUint8Array(jsonObject[\"data\"])) {\n                if (jsonObject[\"formFieldDataFormat\"] === \"Json\") {\n                    jsonObject[\"data\"] = JSON.parse(jsonObject[\"data\"]);\n                }\n                var encoder = new TextEncoder();\n                var uint8ArrayLike = encoder.encode(jsonObject[\"data\"]);\n                jsonObject[\"data\"] = new Uint8Array(uint8ArrayLike);\n            }\n            if (jsonObject.hasOwnProperty(\"formFieldDataFormat\")) {\n                this.loadedDocument.importFormData(jsonObject[\"data\"], dataFormat);\n            }\n            formFields = new FormFieldsBase(this.pdfViewer, this.pdfViewerBase);\n            formFields.GetFormFields();\n            var PdfRenderedFormFields = [];\n            PdfRenderedFormFields = formFields.PdfRenderedFormFields;\n            return { PdfRenderedFormFields: PdfRenderedFormFields };\n        }\n        catch (e) {\n            return null;\n        }\n    };\n    PdfRenderer.prototype.isUint8Array = function (value) {\n        return value instanceof Uint8Array;\n    };\n    PdfRenderer.prototype.isBase64 = function (str) {\n        // Base64 regular expression pattern\n        /* eslint-disable-next-line security/detect-unsafe-regex */\n        var base64Regex = /^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/;\n        return base64Regex.test(str);\n    };\n    PdfRenderer.prototype.exportDataFormat = function (format) {\n        var exportFormat;\n        switch (format) {\n            case \"Json\":\n                exportFormat = DataFormat.json;\n                break;\n            case \"Xfdf\":\n                exportFormat = DataFormat.xfdf;\n                break;\n            case \"Fdf\":\n                exportFormat = DataFormat.fdf;\n                break;\n            case \"Xml\":\n                exportFormat = DataFormat.xml;\n                break;\n        }\n        return exportFormat;\n    };\n    PdfRenderer.prototype.fileFormat = function (value) {\n        var fileExtention;\n        switch (value) {\n            case 0:\n                fileExtention = \"fdf\";\n                break;\n            case 1:\n                fileExtention = \"xfdf\";\n                break;\n            case 2:\n                fileExtention = \"json\";\n                break;\n            case 3:\n                fileExtention = \"xml\";\n                break;\n        }\n        return fileExtention;\n    };\n    PdfRenderer.prototype.exportAsImage = function (pageIndex) {\n        var _this = this;\n        return new Promise(function (resolve, reject) {\n            resolve(_this.pdfiumExportAsImage(pageIndex));\n        });\n    };\n    PdfRenderer.prototype.exportAsImages = function (startIndex, endIndex) {\n        var _this = this;\n        return new Promise(function (resolve, reject) {\n            resolve(_this.pdfiumExportAsImages(startIndex, endIndex));\n        });\n    };\n    PdfRenderer.prototype.pdfiumExportAsImage = function (pageIndex) {\n        var _this = this;\n        return new Promise(function (resolve, reject) {\n            if (!isNullOrUndefined(_this.pdfViewerBase.pdfViewerRunner) && !isNullOrUndefined(_this.loadedDocument)) {\n                _this.pdfViewerBase.pdfViewerRunner.postMessage({ pageIndex: pageIndex, message: 'extractImage', zoomFactor: _this.pdfViewer.magnificationModule.zoomFactor, isTextNeed: false });\n                _this.pdfViewerBase.pdfViewerRunner.onmessage = function (event) {\n                    if (event.data.message === 'imageExtracted') {\n                        var canvas = document.createElement('canvas');\n                        var _a = event.data, value = _a.value, width = _a.width, height = _a.height;\n                        canvas.width = width;\n                        canvas.height = height;\n                        var canvasContext = canvas.getContext('2d');\n                        var imageData = canvasContext.createImageData(width, height);\n                        imageData.data.set(value);\n                        canvasContext.putImageData(imageData, 0, 0);\n                        var imageUrl = canvas.toDataURL();\n                        resolve(imageUrl);\n                    }\n                };\n            }\n            else {\n                resolve(null);\n            }\n        });\n    };\n    PdfRenderer.prototype.pdfiumExportAsImages = function (startIndex, endIndex) {\n        var _this = this;\n        return new Promise(function (resolve, reject) {\n            if (!isNullOrUndefined(_this.pdfViewerBase.pdfViewerRunner) && !isNullOrUndefined(_this.loadedDocument)) {\n                if (startIndex < 0) {\n                    startIndex = 0;\n                }\n                if (endIndex > _this.loadedDocument.pageCount - 1) {\n                    endIndex = _this.loadedDocument.pageCount - 1;\n                }\n                if (startIndex > endIndex) {\n                    reject('Invalid page index');\n                }\n                var imageUrls_1 = [];\n                var count_1 = endIndex - startIndex + 1;\n                for (var i = startIndex; i <= endIndex; i++) {\n                    _this.pdfViewerBase.pdfViewerRunner.postMessage({ pageIndex: i, message: 'extractImage', zoomFactor: _this.pdfViewer.magnificationModule.zoomFactor, isTextNeed: false });\n                }\n                _this.pdfViewerBase.pdfViewerRunner.onmessage = function (event) {\n                    if (event.data.message === 'imageExtracted') {\n                        var canvas = document.createElement('canvas');\n                        var _a = event.data, value = _a.value, width = _a.width, height = _a.height;\n                        canvas.width = width;\n                        canvas.height = height;\n                        var canvasContext = canvas.getContext('2d');\n                        var imageData = canvasContext.createImageData(width, height);\n                        imageData.data.set(value);\n                        canvasContext.putImageData(imageData, 0, 0);\n                        var imageUrl = canvas.toDataURL();\n                        imageUrls_1.push(imageUrl);\n                        if (imageUrls_1.length === count_1) {\n                            resolve(imageUrls_1);\n                        }\n                    }\n                };\n            }\n            else {\n                resolve(null);\n            }\n        });\n    };\n    PdfRenderer.prototype.extractText = function (pageIndex, isLayout) {\n        var _this = this;\n        return new Promise(function (resolve, reject) {\n            resolve(_this.textExtraction(pageIndex, !isNullOrUndefined(isLayout) ? isLayout : true));\n        });\n    };\n    // eslint-disable-next-line max-len\n    PdfRenderer.prototype.textExtraction = function (pageIndex, isLayout, isRenderText) {\n        var _this = this;\n        var extractedText = '';\n        var textDataCollection = [];\n        var proxy = this;\n        return new Promise(function (resolve, reject) {\n            if (!isNullOrUndefined(_this.pdfViewerBase.pdfViewerRunner)) {\n                _this.pdfViewerBase.pdfViewerRunner.postMessage({ pageIndex: pageIndex, message: 'extractText', zoomFactor: _this.pdfViewer.magnificationModule.zoomFactor, isTextNeed: true });\n                _this.pdfViewerBase.pdfViewerRunner.onmessage = function (event) {\n                    if (event.data.message === 'textExtracted') {\n                        var characterDetails = event.data.characterBounds;\n                        for (var i = 0; i < characterDetails.length; i++) {\n                            if (!isLayout && characterDetails[parseInt(i.toString(), 10)].Text.indexOf('\\r') !== -1) {\n                                extractedText += '';\n                            }\n                            else {\n                                extractedText += characterDetails[parseInt(i.toString(), 10)].Text;\n                            }\n                            var cropBox = proxy.loadedDocument.getPage(pageIndex).cropBox;\n                            // eslint-disable-next-line max-len\n                            var bound = new AnnotBounds(proxy.convertPixelToPoint(characterDetails[parseInt(i.toString(), 10)].X), proxy.convertPixelToPoint(characterDetails[parseInt(i.toString(), 10)].Y + cropBox[1]), proxy.convertPixelToPoint(characterDetails[parseInt(i.toString(), 10)].Width), proxy.convertPixelToPoint(characterDetails[parseInt(i.toString(), 10)].Height));\n                            textDataCollection.push(new TextData(characterDetails[parseInt(i.toString(), 10)].Text, bound));\n                        }\n                        var result = {};\n                        if (isRenderText) {\n                            result.extractedTextDetails = { textDataCollection: textDataCollection, extractedText: extractedText };\n                            result.textBounds = event.data.textBounds;\n                            result.textContent = event.data.textContent;\n                            result.rotation = event.data.rotation;\n                            result.pageText = event.data.pageText;\n                            result.characterBounds = event.data.characterBounds;\n                        }\n                        else {\n                            result = { textDataCollection: textDataCollection, extractedText: extractedText };\n                        }\n                        resolve(result);\n                    }\n                };\n            }\n            else {\n                resolve(null);\n            }\n        });\n    };\n    PdfRenderer.prototype.extractTextWithPageSize = function (pageIndex) {\n        var _this = this;\n        return new Promise(function (resolve, reject) {\n            resolve(_this.extractTextDetailsWithPageSize(pageIndex));\n        });\n    };\n    PdfRenderer.prototype.extractTextDetailsWithPageSize = function (pageIndex, isRenderText) {\n        var _this = this;\n        var pageTextDataCollection = {};\n        return new Promise(function (resolve, reject) {\n            // eslint-disable-next-line max-len\n            _this.textExtraction(pageIndex, true, isRenderText).then(function (textData) {\n                if (!isNullOrUndefined(textData)) {\n                    var textDetails = textData;\n                    if (isRenderText) {\n                        textDetails = textData.extractedTextDetails;\n                    }\n                    // eslint-disable-next-line security/detect-object-injection\n                    pageTextDataCollection[pageIndex] = new PageTextData(new SizeBase(_this.getPageSize(pageIndex).width, _this.getPageSize(pageIndex).height), textDetails.textDataCollection, textDetails.extractedText);\n                    if (isRenderText) {\n                        // eslint-disable-next-line max-len\n                        resolve({ pageTextDataCollection: pageTextDataCollection, textBounds: textData.textBounds, textContent: textData.textContent, rotation: textData.rotation, characterBounds: textData.characterBounds });\n                    }\n                    else {\n                        resolve(pageTextDataCollection);\n                    }\n                }\n                else {\n                    resolve(null);\n                }\n            });\n        });\n    };\n    /**\n     * @private\n     */\n    PdfRenderer.prototype.getDocumentText = function (jsonObject) {\n        var _this = this;\n        var pageStartIndex = !isNullOrUndefined(jsonObject.pageStartIndex) ? jsonObject.pageStartIndex : jsonObject.pageIndex;\n        var pageEndIndex = !isNullOrUndefined(jsonObject.pageEndIndex) ? jsonObject.pageEndIndex : jsonObject.pageIndex + 1;\n        var pageCount = this.loadedDocument.pageCount;\n        var documentTextCollection = [];\n        return new Promise(function (resolve, reject) {\n            for (var pageIndex = pageStartIndex; pageIndex < pageEndIndex; pageIndex++) {\n                _this.extractTextDetailsWithPageSize(pageIndex, true).then(function (value) {\n                    documentTextCollection.push(value.pageTextDataCollection);\n                    if (documentTextCollection.length === pageEndIndex - pageStartIndex) {\n                        resolve({ uniqueId: jsonObject.uniqueId,\n                            documentTextCollection: documentTextCollection,\n                            pageStartIndex: pageStartIndex,\n                            pageEndIndex: pageEndIndex,\n                            textBounds: value.textBounds,\n                            textContent: value.textContent,\n                            rotation: value.rotation,\n                            characterBounds: value.characterBounds });\n                    }\n                });\n            }\n        });\n    };\n    PdfRenderer.IsLinuxOS = false;\n    PdfRenderer.IsWindowsOS = false;\n    return PdfRenderer;\n}());\nexport { PdfRenderer };\nvar TextData = /** @class */ (function () {\n    function TextData(text, bounds) {\n        this.Text = text;\n        this.Bounds = bounds;\n    }\n    return TextData;\n}());\nvar PageTextData = /** @class */ (function () {\n    function PageTextData(pageSize, textData, pageText) {\n        this.PageSize = pageSize;\n        this.TextData = textData;\n        this.PageText = pageText;\n    }\n    return PageTextData;\n}());\n/**\n *\n * @hidden\n */\nvar SizeBase = /** @class */ (function () {\n    function SizeBase(_Width, _Height) {\n        this.IsEmpty = true;\n        this.Width = _Width;\n        this.Height = _Height;\n        this.IsEmpty = false;\n    }\n    return SizeBase;\n}());\nexport { SizeBase };\n/**\n *\n * @hidden\n */\nvar Annotations = /** @class */ (function () {\n    function Annotations() {\n    }\n    return Annotations;\n}());\nexport { Annotations };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}