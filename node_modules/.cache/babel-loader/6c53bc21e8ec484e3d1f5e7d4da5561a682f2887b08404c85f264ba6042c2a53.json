{"ast":null,"code":"import { isNullOrUndefined, extend } from '@syncfusion/ej2-base';\nimport { setStyleAttribute, closest as getClosest, remove } from '@syncfusion/ej2-base';\nimport { classList } from '@syncfusion/ej2-base';\nimport { CellType } from '../base/enum';\nimport { RowRenderer } from './row-renderer';\nimport { Cell } from '../models/cell';\nimport { Row } from '../models/row';\nimport * as events from '../base/constant';\nimport { Draggable, Droppable } from '@syncfusion/ej2-base';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { parentsUntil, wrap, measureColumnDepth, appendChildren, addFixedColumnBorder } from '../base/util';\nimport * as literals from '../base/string-literals';\n// eslint-disable-next-line valid-jsdoc\n/**\n * Content module is used to render grid content\n *\n * @hidden\n */\nvar HeaderRender = /** @class */function () {\n  /**\n   * Constructor for header renderer module\n   *\n   * @param {IGrid} parent - specifies the IGrid\n   * @param {ServiceLocator} serviceLocator - specifies the serviceLocator\n   */\n  function HeaderRender(parent, serviceLocator) {\n    var _this = this;\n    this.frzIdx = 0;\n    this.notfrzIdx = 0;\n    this.isFirstCol = false;\n    this.isReplaceDragEle = true;\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    this.helper = function (e) {\n      var gObj = _this.parent;\n      var target = _this.draggable.currentStateTarget;\n      var parentEle = parentsUntil(target, 'e-headercell');\n      if (!(gObj.allowReordering || gObj.allowGrouping) || !isNullOrUndefined(parentEle) && parentEle.getElementsByClassName('e-checkselectall').length > 0) {\n        return false;\n      }\n      var visualElement = _this.parent.createElement('div', {\n        className: 'e-cloneproperties e-dragclone e-headerclone'\n      });\n      var element = target.classList.contains('e-headercell') ? target : parentEle;\n      if (!element || !gObj.allowReordering && element.classList.contains('e-stackedheadercell')) {\n        return false;\n      }\n      var height = element.offsetHeight;\n      var headercelldiv = element.querySelector('.e-headercelldiv') || element.querySelector('.e-stackedheadercelldiv');\n      var col;\n      if (headercelldiv) {\n        if (element.querySelector('.e-stackedheadercelldiv')) {\n          col = gObj.getStackedHeaderColumnByHeaderText(headercelldiv.innerText.trim(), gObj.columns);\n        } else {\n          col = gObj.getColumnByUid(headercelldiv.getAttribute('e-mappinguid'));\n        }\n        _this.column = col;\n        if (_this.column.lockColumn) {\n          return false;\n        }\n        visualElement.setAttribute('e-mappinguid', _this.column.uid);\n      }\n      if (col && !isNullOrUndefined(col.headerTemplate)) {\n        if (!isNullOrUndefined(col.headerTemplate)) {\n          var colIndex = gObj.getColumnIndexByField(col.field);\n          var result = col.getHeaderTemplate()(extend({\n            'index': colIndex\n          }, col), gObj, 'headerTemplate');\n          var isReactCompiler = gObj.isReact && typeof col.headerTemplate !== 'string';\n          var isReactChild = gObj.parentDetails && gObj.parentDetails.parentInstObj && gObj.parentDetails.parentInstObj.isReact;\n          if (isReactCompiler || isReactChild) {\n            gObj.renderTemplates();\n          }\n          appendChildren(visualElement, result);\n        } else {\n          visualElement.innerHTML = col.headerTemplate;\n        }\n        if (!isNullOrUndefined(visualElement.firstChild) && visualElement.firstChild.nodeType === 1) {\n          visualElement.firstChild.style.pointerEvents = 'none';\n        }\n      } else {\n        visualElement.innerHTML = headercelldiv ? col.headerText : element.firstElementChild.innerHTML;\n      }\n      visualElement.style.width = element.offsetWidth + 'px';\n      visualElement.style.height = element.offsetHeight + 'px';\n      visualElement.style.lineHeight = (height - 6).toString() + 'px';\n      gObj.element.appendChild(visualElement);\n      return visualElement;\n    };\n    this.dragStart = function (e) {\n      var gObj = _this.parent;\n      gObj.element.querySelector('.e-gridpopup').style.display = 'none';\n      gObj.notify(events.columnDragStart, {\n        target: _this.draggable.currentStateTarget,\n        column: _this.column,\n        event: e.event\n      });\n    };\n    this.drag = function (e) {\n      var gObj = _this.parent;\n      var target = e.target;\n      if (target) {\n        var closest = getClosest(target, '.e-grid');\n        var cloneElement = _this.parent.element.querySelector('.e-cloneproperties');\n        if (!closest || closest.getAttribute('id') !== gObj.element.getAttribute('id')) {\n          classList(cloneElement, ['e-notallowedcur'], ['e-defaultcur']);\n          if (gObj.allowReordering) {\n            gObj.element.querySelector('.e-reorderuparrow').style.display = 'none';\n            gObj.element.querySelector('.e-reorderdownarrow').style.display = 'none';\n          }\n          if (!gObj.groupSettings.allowReordering) {\n            return;\n          }\n        }\n        gObj.notify(events.columnDrag, {\n          target: e.target,\n          column: _this.column,\n          event: e.event\n        });\n      }\n    };\n    this.dragStop = function (e) {\n      var gObj = _this.parent;\n      var cancel;\n      gObj.element.querySelector('.e-gridpopup').style.display = 'none';\n      if (!parentsUntil(e.target, 'e-headercell') && !parentsUntil(e.target, 'e-groupdroparea') || !gObj.allowReordering && parentsUntil(e.target, 'e-headercell') || !e.helper.getAttribute('e-mappinguid') && parentsUntil(e.target, 'e-groupdroparea')) {\n        remove(e.helper);\n        cancel = true;\n      }\n      gObj.notify(events.columnDragStop, {\n        target: e.target,\n        event: e.event,\n        column: _this.column,\n        cancel: cancel\n      });\n    };\n    this.drop = function (e) {\n      var gObj = _this.parent;\n      var uid = e.droppedElement.getAttribute('e-mappinguid');\n      var closest = getClosest(e.target, '.e-grid');\n      remove(e.droppedElement);\n      if (closest && closest.getAttribute('id') !== gObj.element.getAttribute('id') || !(gObj.allowReordering || gObj.allowGrouping)) {\n        return;\n      }\n      gObj.notify(events.headerDrop, {\n        target: e.target,\n        uid: uid,\n        droppedElement: e.droppedElement\n      });\n    };\n    this.parent = parent;\n    this.serviceLocator = serviceLocator;\n    this.ariaService = this.serviceLocator.getService('ariaService');\n    this.widthService = this.serviceLocator.getService('widthService');\n    if (this.parent.isDestroyed) {\n      return;\n    }\n    if (!this.parent.enableColumnVirtualization) {\n      this.parent.on(events.columnVisibilityChanged, this.setVisible, this);\n    }\n    this.parent.on(events.columnPositionChanged, this.colPosRefresh, this);\n    this.parent.on(events.initialEnd, this.renderCustomToolbar, this);\n    if (this.parent.rowRenderingMode === 'Vertical') {\n      this.parent.on(events.uiUpdate, this.updateCustomResponsiveToolbar, this);\n    }\n  }\n  /**\n   * The function is used to render grid header div\n   *\n   * @returns {void}\n   */\n  HeaderRender.prototype.renderPanel = function () {\n    var div = this.parent.element.querySelector('.' + literals.gridHeader);\n    var isRendered = div != null;\n    div = isRendered ? div : this.parent.createElement('div', {\n      className: 'e-gridheader'\n    });\n    var innerDiv = isRendered ? div.querySelector('.' + literals.headerContent) : this.parent.createElement('div', {\n      className: literals.headerContent\n    });\n    this.toggleStackClass(div);\n    div.appendChild(innerDiv);\n    this.setPanel(div);\n    if (!isRendered) {\n      this.parent.element.appendChild(div);\n    }\n  };\n  /**\n   * The function is used to render grid header div\n   *\n   * @returns {void}\n   */\n  HeaderRender.prototype.renderTable = function () {\n    var headerDiv = this.getPanel();\n    headerDiv.appendChild(this.createHeaderTable());\n    this.setTable(headerDiv.querySelector('.' + literals.table));\n    this.initializeHeaderDrag();\n    this.initializeHeaderDrop();\n    this.parent.notify(events.headerRefreshed, {\n      rows: this.rows\n    });\n  };\n  /**\n   * Get the header content div element of grid\n   *\n   * @returns {Element} returns the element\n   */\n  HeaderRender.prototype.getPanel = function () {\n    return this.headerPanel;\n  };\n  /**\n   * Set the header content div element of grid\n   *\n   * @param  {Element} panel - specifies the panel element\n   * @returns {void}\n   */\n  HeaderRender.prototype.setPanel = function (panel) {\n    this.headerPanel = panel;\n  };\n  /**\n   * Get the header table element of grid\n   *\n   * @returns {Element} returns the element\n   */\n  HeaderRender.prototype.getTable = function () {\n    return this.headerTable;\n  };\n  /**\n   * Set the header table element of grid\n   *\n   * @param  {Element} table - specifies the table element\n   * @returns {void}\n   */\n  HeaderRender.prototype.setTable = function (table) {\n    this.headerTable = table;\n  };\n  /**\n   * Get the header colgroup element\n   *\n   * @returns {Element} returns the element\n   */\n  HeaderRender.prototype.getColGroup = function () {\n    return this.colgroup;\n  };\n  /**\n   * Set the header colgroup element\n   *\n   * @param {Element} colGroup - specifies the colgroup\n   * @returns {Element} returns the element\n   */\n  HeaderRender.prototype.setColGroup = function (colGroup) {\n    return this.colgroup = colGroup;\n  };\n  /**\n   * Get the header row element collection.\n   *\n   * @returns {Element[]} returns the element\n   */\n  HeaderRender.prototype.getRows = function () {\n    var table = this.getTable();\n    return table.tHead.rows;\n  };\n  /**\n   * The function is used to create header table elements\n   *\n   * @returns {Element} returns the element\n   * @hidden\n   */\n  HeaderRender.prototype.createHeaderTable = function () {\n    var table = this.createTable();\n    var innerDiv = this.getPanel().querySelector('.' + literals.headerContent);\n    innerDiv.appendChild(table);\n    return innerDiv;\n  };\n  /**\n   * The function is used to create header table elements\n   *\n   * @param {Element} tableEle - specifies the table Element\n   * @param {freezeTable} tableName - specifies the table name\n   * @returns {Element} returns the element\n   * @hidden\n   */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  HeaderRender.prototype.createHeader = function (tableEle, tableName) {\n    if (tableEle === void 0) {\n      tableEle = null;\n    }\n    var gObj = this.parent;\n    if (this.getTable()) {\n      remove(this.getTable());\n    }\n    var table = this.parent.createElement('table', {\n      className: literals.table,\n      attrs: {\n        cellspacing: '0.25px',\n        role: 'presentation'\n      }\n    });\n    var findHeaderRow = this.createHeaderContent(tableName);\n    var thead = findHeaderRow.thead;\n    var tbody = this.parent.createElement(literals.tbody, {\n      className: this.parent.frozenRows ? '' : 'e-hide',\n      attrs: {\n        role: 'rowgroup'\n      }\n    });\n    this.caption = this.parent.createElement('caption', {\n      innerHTML: this.parent.element.id + '_header_table',\n      className: 'e-hide'\n    });\n    var colGroup = this.parent.createElement(literals.colGroup);\n    var rowBody = this.parent.createElement('tr', {\n      attrs: {\n        role: 'row'\n      }\n    });\n    var bodyCell;\n    var rows = this.rows = findHeaderRow.rows;\n    for (var i = 0, len = rows.length; i < len; i++) {\n      for (var j = 0, len_1 = rows[parseInt(i.toString(), 10)].cells.length; j < len_1; j++) {\n        bodyCell = this.parent.createElement('td');\n        rowBody.appendChild(bodyCell);\n      }\n    }\n    if (gObj.allowFiltering || gObj.allowSorting || gObj.allowGrouping) {\n      table.classList.add('e-sortfilter');\n    }\n    this.updateColGroup(colGroup);\n    tbody.appendChild(rowBody);\n    table.appendChild(this.setColGroup(colGroup));\n    table.appendChild(thead);\n    table.appendChild(tbody);\n    table.appendChild(this.caption);\n    return table;\n  };\n  /**\n   * @param {Element} tableEle - specifies the column\n   * @returns {Element} returns the element\n   * @hidden\n   */\n  HeaderRender.prototype.createTable = function (tableEle) {\n    if (tableEle === void 0) {\n      tableEle = null;\n    }\n    return this.createHeader(tableEle);\n  };\n  HeaderRender.prototype.createHeaderContent = function (tableName) {\n    var gObj = this.parent;\n    var columns = gObj.getColumns();\n    var thead = this.parent.createElement('thead', {\n      attrs: {\n        'role': 'rowgroup'\n      }\n    });\n    var colHeader = this.parent.createElement('tr', {\n      className: 'e-columnheader',\n      attrs: {\n        role: 'row'\n      }\n    });\n    var rowRenderer = new RowRenderer(this.serviceLocator, CellType.Header, gObj);\n    rowRenderer.element = colHeader;\n    var rows = [];\n    var headerRow;\n    this.colDepth = measureColumnDepth(gObj.columns);\n    for (var i = 0, len = this.colDepth; i < len; i++) {\n      rows[parseInt(i.toString(), 10)] = this.generateRow(i);\n      rows[parseInt(i.toString(), 10)].cells = [];\n    }\n    rows = this.ensureColumns(rows);\n    rows = this.getHeaderCells(rows, tableName);\n    if (gObj.isRowDragable() && this.parent.getFrozenMode() === 'Right') {\n      for (var i = 0, len = rows.length; i < len; i++) {\n        rows[parseInt(i.toString(), 10)].cells.push(this.generateCell({}, CellType.RowDragHIcon));\n      }\n    }\n    for (var i = 0, len = this.colDepth; i < len; i++) {\n      headerRow = rowRenderer.render(rows[parseInt(i.toString(), 10)], columns);\n      if (this.parent.rowHeight && headerRow.querySelector('.e-headercell')) {\n        headerRow.style.height = this.parent.rowHeight + 'px';\n      }\n      addFixedColumnBorder(headerRow);\n      thead.appendChild(headerRow);\n    }\n    var findHeaderRow = {\n      thead: thead,\n      rows: rows\n    };\n    return findHeaderRow;\n  };\n  HeaderRender.prototype.updateColGroup = function (colGroup) {\n    var cols = this.parent.getColumns();\n    var col;\n    var indexes = this.parent.getColumnIndexesInView();\n    colGroup.id = this.parent.element.id + literals.colGroup;\n    if (this.parent.allowGrouping) {\n      for (var i = 0, len = this.parent.groupSettings.columns.length; i < len; i++) {\n        if (this.parent.enableColumnVirtualization && indexes.indexOf(i) === -1) {\n          continue;\n        }\n        col = this.parent.createElement('col', {\n          className: 'e-group-intent'\n        });\n        colGroup.appendChild(col);\n      }\n    }\n    if (this.parent.detailTemplate || this.parent.childGrid) {\n      col = this.parent.createElement('col', {\n        className: 'e-detail-intent'\n      });\n      colGroup.appendChild(col);\n    }\n    if (this.parent.isRowDragable() && this.parent.getFrozenMode() !== 'Right') {\n      col = this.parent.createElement('col', {\n        className: 'e-drag-intent'\n      });\n      colGroup.appendChild(col);\n    }\n    for (var i = 0, len = cols.length; i < len; i++) {\n      col = this.parent.createElement('col');\n      if (cols[parseInt(i.toString(), 10)].visible === false) {\n        setStyleAttribute(col, {\n          'display': 'none'\n        });\n      }\n      colGroup.appendChild(col);\n    }\n    if (this.parent.isRowDragable() && this.parent.getFrozenMode() === 'Right') {\n      col = this.parent.createElement('col', {\n        className: 'e-drag-intent'\n      });\n      colGroup.appendChild(col);\n    }\n    return colGroup;\n  };\n  HeaderRender.prototype.ensureColumns = function (rows) {\n    //TODO: generate dummy column for group, detail, stacked row here; ensureColumns here\n    var gObj = this.parent;\n    var indexes = this.parent.getColumnIndexesInView();\n    for (var i = 0, len = rows.length; i < len; i++) {\n      if (gObj.allowGrouping) {\n        for (var c = 0, len_2 = gObj.groupSettings.columns.length; c < len_2; c++) {\n          if (this.parent.enableColumnVirtualization && indexes.indexOf(c) === -1) {\n            continue;\n          }\n          rows[parseInt(i.toString(), 10)].cells.push(this.generateCell({}, CellType.HeaderIndent));\n        }\n      }\n      if (gObj.detailTemplate || gObj.childGrid) {\n        var args = {};\n        this.parent.notify(events.detailIndentCellInfo, args);\n        rows[parseInt(i.toString(), 10)].cells.push(this.generateCell(args, CellType.DetailHeader));\n      }\n      if (gObj.isRowDragable() && this.parent.getFrozenMode() !== 'Right') {\n        rows[parseInt(i.toString(), 10)].cells.push(this.generateCell({}, CellType.RowDragHIcon));\n      }\n    }\n    return rows;\n  };\n  HeaderRender.prototype.getHeaderCells = function (rows, tableName) {\n    var thead = this.parent.getHeaderTable() && this.parent.getHeaderTable().querySelector('thead');\n    var cols = this.parent.enableColumnVirtualization ? this.parent.getColumns(this.parent.enablePersistence) : this.parent.columns;\n    this.frzIdx = 0;\n    this.notfrzIdx = 0;\n    if (this.parent.lockcolPositionCount) {\n      for (var i = 0; i < cols.length; i++) {\n        this.lockColsRendered = false;\n        rows = this.appendCells(cols[parseInt(i.toString(), 10)], rows, 0, i === 0, false, i === cols.length - 1, thead, tableName, false);\n      }\n    }\n    for (var i = 0, len = cols.length; i < len; i++) {\n      this.notfrzIdx = 0;\n      this.lockColsRendered = true;\n      rows = this.appendCells(cols[parseInt(i.toString(), 10)], rows, 0, i === 0, false, i === len - 1, thead, tableName, false);\n    }\n    return rows;\n  };\n  HeaderRender.prototype.appendCells = function (cols, rows, index, isFirstObj, isFirstCol, isLastCol, isMovable, tableName, isStackLastCol) {\n    var lastCol = isLastCol ? isStackLastCol ? 'e-laststackcell' : 'e-lastcell' : '';\n    var isLockColumn = !this.parent.lockcolPositionCount || cols.lockColumn && !this.lockColsRendered || !cols.lockColumn && this.lockColsRendered;\n    if (!cols.columns) {\n      if (isLockColumn) {\n        rows[parseInt(index.toString(), 10)].cells.push(this.generateCell(cols, CellType.Header, this.colDepth - index, (isFirstObj ? '' : isFirstCol ? 'e-firstcell' : '') + lastCol, index, this.parent.getColumnIndexByUid(cols.uid)));\n      }\n      if (this.parent.lockcolPositionCount) {\n        if (this.frzIdx + this.notfrzIdx < this.parent.frozenColumns && (cols.lockColumn && !this.lockColsRendered || !cols.lockColumn && this.lockColsRendered)) {\n          this.frzIdx++;\n        } else {\n          this.notfrzIdx++;\n        }\n      } else {\n        this.frzIdx++;\n      }\n    } else {\n      this.isFirstCol = false;\n      var colSpan = this.getCellCnt(cols, 0);\n      if (colSpan) {\n        var stackedLockColsCount = this.getStackedLockColsCount(cols, 0);\n        var isStackedLockColumn = this.parent.lockcolPositionCount === 0 || !this.lockColsRendered && stackedLockColsCount !== 0 || this.lockColsRendered && colSpan - stackedLockColsCount !== 0;\n        if (isStackedLockColumn) {\n          rows[parseInt(index.toString(), 10)].cells.push(new Cell({\n            cellType: CellType.StackedHeader,\n            column: cols,\n            colSpan: this.getColSpan(colSpan, stackedLockColsCount),\n            className: isFirstObj ? '' : isFirstCol ? 'e-firstcell' : ''\n          }));\n        }\n      }\n      if (this.parent.lockcolPositionCount && !this.lockColsRendered) {\n        for (var i = 0; i < cols.columns.length; i++) {\n          rows = this.appendCells(cols.columns[parseInt(i.toString(), 10)], rows, index + 1, isFirstObj, i === 0, i === cols.columns.length - 1 && isLastCol, isMovable, tableName, false);\n        }\n      }\n      if (this.lockColsRendered) {\n        for (var i = 0, len = cols.columns.length; i < len; i++) {\n          isFirstObj = isFirstObj && i === 0;\n          var isFirstCol_1 = this.isFirstCol = cols.columns[parseInt(i.toString(), 10)].visible && !isFirstObj;\n          var isLaststackedCol = i === len - 1 && isLastCol;\n          rows = this.appendCells(cols.columns[parseInt(i.toString(), 10)], rows, index + 1, isFirstObj, isFirstCol_1 && !isLaststackedCol, isLaststackedCol, isMovable, tableName, true);\n        }\n      }\n    }\n    return rows;\n  };\n  HeaderRender.prototype.getStackedLockColsCount = function (col, lockColsCount) {\n    if (col.columns) {\n      for (var i = 0; i < col.columns.length; i++) {\n        lockColsCount = this.getStackedLockColsCount(col.columns[parseInt(i.toString(), 10)], lockColsCount);\n      }\n    } else if (col.lockColumn) {\n      lockColsCount++;\n    }\n    return lockColsCount;\n  };\n  HeaderRender.prototype.getColSpan = function (colSpan, stackedLockColsCount) {\n    colSpan = !this.lockColsRendered ? stackedLockColsCount : colSpan - stackedLockColsCount;\n    return colSpan;\n  };\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  HeaderRender.prototype.generateRow = function (index) {\n    return new Row({});\n  };\n  HeaderRender.prototype.generateCell = function (column, cellType, rowSpan, className, rowIndex, colIndex) {\n    var opt = {\n      'visible': column.visible,\n      'isDataCell': false,\n      'isTemplate': !isNullOrUndefined(column.headerTemplate),\n      'rowID': '',\n      'column': column,\n      'cellType': cellType,\n      'rowSpan': rowSpan,\n      'className': className,\n      'index': rowIndex,\n      'colIndex': colIndex\n    };\n    if (!opt.rowSpan || opt.rowSpan < 2) {\n      delete opt.rowSpan;\n    }\n    return new Cell(opt);\n  };\n  /**\n   * Function to hide header table column based on visible property\n   *\n   * @param {Column[]} columns - specifies the column\n   * @returns {void}\n   */\n  HeaderRender.prototype.setVisible = function (columns) {\n    var gObj = this.parent;\n    var displayVal;\n    var idx;\n    for (var c = 0, clen = columns.length; c < clen; c++) {\n      var column = columns[parseInt(c.toString(), 10)];\n      idx = gObj.getNormalizedColumnIndex(column.uid);\n      displayVal = column.visible ? '' : 'none';\n      setStyleAttribute(this.getColGroup().children[parseInt(idx.toString(), 10)], {\n        'display': displayVal\n      });\n    }\n    this.refreshUI();\n  };\n  HeaderRender.prototype.colPosRefresh = function () {\n    this.refreshUI();\n  };\n  /**\n   * Refresh the header of the Grid.\n   *\n   * @returns {void}\n   */\n  HeaderRender.prototype.refreshUI = function () {\n    var headerDiv = this.getPanel();\n    this.toggleStackClass(headerDiv);\n    var table = this.freezeReorder ? this.headerPanel.querySelector('.' + literals.movableHeader).querySelector('.' + literals.table) : this.getTable();\n    var tableName = undefined;\n    if (table) {\n      remove(table);\n      table.removeChild(table.firstChild);\n      table.removeChild(table.childNodes[0]);\n      var colGroup = this.parent.createElement(literals.colGroup);\n      var findHeaderRow = this.createHeaderContent(tableName);\n      this.rows = findHeaderRow.rows;\n      table.insertBefore(findHeaderRow.thead, table.firstChild);\n      this.updateColGroup(colGroup);\n      table.insertBefore(this.setColGroup(colGroup), table.firstChild);\n      this.appendContent(table);\n      this.parent.notify(events.colGroupRefresh, {});\n      this.widthService.setWidthToColumns();\n      this.parent.updateDefaultCursor();\n      this.initializeHeaderDrag();\n      var rows = [].slice.call(headerDiv.querySelectorAll('tr.e-columnheader'));\n      for (var _i = 0, rows_1 = rows; _i < rows_1.length; _i++) {\n        var row = rows_1[_i];\n        var gCells = [].slice.call(row.getElementsByClassName('e-grouptopleftcell'));\n        if (gCells.length) {\n          gCells[gCells.length - 1].classList.add('e-lastgrouptopleftcell');\n        }\n      }\n      this.parent.notify(events.headerRefreshed, {\n        rows: this.rows\n      });\n      if (this.parent.enableColumnVirtualization && parentsUntil(table, literals.movableHeader)) {\n        this.parent.notify(events.headerRefreshed, {\n          rows: this.rows,\n          args: {\n            isFrozen: false,\n            isXaxis: true\n          }\n        });\n      }\n      if (this.parent.allowTextWrap && this.parent.textWrapSettings.wrapMode === 'Header') {\n        wrap(rows, true);\n      }\n    }\n    var firstHeaderCell = this.parent.getHeaderContent().querySelector('.e-headercell:not(.e-hide)');\n    if (!isNullOrUndefined(firstHeaderCell)) {\n      firstHeaderCell.tabIndex = 0;\n    }\n  };\n  HeaderRender.prototype.toggleStackClass = function (div) {\n    var column = this.parent.columns;\n    var stackedHdr = column.some(function (column) {\n      return !isNullOrUndefined(column.columns);\n    });\n    if (stackedHdr) {\n      div.classList.add('e-stackedheader');\n    } else {\n      div.classList.remove('e-stackedheader');\n    }\n  };\n  HeaderRender.prototype.appendContent = function (table) {\n    this.getPanel().querySelector('.' + literals.headerContent).appendChild(table);\n  };\n  HeaderRender.prototype.getCellCnt = function (col, cnt) {\n    if (col.columns) {\n      for (var i = 0, len = col.columns.length; i < len; i++) {\n        cnt = this.getCellCnt(col.columns[parseInt(i.toString(), 10)], cnt);\n      }\n    } else {\n      if (col.visible) {\n        cnt++;\n      }\n    }\n    return cnt;\n  };\n  HeaderRender.prototype.initializeHeaderDrag = function () {\n    var gObj = this.parent;\n    if (!(this.parent.allowReordering || this.parent.allowGrouping && this.parent.groupSettings.showDropArea)) {\n      return;\n    }\n    this.draggable = new Draggable(gObj.getHeaderContent(), {\n      dragTarget: '.e-headercell',\n      distance: 5,\n      helper: this.helper,\n      dragStart: this.dragStart,\n      drag: this.drag,\n      dragStop: this.dragStop,\n      abort: '.e-rhandler',\n      isReplaceDragEle: this.isReplaceDragEle\n    });\n    this.parent.on(events.destroy, this.droppableDestroy, this);\n  };\n  HeaderRender.prototype.initializeHeaderDrop = function () {\n    var gObj = this.parent;\n    this.droppable = new Droppable(gObj.getHeaderContent(), {\n      accept: '.e-dragclone',\n      drop: this.drop\n    });\n    this.parent.on(events.destroy, this.droppableDestroy, this);\n  };\n  HeaderRender.prototype.droppableDestroy = function () {\n    if (this.droppable && !this.droppable.isDestroyed) {\n      this.droppable.destroy();\n    }\n    if (this.draggable && !this.draggable.isDestroyed) {\n      this.draggable.destroy();\n    }\n  };\n  HeaderRender.prototype.renderCustomToolbar = function () {\n    var _this = this;\n    var gObj = this.parent;\n    if (gObj.rowRenderingMode === 'Vertical' && !gObj.toolbar && (gObj.allowSorting || gObj.allowFiltering && gObj.filterSettings.type !== 'FilterBar')) {\n      var div = gObj.createElement('div', {\n        className: 'e-res-toolbar e-toolbar'\n      });\n      var toolbarItems = gObj.createElement('div', {\n        className: 'e-toolbar-items'\n      });\n      var toolbarLeft = gObj.createElement('div', {\n        className: 'e-toolbar-left'\n      });\n      var count = this.parent.allowFiltering && this.parent.allowSorting ? 2 : 1;\n      for (var i = 0; i < count; i++) {\n        var toolbarItem = gObj.createElement('div', {\n          className: 'e-toolbar-item e-gridresponsiveicons e-icons e-tbtn-align'\n        });\n        var cls = count === 1 ? this.parent.allowSorting ? 'sort' : 'filter' : i === 1 ? 'sort' : 'filter';\n        var button = gObj.createElement('button', {\n          className: 'e-tbar-btn e-control e-btn e-lib e-icon-btn'\n        });\n        var span = gObj.createElement('span', {\n          className: 'e-btn-icon e-res' + cls + '-icon e-icons'\n        });\n        button.appendChild(span);\n        var btnObj = new Button({\n          cssClass: this.parent.cssClass ? this.parent.cssClass : ''\n        });\n        btnObj.appendTo(button);\n        button.onclick = function (e) {\n          if (e.target.classList.contains('e-ressort-btn') || e.target.classList.contains('e-ressort-icon')) {\n            _this.parent.showResponsiveCustomSort();\n          } else {\n            _this.parent.showResponsiveCustomFilter();\n          }\n        };\n        toolbarItem.appendChild(button);\n        toolbarLeft.appendChild(toolbarItem);\n      }\n      toolbarItems.appendChild(toolbarLeft);\n      div.appendChild(toolbarItems);\n      gObj.element.insertBefore(div, this.parent.element.querySelector('.' + literals.gridHeader));\n    } else {\n      if (gObj.enableAdaptiveUI && !gObj.toolbar) {\n        gObj.getContent().classList.add('e-responsive-header');\n      }\n    }\n  };\n  HeaderRender.prototype.updateCustomResponsiveToolbar = function (args) {\n    var resToolbar = this.parent.element.querySelector('.e-responsive-toolbar');\n    if (args.module === 'toolbar') {\n      if (resToolbar) {\n        remove(resToolbar);\n      } else {\n        this.renderCustomToolbar();\n      }\n    }\n  };\n  return HeaderRender;\n}();\nexport { HeaderRender };","map":{"version":3,"names":["isNullOrUndefined","extend","setStyleAttribute","closest","getClosest","remove","classList","CellType","RowRenderer","Cell","Row","events","Draggable","Droppable","Button","parentsUntil","wrap","measureColumnDepth","appendChildren","addFixedColumnBorder","literals","HeaderRender","parent","serviceLocator","_this","frzIdx","notfrzIdx","isFirstCol","isReplaceDragEle","helper","e","gObj","target","draggable","currentStateTarget","parentEle","allowReordering","allowGrouping","getElementsByClassName","length","visualElement","createElement","className","element","contains","height","offsetHeight","headercelldiv","querySelector","col","getStackedHeaderColumnByHeaderText","innerText","trim","columns","getColumnByUid","getAttribute","column","lockColumn","setAttribute","uid","headerTemplate","colIndex","getColumnIndexByField","field","result","getHeaderTemplate","isReactCompiler","isReact","isReactChild","parentDetails","parentInstObj","renderTemplates","innerHTML","firstChild","nodeType","style","pointerEvents","headerText","firstElementChild","width","offsetWidth","lineHeight","toString","appendChild","dragStart","display","notify","columnDragStart","event","drag","cloneElement","groupSettings","columnDrag","dragStop","cancel","columnDragStop","drop","droppedElement","headerDrop","ariaService","getService","widthService","isDestroyed","enableColumnVirtualization","on","columnVisibilityChanged","setVisible","columnPositionChanged","colPosRefresh","initialEnd","renderCustomToolbar","rowRenderingMode","uiUpdate","updateCustomResponsiveToolbar","prototype","renderPanel","div","gridHeader","isRendered","innerDiv","headerContent","toggleStackClass","setPanel","renderTable","headerDiv","getPanel","createHeaderTable","setTable","table","initializeHeaderDrag","initializeHeaderDrop","headerRefreshed","rows","headerPanel","panel","getTable","headerTable","getColGroup","colgroup","setColGroup","colGroup","getRows","tHead","createTable","createHeader","tableEle","tableName","attrs","cellspacing","role","findHeaderRow","createHeaderContent","thead","tbody","frozenRows","caption","id","rowBody","bodyCell","i","len","j","len_1","parseInt","cells","allowFiltering","allowSorting","add","updateColGroup","getColumns","colHeader","rowRenderer","Header","headerRow","colDepth","generateRow","ensureColumns","getHeaderCells","isRowDragable","getFrozenMode","push","generateCell","RowDragHIcon","render","rowHeight","cols","indexes","getColumnIndexesInView","indexOf","detailTemplate","childGrid","visible","c","len_2","HeaderIndent","args","detailIndentCellInfo","DetailHeader","getHeaderTable","enablePersistence","lockcolPositionCount","lockColsRendered","appendCells","index","isFirstObj","isLastCol","isMovable","isStackLastCol","lastCol","isLockColumn","getColumnIndexByUid","frozenColumns","colSpan","getCellCnt","stackedLockColsCount","getStackedLockColsCount","isStackedLockColumn","cellType","StackedHeader","getColSpan","isFirstCol_1","isLaststackedCol","lockColsCount","rowSpan","rowIndex","opt","displayVal","idx","clen","getNormalizedColumnIndex","children","refreshUI","freezeReorder","movableHeader","undefined","removeChild","childNodes","insertBefore","appendContent","colGroupRefresh","setWidthToColumns","updateDefaultCursor","slice","call","querySelectorAll","_i","rows_1","row","gCells","isFrozen","isXaxis","allowTextWrap","textWrapSettings","wrapMode","firstHeaderCell","getHeaderContent","tabIndex","stackedHdr","some","cnt","showDropArea","dragTarget","distance","abort","destroy","droppableDestroy","droppable","accept","toolbar","filterSettings","type","toolbarItems","toolbarLeft","count","toolbarItem","cls","button","span","btnObj","cssClass","appendTo","onclick","showResponsiveCustomSort","showResponsiveCustomFilter","enableAdaptiveUI","getContent","resToolbar","module"],"sources":["/Users/saleem/Desktop/KClient/Web App/Ver_3.6/User Interface/website_Source files/node_modules/@syncfusion/ej2-grids/src/grid/renderer/header-renderer.js"],"sourcesContent":["import { isNullOrUndefined, extend } from '@syncfusion/ej2-base';\nimport { setStyleAttribute, closest as getClosest, remove } from '@syncfusion/ej2-base';\nimport { classList } from '@syncfusion/ej2-base';\nimport { CellType } from '../base/enum';\nimport { RowRenderer } from './row-renderer';\nimport { Cell } from '../models/cell';\nimport { Row } from '../models/row';\nimport * as events from '../base/constant';\nimport { Draggable, Droppable } from '@syncfusion/ej2-base';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { parentsUntil, wrap, measureColumnDepth, appendChildren, addFixedColumnBorder } from '../base/util';\nimport * as literals from '../base/string-literals';\n// eslint-disable-next-line valid-jsdoc\n/**\n * Content module is used to render grid content\n *\n * @hidden\n */\nvar HeaderRender = /** @class */ (function () {\n    /**\n     * Constructor for header renderer module\n     *\n     * @param {IGrid} parent - specifies the IGrid\n     * @param {ServiceLocator} serviceLocator - specifies the serviceLocator\n     */\n    function HeaderRender(parent, serviceLocator) {\n        var _this = this;\n        this.frzIdx = 0;\n        this.notfrzIdx = 0;\n        this.isFirstCol = false;\n        this.isReplaceDragEle = true;\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        this.helper = function (e) {\n            var gObj = _this.parent;\n            var target = _this.draggable.currentStateTarget;\n            var parentEle = parentsUntil(target, 'e-headercell');\n            if (!(gObj.allowReordering || gObj.allowGrouping) || (!isNullOrUndefined(parentEle)\n                && parentEle.getElementsByClassName('e-checkselectall').length > 0)) {\n                return false;\n            }\n            var visualElement = _this.parent.createElement('div', { className: 'e-cloneproperties e-dragclone e-headerclone' });\n            var element = target.classList.contains('e-headercell') ? target : parentEle;\n            if (!element || (!gObj.allowReordering && element.classList.contains('e-stackedheadercell'))) {\n                return false;\n            }\n            var height = element.offsetHeight;\n            var headercelldiv = element.querySelector('.e-headercelldiv') || element.querySelector('.e-stackedheadercelldiv');\n            var col;\n            if (headercelldiv) {\n                if (element.querySelector('.e-stackedheadercelldiv')) {\n                    col = gObj.getStackedHeaderColumnByHeaderText(headercelldiv.innerText.trim(), gObj.columns);\n                }\n                else {\n                    col = gObj.getColumnByUid(headercelldiv.getAttribute('e-mappinguid'));\n                }\n                _this.column = col;\n                if (_this.column.lockColumn) {\n                    return false;\n                }\n                visualElement.setAttribute('e-mappinguid', _this.column.uid);\n            }\n            if (col && !isNullOrUndefined(col.headerTemplate)) {\n                if (!isNullOrUndefined(col.headerTemplate)) {\n                    var colIndex = gObj.getColumnIndexByField(col.field);\n                    var result = col.getHeaderTemplate()(extend({ 'index': colIndex }, col), gObj, 'headerTemplate');\n                    var isReactCompiler = gObj.isReact && typeof (col.headerTemplate) !== 'string';\n                    var isReactChild = gObj.parentDetails && gObj.parentDetails.parentInstObj &&\n                        gObj.parentDetails.parentInstObj.isReact;\n                    if (isReactCompiler || isReactChild) {\n                        gObj.renderTemplates();\n                    }\n                    appendChildren(visualElement, result);\n                }\n                else {\n                    visualElement.innerHTML = col.headerTemplate;\n                }\n                if (!isNullOrUndefined(visualElement.firstChild) && visualElement.firstChild.nodeType === 1) {\n                    visualElement.firstChild.style.pointerEvents = 'none';\n                }\n            }\n            else {\n                visualElement.innerHTML = headercelldiv ?\n                    col.headerText : element.firstElementChild.innerHTML;\n            }\n            visualElement.style.width = element.offsetWidth + 'px';\n            visualElement.style.height = element.offsetHeight + 'px';\n            visualElement.style.lineHeight = (height - 6).toString() + 'px';\n            gObj.element.appendChild(visualElement);\n            return visualElement;\n        };\n        this.dragStart = function (e) {\n            var gObj = _this.parent;\n            gObj.element.querySelector('.e-gridpopup').style.display = 'none';\n            gObj.notify(events.columnDragStart, { target: _this.draggable.currentStateTarget, column: _this.column, event: e.event });\n        };\n        this.drag = function (e) {\n            var gObj = _this.parent;\n            var target = e.target;\n            if (target) {\n                var closest = getClosest(target, '.e-grid');\n                var cloneElement = _this.parent.element.querySelector('.e-cloneproperties');\n                if (!closest || closest.getAttribute('id') !== gObj.element.getAttribute('id')) {\n                    classList(cloneElement, ['e-notallowedcur'], ['e-defaultcur']);\n                    if (gObj.allowReordering) {\n                        gObj.element.querySelector('.e-reorderuparrow').style.display = 'none';\n                        gObj.element.querySelector('.e-reorderdownarrow').style.display = 'none';\n                    }\n                    if (!gObj.groupSettings.allowReordering) {\n                        return;\n                    }\n                }\n                gObj.notify(events.columnDrag, { target: e.target, column: _this.column, event: e.event });\n            }\n        };\n        this.dragStop = function (e) {\n            var gObj = _this.parent;\n            var cancel;\n            gObj.element.querySelector('.e-gridpopup').style.display = 'none';\n            if ((!parentsUntil(e.target, 'e-headercell') && !parentsUntil(e.target, 'e-groupdroparea')) ||\n                (!gObj.allowReordering && parentsUntil(e.target, 'e-headercell')) ||\n                (!e.helper.getAttribute('e-mappinguid') && parentsUntil(e.target, 'e-groupdroparea'))) {\n                remove(e.helper);\n                cancel = true;\n            }\n            gObj.notify(events.columnDragStop, { target: e.target, event: e.event, column: _this.column, cancel: cancel });\n        };\n        this.drop = function (e) {\n            var gObj = _this.parent;\n            var uid = e.droppedElement.getAttribute('e-mappinguid');\n            var closest = getClosest(e.target, '.e-grid');\n            remove(e.droppedElement);\n            if (closest && closest.getAttribute('id') !== gObj.element.getAttribute('id') ||\n                !(gObj.allowReordering || gObj.allowGrouping)) {\n                return;\n            }\n            gObj.notify(events.headerDrop, { target: e.target, uid: uid, droppedElement: e.droppedElement });\n        };\n        this.parent = parent;\n        this.serviceLocator = serviceLocator;\n        this.ariaService = this.serviceLocator.getService('ariaService');\n        this.widthService = this.serviceLocator.getService('widthService');\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        if (!this.parent.enableColumnVirtualization) {\n            this.parent.on(events.columnVisibilityChanged, this.setVisible, this);\n        }\n        this.parent.on(events.columnPositionChanged, this.colPosRefresh, this);\n        this.parent.on(events.initialEnd, this.renderCustomToolbar, this);\n        if (this.parent.rowRenderingMode === 'Vertical') {\n            this.parent.on(events.uiUpdate, this.updateCustomResponsiveToolbar, this);\n        }\n    }\n    /**\n     * The function is used to render grid header div\n     *\n     * @returns {void}\n     */\n    HeaderRender.prototype.renderPanel = function () {\n        var div = this.parent.element.querySelector('.' + literals.gridHeader);\n        var isRendered = (div != null);\n        div = isRendered ? div : this.parent.createElement('div', { className: 'e-gridheader' });\n        var innerDiv = isRendered ? div.querySelector('.' + literals.headerContent) :\n            this.parent.createElement('div', { className: literals.headerContent });\n        this.toggleStackClass(div);\n        div.appendChild(innerDiv);\n        this.setPanel(div);\n        if (!isRendered) {\n            this.parent.element.appendChild(div);\n        }\n    };\n    /**\n     * The function is used to render grid header div\n     *\n     * @returns {void}\n     */\n    HeaderRender.prototype.renderTable = function () {\n        var headerDiv = this.getPanel();\n        headerDiv.appendChild(this.createHeaderTable());\n        this.setTable(headerDiv.querySelector('.' + literals.table));\n        this.initializeHeaderDrag();\n        this.initializeHeaderDrop();\n        this.parent.notify(events.headerRefreshed, { rows: this.rows });\n    };\n    /**\n     * Get the header content div element of grid\n     *\n     * @returns {Element} returns the element\n     */\n    HeaderRender.prototype.getPanel = function () {\n        return this.headerPanel;\n    };\n    /**\n     * Set the header content div element of grid\n     *\n     * @param  {Element} panel - specifies the panel element\n     * @returns {void}\n     */\n    HeaderRender.prototype.setPanel = function (panel) {\n        this.headerPanel = panel;\n    };\n    /**\n     * Get the header table element of grid\n     *\n     * @returns {Element} returns the element\n     */\n    HeaderRender.prototype.getTable = function () {\n        return this.headerTable;\n    };\n    /**\n     * Set the header table element of grid\n     *\n     * @param  {Element} table - specifies the table element\n     * @returns {void}\n     */\n    HeaderRender.prototype.setTable = function (table) {\n        this.headerTable = table;\n    };\n    /**\n     * Get the header colgroup element\n     *\n     * @returns {Element} returns the element\n     */\n    HeaderRender.prototype.getColGroup = function () {\n        return this.colgroup;\n    };\n    /**\n     * Set the header colgroup element\n     *\n     * @param {Element} colGroup - specifies the colgroup\n     * @returns {Element} returns the element\n     */\n    HeaderRender.prototype.setColGroup = function (colGroup) {\n        return this.colgroup = colGroup;\n    };\n    /**\n     * Get the header row element collection.\n     *\n     * @returns {Element[]} returns the element\n     */\n    HeaderRender.prototype.getRows = function () {\n        var table = this.getTable();\n        return table.tHead.rows;\n    };\n    /**\n     * The function is used to create header table elements\n     *\n     * @returns {Element} returns the element\n     * @hidden\n     */\n    HeaderRender.prototype.createHeaderTable = function () {\n        var table = this.createTable();\n        var innerDiv = this.getPanel().querySelector('.' + literals.headerContent);\n        innerDiv.appendChild(table);\n        return innerDiv;\n    };\n    /**\n     * The function is used to create header table elements\n     *\n     * @param {Element} tableEle - specifies the table Element\n     * @param {freezeTable} tableName - specifies the table name\n     * @returns {Element} returns the element\n     * @hidden\n     */\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    HeaderRender.prototype.createHeader = function (tableEle, tableName) {\n        if (tableEle === void 0) { tableEle = null; }\n        var gObj = this.parent;\n        if (this.getTable()) {\n            remove(this.getTable());\n        }\n        var table = this.parent.createElement('table', { className: literals.table, attrs: { cellspacing: '0.25px', role: 'presentation' } });\n        var findHeaderRow = this.createHeaderContent(tableName);\n        var thead = findHeaderRow.thead;\n        var tbody = this.parent.createElement(literals.tbody, { className: this.parent.frozenRows ? '' : 'e-hide', attrs: { role: 'rowgroup' } });\n        this.caption = this.parent.createElement('caption', { innerHTML: this.parent.element.id + '_header_table', className: 'e-hide' });\n        var colGroup = this.parent.createElement(literals.colGroup);\n        var rowBody = this.parent.createElement('tr', { attrs: { role: 'row' } });\n        var bodyCell;\n        var rows = this.rows = findHeaderRow.rows;\n        for (var i = 0, len = rows.length; i < len; i++) {\n            for (var j = 0, len_1 = rows[parseInt(i.toString(), 10)].cells.length; j < len_1; j++) {\n                bodyCell = this.parent.createElement('td');\n                rowBody.appendChild(bodyCell);\n            }\n        }\n        if (gObj.allowFiltering || gObj.allowSorting || gObj.allowGrouping) {\n            table.classList.add('e-sortfilter');\n        }\n        this.updateColGroup(colGroup);\n        tbody.appendChild(rowBody);\n        table.appendChild(this.setColGroup(colGroup));\n        table.appendChild(thead);\n        table.appendChild(tbody);\n        table.appendChild(this.caption);\n        return table;\n    };\n    /**\n     * @param {Element} tableEle - specifies the column\n     * @returns {Element} returns the element\n     * @hidden\n     */\n    HeaderRender.prototype.createTable = function (tableEle) {\n        if (tableEle === void 0) { tableEle = null; }\n        return this.createHeader(tableEle);\n    };\n    HeaderRender.prototype.createHeaderContent = function (tableName) {\n        var gObj = this.parent;\n        var columns = gObj.getColumns();\n        var thead = this.parent.createElement('thead', { attrs: { 'role': 'rowgroup' } });\n        var colHeader = this.parent.createElement('tr', { className: 'e-columnheader', attrs: { role: 'row' } });\n        var rowRenderer = new RowRenderer(this.serviceLocator, CellType.Header, gObj);\n        rowRenderer.element = colHeader;\n        var rows = [];\n        var headerRow;\n        this.colDepth = measureColumnDepth(gObj.columns);\n        for (var i = 0, len = this.colDepth; i < len; i++) {\n            rows[parseInt(i.toString(), 10)] = this.generateRow(i);\n            rows[parseInt(i.toString(), 10)].cells = [];\n        }\n        rows = this.ensureColumns(rows);\n        rows = this.getHeaderCells(rows, tableName);\n        if (gObj.isRowDragable() && this.parent.getFrozenMode() === 'Right') {\n            for (var i = 0, len = rows.length; i < len; i++) {\n                rows[parseInt(i.toString(), 10)].cells.push(this.generateCell({}, CellType.RowDragHIcon));\n            }\n        }\n        for (var i = 0, len = this.colDepth; i < len; i++) {\n            headerRow = rowRenderer.render(rows[parseInt(i.toString(), 10)], columns);\n            if (this.parent.rowHeight && headerRow.querySelector('.e-headercell')) {\n                headerRow.style.height = this.parent.rowHeight + 'px';\n            }\n            addFixedColumnBorder(headerRow);\n            thead.appendChild(headerRow);\n        }\n        var findHeaderRow = {\n            thead: thead,\n            rows: rows\n        };\n        return findHeaderRow;\n    };\n    HeaderRender.prototype.updateColGroup = function (colGroup) {\n        var cols = this.parent.getColumns();\n        var col;\n        var indexes = this.parent.getColumnIndexesInView();\n        colGroup.id = this.parent.element.id + literals.colGroup;\n        if (this.parent.allowGrouping) {\n            for (var i = 0, len = this.parent.groupSettings.columns.length; i < len; i++) {\n                if (this.parent.enableColumnVirtualization && indexes.indexOf(i) === -1) {\n                    continue;\n                }\n                col = this.parent.createElement('col', { className: 'e-group-intent' });\n                colGroup.appendChild(col);\n            }\n        }\n        if (this.parent.detailTemplate || this.parent.childGrid) {\n            col = this.parent.createElement('col', { className: 'e-detail-intent' });\n            colGroup.appendChild(col);\n        }\n        if (this.parent.isRowDragable() && this.parent.getFrozenMode() !== 'Right') {\n            col = this.parent.createElement('col', { className: 'e-drag-intent' });\n            colGroup.appendChild(col);\n        }\n        for (var i = 0, len = cols.length; i < len; i++) {\n            col = this.parent.createElement('col');\n            if (cols[parseInt(i.toString(), 10)].visible === false) {\n                setStyleAttribute(col, { 'display': 'none' });\n            }\n            colGroup.appendChild(col);\n        }\n        if (this.parent.isRowDragable() && this.parent.getFrozenMode() === 'Right') {\n            col = this.parent.createElement('col', { className: 'e-drag-intent' });\n            colGroup.appendChild(col);\n        }\n        return colGroup;\n    };\n    HeaderRender.prototype.ensureColumns = function (rows) {\n        //TODO: generate dummy column for group, detail, stacked row here; ensureColumns here\n        var gObj = this.parent;\n        var indexes = this.parent.getColumnIndexesInView();\n        for (var i = 0, len = rows.length; i < len; i++) {\n            if (gObj.allowGrouping) {\n                for (var c = 0, len_2 = gObj.groupSettings.columns.length; c < len_2; c++) {\n                    if (this.parent.enableColumnVirtualization && indexes.indexOf(c) === -1) {\n                        continue;\n                    }\n                    rows[parseInt(i.toString(), 10)].cells.push(this.generateCell({}, CellType.HeaderIndent));\n                }\n            }\n            if (gObj.detailTemplate || gObj.childGrid) {\n                var args = {};\n                this.parent.notify(events.detailIndentCellInfo, args);\n                rows[parseInt(i.toString(), 10)].cells.push(this.generateCell(args, CellType.DetailHeader));\n            }\n            if (gObj.isRowDragable() && this.parent.getFrozenMode() !== 'Right') {\n                rows[parseInt(i.toString(), 10)].cells.push(this.generateCell({}, CellType.RowDragHIcon));\n            }\n        }\n        return rows;\n    };\n    HeaderRender.prototype.getHeaderCells = function (rows, tableName) {\n        var thead = this.parent.getHeaderTable() && this.parent.getHeaderTable().querySelector('thead');\n        var cols = this.parent.enableColumnVirtualization ?\n            this.parent.getColumns(this.parent.enablePersistence) : this.parent.columns;\n        this.frzIdx = 0;\n        this.notfrzIdx = 0;\n        if (this.parent.lockcolPositionCount) {\n            for (var i = 0; i < cols.length; i++) {\n                this.lockColsRendered = false;\n                rows = this.appendCells(cols[parseInt(i.toString(), 10)], rows, 0, i === 0, false, i === (cols.length - 1), thead, tableName, false);\n            }\n        }\n        for (var i = 0, len = cols.length; i < len; i++) {\n            this.notfrzIdx = 0;\n            this.lockColsRendered = true;\n            rows = this.appendCells(cols[parseInt(i.toString(), 10)], rows, 0, i === 0, false, i === (len - 1), thead, tableName, false);\n        }\n        return rows;\n    };\n    HeaderRender.prototype.appendCells = function (cols, rows, index, isFirstObj, isFirstCol, isLastCol, isMovable, tableName, isStackLastCol) {\n        var lastCol = isLastCol ? isStackLastCol ? 'e-laststackcell' : 'e-lastcell' : '';\n        var isLockColumn = !this.parent.lockcolPositionCount\n            || (cols.lockColumn && !this.lockColsRendered) || (!cols.lockColumn && this.lockColsRendered);\n        if (!cols.columns) {\n            if (isLockColumn) {\n                rows[parseInt(index.toString(), 10)].cells.push(this.generateCell(cols, CellType.Header, this.colDepth - index, (isFirstObj ? '' : (isFirstCol ? 'e-firstcell' : '')) + lastCol, index, this.parent.getColumnIndexByUid(cols.uid)));\n            }\n            if (this.parent.lockcolPositionCount) {\n                if ((this.frzIdx + this.notfrzIdx < this.parent.frozenColumns) &&\n                    ((cols.lockColumn && !this.lockColsRendered) || (!cols.lockColumn && this.lockColsRendered))) {\n                    this.frzIdx++;\n                }\n                else {\n                    this.notfrzIdx++;\n                }\n            }\n            else {\n                this.frzIdx++;\n            }\n        }\n        else {\n            this.isFirstCol = false;\n            var colSpan = this.getCellCnt(cols, 0);\n            if (colSpan) {\n                var stackedLockColsCount = this.getStackedLockColsCount(cols, 0);\n                var isStackedLockColumn = this.parent.lockcolPositionCount === 0\n                    || (!this.lockColsRendered && stackedLockColsCount !== 0)\n                    || (this.lockColsRendered && (colSpan - stackedLockColsCount) !== 0);\n                if (isStackedLockColumn) {\n                    rows[parseInt(index.toString(), 10)].cells.push(new Cell({\n                        cellType: CellType.StackedHeader, column: cols,\n                        colSpan: this.getColSpan(colSpan, stackedLockColsCount),\n                        className: isFirstObj ? '' : (isFirstCol ? 'e-firstcell' : '')\n                    }));\n                }\n            }\n            if (this.parent.lockcolPositionCount && !this.lockColsRendered) {\n                for (var i = 0; i < cols.columns.length; i++) {\n                    rows = this.appendCells(cols.columns[parseInt(i.toString(), 10)], rows, index + 1, isFirstObj, i === 0, i === (cols.columns.length - 1) && isLastCol, isMovable, tableName, false);\n                }\n            }\n            if (this.lockColsRendered) {\n                for (var i = 0, len = cols.columns.length; i < len; i++) {\n                    isFirstObj = isFirstObj && i === 0;\n                    var isFirstCol_1 = this.isFirstCol = cols.columns[parseInt(i.toString(), 10)].visible\n                        && !isFirstObj;\n                    var isLaststackedCol = i === (len - 1) && isLastCol;\n                    rows = this.appendCells(cols.columns[parseInt(i.toString(), 10)], rows, index + 1, isFirstObj, isFirstCol_1 && !isLaststackedCol, isLaststackedCol, isMovable, tableName, true);\n                }\n            }\n        }\n        return rows;\n    };\n    HeaderRender.prototype.getStackedLockColsCount = function (col, lockColsCount) {\n        if (col.columns) {\n            for (var i = 0; i < col.columns.length; i++) {\n                lockColsCount = this.getStackedLockColsCount(col.columns[parseInt(i.toString(), 10)], lockColsCount);\n            }\n        }\n        else if (col.lockColumn) {\n            lockColsCount++;\n        }\n        return lockColsCount;\n    };\n    HeaderRender.prototype.getColSpan = function (colSpan, stackedLockColsCount) {\n        colSpan = !this.lockColsRendered ? stackedLockColsCount : colSpan - stackedLockColsCount;\n        return colSpan;\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    HeaderRender.prototype.generateRow = function (index) {\n        return new Row({});\n    };\n    HeaderRender.prototype.generateCell = function (column, cellType, rowSpan, className, rowIndex, colIndex) {\n        var opt = {\n            'visible': column.visible,\n            'isDataCell': false,\n            'isTemplate': !isNullOrUndefined(column.headerTemplate),\n            'rowID': '',\n            'column': column,\n            'cellType': cellType,\n            'rowSpan': rowSpan,\n            'className': className,\n            'index': rowIndex,\n            'colIndex': colIndex\n        };\n        if (!opt.rowSpan || opt.rowSpan < 2) {\n            delete opt.rowSpan;\n        }\n        return new Cell(opt);\n    };\n    /**\n     * Function to hide header table column based on visible property\n     *\n     * @param {Column[]} columns - specifies the column\n     * @returns {void}\n     */\n    HeaderRender.prototype.setVisible = function (columns) {\n        var gObj = this.parent;\n        var displayVal;\n        var idx;\n        for (var c = 0, clen = columns.length; c < clen; c++) {\n            var column = columns[parseInt(c.toString(), 10)];\n            idx = gObj.getNormalizedColumnIndex(column.uid);\n            displayVal = column.visible ? '' : 'none';\n            setStyleAttribute(this.getColGroup().children[parseInt(idx.toString(), 10)], { 'display': displayVal });\n        }\n        this.refreshUI();\n    };\n    HeaderRender.prototype.colPosRefresh = function () {\n        this.refreshUI();\n    };\n    /**\n     * Refresh the header of the Grid.\n     *\n     * @returns {void}\n     */\n    HeaderRender.prototype.refreshUI = function () {\n        var headerDiv = this.getPanel();\n        this.toggleStackClass(headerDiv);\n        var table = this.freezeReorder ? this.headerPanel.querySelector('.' + literals.movableHeader).querySelector('.' + literals.table)\n            : this.getTable();\n        var tableName = undefined;\n        if (table) {\n            remove(table);\n            table.removeChild(table.firstChild);\n            table.removeChild(table.childNodes[0]);\n            var colGroup = this.parent.createElement(literals.colGroup);\n            var findHeaderRow = this.createHeaderContent(tableName);\n            this.rows = findHeaderRow.rows;\n            table.insertBefore(findHeaderRow.thead, table.firstChild);\n            this.updateColGroup(colGroup);\n            table.insertBefore(this.setColGroup(colGroup), table.firstChild);\n            this.appendContent(table);\n            this.parent.notify(events.colGroupRefresh, {});\n            this.widthService.setWidthToColumns();\n            this.parent.updateDefaultCursor();\n            this.initializeHeaderDrag();\n            var rows = [].slice.call(headerDiv.querySelectorAll('tr.e-columnheader'));\n            for (var _i = 0, rows_1 = rows; _i < rows_1.length; _i++) {\n                var row = rows_1[_i];\n                var gCells = [].slice.call(row.getElementsByClassName('e-grouptopleftcell'));\n                if (gCells.length) {\n                    gCells[gCells.length - 1].classList.add('e-lastgrouptopleftcell');\n                }\n            }\n            this.parent.notify(events.headerRefreshed, { rows: this.rows });\n            if (this.parent.enableColumnVirtualization && parentsUntil(table, literals.movableHeader)) {\n                this.parent.notify(events.headerRefreshed, { rows: this.rows, args: { isFrozen: false, isXaxis: true } });\n            }\n            if (this.parent.allowTextWrap && this.parent.textWrapSettings.wrapMode === 'Header') {\n                wrap(rows, true);\n            }\n        }\n        var firstHeaderCell = this.parent.getHeaderContent().querySelector('.e-headercell:not(.e-hide)');\n        if (!isNullOrUndefined(firstHeaderCell)) {\n            firstHeaderCell.tabIndex = 0;\n        }\n    };\n    HeaderRender.prototype.toggleStackClass = function (div) {\n        var column = this.parent.columns;\n        var stackedHdr = column.some(function (column) { return !isNullOrUndefined(column.columns); });\n        if (stackedHdr) {\n            div.classList.add('e-stackedheader');\n        }\n        else {\n            div.classList.remove('e-stackedheader');\n        }\n    };\n    HeaderRender.prototype.appendContent = function (table) {\n        this.getPanel().querySelector('.' + literals.headerContent).appendChild(table);\n    };\n    HeaderRender.prototype.getCellCnt = function (col, cnt) {\n        if (col.columns) {\n            for (var i = 0, len = col.columns.length; i < len; i++) {\n                cnt = this.getCellCnt(col.columns[parseInt(i.toString(), 10)], cnt);\n            }\n        }\n        else {\n            if (col.visible) {\n                cnt++;\n            }\n        }\n        return cnt;\n    };\n    HeaderRender.prototype.initializeHeaderDrag = function () {\n        var gObj = this.parent;\n        if (!(this.parent.allowReordering || (this.parent.allowGrouping && this.parent.groupSettings.showDropArea))) {\n            return;\n        }\n        this.draggable = new Draggable(gObj.getHeaderContent(), {\n            dragTarget: '.e-headercell',\n            distance: 5,\n            helper: this.helper,\n            dragStart: this.dragStart,\n            drag: this.drag,\n            dragStop: this.dragStop,\n            abort: '.e-rhandler',\n            isReplaceDragEle: this.isReplaceDragEle\n        });\n        this.parent.on(events.destroy, this.droppableDestroy, this);\n    };\n    HeaderRender.prototype.initializeHeaderDrop = function () {\n        var gObj = this.parent;\n        this.droppable = new Droppable(gObj.getHeaderContent(), {\n            accept: '.e-dragclone',\n            drop: this.drop\n        });\n        this.parent.on(events.destroy, this.droppableDestroy, this);\n    };\n    HeaderRender.prototype.droppableDestroy = function () {\n        if (this.droppable && !this.droppable.isDestroyed) {\n            this.droppable.destroy();\n        }\n        if (this.draggable && !this.draggable.isDestroyed) {\n            this.draggable.destroy();\n        }\n    };\n    HeaderRender.prototype.renderCustomToolbar = function () {\n        var _this = this;\n        var gObj = this.parent;\n        if (gObj.rowRenderingMode === 'Vertical' && !gObj.toolbar\n            && (gObj.allowSorting || (gObj.allowFiltering && gObj.filterSettings.type !== 'FilterBar'))) {\n            var div = gObj.createElement('div', { className: 'e-res-toolbar e-toolbar' });\n            var toolbarItems = gObj.createElement('div', { className: 'e-toolbar-items' });\n            var toolbarLeft = gObj.createElement('div', { className: 'e-toolbar-left' });\n            var count = this.parent.allowFiltering && this.parent.allowSorting ? 2 : 1;\n            for (var i = 0; i < count; i++) {\n                var toolbarItem = gObj.createElement('div', { className: 'e-toolbar-item e-gridresponsiveicons e-icons e-tbtn-align' });\n                var cls = count === 1 ? this.parent.allowSorting ? 'sort'\n                    : 'filter' : i === 1 ? 'sort' : 'filter';\n                var button = gObj.createElement('button', { className: 'e-tbar-btn e-control e-btn e-lib e-icon-btn' });\n                var span = gObj.createElement('span', { className: 'e-btn-icon e-res' + cls + '-icon e-icons' });\n                button.appendChild(span);\n                var btnObj = new Button({\n                    cssClass: this.parent.cssClass ? this.parent.cssClass : ''\n                });\n                btnObj.appendTo(button);\n                button.onclick = function (e) {\n                    if (e.target.classList.contains('e-ressort-btn')\n                        || e.target.classList.contains('e-ressort-icon')) {\n                        _this.parent.showResponsiveCustomSort();\n                    }\n                    else {\n                        _this.parent.showResponsiveCustomFilter();\n                    }\n                };\n                toolbarItem.appendChild(button);\n                toolbarLeft.appendChild(toolbarItem);\n            }\n            toolbarItems.appendChild(toolbarLeft);\n            div.appendChild(toolbarItems);\n            gObj.element.insertBefore(div, this.parent.element.querySelector('.' + literals.gridHeader));\n        }\n        else {\n            if (gObj.enableAdaptiveUI && !gObj.toolbar) {\n                gObj.getContent().classList.add('e-responsive-header');\n            }\n        }\n    };\n    HeaderRender.prototype.updateCustomResponsiveToolbar = function (args) {\n        var resToolbar = this.parent.element.querySelector('.e-responsive-toolbar');\n        if (args.module === 'toolbar') {\n            if (resToolbar) {\n                remove(resToolbar);\n            }\n            else {\n                this.renderCustomToolbar();\n            }\n        }\n    };\n    return HeaderRender;\n}());\nexport { HeaderRender };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}