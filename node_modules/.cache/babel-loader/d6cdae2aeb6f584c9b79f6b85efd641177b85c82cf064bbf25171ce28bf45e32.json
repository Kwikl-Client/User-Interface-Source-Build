{"ast":null,"code":"import { contains } from '@syncfusion/ej2-drawings';\nimport { Rect } from '@syncfusion/ej2-drawings';\nimport { Point, identityMatrix, rotateMatrix } from '@syncfusion/ej2-drawings';\nimport { Container, transformPointByMatrix } from '@syncfusion/ej2-drawings';\nimport { isPointOverConnector } from './connector-util';\nimport { LineTool, NodeDrawingTool, StampTool } from './tools';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n * @param {MouseEvent | TouchEvent} event - Specified the annotaion event.\n * @param {PdfViewerBase} pdfBase - Specified the pdfviewer base element.\n * @param {PdfViewer} pdfViewer - Specified the pdfviewer element.\n * @param {boolean} isOverlapped - Specified the overlapped element or not.\n * @returns {any} - Returns the active element.\n */\n// eslint-disable-next-line\nexport function findActiveElement(event, pdfBase, pdfViewer, isOverlapped) {\n  if (pdfViewer && pdfBase.activeElements.activePageID > -1) {\n    var objects = findObjectsUnderMouse(pdfBase, pdfViewer, event);\n    var object = findObjectUnderMouse(objects, event, pdfBase, pdfViewer);\n    if (isOverlapped) {\n      return objects;\n    }\n    return object;\n  }\n  return undefined;\n}\n/**\n * @private\n * @param {PdfViewerBase} pdfBase - Specified the pdfviewer base element.\n * @param {PdfViewer} pdfViewer - Specified the pdfviewer element.\n * @param {MouseEvent} event - Specified the annotaion event.\n * @returns {IElement[]} - Returns the annotaion elements.\n */\nexport function findObjectsUnderMouse(pdfBase, pdfViewer, event) {\n  var pt = pdfBase.currentPosition || {\n    x: event.offsetX,\n    y: event.offsetY\n  };\n  pt = {\n    x: pt.x / pdfBase.getZoomFactor(),\n    y: pt.y / pdfBase.getZoomFactor()\n  };\n  var pageTable = pdfViewer.getPageTable(pdfBase.activeElements.activePageID);\n  var objArray = findObjects(pt, pageTable.objects, pdfViewer.touchPadding);\n  return objArray;\n}\n/**\n * @private\n * @param {PdfAnnotationBaseModel[]} objects - Specified the annotaion object model.\n * @param {any} event - Specified the annotaion event.\n * @param {PdfViewerBase} pdfBase - Specified the pdfviewer base element.\n * @param {PdfViewer} pdfViewer - Specified the pdfviewer element.\n * @returns {IElement} - Returns the annotaion element.\n */\nexport function findObjectUnderMouse(\n// eslint-disable-next-line\nobjects, event, pdfBase, pdfViewer) {\n  var actualTarget = null;\n  var touchArg;\n  var offsetX;\n  var offsetY;\n  if (event && event.type && event.type.indexOf('touch') !== -1) {\n    touchArg = event;\n    if (pdfViewer.annotation) {\n      var pageDiv = pdfBase.getElement('_pageDiv_' + pdfViewer.annotation.getEventPageNumber(event));\n      if (pageDiv) {\n        var pageCurrentRect = pageDiv.getBoundingClientRect();\n        offsetX = touchArg.changedTouches[0].clientX - pageCurrentRect.left;\n        offsetY = touchArg.changedTouches[0].clientY - pageCurrentRect.top;\n      }\n    }\n    // eslint-disable-next-line\n  } else if (event && event.target && event.path && event.target.parentElement && event.target.parentElement.classList.contains('foreign-object')) {\n    // eslint-disable-next-line\n    var targetParentRect = event.path[4].getBoundingClientRect();\n    offsetX = event.clientX - targetParentRect.left;\n    offsetY = event.clientY - targetParentRect.top;\n  } else if (event.target && event.target.parentElement && event.target.parentElement.classList.contains('foreign-object')) {\n    // eslint-disable-next-line\n    var targetParentRect = event.target.offsetParent.offsetParent.offsetParent.getBoundingClientRect();\n    offsetX = event.clientX - targetParentRect.left;\n    offsetY = event.clientY - targetParentRect.top;\n    // eslint-disable-next-line\n  } else if (event.target && event.target.parentElement && event.target.parentElement.parentElement && event.target.parentElement.parentElement.classList.contains('foreign-object')) {\n    var targetParentRect = void 0;\n    if (event.target.offsetParent && event.target.offsetParent.offsetParent && event.target.offsetParent.offsetParent.offsetParent && event.target.offsetParent.offsetParent.offsetParent.offsetParent) {\n      // eslint-disable-next-line\n      targetParentRect = event.target.offsetParent.offsetParent.offsetParent.offsetParent.getBoundingClientRect();\n      offsetX = event.clientX - targetParentRect.left;\n      offsetY = event.clientY - targetParentRect.top;\n    } else if (event.target.parentElement.offsetParent && event.target.parentElement.offsetParent.offsetParent) {\n      // eslint-disable-next-line\n      targetParentRect = event.target.parentElement.offsetParent.offsetParent.getBoundingClientRect();\n      offsetX = event.clientX - targetParentRect.left;\n      offsetY = event.clientY - targetParentRect.top;\n      // eslint-disable-next-line\n    }\n  } else {\n    offsetX = !isNaN(event.offsetX) ? event.offsetX : event.position ? event.position.x : 0;\n    offsetY = !isNaN(event.offsetY) ? event.offsetY : event.position ? event.position.y : 0;\n  }\n  //EJ2-63562 - Reduced the offset selector by half to improve selection of fields in mobile devices\n  var offsetForSelector = pdfViewer.touchPadding / 2;\n  var boundsDiff = 0;\n  for (var i = 0; i < objects.length; i++) {\n    if (!(objects[parseInt(i.toString(), 10)].shapeAnnotationType === 'Distance' || objects[parseInt(i.toString(), 10)].shapeAnnotationType === 'Line' || objects[parseInt(i.toString(), 10)].shapeAnnotationType === 'LineWidthArrowHead' || pdfBase.tool instanceof LineTool)) {\n      var bounds = objects[parseInt(i.toString(), 10)].wrapper.bounds;\n      var rotationValue = 0;\n      if (objects[parseInt(i.toString(), 10)].shapeAnnotationType === 'Stamp' || objects[parseInt(i.toString(), 10)].shapeAnnotationType === 'Image') {\n        rotationValue = 25;\n      }\n      // eslint-disable-next-line max-len\n      if ((bounds.x - offsetForSelector) * pdfBase.getZoomFactor() < offsetX && (bounds.x + bounds.width + offsetForSelector) * pdfBase.getZoomFactor() > offsetX &&\n      // eslint-disable-next-line max-len\n      (bounds.y - offsetForSelector - rotationValue) * pdfBase.getZoomFactor() < offsetY && (bounds.y + bounds.height + offsetForSelector) * pdfBase.getZoomFactor() > offsetY) {\n        if (pdfBase.tool instanceof NodeDrawingTool || pdfBase.tool instanceof StampTool) {\n          actualTarget = objects[parseInt(i.toString(), 10)];\n        } else {\n          if (!boundsDiff) {\n            actualTarget = objects[parseInt(i.toString(), 10)];\n            // eslint-disable-next-line max-len\n            boundsDiff = offsetX - (bounds.x - offsetForSelector) * pdfBase.getZoomFactor() + ((bounds.x + bounds.width + offsetForSelector) * pdfBase.getZoomFactor() - offsetX) + (\n            // eslint-disable-next-line max-len\n            offsetY - (bounds.y - offsetForSelector - rotationValue) * pdfBase.getZoomFactor()) + ((bounds.y + bounds.height + offsetForSelector) * pdfBase.getZoomFactor() - offsetY);\n          } else {\n            // eslint-disable-next-line max-len\n            var objectBounds = offsetX - (bounds.x - offsetForSelector) * pdfBase.getZoomFactor() + ((bounds.x + bounds.width + offsetForSelector) * pdfBase.getZoomFactor() - offsetX) + (\n            // eslint-disable-next-line max-len\n            offsetY - (bounds.y - offsetForSelector - rotationValue) * pdfBase.getZoomFactor()) + ((bounds.y + bounds.height + offsetForSelector) * pdfBase.getZoomFactor() - offsetY);\n            if (boundsDiff > objectBounds) {\n              actualTarget = objects[parseInt(i.toString(), 10)];\n              boundsDiff = objectBounds;\n            } else if (boundsDiff === objectBounds) {\n              actualTarget = objects[parseInt(i.toString(), 10)];\n              boundsDiff = objectBounds;\n            } else if (objects[parseInt(i.toString(), 10)].shapeAnnotationType === \"Image\" || objects[parseInt(i.toString(), 10)].shapeAnnotationType === \"Stamp\") {\n              actualTarget = objects[parseInt(i.toString(), 10)];\n            }\n          }\n        }\n      }\n    } else {\n      var pt = {\n        x: offsetX / pdfBase.getZoomFactor(),\n        y: offsetY / pdfBase.getZoomFactor()\n      };\n      var obj = findElementUnderMouse(objects[parseInt(i.toString(), 10)], pt, offsetForSelector);\n      var isOver = isPointOverConnector(objects[parseInt(i.toString(), 10)], pt);\n      if (obj && !isOver) {\n        var newpoint = CalculateLeaderPoints(objects[parseInt(i.toString(), 10)], obj);\n        if (newpoint) {\n          var rect = Rect.toBounds([newpoint, newpoint]);\n          rect.Inflate(10);\n          if (rect.containsPoint(pt)) {\n            isOver = true;\n          }\n        }\n      }\n      if (obj && isOver) {\n        actualTarget = objects[parseInt(i.toString(), 10)];\n      }\n    }\n  }\n  return actualTarget;\n}\n/**\n * @private\n * @param {any} selector - Specified the annotaion selctor.\n * @param {any} currentobject - Specified the current annotaion object.\n * @returns {any} - Returns the leader points.\n */\n// eslint-disable-next-line\nexport function CalculateLeaderPoints(selector, currentobject) {\n  var leaderCount = 0;\n  var sourcePoint = selector.sourcePoint;\n  var targetPoint = selector.targetPoint;\n  if (selector.shapeAnnotationType === 'Distance') {\n    var segment = currentobject;\n    var newPoint1 = void 0;\n    var angle = Point.findAngle(selector.sourcePoint, selector.targetPoint);\n    if (segment.id.indexOf('leader') > -1) {\n      var center = selector.wrapper.children[0].bounds.center;\n      if (leaderCount === 0 && segment.id.indexOf('leader1') > -1) {\n        newPoint1 = {\n          x: selector.sourcePoint.x,\n          y: selector.sourcePoint.y - selector.leaderHeight\n        };\n        center = sourcePoint;\n      } else {\n        newPoint1 = {\n          x: selector.targetPoint.x,\n          y: selector.targetPoint.y - selector.leaderHeight\n        };\n        center = targetPoint;\n      }\n      var matrix = identityMatrix();\n      rotateMatrix(matrix, angle, center.x, center.y);\n      var rotatedPoint = transformPointByMatrix(matrix, {\n        x: newPoint1.x,\n        y: newPoint1.y\n      });\n      return rotatedPoint;\n    }\n  }\n}\n/**\n * @private\n * @param {IElement} obj - Specified the annotation element.\n * @param {PointModel} position - Specified the annotation position value.\n * @param {number} padding - Specified the annotation padding.\n * @returns {DrawingElement} - Returns the annotation drawing element.\n */\nexport function findElementUnderMouse(obj, position, padding) {\n  return findTargetShapeElement(obj.wrapper, position, padding);\n}\n/**\n * @private\n * @param {PdfAnnotationBaseModel} obj - Specified the annotation object model.\n * @param {string} key - Specified the annotation key value.\n * @param {Object[]} collection - Specified the annotation collection.\n * @returns {void}\n */\nexport function insertObject(obj, key, collection) {\n  if (collection.length === 0) {\n    collection.push(obj);\n  } else if (collection.length === 1) {\n    // eslint-disable-next-line\n    if (collection[0][key] > obj[key]) {\n      collection.splice(0, 0, obj);\n    } else {\n      collection.push(obj);\n    }\n  } else if (collection.length > 1) {\n    var low = 0;\n    var high = collection.length - 1;\n    var mid = Math.floor((low + high) / 2);\n    while (mid !== low) {\n      // eslint-disable-next-line\n      if (collection[mid][key] < obj[key]) {\n        low = mid;\n        mid = Math.floor((low + high) / 2);\n        // eslint-disable-next-line\n      } else if (collection[mid][key] > obj[key]) {\n        high = mid;\n        mid = Math.floor((low + high) / 2);\n      }\n    }\n    // eslint-disable-next-line\n    if (collection[high][key] < obj[key]) {\n      collection.push(obj);\n      // eslint-disable-next-line\n    } else if (collection[low][key] > obj[key]) {\n      collection.splice(low, 0, obj);\n      // eslint-disable-next-line\n    } else if (collection[low][key] < obj[key] && collection[high][key] > obj[key]) {\n      collection.splice(high, 0, obj);\n    }\n  }\n}\n/**\n * @private\n * @param {Container} container - Specified the annotaion container.\n * @param {PointModel} position - Specified the annotation position.\n * @param {number} padding - Specified the annotaion padding value.\n * @returns {DrawingElement} - Returns the annotation drawing element.\n */\nexport function findTargetShapeElement(container, position, padding) {\n  if (container && container.children) {\n    for (var i = container.children.length - 1; i >= 0; i--) {\n      var shapeElement = container.children[parseInt(i.toString(), 10)];\n      var touchPadding = padding;\n      // eslint-disable-next-line\n      if (!isNullOrUndefined(shapeElement.children) && shapeElement.children.length > 0) {\n        // eslint-disable-next-line\n        for (var j = shapeElement.children.length - 1; j >= 0; j--) {\n          // eslint-disable-next-line\n          var currentTarget = shapeElement.children[j];\n          if (currentTarget && currentTarget.bounds.containsPoint(position, touchPadding)) {\n            if (currentTarget instanceof Container) {\n              var targetElement = this.findTargetElement(currentTarget, position);\n              if (targetElement) {\n                return targetElement;\n              }\n            }\n            if (currentTarget.bounds.containsPoint(position, touchPadding)) {\n              return currentTarget;\n            }\n          }\n        }\n      } else {\n        if (shapeElement && shapeElement.bounds.containsPoint(position, touchPadding)) {\n          if (shapeElement instanceof Container) {\n            var targetElement = this.findTargetElement(shapeElement, position);\n            if (targetElement) {\n              return targetElement;\n            }\n          }\n          if (shapeElement.bounds.containsPoint(position, touchPadding)) {\n            return shapeElement;\n          }\n        }\n      }\n    }\n  }\n  if (container && container.bounds.containsPoint(position, padding) && container.style.fill !== 'none') {\n    var element = container;\n    var paddingValue = 10;\n    var rotateThumbDistance = 30;\n    var matrix = identityMatrix();\n    rotateMatrix(matrix, element.parentTransform, element.offsetX, element.offsetY);\n    var x = element.offsetX - element.pivot.x * element.actualSize.width;\n    var y = element.offsetY - element.pivot.y * element.actualSize.height;\n    var rotateThumb = {\n      x: x + (element.pivot.x === 0.5 ? element.pivot.x * 2 : element.pivot.x) * element.actualSize.width / 2,\n      y: y - rotateThumbDistance\n    };\n    rotateThumb = transformPointByMatrix(matrix, rotateThumb);\n    if (contains(position, rotateThumb, paddingValue)) {\n      return container;\n    }\n  }\n  return null;\n}\n/**\n * @private\n * @param {PointModel} region - Specified the annotation region point model.\n * @param {PdfAnnotationBaseModel[]} objCollection - Specified the annotation object collections.\n * @returns {PdfAnnotationBaseModel[]} - Returns the annotation object collections.\n */\nexport function findObjects(region, objCollection, touchPadding) {\n  var objects = [];\n  for (var _i = 0, objCollection_1 = objCollection; _i < objCollection_1.length; _i++) {\n    var obj = objCollection_1[_i];\n    if (findElementUnderMouse(obj, region, touchPadding) || obj.shapeAnnotationType === 'Stamp' && findElementUnderMouse(obj, region, 40)) {\n      insertObject(obj, 'zIndex', objects);\n    }\n  }\n  return objects;\n}\n/**\n * @private\n * @param {MouseEvent} event - Specified the annotaion mouse event.\n * @param {PdfViewerBase} pdfBase - Specified the pdfBase element.\n * @returns {number} - Returns the active page Id.\n */\nexport function findActivePage(event, pdfBase) {\n  var activePageID = undefined;\n  if (event.target && event.target.wrapper) {\n    return event.target.pageIndex;\n  }\n  if (event.target) {\n    var elementIdColl = event.target.id.split('_');\n    if (elementIdColl.length > 0) {\n      // eslint-disable-next-line radix\n      activePageID = parseInt(elementIdColl[elementIdColl.length - 1]);\n    }\n  }\n  return activePageID;\n}\n/**\n * @hidden\n */\nvar ActiveElements = /** @class */function () {\n  function ActiveElements() {\n    this.activePage = undefined;\n    this.activePageID = undefined;\n  }\n  Object.defineProperty(ActiveElements.prototype, \"activePageID\", {\n    /**\n     * @private\n     * @returns {number} - Returns the active page Id.\n     */\n    get: function () {\n      return this.activePage;\n    },\n    /**\n     * @private\n     * @param {number} offset - The page offset value.\n     */\n    set: function (offset) {\n      this.activePage = offset;\n      // eslint-disable-next-line\n      if (offset !== this.activePage) {}\n    },\n    enumerable: true,\n    configurable: true\n  });\n  return ActiveElements;\n}();\nexport { ActiveElements };","map":{"version":3,"names":["contains","Rect","Point","identityMatrix","rotateMatrix","Container","transformPointByMatrix","isPointOverConnector","LineTool","NodeDrawingTool","StampTool","isNullOrUndefined","findActiveElement","event","pdfBase","pdfViewer","isOverlapped","activeElements","activePageID","objects","findObjectsUnderMouse","object","findObjectUnderMouse","undefined","pt","currentPosition","x","offsetX","y","offsetY","getZoomFactor","pageTable","getPageTable","objArray","findObjects","touchPadding","actualTarget","touchArg","type","indexOf","annotation","pageDiv","getElement","getEventPageNumber","pageCurrentRect","getBoundingClientRect","changedTouches","clientX","left","clientY","top","target","path","parentElement","classList","targetParentRect","offsetParent","isNaN","position","offsetForSelector","boundsDiff","i","length","parseInt","toString","shapeAnnotationType","tool","bounds","wrapper","rotationValue","width","height","objectBounds","obj","findElementUnderMouse","isOver","newpoint","CalculateLeaderPoints","rect","toBounds","Inflate","containsPoint","selector","currentobject","leaderCount","sourcePoint","targetPoint","segment","newPoint1","angle","findAngle","id","center","children","leaderHeight","matrix","rotatedPoint","padding","findTargetShapeElement","insertObject","key","collection","push","splice","low","high","mid","Math","floor","container","shapeElement","j","currentTarget","targetElement","findTargetElement","style","fill","element","paddingValue","rotateThumbDistance","parentTransform","pivot","actualSize","rotateThumb","region","objCollection","_i","objCollection_1","findActivePage","pageIndex","elementIdColl","split","ActiveElements","activePage","Object","defineProperty","prototype","get","set","offset","enumerable","configurable"],"sources":["/Users/saleem/Desktop/KClient/Web App/Ver_3.6/User Interface/website_Source files/node_modules/@syncfusion/ej2-pdfviewer/src/pdfviewer/drawing/action.js"],"sourcesContent":["import { contains } from '@syncfusion/ej2-drawings';\nimport { Rect } from '@syncfusion/ej2-drawings';\nimport { Point, identityMatrix, rotateMatrix } from '@syncfusion/ej2-drawings';\nimport { Container, transformPointByMatrix } from '@syncfusion/ej2-drawings';\nimport { isPointOverConnector } from './connector-util';\nimport { LineTool, NodeDrawingTool, StampTool } from './tools';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n * @param {MouseEvent | TouchEvent} event - Specified the annotaion event.\n * @param {PdfViewerBase} pdfBase - Specified the pdfviewer base element.\n * @param {PdfViewer} pdfViewer - Specified the pdfviewer element.\n * @param {boolean} isOverlapped - Specified the overlapped element or not.\n * @returns {any} - Returns the active element.\n */\n// eslint-disable-next-line\nexport function findActiveElement(event, pdfBase, pdfViewer, isOverlapped) {\n    if (pdfViewer && pdfBase.activeElements.activePageID > -1) {\n        var objects = findObjectsUnderMouse(pdfBase, pdfViewer, event);\n        var object = findObjectUnderMouse(objects, event, pdfBase, pdfViewer);\n        if (isOverlapped) {\n            return objects;\n        }\n        return object;\n    }\n    return undefined;\n}\n/**\n * @private\n * @param {PdfViewerBase} pdfBase - Specified the pdfviewer base element.\n * @param {PdfViewer} pdfViewer - Specified the pdfviewer element.\n * @param {MouseEvent} event - Specified the annotaion event.\n * @returns {IElement[]} - Returns the annotaion elements.\n */\nexport function findObjectsUnderMouse(pdfBase, pdfViewer, event) {\n    var pt = pdfBase.currentPosition || { x: event.offsetX, y: event.offsetY };\n    pt = { x: pt.x / pdfBase.getZoomFactor(), y: pt.y / pdfBase.getZoomFactor() };\n    var pageTable = pdfViewer.getPageTable(pdfBase.activeElements.activePageID);\n    var objArray = findObjects(pt, pageTable.objects, pdfViewer.touchPadding);\n    return objArray;\n}\n/**\n * @private\n * @param {PdfAnnotationBaseModel[]} objects - Specified the annotaion object model.\n * @param {any} event - Specified the annotaion event.\n * @param {PdfViewerBase} pdfBase - Specified the pdfviewer base element.\n * @param {PdfViewer} pdfViewer - Specified the pdfviewer element.\n * @returns {IElement} - Returns the annotaion element.\n */\nexport function findObjectUnderMouse(\n// eslint-disable-next-line\nobjects, event, pdfBase, pdfViewer) {\n    var actualTarget = null;\n    var touchArg;\n    var offsetX;\n    var offsetY;\n    if (event && event.type && event.type.indexOf('touch') !== -1) {\n        touchArg = event;\n        if (pdfViewer.annotation) {\n            var pageDiv = pdfBase.getElement('_pageDiv_' + pdfViewer.annotation.getEventPageNumber(event));\n            if (pageDiv) {\n                var pageCurrentRect = pageDiv.getBoundingClientRect();\n                offsetX = touchArg.changedTouches[0].clientX - pageCurrentRect.left;\n                offsetY = touchArg.changedTouches[0].clientY - pageCurrentRect.top;\n            }\n        }\n        // eslint-disable-next-line\n    }\n    else if (event && event.target && event.path && event.target.parentElement && event.target.parentElement.classList.contains('foreign-object')) {\n        // eslint-disable-next-line\n        var targetParentRect = event.path[4].getBoundingClientRect();\n        offsetX = event.clientX - targetParentRect.left;\n        offsetY = event.clientY - targetParentRect.top;\n    }\n    else if (event.target && event.target.parentElement && event.target.parentElement.classList.contains('foreign-object')) {\n        // eslint-disable-next-line\n        var targetParentRect = event.target.offsetParent.offsetParent.offsetParent.getBoundingClientRect();\n        offsetX = event.clientX - targetParentRect.left;\n        offsetY = event.clientY - targetParentRect.top;\n        // eslint-disable-next-line\n    }\n    else if (event.target && event.target.parentElement && event.target.parentElement.parentElement && event.target.parentElement.parentElement.classList.contains('foreign-object')) {\n        var targetParentRect = void 0;\n        if (event.target.offsetParent && event.target.offsetParent.offsetParent && event.target.offsetParent.offsetParent.offsetParent && event.target.offsetParent.offsetParent.offsetParent.offsetParent) {\n            // eslint-disable-next-line\n            targetParentRect = event.target.offsetParent.offsetParent.offsetParent.offsetParent.getBoundingClientRect();\n            offsetX = event.clientX - targetParentRect.left;\n            offsetY = event.clientY - targetParentRect.top;\n        }\n        else if (event.target.parentElement.offsetParent && event.target.parentElement.offsetParent.offsetParent) {\n            // eslint-disable-next-line\n            targetParentRect = event.target.parentElement.offsetParent.offsetParent.getBoundingClientRect();\n            offsetX = event.clientX - targetParentRect.left;\n            offsetY = event.clientY - targetParentRect.top;\n            // eslint-disable-next-line\n        }\n    }\n    else {\n        offsetX = !isNaN(event.offsetX) ? event.offsetX : (event.position ? event.position.x : 0);\n        offsetY = !isNaN(event.offsetY) ? event.offsetY : (event.position ? event.position.y : 0);\n    }\n    //EJ2-63562 - Reduced the offset selector by half to improve selection of fields in mobile devices\n    var offsetForSelector = pdfViewer.touchPadding / 2;\n    var boundsDiff = 0;\n    for (var i = 0; i < objects.length; i++) {\n        if (!(objects[parseInt(i.toString(), 10)].shapeAnnotationType === 'Distance' || objects[parseInt(i.toString(), 10)].shapeAnnotationType === 'Line' || objects[parseInt(i.toString(), 10)].shapeAnnotationType === 'LineWidthArrowHead' || pdfBase.tool instanceof LineTool)) {\n            var bounds = objects[parseInt(i.toString(), 10)].wrapper.bounds;\n            var rotationValue = 0;\n            if (objects[parseInt(i.toString(), 10)].shapeAnnotationType === 'Stamp' || objects[parseInt(i.toString(), 10)].shapeAnnotationType === 'Image') {\n                rotationValue = 25;\n            }\n            // eslint-disable-next-line max-len\n            if ((((bounds.x - offsetForSelector) * pdfBase.getZoomFactor()) < offsetX) && (((bounds.x + bounds.width + offsetForSelector) * pdfBase.getZoomFactor()) > offsetX) &&\n                // eslint-disable-next-line max-len\n                (((bounds.y - offsetForSelector - rotationValue) * pdfBase.getZoomFactor()) < offsetY) && (((bounds.y + bounds.height + offsetForSelector) * pdfBase.getZoomFactor()) > offsetY)) {\n                if (pdfBase.tool instanceof NodeDrawingTool || pdfBase.tool instanceof StampTool) {\n                    actualTarget = objects[parseInt(i.toString(), 10)];\n                }\n                else {\n                    if (!boundsDiff) {\n                        actualTarget = objects[parseInt(i.toString(), 10)];\n                        // eslint-disable-next-line max-len\n                        boundsDiff = (offsetX - ((bounds.x - offsetForSelector) * pdfBase.getZoomFactor())) + (((bounds.x + bounds.width + offsetForSelector) * pdfBase.getZoomFactor()) - offsetX) +\n                            // eslint-disable-next-line max-len\n                            (offsetY - ((bounds.y - offsetForSelector - rotationValue) * pdfBase.getZoomFactor())) + (((bounds.y + bounds.height + offsetForSelector) * pdfBase.getZoomFactor()) - offsetY);\n                    }\n                    else {\n                        // eslint-disable-next-line max-len\n                        var objectBounds = (offsetX - ((bounds.x - offsetForSelector) * pdfBase.getZoomFactor())) + (((bounds.x + bounds.width + offsetForSelector) * pdfBase.getZoomFactor()) - offsetX) +\n                            // eslint-disable-next-line max-len\n                            (offsetY - ((bounds.y - offsetForSelector - rotationValue) * pdfBase.getZoomFactor())) + (((bounds.y + bounds.height + offsetForSelector) * pdfBase.getZoomFactor()) - offsetY);\n                        if (boundsDiff > objectBounds) {\n                            actualTarget = objects[parseInt(i.toString(), 10)];\n                            boundsDiff = objectBounds;\n                        }\n                        else if (boundsDiff === objectBounds) {\n                            actualTarget = objects[parseInt(i.toString(), 10)];\n                            boundsDiff = objectBounds;\n                        }\n                        else if ((objects[parseInt(i.toString(), 10)].shapeAnnotationType === \"Image\") || (objects[parseInt(i.toString(), 10)].shapeAnnotationType === \"Stamp\")) {\n                            actualTarget = objects[parseInt(i.toString(), 10)];\n                        }\n                    }\n                }\n            }\n        }\n        else {\n            var pt = { x: offsetX / pdfBase.getZoomFactor(), y: offsetY / pdfBase.getZoomFactor() };\n            var obj = findElementUnderMouse(objects[parseInt(i.toString(), 10)], pt, offsetForSelector);\n            var isOver = isPointOverConnector(objects[parseInt(i.toString(), 10)], pt);\n            if (obj && !isOver) {\n                var newpoint = CalculateLeaderPoints(objects[parseInt(i.toString(), 10)], obj);\n                if (newpoint) {\n                    var rect = Rect.toBounds([newpoint, newpoint]);\n                    rect.Inflate(10);\n                    if (rect.containsPoint(pt)) {\n                        isOver = true;\n                    }\n                }\n            }\n            if (obj && isOver) {\n                actualTarget = objects[parseInt(i.toString(), 10)];\n            }\n        }\n    }\n    return actualTarget;\n}\n/**\n * @private\n * @param {any} selector - Specified the annotaion selctor.\n * @param {any} currentobject - Specified the current annotaion object.\n * @returns {any} - Returns the leader points.\n */\n// eslint-disable-next-line\nexport function CalculateLeaderPoints(selector, currentobject) {\n    var leaderCount = 0;\n    var sourcePoint = selector.sourcePoint;\n    var targetPoint = selector.targetPoint;\n    if (selector.shapeAnnotationType === 'Distance') {\n        var segment = currentobject;\n        var newPoint1 = void 0;\n        var angle = Point.findAngle(selector.sourcePoint, selector.targetPoint);\n        if (segment.id.indexOf('leader') > -1) {\n            var center = selector.wrapper.children[0].bounds.center;\n            if (leaderCount === 0 && segment.id.indexOf('leader1') > -1) {\n                newPoint1 = { x: selector.sourcePoint.x, y: selector.sourcePoint.y - selector.leaderHeight };\n                center = sourcePoint;\n            }\n            else {\n                newPoint1 = { x: selector.targetPoint.x, y: selector.targetPoint.y - selector.leaderHeight };\n                center = targetPoint;\n            }\n            var matrix = identityMatrix();\n            rotateMatrix(matrix, angle, center.x, center.y);\n            var rotatedPoint = transformPointByMatrix(matrix, { x: newPoint1.x, y: newPoint1.y });\n            return rotatedPoint;\n        }\n    }\n}\n/**\n * @private\n * @param {IElement} obj - Specified the annotation element.\n * @param {PointModel} position - Specified the annotation position value.\n * @param {number} padding - Specified the annotation padding.\n * @returns {DrawingElement} - Returns the annotation drawing element.\n */\nexport function findElementUnderMouse(obj, position, padding) {\n    return findTargetShapeElement(obj.wrapper, position, padding);\n}\n/**\n * @private\n * @param {PdfAnnotationBaseModel} obj - Specified the annotation object model.\n * @param {string} key - Specified the annotation key value.\n * @param {Object[]} collection - Specified the annotation collection.\n * @returns {void}\n */\nexport function insertObject(obj, key, collection) {\n    if (collection.length === 0) {\n        collection.push(obj);\n    }\n    else if (collection.length === 1) {\n        // eslint-disable-next-line\n        if (collection[0][key] > obj[key]) {\n            collection.splice(0, 0, obj);\n        }\n        else {\n            collection.push(obj);\n        }\n    }\n    else if (collection.length > 1) {\n        var low = 0;\n        var high = collection.length - 1;\n        var mid = Math.floor((low + high) / 2);\n        while (mid !== low) {\n            // eslint-disable-next-line\n            if (collection[mid][key] < obj[key]) {\n                low = mid;\n                mid = Math.floor((low + high) / 2);\n                // eslint-disable-next-line\n            }\n            else if (collection[mid][key] > obj[key]) {\n                high = mid;\n                mid = Math.floor((low + high) / 2);\n            }\n        }\n        // eslint-disable-next-line\n        if (collection[high][key] < obj[key]) {\n            collection.push(obj);\n            // eslint-disable-next-line\n        }\n        else if (collection[low][key] > obj[key]) {\n            collection.splice(low, 0, obj);\n            // eslint-disable-next-line\n        }\n        else if ((collection[low][key] < obj[key]) && collection[high][key] > obj[key]) {\n            collection.splice(high, 0, obj);\n        }\n    }\n}\n/**\n * @private\n * @param {Container} container - Specified the annotaion container.\n * @param {PointModel} position - Specified the annotation position.\n * @param {number} padding - Specified the annotaion padding value.\n * @returns {DrawingElement} - Returns the annotation drawing element.\n */\nexport function findTargetShapeElement(container, position, padding) {\n    if (container && container.children) {\n        for (var i = container.children.length - 1; i >= 0; i--) {\n            var shapeElement = container.children[parseInt(i.toString(), 10)];\n            var touchPadding = padding;\n            // eslint-disable-next-line\n            if (!isNullOrUndefined(shapeElement.children) && shapeElement.children.length > 0) {\n                // eslint-disable-next-line\n                for (var j = shapeElement.children.length - 1; j >= 0; j--) {\n                    // eslint-disable-next-line\n                    var currentTarget = shapeElement.children[j];\n                    if (currentTarget && currentTarget.bounds.containsPoint(position, touchPadding)) {\n                        if (currentTarget instanceof Container) {\n                            var targetElement = this.findTargetElement(currentTarget, position);\n                            if (targetElement) {\n                                return targetElement;\n                            }\n                        }\n                        if (currentTarget.bounds.containsPoint(position, touchPadding)) {\n                            return currentTarget;\n                        }\n                    }\n                }\n            }\n            else {\n                if (shapeElement && shapeElement.bounds.containsPoint(position, touchPadding)) {\n                    if (shapeElement instanceof Container) {\n                        var targetElement = this.findTargetElement(shapeElement, position);\n                        if (targetElement) {\n                            return targetElement;\n                        }\n                    }\n                    if (shapeElement.bounds.containsPoint(position, touchPadding)) {\n                        return shapeElement;\n                    }\n                }\n            }\n        }\n    }\n    if (container && container.bounds.containsPoint(position, padding) && container.style.fill !== 'none') {\n        var element = container;\n        var paddingValue = 10;\n        var rotateThumbDistance = 30;\n        var matrix = identityMatrix();\n        rotateMatrix(matrix, element.parentTransform, element.offsetX, element.offsetY);\n        var x = element.offsetX - element.pivot.x * element.actualSize.width;\n        var y = element.offsetY - element.pivot.y * element.actualSize.height;\n        var rotateThumb = {\n            x: x + ((element.pivot.x === 0.5 ? element.pivot.x * 2 : element.pivot.x) * element.actualSize.width / 2),\n            y: y - rotateThumbDistance\n        };\n        rotateThumb = transformPointByMatrix(matrix, rotateThumb);\n        if (contains(position, rotateThumb, paddingValue)) {\n            return container;\n        }\n    }\n    return null;\n}\n/**\n * @private\n * @param {PointModel} region - Specified the annotation region point model.\n * @param {PdfAnnotationBaseModel[]} objCollection - Specified the annotation object collections.\n * @returns {PdfAnnotationBaseModel[]} - Returns the annotation object collections.\n */\nexport function findObjects(region, objCollection, touchPadding) {\n    var objects = [];\n    for (var _i = 0, objCollection_1 = objCollection; _i < objCollection_1.length; _i++) {\n        var obj = objCollection_1[_i];\n        if (findElementUnderMouse(obj, region, touchPadding) || ((obj.shapeAnnotationType === 'Stamp') && findElementUnderMouse(obj, region, 40))) {\n            insertObject(obj, 'zIndex', objects);\n        }\n    }\n    return objects;\n}\n/**\n * @private\n * @param {MouseEvent} event - Specified the annotaion mouse event.\n * @param {PdfViewerBase} pdfBase - Specified the pdfBase element.\n * @returns {number} - Returns the active page Id.\n */\nexport function findActivePage(event, pdfBase) {\n    var activePageID = undefined;\n    if (event.target && event.target.wrapper) {\n        return event.target.pageIndex;\n    }\n    if (event.target) {\n        var elementIdColl = event.target.id.split('_');\n        if (elementIdColl.length > 0) {\n            // eslint-disable-next-line radix\n            activePageID = parseInt(elementIdColl[elementIdColl.length - 1]);\n        }\n    }\n    return activePageID;\n}\n/**\n * @hidden\n */\nvar ActiveElements = /** @class */ (function () {\n    function ActiveElements() {\n        this.activePage = undefined;\n        this.activePageID = undefined;\n    }\n    Object.defineProperty(ActiveElements.prototype, \"activePageID\", {\n        /**\n         * @private\n         * @returns {number} - Returns the active page Id.\n         */\n        get: function () {\n            return this.activePage;\n        },\n        /**\n         * @private\n         * @param {number} offset - The page offset value.\n         */\n        set: function (offset) {\n            this.activePage = offset;\n            // eslint-disable-next-line\n            if (offset !== this.activePage) { }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return ActiveElements;\n}());\nexport { ActiveElements };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}